const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/jszip.min-DiWZ7tmh.js","assets/vendor-react-RsqJS7wA.js","assets/vendor-export-UWB0VjdR.js"])))=>i.map(i=>d[i]);
import{j as e,M as t,r as n}from"./vendor-markdown-iz-HGMzE.js";import{r,g as a,a as i}from"./vendor-react-RsqJS7wA.js";import{s as o,z as s,a as l,l as c,m as u,c as d,b as p,d as h,g as m,h as f,r as g,i as y,t as x}from"./vendor-d3-DDvxXOtr.js";import{S as b,O as v,W as w,P as N,a as E,V as S,M as C,C as k}from"./vendor-three-CnGKBE0v.js";import{_ as T}from"./vendor-export-UWB0VjdR.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var I=r();const A=a(I);var j,_,O,P,R={exports:{}},M={},D={exports:{}},L={};function U(){return _||(_=1,D.exports=(j||(j=1,function(e){function t(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,i=e[r];if(!(0<a(i,t)))break e;e[r]=t,e[n]=i,n=r}}function n(e){return 0===e.length?null:e[0]}function r(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length,o=i>>>1;r<o;){var s=2*(r+1)-1,l=e[s],c=s+1,u=e[c];if(0>a(l,n))c<i&&0>a(u,l)?(e[r]=u,e[c]=n,r=c):(e[r]=l,e[s]=n,r=s);else{if(!(c<i&&0>a(u,n)))break e;e[r]=u,e[c]=n,r=c}}}return t}function a(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if(e.unstable_now=void 0,"object"==typeof performance&&"function"==typeof performance.now){var i=performance;e.unstable_now=function(){return i.now()}}else{var o=Date,s=o.now();e.unstable_now=function(){return o.now()-s}}var l=[],c=[],u=1,d=null,p=3,h=!1,m=!1,f=!1,g=!1,y="function"==typeof setTimeout?setTimeout:null,x="function"==typeof clearTimeout?clearTimeout:null,b="undefined"!=typeof setImmediate?setImmediate:null;function v(e){for(var a=n(c);null!==a;){if(null===a.callback)r(c);else{if(!(a.startTime<=e))break;r(c),a.sortIndex=a.expirationTime,t(l,a)}a=n(c)}}function w(e){if(f=!1,v(e),!m)if(null!==n(l))m=!0,E||(E=!0,N());else{var t=n(c);null!==t&&_(w,t.startTime-e)}}var N,E=!1,S=-1,C=5,k=-1;function T(){return!(!g&&e.unstable_now()-k<C)}function I(){if(g=!1,E){var t=e.unstable_now();k=t;var a=!0;try{e:{m=!1,f&&(f=!1,x(S),S=-1),h=!0;var i=p;try{t:{for(v(t),d=n(l);null!==d&&!(d.expirationTime>t&&T());){var o=d.callback;if("function"==typeof o){d.callback=null,p=d.priorityLevel;var s=o(d.expirationTime<=t);if(t=e.unstable_now(),"function"==typeof s){d.callback=s,v(t),a=!0;break t}d===n(l)&&r(l),v(t)}else r(l);d=n(l)}if(null!==d)a=!0;else{var u=n(c);null!==u&&_(w,u.startTime-t),a=!1}}break e}finally{d=null,p=i,h=!1}a=void 0}}finally{a?N():E=!1}}}if("function"==typeof b)N=function(){b(I)};else if("undefined"!=typeof MessageChannel){var A=new MessageChannel,j=A.port2;A.port1.onmessage=I,N=function(){j.postMessage(null)}}else N=function(){y(I,0)};function _(t,n){S=y(function(){t(e.unstable_now())},n)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(e){e.callback=null},e.unstable_forceFrameRate=function(e){0>e||125<e||(C=0<e?Math.floor(1e3/e):5)},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var n=p;p=t;try{return e()}finally{p=n}},e.unstable_requestPaint=function(){g=!0},e.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=p;p=e;try{return t()}finally{p=n}},e.unstable_scheduleCallback=function(r,a,i){var o=e.unstable_now();switch(i="object"==typeof i&&null!==i&&"number"==typeof(i=i.delay)&&0<i?o+i:o,r){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return r={id:u++,callback:a,priorityLevel:r,startTime:i,expirationTime:s=i+s,sortIndex:-1},i>o?(r.sortIndex=i,t(c,r),null===n(l)&&r===n(c)&&(f?(x(S),S=-1):f=!0,_(w,i-o))):(r.sortIndex=s,t(l,r),m||h||(m=!0,E||(E=!0,N()))),r},e.unstable_shouldYield=T,e.unstable_wrapCallback=function(e){var t=p;return function(){var n=p;p=t;try{return e.apply(this,arguments)}finally{p=n}}}}(L)),L)),D.exports}
/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */function z(){if(O)return M;O=1;var e=U(),t=r(),n=i();function a(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function s(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{!!(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function l(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function c(e){if(31===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function u(e){if(s(e)!==e)throw Error(a(188))}function d(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e;for(e=e.child;null!==e;){if(null!==(t=d(e)))return t;e=e.sibling}return null}var p=Object.assign,h=Symbol.for("react.element"),m=Symbol.for("react.transitional.element"),f=Symbol.for("react.portal"),g=Symbol.for("react.fragment"),y=Symbol.for("react.strict_mode"),x=Symbol.for("react.profiler"),b=Symbol.for("react.consumer"),v=Symbol.for("react.context"),w=Symbol.for("react.forward_ref"),N=Symbol.for("react.suspense"),E=Symbol.for("react.suspense_list"),S=Symbol.for("react.memo"),C=Symbol.for("react.lazy"),k=Symbol.for("react.activity"),T=Symbol.for("react.memo_cache_sentinel"),I=Symbol.iterator;function A(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=I&&e[I]||e["@@iterator"])?e:null}var j=Symbol.for("react.client.reference");function _(e){if(null==e)return null;if("function"==typeof e)return e.$$typeof===j?null:e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case g:return"Fragment";case x:return"Profiler";case y:return"StrictMode";case N:return"Suspense";case E:return"SuspenseList";case k:return"Activity"}if("object"==typeof e)switch(e.$$typeof){case f:return"Portal";case v:return e.displayName||"Context";case b:return(e._context.displayName||"Context")+".Consumer";case w:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case S:return null!==(t=e.displayName||null)?t:_(e.type)||"Memo";case C:t=e._payload,e=e._init;try{return _(e(t))}catch(n){}}return null}var P=Array.isArray,R=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,D=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,L={pending:!1,data:null,method:null,action:null},z=[],F=-1;function G(e){return{current:e}}function q(e){0>F||(e.current=z[F],z[F]=null,F--)}function H(e,t){F++,z[F]=e.current,e.current=t}var $,B,V=G(null),Y=G(null),W=G(null),K=G(null);function J(e,t){switch(H(W,t),H(Y,e),H(V,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?bd(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)e=vd(t=bd(t),e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}q(V),H(V,e)}function Q(){q(V),q(Y),q(W)}function X(e){null!==e.memoizedState&&H(K,e);var t=V.current,n=vd(t,e.type);t!==n&&(H(Y,e),H(V,n))}function Z(e){Y.current===e&&(q(V),q(Y)),K.current===e&&(q(K),pp._currentValue=L)}function ee(e){if(void 0===$)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);$=t&&t[1]||"",B=-1<n.stack.indexOf("\n    at")?" (<anonymous>)":-1<n.stack.indexOf("@")?"@unknown:0:0":""}return"\n"+$+e+B}var te=!1;function ne(e,t){if(!e||te)return"";te=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var r={DetermineComponentFrameRoot:function(){try{if(t){var n=function(){throw Error()};if(Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(n,[])}catch(a){var r=a}Reflect.construct(e,[],n)}else{try{n.call()}catch(i){r=i}e.call(n.prototype)}}else{try{throw Error()}catch(o){r=o}(n=e())&&"function"==typeof n.catch&&n.catch(function(){})}}catch(s){if(s&&r&&"string"==typeof s.stack)return[s.stack,r.stack]}return[null,null]}};r.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var a=Object.getOwnPropertyDescriptor(r.DetermineComponentFrameRoot,"name");a&&a.configurable&&Object.defineProperty(r.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var i=r.DetermineComponentFrameRoot(),o=i[0],s=i[1];if(o&&s){var l=o.split("\n"),c=s.split("\n");for(a=r=0;r<l.length&&!l[r].includes("DetermineComponentFrameRoot");)r++;for(;a<c.length&&!c[a].includes("DetermineComponentFrameRoot");)a++;if(r===l.length||a===c.length)for(r=l.length-1,a=c.length-1;1<=r&&0<=a&&l[r]!==c[a];)a--;for(;1<=r&&0<=a;r--,a--)if(l[r]!==c[a]){if(1!==r||1!==a)do{if(r--,0>--a||l[r]!==c[a]){var u="\n"+l[r].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}}while(1<=r&&0<=a);break}}}finally{te=!1,Error.prepareStackTrace=n}return(n=e?e.displayName||e.name:"")?ee(n):""}function re(e,t){switch(e.tag){case 26:case 27:case 5:return ee(e.type);case 16:return ee("Lazy");case 13:return e.child!==t&&null!==t?ee("Suspense Fallback"):ee("Suspense");case 19:return ee("SuspenseList");case 0:case 15:return ne(e.type,!1);case 11:return ne(e.type.render,!1);case 1:return ne(e.type,!0);case 31:return ee("Activity");default:return""}}function ae(e){try{var t="",n=null;do{t+=re(e,n),n=e,e=e.return}while(e);return t}catch(r){return"\nError generating stack: "+r.message+"\n"+r.stack}}var ie=Object.prototype.hasOwnProperty,oe=e.unstable_scheduleCallback,se=e.unstable_cancelCallback,le=e.unstable_shouldYield,ce=e.unstable_requestPaint,ue=e.unstable_now,de=e.unstable_getCurrentPriorityLevel,pe=e.unstable_ImmediatePriority,he=e.unstable_UserBlockingPriority,me=e.unstable_NormalPriority,fe=e.unstable_LowPriority,ge=e.unstable_IdlePriority,ye=e.log,xe=e.unstable_setDisableYieldValue,be=null,ve=null;function we(e){if("function"==typeof ye&&xe(e),ve&&"function"==typeof ve.setStrictMode)try{ve.setStrictMode(be,e)}catch(t){}}var Ne=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(Ee(e)/Se|0)|0},Ee=Math.log,Se=Math.LN2;var Ce=256,ke=262144,Te=4194304;function Ie(e){var t=42&e;if(0!==t)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return 261888&e;case 262144:case 524288:case 1048576:case 2097152:return 3932160&e;case 4194304:case 8388608:case 16777216:case 33554432:return 62914560&e;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function Ae(e,t,n){var r=e.pendingLanes;if(0===r)return 0;var a=0,i=e.suspendedLanes,o=e.pingedLanes;e=e.warmLanes;var s=134217727&r;return 0!==s?0!==(r=s&~i)?a=Ie(r):0!==(o&=s)?a=Ie(o):n||0!==(n=s&~e)&&(a=Ie(n)):0!==(s=r&~i)?a=Ie(s):0!==o?a=Ie(o):n||0!==(n=r&~e)&&(a=Ie(n)),0===a?0:0!==t&&t!==a&&0===(t&i)&&((i=a&-a)>=(n=t&-t)||32===i&&4194048&n)?t:a}function je(e,t){return 0===(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)}function _e(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function Oe(){var e=Te;return!(62914560&(Te<<=1))&&(Te=4194304),e}function Pe(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Re(e,t){e.pendingLanes|=t,268435456!==t&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function Me(e,t,n){e.pendingLanes|=t,e.suspendedLanes&=~t;var r=31-Ne(t);e.entangledLanes|=t,e.entanglements[r]=1073741824|e.entanglements[r]|261930&n}function De(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-Ne(n),a=1<<r;a&t|e[r]&t&&(e[r]|=t),n&=~a}}function Le(e,t){var n=t&-t;return 0!==((n=42&n?1:Ue(n))&(e.suspendedLanes|t))?0:n}function Ue(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function ze(e){return 2<(e&=-e)?8<e?134217727&e?32:268435456:8:2}function Fe(){var e=D.p;return 0!==e?e:void 0===(e=window.event)?32:Ip(e.type)}function Ge(e,t){var n=D.p;try{return D.p=e,t()}finally{D.p=n}}var qe=Math.random().toString(36).slice(2),He="__reactFiber$"+qe,$e="__reactProps$"+qe,Be="__reactContainer$"+qe,Ve="__reactEvents$"+qe,Ye="__reactListeners$"+qe,We="__reactHandles$"+qe,Ke="__reactResources$"+qe,Je="__reactMarker$"+qe;function Qe(e){delete e[He],delete e[$e],delete e[Ve],delete e[Ye],delete e[We]}function Xe(e){var t=e[He];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Be]||n[He]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=Ud(e);null!==e;){if(n=e[He])return n;e=Ud(e)}return t}n=(e=n).parentNode}return null}function Ze(e){if(e=e[He]||e[Be]){var t=e.tag;if(5===t||6===t||13===t||31===t||26===t||27===t||3===t)return e}return null}function et(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e.stateNode;throw Error(a(33))}function tt(e){var t=e[Ke];return t||(t=e[Ke]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function nt(e){e[Je]=!0}var rt=new Set,at={};function it(e,t){ot(e,t),ot(e+"Capture",t)}function ot(e,t){for(at[e]=t,e=0;e<t.length;e++)rt.add(t[e])}var st=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),lt={},ct={};function ut(e,t,n){if(a=t,ie.call(ct,a)||!ie.call(lt,a)&&(st.test(a)?ct[a]=!0:(lt[a]=!0,0)))if(null===n)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":return void e.removeAttribute(t);case"boolean":var r=t.toLowerCase().slice(0,5);if("data-"!==r&&"aria-"!==r)return void e.removeAttribute(t)}e.setAttribute(t,""+n)}var a}function dt(e,t,n){if(null===n)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(t)}e.setAttribute(t,""+n)}}function pt(e,t,n,r){if(null===r)e.removeAttribute(n);else{switch(typeof r){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(n)}e.setAttributeNS(t,n,""+r)}}function ht(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function mt(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function ft(e){if(!e._valueTracker){var t=mt(e)?"checked":"value";e._valueTracker=function(e,t,n){var r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t);if(!e.hasOwnProperty(t)&&void 0!==r&&"function"==typeof r.get&&"function"==typeof r.set){var a=r.get,i=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(e){n=""+e,i.call(this,e)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(e){n=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e,t,""+e[t])}}function gt(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=mt(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function yt(e){if(void 0===(e=e||("undefined"!=typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}var xt=/[\n"\\]/g;function bt(e){return e.replace(xt,function(e){return"\\"+e.charCodeAt(0).toString(16)+" "})}function vt(e,t,n,r,a,i,o,s){e.name="",null!=o&&"function"!=typeof o&&"symbol"!=typeof o&&"boolean"!=typeof o?e.type=o:e.removeAttribute("type"),null!=t?"number"===o?(0===t&&""===e.value||e.value!=t)&&(e.value=""+ht(t)):e.value!==""+ht(t)&&(e.value=""+ht(t)):"submit"!==o&&"reset"!==o||e.removeAttribute("value"),null!=t?Nt(e,o,ht(t)):null!=n?Nt(e,o,ht(n)):null!=r&&e.removeAttribute("value"),null==a&&null!=i&&(e.defaultChecked=!!i),null!=a&&(e.checked=a&&"function"!=typeof a&&"symbol"!=typeof a),null!=s&&"function"!=typeof s&&"symbol"!=typeof s&&"boolean"!=typeof s?e.name=""+ht(s):e.removeAttribute("name")}function wt(e,t,n,r,a,i,o,s){if(null!=i&&"function"!=typeof i&&"symbol"!=typeof i&&"boolean"!=typeof i&&(e.type=i),null!=t||null!=n){if(("submit"===i||"reset"===i)&&null==t)return void ft(e);n=null!=n?""+ht(n):"",t=null!=t?""+ht(t):n,s||t===e.value||(e.value=t),e.defaultValue=t}r="function"!=typeof(r=null!=r?r:a)&&"symbol"!=typeof r&&!!r,e.checked=s?e.checked:!!r,e.defaultChecked=!!r,null!=o&&"function"!=typeof o&&"symbol"!=typeof o&&"boolean"!=typeof o&&(e.name=o),ft(e)}function Nt(e,t,n){"number"===t&&yt(e.ownerDocument)===e||e.defaultValue===""+n||(e.defaultValue=""+n)}function Et(e,t,n,r){if(e=e.options,t){t={};for(var a=0;a<n.length;a++)t["$"+n[a]]=!0;for(n=0;n<e.length;n++)a=t.hasOwnProperty("$"+e[n].value),e[n].selected!==a&&(e[n].selected=a),a&&r&&(e[n].defaultSelected=!0)}else{for(n=""+ht(n),t=null,a=0;a<e.length;a++){if(e[a].value===n)return e[a].selected=!0,void(r&&(e[a].defaultSelected=!0));null!==t||e[a].disabled||(t=e[a])}null!==t&&(t.selected=!0)}}function St(e,t,n){null==t||((t=""+ht(t))!==e.value&&(e.value=t),null!=n)?e.defaultValue=null!=n?""+ht(n):"":e.defaultValue!==t&&(e.defaultValue=t)}function Ct(e,t,n,r){if(null==t){if(null!=r){if(null!=n)throw Error(a(92));if(P(r)){if(1<r.length)throw Error(a(93));r=r[0]}n=r}null==n&&(n=""),t=n}n=ht(t),e.defaultValue=n,(r=e.textContent)===n&&""!==r&&null!==r&&(e.value=r),ft(e)}function kt(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var Tt=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function It(e,t,n){var r=0===t.indexOf("--");null==n||"boolean"==typeof n||""===n?r?e.setProperty(t,""):"float"===t?e.cssFloat="":e[t]="":r?e.setProperty(t,n):"number"!=typeof n||0===n||Tt.has(t)?"float"===t?e.cssFloat=n:e[t]=(""+n).trim():e[t]=n+"px"}function At(e,t,n){if(null!=t&&"object"!=typeof t)throw Error(a(62));if(e=e.style,null!=n){for(var r in n)!n.hasOwnProperty(r)||null!=t&&t.hasOwnProperty(r)||(0===r.indexOf("--")?e.setProperty(r,""):"float"===r?e.cssFloat="":e[r]="");for(var i in t)r=t[i],t.hasOwnProperty(i)&&n[i]!==r&&It(e,i,r)}else for(var o in t)t.hasOwnProperty(o)&&It(e,o,t[o])}function jt(e){if(-1===e.indexOf("-"))return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var _t=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Ot=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Pt(e){return Ot.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function Rt(){}var Mt=null;function Dt(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Lt=null,Ut=null;function zt(e){var t=Ze(e);if(t&&(e=t.stateNode)){var n=e[$e]||null;e:switch(e=t.stateNode,t.type){case"input":if(vt(e,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+bt(""+t)+'"][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=r[$e]||null;if(!i)throw Error(a(90));vt(r,i.value,i.defaultValue,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name)}}for(t=0;t<n.length;t++)(r=n[t]).form===e.form&&gt(r)}break e;case"textarea":St(e,n.value,n.defaultValue);break e;case"select":null!=(t=n.value)&&Et(e,!!n.multiple,t,!1)}}}var Ft=!1;function Gt(e,t,n){if(Ft)return e(t,n);Ft=!0;try{return e(t)}finally{if(Ft=!1,(null!==Lt||null!==Ut)&&(tu(),Lt&&(t=Lt,e=Ut,Ut=Lt=null,zt(t),e)))for(t=0;t<e.length;t++)zt(e[t])}}function qt(e,t){var n=e.stateNode;if(null===n)return null;var r=n[$e]||null;if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!=typeof n)throw Error(a(231,t,typeof n));return n}var Ht=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement),$t=!1;if(Ht)try{var Bt={};Object.defineProperty(Bt,"passive",{get:function(){$t=!0}}),window.addEventListener("test",Bt,Bt),window.removeEventListener("test",Bt,Bt)}catch(Zp){$t=!1}var Vt=null,Yt=null,Wt=null;function Kt(){if(Wt)return Wt;var e,t,n=Yt,r=n.length,a="value"in Vt?Vt.value:Vt.textContent,i=a.length;for(e=0;e<r&&n[e]===a[e];e++);var o=r-e;for(t=1;t<=o&&n[r-t]===a[i-t];t++);return Wt=a.slice(e,1<t?1-t:void 0)}function Jt(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function Qt(){return!0}function Xt(){return!1}function Zt(e){function t(t,n,r,a,i){for(var o in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=a,this.target=i,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(a):a[o]);return this.isDefaultPrevented=(null!=a.defaultPrevented?a.defaultPrevented:!1===a.returnValue)?Qt:Xt,this.isPropagationStopped=Xt,this}return p(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!=typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=Qt)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!=typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=Qt)},persist:function(){},isPersistent:Qt}),t}var en,tn,nn,rn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},an=Zt(rn),on=p({},rn,{view:0,detail:0}),sn=Zt(on),ln=p({},on,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:bn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==nn&&(nn&&"mousemove"===e.type?(en=e.screenX-nn.screenX,tn=e.screenY-nn.screenY):tn=en=0,nn=e),en)},movementY:function(e){return"movementY"in e?e.movementY:tn}}),cn=Zt(ln),un=Zt(p({},ln,{dataTransfer:0})),dn=Zt(p({},on,{relatedTarget:0})),pn=Zt(p({},rn,{animationName:0,elapsedTime:0,pseudoElement:0})),hn=Zt(p({},rn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}})),mn=Zt(p({},rn,{data:0})),fn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},gn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},yn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function xn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=yn[e])&&!!t[e]}function bn(){return xn}var vn=Zt(p({},on,{key:function(e){if(e.key){var t=fn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=Jt(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?gn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:bn,charCode:function(e){return"keypress"===e.type?Jt(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?Jt(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}})),wn=Zt(p({},ln,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Nn=Zt(p({},on,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:bn})),En=Zt(p({},rn,{propertyName:0,elapsedTime:0,pseudoElement:0})),Sn=Zt(p({},ln,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0})),Cn=Zt(p({},rn,{newState:0,oldState:0})),kn=[9,13,27,32],Tn=Ht&&"CompositionEvent"in window,In=null;Ht&&"documentMode"in document&&(In=document.documentMode);var An=Ht&&"TextEvent"in window&&!In,jn=Ht&&(!Tn||In&&8<In&&11>=In),_n=String.fromCharCode(32),On=!1;function Pn(e,t){switch(e){case"keyup":return-1!==kn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Rn(e){return"object"==typeof(e=e.detail)&&"data"in e?e.data:null}var Mn=!1;var Dn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ln(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Dn[e.type]:"textarea"===t}function Un(e,t,n,r){Lt?Ut?Ut.push(r):Ut=[r]:Lt=r,0<(t=id(t,"onChange")).length&&(n=new an("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var zn=null,Fn=null;function Gn(e){Qu(e,0)}function qn(e){if(gt(et(e)))return e}function Hn(e,t){if("change"===e)return t}var $n=!1;if(Ht){var Bn;if(Ht){var Vn="oninput"in document;if(!Vn){var Yn=document.createElement("div");Yn.setAttribute("oninput","return;"),Vn="function"==typeof Yn.oninput}Bn=Vn}else Bn=!1;$n=Bn&&(!document.documentMode||9<document.documentMode)}function Wn(){zn&&(zn.detachEvent("onpropertychange",Kn),Fn=zn=null)}function Kn(e){if("value"===e.propertyName&&qn(Fn)){var t=[];Un(t,Fn,e,Dt(e)),Gt(Gn,t)}}function Jn(e,t,n){"focusin"===e?(Wn(),Fn=n,(zn=t).attachEvent("onpropertychange",Kn)):"focusout"===e&&Wn()}function Qn(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return qn(Fn)}function Xn(e,t){if("click"===e)return qn(t)}function Zn(e,t){if("input"===e||"change"===e)return qn(t)}var er="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t};function tr(e,t){if(er(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var a=n[r];if(!ie.call(t,a)||!er(e[a],t[a]))return!1}return!0}function nr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function rr(e,t){var n,r=nr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=nr(r)}}function ar(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?ar(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function ir(e){for(var t=yt((e=null!=e&&null!=e.ownerDocument&&null!=e.ownerDocument.defaultView?e.ownerDocument.defaultView:window).document);t instanceof e.HTMLIFrameElement;){try{var n="string"==typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=yt((e=t.contentWindow).document)}return t}function or(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var sr=Ht&&"documentMode"in document&&11>=document.documentMode,lr=null,cr=null,ur=null,dr=!1;function pr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;dr||null==lr||lr!==yt(r)||("selectionStart"in(r=lr)&&or(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},ur&&tr(ur,r)||(ur=r,0<(r=id(cr,"onSelect")).length&&(t=new an("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=lr)))}function hr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var mr={animationend:hr("Animation","AnimationEnd"),animationiteration:hr("Animation","AnimationIteration"),animationstart:hr("Animation","AnimationStart"),transitionrun:hr("Transition","TransitionRun"),transitionstart:hr("Transition","TransitionStart"),transitioncancel:hr("Transition","TransitionCancel"),transitionend:hr("Transition","TransitionEnd")},fr={},gr={};function yr(e){if(fr[e])return fr[e];if(!mr[e])return e;var t,n=mr[e];for(t in n)if(n.hasOwnProperty(t)&&t in gr)return fr[e]=n[t];return e}Ht&&(gr=document.createElement("div").style,"AnimationEvent"in window||(delete mr.animationend.animation,delete mr.animationiteration.animation,delete mr.animationstart.animation),"TransitionEvent"in window||delete mr.transitionend.transition);var xr=yr("animationend"),br=yr("animationiteration"),vr=yr("animationstart"),wr=yr("transitionrun"),Nr=yr("transitionstart"),Er=yr("transitioncancel"),Sr=yr("transitionend"),Cr=new Map,kr="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Tr(e,t){Cr.set(e,t),it(t,[e])}kr.push("scrollEnd");var Ir="function"==typeof reportError?reportError:function(e){if("object"==typeof window&&"function"==typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"==typeof e&&null!==e&&"string"==typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"==typeof process&&"function"==typeof process.emit)return void process.emit("uncaughtException",e)},Ar=[],jr=0,_r=0;function Or(){for(var e=jr,t=_r=jr=0;t<e;){var n=Ar[t];Ar[t++]=null;var r=Ar[t];Ar[t++]=null;var a=Ar[t];Ar[t++]=null;var i=Ar[t];if(Ar[t++]=null,null!==r&&null!==a){var o=r.pending;null===o?a.next=a:(a.next=o.next,o.next=a),r.pending=a}0!==i&&Dr(n,a,i)}}function Pr(e,t,n,r){Ar[jr++]=e,Ar[jr++]=t,Ar[jr++]=n,Ar[jr++]=r,_r|=r,e.lanes|=r,null!==(e=e.alternate)&&(e.lanes|=r)}function Rr(e,t,n,r){return Pr(e,t,n,r),Lr(e)}function Mr(e,t){return Pr(e,null,null,t),Lr(e)}function Dr(e,t,n){e.lanes|=n;var r=e.alternate;null!==r&&(r.lanes|=n);for(var a=!1,i=e.return;null!==i;)i.childLanes|=n,null!==(r=i.alternate)&&(r.childLanes|=n),22===i.tag&&(null===(e=i.stateNode)||1&e._visibility||(a=!0)),e=i,i=i.return;return 3===e.tag?(i=e.stateNode,a&&null!==t&&(a=31-Ne(n),null===(r=(e=i.hiddenUpdates)[a])?e[a]=[t]:r.push(t),t.lane=536870912|n),i):null}function Lr(e){if(50<Vc)throw Vc=0,Yc=null,Error(a(185));for(var t=e.return;null!==t;)t=(e=t).return;return 3===e.tag?e.stateNode:null}var Ur={};function zr(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Fr(e,t,n,r){return new zr(e,t,n,r)}function Gr(e){return!(!(e=e.prototype)||!e.isReactComponent)}function qr(e,t){var n=e.alternate;return null===n?((n=Fr(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=65011712&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n.refCleanup=e.refCleanup,n}function Hr(e,t){e.flags&=65011714;var n=e.alternate;return null===n?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=n.childLanes,e.lanes=n.lanes,e.child=n.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=n.memoizedProps,e.memoizedState=n.memoizedState,e.updateQueue=n.updateQueue,e.type=n.type,t=n.dependencies,e.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function $r(e,t,n,r,i,o){var s=0;if(r=e,"function"==typeof e)Gr(e)&&(s=1);else if("string"==typeof e)s=function(e,t,n){if(1===n||null!=t.itemProp)return!1;switch(e){case"meta":case"title":return!0;case"style":if("string"!=typeof t.precedence||"string"!=typeof t.href||""===t.href)break;return!0;case"link":if("string"!=typeof t.rel||"string"!=typeof t.href||""===t.href||t.onLoad||t.onError)break;return"stylesheet"!==t.rel||(e=t.disabled,"string"==typeof t.precedence&&null==e);case"script":if(t.async&&"function"!=typeof t.async&&"symbol"!=typeof t.async&&!t.onLoad&&!t.onError&&t.src&&"string"==typeof t.src)return!0}return!1}(e,n,V.current)?26:"html"===e||"head"===e||"body"===e?27:5;else e:switch(e){case k:return(e=Fr(31,n,t,i)).elementType=k,e.lanes=o,e;case g:return Br(n.children,i,o,t);case y:s=8,i|=24;break;case x:return(e=Fr(12,n,t,2|i)).elementType=x,e.lanes=o,e;case N:return(e=Fr(13,n,t,i)).elementType=N,e.lanes=o,e;case E:return(e=Fr(19,n,t,i)).elementType=E,e.lanes=o,e;default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case v:s=10;break e;case b:s=9;break e;case w:s=11;break e;case S:s=14;break e;case C:s=16,r=null;break e}s=29,n=Error(a(130,null===e?"null":typeof e,"")),r=null}return(t=Fr(s,n,t,i)).elementType=e,t.type=r,t.lanes=o,t}function Br(e,t,n,r){return(e=Fr(7,e,r,t)).lanes=n,e}function Vr(e,t,n){return(e=Fr(6,e,null,t)).lanes=n,e}function Yr(e){var t=Fr(18,null,null,0);return t.stateNode=e,t}function Wr(e,t,n){return(t=Fr(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var Kr=new WeakMap;function Jr(e,t){if("object"==typeof e&&null!==e){var n=Kr.get(e);return void 0!==n?n:(t={value:e,source:t,stack:ae(t)},Kr.set(e,t),t)}return{value:e,source:t,stack:ae(t)}}var Qr=[],Xr=0,Zr=null,ea=0,ta=[],na=0,ra=null,aa=1,ia="";function oa(e,t){Qr[Xr++]=ea,Qr[Xr++]=Zr,Zr=e,ea=t}function sa(e,t,n){ta[na++]=aa,ta[na++]=ia,ta[na++]=ra,ra=e;var r=aa;e=ia;var a=32-Ne(r)-1;r&=~(1<<a),n+=1;var i=32-Ne(t)+a;if(30<i){var o=a-a%5;i=(r&(1<<o)-1).toString(32),r>>=o,a-=o,aa=1<<32-Ne(t)+a|n<<a|r,ia=i+e}else aa=1<<i|n<<a|r,ia=e}function la(e){null!==e.return&&(oa(e,1),sa(e,1,0))}function ca(e){for(;e===Zr;)Zr=Qr[--Xr],Qr[Xr]=null,ea=Qr[--Xr],Qr[Xr]=null;for(;e===ra;)ra=ta[--na],ta[na]=null,ia=ta[--na],ta[na]=null,aa=ta[--na],ta[na]=null}function ua(e,t){ta[na++]=aa,ta[na++]=ia,ta[na++]=ra,aa=t.id,ia=t.overflow,ra=e}var da=null,pa=null,ha=!1,ma=null,fa=!1,ga=Error(a(519));function ya(e){throw Ea(Jr(Error(a(418,1<arguments.length&&void 0!==arguments[1]&&arguments[1]?"text":"HTML","")),e)),ga}function xa(e){var t=e.stateNode,n=e.type,r=e.memoizedProps;switch(t[He]=e,t[$e]=r,n){case"dialog":Xu("cancel",t),Xu("close",t);break;case"iframe":case"object":case"embed":Xu("load",t);break;case"video":case"audio":for(n=0;n<Ku.length;n++)Xu(Ku[n],t);break;case"source":Xu("error",t);break;case"img":case"image":case"link":Xu("error",t),Xu("load",t);break;case"details":Xu("toggle",t);break;case"input":Xu("invalid",t),wt(t,r.value,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name,!0);break;case"select":Xu("invalid",t);break;case"textarea":Xu("invalid",t),Ct(t,r.value,r.defaultValue,r.children)}"string"!=typeof(n=r.children)&&"number"!=typeof n&&"bigint"!=typeof n||t.textContent===""+n||!0===r.suppressHydrationWarning||dd(t.textContent,n)?(null!=r.popover&&(Xu("beforetoggle",t),Xu("toggle",t)),null!=r.onScroll&&Xu("scroll",t),null!=r.onScrollEnd&&Xu("scrollend",t),null!=r.onClick&&(t.onclick=Rt),t=!0):t=!1,t||ya(e,!0)}function ba(e){for(da=e.return;da;)switch(da.tag){case 5:case 31:case 13:return void(fa=!1);case 27:case 3:return void(fa=!0);default:da=da.return}}function va(e){if(e!==da)return!1;if(!ha)return ba(e),ha=!0,!1;var t,n=e.tag;if((t=3!==n&&27!==n)&&((t=5===n)&&(t=!("form"!==(t=e.type)&&"button"!==t)||wd(e.type,e.memoizedProps)),t=!t),t&&pa&&ya(e),ba(e),13===n){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(a(317));pa=Ld(e)}else if(31===n){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(a(317));pa=Ld(e)}else 27===n?(n=pa,Id(e.type)?(e=Dd,Dd=null,pa=e):pa=n):pa=da?Md(e.stateNode.nextSibling):null;return!0}function wa(){pa=da=null,ha=!1}function Na(){var e=ma;return null!==e&&(null===Oc?Oc=e:Oc.push.apply(Oc,e),ma=null),e}function Ea(e){null===ma?ma=[e]:ma.push(e)}var Sa=G(null),Ca=null,ka=null;function Ta(e,t,n){H(Sa,t._currentValue),t._currentValue=n}function Ia(e){e._currentValue=Sa.current,q(Sa)}function Aa(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function ja(e,t,n,r){var i=e.child;for(null!==i&&(i.return=e);null!==i;){var o=i.dependencies;if(null!==o){var s=i.child;o=o.firstContext;e:for(;null!==o;){var l=o;o=i;for(var c=0;c<t.length;c++)if(l.context===t[c]){o.lanes|=n,null!==(l=o.alternate)&&(l.lanes|=n),Aa(o.return,n,e),r||(s=null);break e}o=l.next}}else if(18===i.tag){if(null===(s=i.return))throw Error(a(341));s.lanes|=n,null!==(o=s.alternate)&&(o.lanes|=n),Aa(s,n,e),s=null}else s=i.child;if(null!==s)s.return=i;else for(s=i;null!==s;){if(s===e){s=null;break}if(null!==(i=s.sibling)){i.return=s.return,s=i;break}s=s.return}i=s}}function _a(e,t,n,r){e=null;for(var i=t,o=!1;null!==i;){if(!o)if(524288&i.flags)o=!0;else if(262144&i.flags)break;if(10===i.tag){var s=i.alternate;if(null===s)throw Error(a(387));if(null!==(s=s.memoizedProps)){var l=i.type;er(i.pendingProps.value,s.value)||(null!==e?e.push(l):e=[l])}}else if(i===K.current){if(null===(s=i.alternate))throw Error(a(387));s.memoizedState.memoizedState!==i.memoizedState.memoizedState&&(null!==e?e.push(pp):e=[pp])}i=i.return}null!==e&&ja(t,e,n,r),t.flags|=262144}function Oa(e){for(e=e.firstContext;null!==e;){if(!er(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Pa(e){Ca=e,ka=null,null!==(e=e.dependencies)&&(e.firstContext=null)}function Ra(e){return Da(Ca,e)}function Ma(e,t){return null===Ca&&Pa(e),Da(e,t)}function Da(e,t){var n=t._currentValue;if(t={context:t,memoizedValue:n,next:null},null===ka){if(null===e)throw Error(a(308));ka=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else ka=ka.next=t;return n}var La="undefined"!=typeof AbortController?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(t,n){e.push(n)}};this.abort=function(){t.aborted=!0,e.forEach(function(e){return e()})}},Ua=e.unstable_scheduleCallback,za=e.unstable_NormalPriority,Fa={$$typeof:v,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Ga(){return{controller:new La,data:new Map,refCount:0}}function qa(e){e.refCount--,0===e.refCount&&Ua(za,function(){e.controller.abort()})}var Ha=null,$a=0,Ba=0,Va=null;function Ya(){if(0===--$a&&null!==Ha){null!==Va&&(Va.status="fulfilled");var e=Ha;Ha=null,Ba=0,Va=null;for(var t=0;t<e.length;t++)(0,e[t])()}}var Wa=R.S;R.S=function(e,t){Mc=ue(),"object"==typeof t&&null!==t&&"function"==typeof t.then&&function(e,t){if(null===Ha){var n=Ha=[];$a=0,Ba=$u(),Va={status:"pending",value:void 0,then:function(e){n.push(e)}}}$a++,t.then(Ya,Ya)}(0,t),null!==Wa&&Wa(e,t)};var Ka=G(null);function Ja(){var e=Ka.current;return null!==e?e:gc.pooledCache}function Qa(e,t){H(Ka,null===t?Ka.current:t.pool)}function Xa(){var e=Ja();return null===e?null:{parent:Fa._currentValue,pool:e}}var Za=Error(a(460)),ei=Error(a(474)),ti=Error(a(542)),ni={then:function(){}};function ri(e){return"fulfilled"===(e=e.status)||"rejected"===e}function ai(e,t,n){switch(void 0===(n=e[n])?e.push(t):n!==t&&(t.then(Rt,Rt),t=n),t.status){case"fulfilled":return t.value;case"rejected":throw li(e=t.reason),e;default:if("string"==typeof t.status)t.then(Rt,Rt);else{if(null!==(e=gc)&&100<e.shellSuspendCounter)throw Error(a(482));(e=t).status="pending",e.then(function(e){if("pending"===t.status){var n=t;n.status="fulfilled",n.value=e}},function(e){if("pending"===t.status){var n=t;n.status="rejected",n.reason=e}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw li(e=t.reason),e}throw oi=t,Za}}function ii(e){try{return(0,e._init)(e._payload)}catch(t){if(null!==t&&"object"==typeof t&&"function"==typeof t.then)throw oi=t,Za;throw t}}var oi=null;function si(){if(null===oi)throw Error(a(459));var e=oi;return oi=null,e}function li(e){if(e===Za||e===ti)throw Error(a(483))}var ci=null,ui=0;function di(e){var t=ui;return ui+=1,null===ci&&(ci=[]),ai(ci,e,t)}function pi(e,t){t=t.props.ref,e.ref=void 0!==t?t:null}function hi(e,t){if(t.$$typeof===h)throw Error(a(525));throw e=Object.prototype.toString.call(t),Error(a(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function mi(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e){for(var t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function i(e,t){return(e=qr(e,t)).index=0,e.sibling=null,e}function o(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=67108866,n):r:(t.flags|=67108866,n):(t.flags|=1048576,n)}function s(t){return e&&null===t.alternate&&(t.flags|=67108866),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=Vr(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function c(e,t,n,r){var a=n.type;return a===g?d(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===a||"object"==typeof a&&null!==a&&a.$$typeof===C&&ii(a)===t.type)?(pi(t=i(t,n.props),n),t.return=e,t):(pi(t=$r(n.type,n.key,n.props,null,e.mode,r),n),t.return=e,t)}function u(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Wr(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function d(e,t,n,r,a){return null===t||7!==t.tag?((t=Br(n,e.mode,r,a)).return=e,t):((t=i(t,n)).return=e,t)}function p(e,t,n){if("string"==typeof t&&""!==t||"number"==typeof t||"bigint"==typeof t)return(t=Vr(""+t,e.mode,n)).return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case m:return pi(n=$r(t.type,t.key,t.props,null,e.mode,n),t),n.return=e,n;case f:return(t=Wr(t,e.mode,n)).return=e,t;case C:return p(e,t=ii(t),n)}if(P(t)||A(t))return(t=Br(t,e.mode,n,null)).return=e,t;if("function"==typeof t.then)return p(e,di(t),n);if(t.$$typeof===v)return p(e,Ma(e,t),n);hi(e,t)}return null}function h(e,t,n,r){var a=null!==t?t.key:null;if("string"==typeof n&&""!==n||"number"==typeof n||"bigint"==typeof n)return null!==a?null:l(e,t,""+n,r);if("object"==typeof n&&null!==n){switch(n.$$typeof){case m:return n.key===a?c(e,t,n,r):null;case f:return n.key===a?u(e,t,n,r):null;case C:return h(e,t,n=ii(n),r)}if(P(n)||A(n))return null!==a?null:d(e,t,n,r,null);if("function"==typeof n.then)return h(e,t,di(n),r);if(n.$$typeof===v)return h(e,t,Ma(e,n),r);hi(e,n)}return null}function y(e,t,n,r,a){if("string"==typeof r&&""!==r||"number"==typeof r||"bigint"==typeof r)return l(t,e=e.get(n)||null,""+r,a);if("object"==typeof r&&null!==r){switch(r.$$typeof){case m:return c(t,e=e.get(null===r.key?n:r.key)||null,r,a);case f:return u(t,e=e.get(null===r.key?n:r.key)||null,r,a);case C:return y(e,t,n,r=ii(r),a)}if(P(r)||A(r))return d(t,e=e.get(n)||null,r,a,null);if("function"==typeof r.then)return y(e,t,n,di(r),a);if(r.$$typeof===v)return y(e,t,n,Ma(t,r),a);hi(t,r)}return null}function x(l,c,u,d){if("object"==typeof u&&null!==u&&u.type===g&&null===u.key&&(u=u.props.children),"object"==typeof u&&null!==u){switch(u.$$typeof){case m:e:{for(var b=u.key;null!==c;){if(c.key===b){if((b=u.type)===g){if(7===c.tag){n(l,c.sibling),(d=i(c,u.props.children)).return=l,l=d;break e}}else if(c.elementType===b||"object"==typeof b&&null!==b&&b.$$typeof===C&&ii(b)===c.type){n(l,c.sibling),pi(d=i(c,u.props),u),d.return=l,l=d;break e}n(l,c);break}t(l,c),c=c.sibling}u.type===g?((d=Br(u.props.children,l.mode,d,u.key)).return=l,l=d):(pi(d=$r(u.type,u.key,u.props,null,l.mode,d),u),d.return=l,l=d)}return s(l);case f:e:{for(b=u.key;null!==c;){if(c.key===b){if(4===c.tag&&c.stateNode.containerInfo===u.containerInfo&&c.stateNode.implementation===u.implementation){n(l,c.sibling),(d=i(c,u.children||[])).return=l,l=d;break e}n(l,c);break}t(l,c),c=c.sibling}(d=Wr(u,l.mode,d)).return=l,l=d}return s(l);case C:return x(l,c,u=ii(u),d)}if(P(u))return function(a,i,s,l){for(var c=null,u=null,d=i,m=i=0,f=null;null!==d&&m<s.length;m++){d.index>m?(f=d,d=null):f=d.sibling;var g=h(a,d,s[m],l);if(null===g){null===d&&(d=f);break}e&&d&&null===g.alternate&&t(a,d),i=o(g,i,m),null===u?c=g:u.sibling=g,u=g,d=f}if(m===s.length)return n(a,d),ha&&oa(a,m),c;if(null===d){for(;m<s.length;m++)null!==(d=p(a,s[m],l))&&(i=o(d,i,m),null===u?c=d:u.sibling=d,u=d);return ha&&oa(a,m),c}for(d=r(d);m<s.length;m++)null!==(f=y(d,a,m,s[m],l))&&(e&&null!==f.alternate&&d.delete(null===f.key?m:f.key),i=o(f,i,m),null===u?c=f:u.sibling=f,u=f);return e&&d.forEach(function(e){return t(a,e)}),ha&&oa(a,m),c}(l,c,u,d);if(A(u)){if("function"!=typeof(b=A(u)))throw Error(a(150));return function(i,s,l,c){if(null==l)throw Error(a(151));for(var u=null,d=null,m=s,f=s=0,g=null,x=l.next();null!==m&&!x.done;f++,x=l.next()){m.index>f?(g=m,m=null):g=m.sibling;var b=h(i,m,x.value,c);if(null===b){null===m&&(m=g);break}e&&m&&null===b.alternate&&t(i,m),s=o(b,s,f),null===d?u=b:d.sibling=b,d=b,m=g}if(x.done)return n(i,m),ha&&oa(i,f),u;if(null===m){for(;!x.done;f++,x=l.next())null!==(x=p(i,x.value,c))&&(s=o(x,s,f),null===d?u=x:d.sibling=x,d=x);return ha&&oa(i,f),u}for(m=r(m);!x.done;f++,x=l.next())null!==(x=y(m,i,f,x.value,c))&&(e&&null!==x.alternate&&m.delete(null===x.key?f:x.key),s=o(x,s,f),null===d?u=x:d.sibling=x,d=x);return e&&m.forEach(function(e){return t(i,e)}),ha&&oa(i,f),u}(l,c,u=b.call(u),d)}if("function"==typeof u.then)return x(l,c,di(u),d);if(u.$$typeof===v)return x(l,c,Ma(l,u),d);hi(l,u)}return"string"==typeof u&&""!==u||"number"==typeof u||"bigint"==typeof u?(u=""+u,null!==c&&6===c.tag?(n(l,c.sibling),(d=i(c,u)).return=l,l=d):(n(l,c),(d=Vr(u,l.mode,d)).return=l,l=d),s(l)):n(l,c)}return function(e,t,n,r){try{ui=0;var a=x(e,t,n,r);return ci=null,a}catch(o){if(o===Za||o===ti)throw o;var i=Fr(29,o,null,e.mode);return i.lanes=r,i.return=e,i}}}var fi=mi(!0),gi=mi(!1),yi=!1;function xi(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function bi(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function vi(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function wi(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,2&fc){var a=r.pending;return null===a?t.next=t:(t.next=a.next,a.next=t),r.pending=t,t=Lr(e),Dr(e,null,n),t}return Pr(e,r,t,n),Lr(e)}function Ni(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,4194048&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,De(e,n)}}function Ei(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var a=null,i=null;if(null!==(n=n.firstBaseUpdate)){do{var o={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};null===i?a=i=o:i=i.next=o,n=n.next}while(null!==n);null===i?a=i=t:i=i.next=t}else a=i=t;return n={baseState:r.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:r.shared,callbacks:r.callbacks},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}var Si=!1;function Ci(){if(Si){if(null!==Va)throw Va}}function ki(e,t,n,r){Si=!1;var a=e.updateQueue;yi=!1;var i=a.firstBaseUpdate,o=a.lastBaseUpdate,s=a.shared.pending;if(null!==s){a.shared.pending=null;var l=s,c=l.next;l.next=null,null===o?i=c:o.next=c,o=l;var u=e.alternate;null!==u&&((s=(u=u.updateQueue).lastBaseUpdate)!==o&&(null===s?u.firstBaseUpdate=c:s.next=c,u.lastBaseUpdate=l))}if(null!==i){var d=a.baseState;for(o=0,u=c=l=null,s=i;;){var h=-536870913&s.lane,m=h!==s.lane;if(m?(xc&h)===h:(r&h)===h){0!==h&&h===Ba&&(Si=!0),null!==u&&(u=u.next={lane:0,tag:s.tag,payload:s.payload,callback:null,next:null});e:{var f=e,g=s;h=t;var y=n;switch(g.tag){case 1:if("function"==typeof(f=g.payload)){d=f.call(y,d,h);break e}d=f;break e;case 3:f.flags=-65537&f.flags|128;case 0:if(null==(h="function"==typeof(f=g.payload)?f.call(y,d,h):f))break e;d=p({},d,h);break e;case 2:yi=!0}}null!==(h=s.callback)&&(e.flags|=64,m&&(e.flags|=8192),null===(m=a.callbacks)?a.callbacks=[h]:m.push(h))}else m={lane:h,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===u?(c=u=m,l=d):u=u.next=m,o|=h;if(null===(s=s.next)){if(null===(s=a.shared.pending))break;s=(m=s).next,m.next=null,a.lastBaseUpdate=m,a.shared.pending=null}}null===u&&(l=d),a.baseState=l,a.firstBaseUpdate=c,a.lastBaseUpdate=u,null===i&&(a.shared.lanes=0),kc|=o,e.lanes=o,e.memoizedState=d}}function Ti(e,t){if("function"!=typeof e)throw Error(a(191,e));e.call(t)}function Ii(e,t){var n=e.callbacks;if(null!==n)for(e.callbacks=null,e=0;e<n.length;e++)Ti(n[e],t)}var Ai=G(null),ji=G(0);function _i(e,t){H(ji,e=Sc),H(Ai,t),Sc=e|t.baseLanes}function Oi(){H(ji,Sc),H(Ai,Ai.current)}function Pi(){Sc=ji.current,q(Ai),q(ji)}var Ri=G(null),Mi=null;function Di(e){var t=e.alternate;H(Gi,1&Gi.current),H(Ri,e),null===Mi&&(null===t||null!==Ai.current||null!==t.memoizedState)&&(Mi=e)}function Li(e){H(Gi,Gi.current),H(Ri,e),null===Mi&&(Mi=e)}function Ui(e){22===e.tag?(H(Gi,Gi.current),H(Ri,e),null===Mi&&(Mi=e)):zi()}function zi(){H(Gi,Gi.current),H(Ri,Ri.current)}function Fi(e){q(Ri),Mi===e&&(Mi=null),q(Gi)}var Gi=G(0);function qi(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||Pd(n)||Rd(n)))return t}else if(19!==t.tag||"forwards"!==t.memoizedProps.revealOrder&&"backwards"!==t.memoizedProps.revealOrder&&"unstable_legacy-backwards"!==t.memoizedProps.revealOrder&&"together"!==t.memoizedProps.revealOrder){if(null!==t.child){t.child.return=t,t=t.child;continue}}else if(128&t.flags)return t;if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Hi=0,$i=null,Bi=null,Vi=null,Yi=!1,Wi=!1,Ki=!1,Ji=0,Qi=0,Xi=null,Zi=0;function eo(){throw Error(a(321))}function to(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!er(e[n],t[n]))return!1;return!0}function no(e,t,n,r,a,i){return Hi=i,$i=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,R.H=null===e||null===e.memoizedState?xs:bs,Ki=!1,i=n(r,a),Ki=!1,Wi&&(i=ao(t,n,r,a)),ro(e),i}function ro(e){R.H=ys;var t=null!==Bi&&null!==Bi.next;if(Hi=0,Vi=Bi=$i=null,Yi=!1,Qi=0,Xi=null,t)throw Error(a(300));null===e||Ms||null!==(e=e.dependencies)&&Oa(e)&&(Ms=!0)}function ao(e,t,n,r){$i=e;var i=0;do{if(Wi&&(Xi=null),Qi=0,Wi=!1,25<=i)throw Error(a(301));if(i+=1,Vi=Bi=null,null!=e.updateQueue){var o=e.updateQueue;o.lastEffect=null,o.events=null,o.stores=null,null!=o.memoCache&&(o.memoCache.index=0)}R.H=vs,o=t(n,r)}while(Wi);return o}function io(){var e=R.H,t=e.useState()[0];return t="function"==typeof t.then?po(t):t,e=e.useState()[0],(null!==Bi?Bi.memoizedState:null)!==e&&($i.flags|=1024),t}function oo(){var e=0!==Ji;return Ji=0,e}function so(e,t,n){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n}function lo(e){if(Yi){for(e=e.memoizedState;null!==e;){var t=e.queue;null!==t&&(t.pending=null),e=e.next}Yi=!1}Hi=0,Vi=Bi=$i=null,Wi=!1,Qi=Ji=0,Xi=null}function co(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===Vi?$i.memoizedState=Vi=e:Vi=Vi.next=e,Vi}function uo(){if(null===Bi){var e=$i.alternate;e=null!==e?e.memoizedState:null}else e=Bi.next;var t=null===Vi?$i.memoizedState:Vi.next;if(null!==t)Vi=t,Bi=e;else{if(null===e){if(null===$i.alternate)throw Error(a(467));throw Error(a(310))}e={memoizedState:(Bi=e).memoizedState,baseState:Bi.baseState,baseQueue:Bi.baseQueue,queue:Bi.queue,next:null},null===Vi?$i.memoizedState=Vi=e:Vi=Vi.next=e}return Vi}function po(e){var t=Qi;return Qi+=1,null===Xi&&(Xi=[]),e=ai(Xi,e,t),t=$i,null===(null===Vi?t.memoizedState:Vi.next)&&(t=t.alternate,R.H=null===t||null===t.memoizedState?xs:bs),e}function ho(e){if(null!==e&&"object"==typeof e){if("function"==typeof e.then)return po(e);if(e.$$typeof===v)return Ra(e)}throw Error(a(438,String(e)))}function mo(e){var t=null,n=$i.updateQueue;if(null!==n&&(t=n.memoCache),null==t){var r=$i.alternate;null!==r&&(null!==(r=r.updateQueue)&&(null!=(r=r.memoCache)&&(t={data:r.data.map(function(e){return e.slice()}),index:0})))}if(null==t&&(t={data:[],index:0}),null===n&&(n={lastEffect:null,events:null,stores:null,memoCache:null},$i.updateQueue=n),n.memoCache=t,void 0===(n=t.data[t.index]))for(n=t.data[t.index]=Array(e),r=0;r<e;r++)n[r]=T;return t.index++,n}function fo(e,t){return"function"==typeof t?t(e):t}function go(e){return yo(uo(),Bi,e)}function yo(e,t,n){var r=e.queue;if(null===r)throw Error(a(311));r.lastRenderedReducer=n;var i=e.baseQueue,o=r.pending;if(null!==o){if(null!==i){var s=i.next;i.next=o.next,o.next=s}t.baseQueue=i=o,r.pending=null}if(o=e.baseState,null===i)e.memoizedState=o;else{var l=s=null,c=null,u=t=i.next,d=!1;do{var p=-536870913&u.lane;if(p!==u.lane?(xc&p)===p:(Hi&p)===p){var h=u.revertLane;if(0===h)null!==c&&(c=c.next={lane:0,revertLane:0,gesture:null,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),p===Ba&&(d=!0);else{if((Hi&h)===h){u=u.next,h===Ba&&(d=!0);continue}p={lane:0,revertLane:u.revertLane,gesture:null,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},null===c?(l=c=p,s=o):c=c.next=p,$i.lanes|=h,kc|=h}p=u.action,Ki&&n(o,p),o=u.hasEagerState?u.eagerState:n(o,p)}else h={lane:p,revertLane:u.revertLane,gesture:u.gesture,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},null===c?(l=c=h,s=o):c=c.next=h,$i.lanes|=p,kc|=p;u=u.next}while(null!==u&&u!==t);if(null===c?s=o:c.next=l,!er(o,e.memoizedState)&&(Ms=!0,d&&null!==(n=Va)))throw n;e.memoizedState=o,e.baseState=s,e.baseQueue=c,r.lastRenderedState=o}return null===i&&(r.lanes=0),[e.memoizedState,r.dispatch]}function xo(e){var t=uo(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,o=t.memoizedState;if(null!==i){n.pending=null;var s=i=i.next;do{o=e(o,s.action),s=s.next}while(s!==i);er(o,t.memoizedState)||(Ms=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function bo(e,t,n){var r=$i,i=uo(),o=ha;if(o){if(void 0===n)throw Error(a(407));n=n()}else n=t();var s=!er((Bi||i).memoizedState,n);if(s&&(i.memoizedState=n,Ms=!0),i=i.queue,$o(No.bind(null,r,i,e),[e]),i.getSnapshot!==t||s||null!==Vi&&1&Vi.memoizedState.tag){if(r.flags|=2048,zo(9,{destroy:void 0},wo.bind(null,r,i,n,t),null),null===gc)throw Error(a(349));o||127&Hi||vo(r,t,n)}return n}function vo(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=$i.updateQueue)?(t={lastEffect:null,events:null,stores:null,memoCache:null},$i.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function wo(e,t,n,r){t.value=n,t.getSnapshot=r,Eo(t)&&So(e)}function No(e,t,n){return n(function(){Eo(t)&&So(e)})}function Eo(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!er(e,n)}catch(r){return!0}}function So(e){var t=Mr(e,2);null!==t&&Jc(t,e,2)}function Co(e){var t=co();if("function"==typeof e){var n=e;if(e=n(),Ki){we(!0);try{n()}finally{we(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:fo,lastRenderedState:e},t}function ko(e,t,n,r){return e.baseState=n,yo(e,Bi,"function"==typeof r?r:fo)}function To(e,t,n,r,i){if(ms(e))throw Error(a(485));if(null!==(e=t.action)){var o={payload:i,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(e){o.listeners.push(e)}};null!==R.T?n(!0):o.isTransition=!1,r(o),null===(n=t.pending)?(o.next=t.pending=o,Io(t,o)):(o.next=n.next,t.pending=n.next=o)}}function Io(e,t){var n=t.action,r=t.payload,a=e.state;if(t.isTransition){var i=R.T,o={};R.T=o;try{var s=n(a,r),l=R.S;null!==l&&l(o,s),Ao(e,t,s)}catch(c){_o(e,t,c)}finally{null!==i&&null!==o.types&&(i.types=o.types),R.T=i}}else try{Ao(e,t,i=n(a,r))}catch(u){_o(e,t,u)}}function Ao(e,t,n){null!==n&&"object"==typeof n&&"function"==typeof n.then?n.then(function(n){jo(e,t,n)},function(n){return _o(e,t,n)}):jo(e,t,n)}function jo(e,t,n){t.status="fulfilled",t.value=n,Oo(t),e.state=n,null!==(t=e.pending)&&((n=t.next)===t?e.pending=null:(n=n.next,t.next=n,Io(e,n)))}function _o(e,t,n){var r=e.pending;if(e.pending=null,null!==r){r=r.next;do{t.status="rejected",t.reason=n,Oo(t),t=t.next}while(t!==r)}e.action=null}function Oo(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function Po(e,t){return t}function Ro(e,t){if(ha){var n=gc.formState;if(null!==n){e:{var r=$i;if(ha){if(pa){t:{for(var a=pa,i=fa;8!==a.nodeType;){if(!i){a=null;break t}if(null===(a=Md(a.nextSibling))){a=null;break t}}a="F!"===(i=a.data)||"F"===i?a:null}if(a){pa=Md(a.nextSibling),r="F!"===a.data;break e}}ya(r)}r=!1}r&&(t=n[0])}}return(n=co()).memoizedState=n.baseState=t,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Po,lastRenderedState:t},n.queue=r,n=ds.bind(null,$i,r),r.dispatch=n,r=Co(!1),i=hs.bind(null,$i,!1,r.queue),a={state:t,dispatch:null,action:e,pending:null},(r=co()).queue=a,n=To.bind(null,$i,a,i,n),a.dispatch=n,r.memoizedState=e,[t,n,!1]}function Mo(e){return Do(uo(),Bi,e)}function Do(e,t,n){if(t=yo(e,t,Po)[0],e=go(fo)[0],"object"==typeof t&&null!==t&&"function"==typeof t.then)try{var r=po(t)}catch(o){if(o===Za)throw ti;throw o}else r=t;var a=(t=uo()).queue,i=a.dispatch;return n!==t.memoizedState&&($i.flags|=2048,zo(9,{destroy:void 0},Lo.bind(null,a,n),null)),[r,i,e]}function Lo(e,t){e.action=t}function Uo(e){var t=uo(),n=Bi;if(null!==n)return Do(t,n,e);uo(),t=t.memoizedState;var r=(n=uo()).queue.dispatch;return n.memoizedState=e,[t,r,!1]}function zo(e,t,n,r){return e={tag:e,create:n,deps:r,inst:t,next:null},null===(t=$i.updateQueue)&&(t={lastEffect:null,events:null,stores:null,memoCache:null},$i.updateQueue=t),null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Fo(){return uo().memoizedState}function Go(e,t,n,r){var a=co();$i.flags|=e,a.memoizedState=zo(1|t,{destroy:void 0},n,void 0===r?null:r)}function qo(e,t,n,r){var a=uo();r=void 0===r?null:r;var i=a.memoizedState.inst;null!==Bi&&null!==r&&to(r,Bi.memoizedState.deps)?a.memoizedState=zo(t,i,n,r):($i.flags|=e,a.memoizedState=zo(1|t,i,n,r))}function Ho(e,t){Go(8390656,8,e,t)}function $o(e,t){qo(2048,8,e,t)}function Bo(e){var t=uo().memoizedState;return function(e){$i.flags|=4;var t=$i.updateQueue;if(null===t)t={lastEffect:null,events:null,stores:null,memoCache:null},$i.updateQueue=t,t.events=[e];else{var n=t.events;null===n?t.events=[e]:n.push(e)}}({ref:t,nextImpl:e}),function(){if(2&fc)throw Error(a(440));return t.impl.apply(void 0,arguments)}}function Vo(e,t){return qo(4,2,e,t)}function Yo(e,t){return qo(4,4,e,t)}function Wo(e,t){if("function"==typeof t){e=e();var n=t(e);return function(){"function"==typeof n?n():t(null)}}if(null!=t)return e=e(),t.current=e,function(){t.current=null}}function Ko(e,t,n){n=null!=n?n.concat([e]):null,qo(4,4,Wo.bind(null,t,e),n)}function Jo(){}function Qo(e,t){var n=uo();t=void 0===t?null:t;var r=n.memoizedState;return null!==t&&to(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Xo(e,t){var n=uo();t=void 0===t?null:t;var r=n.memoizedState;if(null!==t&&to(t,r[1]))return r[0];if(r=e(),Ki){we(!0);try{e()}finally{we(!1)}}return n.memoizedState=[r,t],r}function Zo(e,t,n){return void 0===n||1073741824&Hi&&!(261930&xc)?e.memoizedState=t:(e.memoizedState=n,e=Kc(),$i.lanes|=e,kc|=e,n)}function es(e,t,n,r){return er(n,t)?n:null!==Ai.current?(e=Zo(e,n,r),er(e,t)||(Ms=!0),e):42&Hi&&(!(1073741824&Hi)||261930&xc)?(e=Kc(),$i.lanes|=e,kc|=e,t):(Ms=!0,e.memoizedState=n)}function ts(e,t,n,r,a){var i=D.p;D.p=0!==i&&8>i?i:8;var o,s,l,c=R.T,u={};R.T=u,hs(e,!1,t,n);try{var d=a(),p=R.S;if(null!==p&&p(u,d),null!==d&&"object"==typeof d&&"function"==typeof d.then)ps(e,t,(o=r,s=[],l={status:"pending",value:null,reason:null,then:function(e){s.push(e)}},d.then(function(){l.status="fulfilled",l.value=o;for(var e=0;e<s.length;e++)(0,s[e])(o)},function(e){for(l.status="rejected",l.reason=e,e=0;e<s.length;e++)(0,s[e])(void 0)}),l),Wc());else ps(e,t,r,Wc())}catch(h){ps(e,t,{then:function(){},status:"rejected",reason:h},Wc())}finally{D.p=i,null!==c&&null!==u.types&&(c.types=u.types),R.T=c}}function ns(){}function rs(e,t,n,r){if(5!==e.tag)throw Error(a(476));var i=as(e).queue;ts(e,i,t,L,null===n?ns:function(){return is(e),n(r)})}function as(e){var t=e.memoizedState;if(null!==t)return t;var n={};return(t={memoizedState:L,baseState:L,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:fo,lastRenderedState:L},next:null}).next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:fo,lastRenderedState:n},next:null},e.memoizedState=t,null!==(e=e.alternate)&&(e.memoizedState=t),t}function is(e){var t=as(e);null===t.next&&(t=e.alternate.memoizedState),ps(e,t.next.queue,{},Wc())}function os(){return Ra(pp)}function ss(){return uo().memoizedState}function ls(){return uo().memoizedState}function cs(e){for(var t=e.return;null!==t;){switch(t.tag){case 24:case 3:var n=Wc(),r=wi(t,e=vi(n),n);return null!==r&&(Jc(r,t,n),Ni(r,t,n)),t={cache:Ga()},void(e.payload=t)}t=t.return}}function us(e,t,n){var r=Wc();n={lane:r,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null},ms(e)?fs(t,n):null!==(n=Rr(e,t,n,r))&&(Jc(n,e,r),gs(n,t,r))}function ds(e,t,n){ps(e,t,n,Wc())}function ps(e,t,n,r){var a={lane:r,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null};if(ms(e))fs(t,a);else{var i=e.alternate;if(0===e.lanes&&(null===i||0===i.lanes)&&null!==(i=t.lastRenderedReducer))try{var o=t.lastRenderedState,s=i(o,n);if(a.hasEagerState=!0,a.eagerState=s,er(s,o))return Pr(e,t,a,0),null===gc&&Or(),!1}catch(l){}if(null!==(n=Rr(e,t,a,r)))return Jc(n,e,r),gs(n,t,r),!0}return!1}function hs(e,t,n,r){if(r={lane:2,revertLane:$u(),gesture:null,action:r,hasEagerState:!1,eagerState:null,next:null},ms(e)){if(t)throw Error(a(479))}else null!==(t=Rr(e,n,r,2))&&Jc(t,e,2)}function ms(e){var t=e.alternate;return e===$i||null!==t&&t===$i}function fs(e,t){Wi=Yi=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function gs(e,t,n){if(4194048&n){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,De(e,n)}}var ys={readContext:Ra,use:ho,useCallback:eo,useContext:eo,useEffect:eo,useImperativeHandle:eo,useLayoutEffect:eo,useInsertionEffect:eo,useMemo:eo,useReducer:eo,useRef:eo,useState:eo,useDebugValue:eo,useDeferredValue:eo,useTransition:eo,useSyncExternalStore:eo,useId:eo,useHostTransitionStatus:eo,useFormState:eo,useActionState:eo,useOptimistic:eo,useMemoCache:eo,useCacheRefresh:eo};ys.useEffectEvent=eo;var xs={readContext:Ra,use:ho,useCallback:function(e,t){return co().memoizedState=[e,void 0===t?null:t],e},useContext:Ra,useEffect:Ho,useImperativeHandle:function(e,t,n){n=null!=n?n.concat([e]):null,Go(4194308,4,Wo.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Go(4194308,4,e,t)},useInsertionEffect:function(e,t){Go(4,2,e,t)},useMemo:function(e,t){var n=co();t=void 0===t?null:t;var r=e();if(Ki){we(!0);try{e()}finally{we(!1)}}return n.memoizedState=[r,t],r},useReducer:function(e,t,n){var r=co();if(void 0!==n){var a=n(t);if(Ki){we(!0);try{n(t)}finally{we(!1)}}}else a=t;return r.memoizedState=r.baseState=a,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:a},r.queue=e,e=e.dispatch=us.bind(null,$i,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},co().memoizedState=e},useState:function(e){var t=(e=Co(e)).queue,n=ds.bind(null,$i,t);return t.dispatch=n,[e.memoizedState,n]},useDebugValue:Jo,useDeferredValue:function(e,t){return Zo(co(),e,t)},useTransition:function(){var e=Co(!1);return e=ts.bind(null,$i,e.queue,!0,!1),co().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,n){var r=$i,i=co();if(ha){if(void 0===n)throw Error(a(407));n=n()}else{if(n=t(),null===gc)throw Error(a(349));127&xc||vo(r,t,n)}i.memoizedState=n;var o={value:n,getSnapshot:t};return i.queue=o,Ho(No.bind(null,r,o,e),[e]),r.flags|=2048,zo(9,{destroy:void 0},wo.bind(null,r,o,n,t),null),n},useId:function(){var e=co(),t=gc.identifierPrefix;if(ha){var n=ia;t="_"+t+"R_"+(n=(aa&~(1<<32-Ne(aa)-1)).toString(32)+n),0<(n=Ji++)&&(t+="H"+n.toString(32)),t+="_"}else t="_"+t+"r_"+(n=Zi++).toString(32)+"_";return e.memoizedState=t},useHostTransitionStatus:os,useFormState:Ro,useActionState:Ro,useOptimistic:function(e){var t=co();t.memoizedState=t.baseState=e;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=n,t=hs.bind(null,$i,!0,n),n.dispatch=t,[e,t]},useMemoCache:mo,useCacheRefresh:function(){return co().memoizedState=cs.bind(null,$i)},useEffectEvent:function(e){var t=co(),n={impl:e};return t.memoizedState=n,function(){if(2&fc)throw Error(a(440));return n.impl.apply(void 0,arguments)}}},bs={readContext:Ra,use:ho,useCallback:Qo,useContext:Ra,useEffect:$o,useImperativeHandle:Ko,useInsertionEffect:Vo,useLayoutEffect:Yo,useMemo:Xo,useReducer:go,useRef:Fo,useState:function(){return go(fo)},useDebugValue:Jo,useDeferredValue:function(e,t){return es(uo(),Bi.memoizedState,e,t)},useTransition:function(){var e=go(fo)[0],t=uo().memoizedState;return["boolean"==typeof e?e:po(e),t]},useSyncExternalStore:bo,useId:ss,useHostTransitionStatus:os,useFormState:Mo,useActionState:Mo,useOptimistic:function(e,t){return ko(uo(),0,e,t)},useMemoCache:mo,useCacheRefresh:ls};bs.useEffectEvent=Bo;var vs={readContext:Ra,use:ho,useCallback:Qo,useContext:Ra,useEffect:$o,useImperativeHandle:Ko,useInsertionEffect:Vo,useLayoutEffect:Yo,useMemo:Xo,useReducer:xo,useRef:Fo,useState:function(){return xo(fo)},useDebugValue:Jo,useDeferredValue:function(e,t){var n=uo();return null===Bi?Zo(n,e,t):es(n,Bi.memoizedState,e,t)},useTransition:function(){var e=xo(fo)[0],t=uo().memoizedState;return["boolean"==typeof e?e:po(e),t]},useSyncExternalStore:bo,useId:ss,useHostTransitionStatus:os,useFormState:Uo,useActionState:Uo,useOptimistic:function(e,t){var n=uo();return null!==Bi?ko(n,0,e,t):(n.baseState=e,[e,n.queue.dispatch])},useMemoCache:mo,useCacheRefresh:ls};function ws(e,t,n,r){n=null==(n=n(r,t=e.memoizedState))?t:p({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}vs.useEffectEvent=Bo;var Ns={enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Wc(),a=vi(r);a.payload=t,null!=n&&(a.callback=n),null!==(t=wi(e,a,r))&&(Jc(t,e,r),Ni(t,e,r))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Wc(),a=vi(r);a.tag=1,a.payload=t,null!=n&&(a.callback=n),null!==(t=wi(e,a,r))&&(Jc(t,e,r),Ni(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Wc(),r=vi(n);r.tag=2,null!=t&&(r.callback=t),null!==(t=wi(e,r,n))&&(Jc(t,e,n),Ni(t,e,n))}};function Es(e,t,n,r,a,i,o){return"function"==typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,i,o):!t.prototype||!t.prototype.isPureReactComponent||(!tr(n,r)||!tr(a,i))}function Ss(e,t,n,r){e=t.state,"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Ns.enqueueReplaceState(t,t.state,null)}function Cs(e,t){var n=t;if("ref"in t)for(var r in n={},t)"ref"!==r&&(n[r]=t[r]);if(e=e.defaultProps)for(var a in n===t&&(n=p({},n)),e)void 0===n[a]&&(n[a]=e[a]);return n}function ks(e){Ir(e)}function Ts(e){}function Is(e){Ir(e)}function As(e,t){try{(0,e.onUncaughtError)(t.value,{componentStack:t.stack})}catch(n){setTimeout(function(){throw n})}}function js(e,t,n){try{(0,e.onCaughtError)(n.value,{componentStack:n.stack,errorBoundary:1===t.tag?t.stateNode:null})}catch(r){setTimeout(function(){throw r})}}function _s(e,t,n){return(n=vi(n)).tag=3,n.payload={element:null},n.callback=function(){As(e,t)},n}function Os(e){return(e=vi(e)).tag=3,e}function Ps(e,t,n,r){var a=n.type.getDerivedStateFromError;if("function"==typeof a){var i=r.value;e.payload=function(){return a(i)},e.callback=function(){js(t,n,r)}}var o=n.stateNode;null!==o&&"function"==typeof o.componentDidCatch&&(e.callback=function(){js(t,n,r),"function"!=typeof a&&(null===Uc?Uc=new Set([this]):Uc.add(this));var e=r.stack;this.componentDidCatch(r.value,{componentStack:null!==e?e:""})})}var Rs=Error(a(461)),Ms=!1;function Ds(e,t,n,r){t.child=null===e?gi(t,null,n,r):fi(t,e.child,n,r)}function Ls(e,t,n,r,a){n=n.render;var i=t.ref;if("ref"in r){var o={};for(var s in r)"ref"!==s&&(o[s]=r[s])}else o=r;return Pa(t),r=no(e,t,n,o,i,a),s=oo(),null===e||Ms?(ha&&s&&la(t),t.flags|=1,Ds(e,t,r,a),t.child):(so(e,t,a),ol(e,t,a))}function Us(e,t,n,r,a){if(null===e){var i=n.type;return"function"!=typeof i||Gr(i)||void 0!==i.defaultProps||null!==n.compare?((e=$r(n.type,null,r,t,t.mode,a)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=i,zs(e,t,i,r,a))}if(i=e.child,!sl(e,a)){var o=i.memoizedProps;if((n=null!==(n=n.compare)?n:tr)(o,r)&&e.ref===t.ref)return ol(e,t,a)}return t.flags|=1,(e=qr(i,r)).ref=t.ref,e.return=t,t.child=e}function zs(e,t,n,r,a){if(null!==e){var i=e.memoizedProps;if(tr(i,r)&&e.ref===t.ref){if(Ms=!1,t.pendingProps=r=i,!sl(e,a))return t.lanes=e.lanes,ol(e,t,a);131072&e.flags&&(Ms=!0)}}return Vs(e,t,n,r,a)}function Fs(e,t,n,r){var a=r.children,i=null!==e?e.memoizedState:null;if(null===e&&null===t.stateNode&&(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),"hidden"===r.mode){if(128&t.flags){if(i=null!==i?i.baseLanes|n:n,null!==e){for(r=t.child=e.child,a=0;null!==r;)a=a|r.lanes|r.childLanes,r=r.sibling;r=a&~i}else r=0,t.child=null;return qs(e,t,i,n,r)}if(!(536870912&n))return r=t.lanes=536870912,qs(e,t,null!==i?i.baseLanes|n:n,n,r);t.memoizedState={baseLanes:0,cachePool:null},null!==e&&Qa(0,null!==i?i.cachePool:null),null!==i?_i(t,i):Oi(),Ui(t)}else null!==i?(Qa(0,i.cachePool),_i(t,i),zi(),t.memoizedState=null):(null!==e&&Qa(0,null),Oi(),zi());return Ds(e,t,a,n),t.child}function Gs(e,t){return null!==e&&22===e.tag||null!==t.stateNode||(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),t.sibling}function qs(e,t,n,r,a){var i=Ja();return i=null===i?null:{parent:Fa._currentValue,pool:i},t.memoizedState={baseLanes:n,cachePool:i},null!==e&&Qa(0,null),Oi(),Ui(t),null!==e&&_a(e,t,r,!0),t.childLanes=a,null}function Hs(e,t){return(t=tl({mode:t.mode,children:t.children},e.mode)).ref=e.ref,e.child=t,t.return=e,t}function $s(e,t,n){return fi(t,e.child,null,n),(e=Hs(t,t.pendingProps)).flags|=2,Fi(t),t.memoizedState=null,e}function Bs(e,t){var n=t.ref;if(null===n)null!==e&&null!==e.ref&&(t.flags|=4194816);else{if("function"!=typeof n&&"object"!=typeof n)throw Error(a(284));null!==e&&e.ref===n||(t.flags|=4194816)}}function Vs(e,t,n,r,a){return Pa(t),n=no(e,t,n,r,void 0,a),r=oo(),null===e||Ms?(ha&&r&&la(t),t.flags|=1,Ds(e,t,n,a),t.child):(so(e,t,a),ol(e,t,a))}function Ys(e,t,n,r,a,i){return Pa(t),t.updateQueue=null,n=ao(t,r,n,a),ro(e),r=oo(),null===e||Ms?(ha&&r&&la(t),t.flags|=1,Ds(e,t,n,i),t.child):(so(e,t,i),ol(e,t,i))}function Ws(e,t,n,r,a){if(Pa(t),null===t.stateNode){var i=Ur,o=n.contextType;"object"==typeof o&&null!==o&&(i=Ra(o)),i=new n(r,i),t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,i.updater=Ns,t.stateNode=i,i._reactInternals=t,(i=t.stateNode).props=r,i.state=t.memoizedState,i.refs={},xi(t),o=n.contextType,i.context="object"==typeof o&&null!==o?Ra(o):Ur,i.state=t.memoizedState,"function"==typeof(o=n.getDerivedStateFromProps)&&(ws(t,n,o,r),i.state=t.memoizedState),"function"==typeof n.getDerivedStateFromProps||"function"==typeof i.getSnapshotBeforeUpdate||"function"!=typeof i.UNSAFE_componentWillMount&&"function"!=typeof i.componentWillMount||(o=i.state,"function"==typeof i.componentWillMount&&i.componentWillMount(),"function"==typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),o!==i.state&&Ns.enqueueReplaceState(i,i.state,null),ki(t,r,i,a),Ci(),i.state=t.memoizedState),"function"==typeof i.componentDidMount&&(t.flags|=4194308),r=!0}else if(null===e){i=t.stateNode;var s=t.memoizedProps,l=Cs(n,s);i.props=l;var c=i.context,u=n.contextType;o=Ur,"object"==typeof u&&null!==u&&(o=Ra(u));var d=n.getDerivedStateFromProps;u="function"==typeof d||"function"==typeof i.getSnapshotBeforeUpdate,s=t.pendingProps!==s,u||"function"!=typeof i.UNSAFE_componentWillReceiveProps&&"function"!=typeof i.componentWillReceiveProps||(s||c!==o)&&Ss(t,i,r,o),yi=!1;var p=t.memoizedState;i.state=p,ki(t,r,i,a),Ci(),c=t.memoizedState,s||p!==c||yi?("function"==typeof d&&(ws(t,n,d,r),c=t.memoizedState),(l=yi||Es(t,n,l,r,p,c,o))?(u||"function"!=typeof i.UNSAFE_componentWillMount&&"function"!=typeof i.componentWillMount||("function"==typeof i.componentWillMount&&i.componentWillMount(),"function"==typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount()),"function"==typeof i.componentDidMount&&(t.flags|=4194308)):("function"==typeof i.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=c),i.props=r,i.state=c,i.context=o,r=l):("function"==typeof i.componentDidMount&&(t.flags|=4194308),r=!1)}else{i=t.stateNode,bi(e,t),u=Cs(n,o=t.memoizedProps),i.props=u,d=t.pendingProps,p=i.context,c=n.contextType,l=Ur,"object"==typeof c&&null!==c&&(l=Ra(c)),(c="function"==typeof(s=n.getDerivedStateFromProps)||"function"==typeof i.getSnapshotBeforeUpdate)||"function"!=typeof i.UNSAFE_componentWillReceiveProps&&"function"!=typeof i.componentWillReceiveProps||(o!==d||p!==l)&&Ss(t,i,r,l),yi=!1,p=t.memoizedState,i.state=p,ki(t,r,i,a),Ci();var h=t.memoizedState;o!==d||p!==h||yi||null!==e&&null!==e.dependencies&&Oa(e.dependencies)?("function"==typeof s&&(ws(t,n,s,r),h=t.memoizedState),(u=yi||Es(t,n,u,r,p,h,l)||null!==e&&null!==e.dependencies&&Oa(e.dependencies))?(c||"function"!=typeof i.UNSAFE_componentWillUpdate&&"function"!=typeof i.componentWillUpdate||("function"==typeof i.componentWillUpdate&&i.componentWillUpdate(r,h,l),"function"==typeof i.UNSAFE_componentWillUpdate&&i.UNSAFE_componentWillUpdate(r,h,l)),"function"==typeof i.componentDidUpdate&&(t.flags|=4),"function"==typeof i.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!=typeof i.componentDidUpdate||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),"function"!=typeof i.getSnapshotBeforeUpdate||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=h),i.props=r,i.state=h,i.context=l,r=u):("function"!=typeof i.componentDidUpdate||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),"function"!=typeof i.getSnapshotBeforeUpdate||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),r=!1)}return i=r,Bs(e,t),r=!!(128&t.flags),i||r?(i=t.stateNode,n=r&&"function"!=typeof n.getDerivedStateFromError?null:i.render(),t.flags|=1,null!==e&&r?(t.child=fi(t,e.child,null,a),t.child=fi(t,null,n,a)):Ds(e,t,n,a),t.memoizedState=i.state,e=t.child):e=ol(e,t,a),e}function Ks(e,t,n,r){return wa(),t.flags|=256,Ds(e,t,n,r),t.child}var Js={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Qs(e){return{baseLanes:e,cachePool:Xa()}}function Xs(e,t,n){return e=null!==e?e.childLanes&~n:0,t&&(e|=Ac),e}function Zs(e,t,n){var r,i=t.pendingProps,o=!1,s=!!(128&t.flags);if((r=s)||(r=(null===e||null!==e.memoizedState)&&!!(2&Gi.current)),r&&(o=!0,t.flags&=-129),r=!!(32&t.flags),t.flags&=-33,null===e){if(ha){if(o?Di(t):zi(),(e=pa)?null!==(e=null!==(e=Od(e,fa))&&"&"!==e.data?e:null)&&(t.memoizedState={dehydrated:e,treeContext:null!==ra?{id:aa,overflow:ia}:null,retryLane:536870912,hydrationErrors:null},(n=Yr(e)).return=t,t.child=n,da=t,pa=null):e=null,null===e)throw ya(t);return Rd(e)?t.lanes=32:t.lanes=536870912,null}var l=i.children;return i=i.fallback,o?(zi(),l=tl({mode:"hidden",children:l},o=t.mode),i=Br(i,o,n,null),l.return=t,i.return=t,l.sibling=i,t.child=l,(i=t.child).memoizedState=Qs(n),i.childLanes=Xs(e,r,n),t.memoizedState=Js,Gs(null,i)):(Di(t),el(t,l))}var c=e.memoizedState;if(null!==c&&null!==(l=c.dehydrated)){if(s)256&t.flags?(Di(t),t.flags&=-257,t=nl(e,t,n)):null!==t.memoizedState?(zi(),t.child=e.child,t.flags|=128,t=null):(zi(),l=i.fallback,o=t.mode,i=tl({mode:"visible",children:i.children},o),(l=Br(l,o,n,null)).flags|=2,i.return=t,l.return=t,i.sibling=l,t.child=i,fi(t,e.child,null,n),(i=t.child).memoizedState=Qs(n),i.childLanes=Xs(e,r,n),t.memoizedState=Js,t=Gs(null,i));else if(Di(t),Rd(l)){if(r=l.nextSibling&&l.nextSibling.dataset)var u=r.dgst;r=u,(i=Error(a(419))).stack="",i.digest=r,Ea({value:i,source:null,stack:null}),t=nl(e,t,n)}else if(Ms||_a(e,t,n,!1),r=0!==(n&e.childLanes),Ms||r){if(null!==(r=gc)&&(0!==(i=Le(r,n))&&i!==c.retryLane))throw c.retryLane=i,Mr(e,i),Jc(r,e,i),Rs;Pd(l)||lu(),t=nl(e,t,n)}else Pd(l)?(t.flags|=192,t.child=e.child,t=null):(e=c.treeContext,pa=Md(l.nextSibling),da=t,ha=!0,ma=null,fa=!1,null!==e&&ua(t,e),(t=el(t,i.children)).flags|=4096);return t}return o?(zi(),l=i.fallback,o=t.mode,u=(c=e.child).sibling,(i=qr(c,{mode:"hidden",children:i.children})).subtreeFlags=65011712&c.subtreeFlags,null!==u?l=qr(u,l):(l=Br(l,o,n,null)).flags|=2,l.return=t,i.return=t,i.sibling=l,t.child=i,Gs(null,i),i=t.child,null===(l=e.child.memoizedState)?l=Qs(n):(null!==(o=l.cachePool)?(c=Fa._currentValue,o=o.parent!==c?{parent:c,pool:c}:o):o=Xa(),l={baseLanes:l.baseLanes|n,cachePool:o}),i.memoizedState=l,i.childLanes=Xs(e,r,n),t.memoizedState=Js,Gs(e.child,i)):(Di(t),e=(n=e.child).sibling,(n=qr(n,{mode:"visible",children:i.children})).return=t,n.sibling=null,null!==e&&(null===(r=t.deletions)?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n)}function el(e,t){return(t=tl({mode:"visible",children:t},e.mode)).return=e,e.child=t}function tl(e,t){return(e=Fr(22,e,null,t)).lanes=0,e}function nl(e,t,n){return fi(t,e.child,null,n),(e=el(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function rl(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),Aa(e.return,t,n)}function al(e,t,n,r,a,i){var o=e.memoizedState;null===o?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:a,treeForkCount:i}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=a,o.treeForkCount=i)}function il(e,t,n){var r=t.pendingProps,a=r.revealOrder,i=r.tail;r=r.children;var o=Gi.current,s=!!(2&o);if(s?(o=1&o|2,t.flags|=128):o&=1,H(Gi,o),Ds(e,t,r,n),r=ha?ea:0,!s&&null!==e&&128&e.flags)e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&rl(e,n,t);else if(19===e.tag)rl(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(a){case"forwards":for(n=t.child,a=null;null!==n;)null!==(e=n.alternate)&&null===qi(e)&&(a=n),n=n.sibling;null===(n=a)?(a=t.child,t.child=null):(a=n.sibling,n.sibling=null),al(t,!1,a,n,i,r);break;case"backwards":case"unstable_legacy-backwards":for(n=null,a=t.child,t.child=null;null!==a;){if(null!==(e=a.alternate)&&null===qi(e)){t.child=a;break}e=a.sibling,a.sibling=n,n=a,a=e}al(t,!0,n,null,i,r);break;case"together":al(t,!1,null,null,void 0,r);break;default:t.memoizedState=null}return t.child}function ol(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),kc|=t.lanes,0===(n&t.childLanes)){if(null===e)return null;if(_a(e,t,n,!1),0===(n&t.childLanes))return null}if(null!==e&&t.child!==e.child)throw Error(a(153));if(null!==t.child){for(n=qr(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=qr(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function sl(e,t){return 0!==(e.lanes&t)||!(null===(e=e.dependencies)||!Oa(e))}function ll(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps)Ms=!0;else{if(!(sl(e,n)||128&t.flags))return Ms=!1,function(e,t,n){switch(t.tag){case 3:J(t,t.stateNode.containerInfo),Ta(0,Fa,e.memoizedState.cache),wa();break;case 27:case 5:X(t);break;case 4:J(t,t.stateNode.containerInfo);break;case 10:Ta(0,t.type,t.memoizedProps.value);break;case 31:if(null!==t.memoizedState)return t.flags|=128,Li(t),null;break;case 13:var r=t.memoizedState;if(null!==r)return null!==r.dehydrated?(Di(t),t.flags|=128,null):0!==(n&t.child.childLanes)?Zs(e,t,n):(Di(t),null!==(e=ol(e,t,n))?e.sibling:null);Di(t);break;case 19:var a=!!(128&e.flags);if((r=0!==(n&t.childLanes))||(_a(e,t,n,!1),r=0!==(n&t.childLanes)),a){if(r)return il(e,t,n);t.flags|=128}if(null!==(a=t.memoizedState)&&(a.rendering=null,a.tail=null,a.lastEffect=null),H(Gi,Gi.current),r)break;return null;case 22:return t.lanes=0,Fs(e,t,n,t.pendingProps);case 24:Ta(0,Fa,e.memoizedState.cache)}return ol(e,t,n)}(e,t,n);Ms=!!(131072&e.flags)}else Ms=!1,ha&&1048576&t.flags&&sa(t,ea,t.index);switch(t.lanes=0,t.tag){case 16:e:{var r=t.pendingProps;if(e=ii(t.elementType),t.type=e,"function"!=typeof e){if(null!=e){var i=e.$$typeof;if(i===w){t.tag=11,t=Ls(null,t,e,r,n);break e}if(i===S){t.tag=14,t=Us(null,t,e,r,n);break e}}throw t=_(e)||e,Error(a(306,t,""))}Gr(e)?(r=Cs(e,r),t.tag=1,t=Ws(null,t,e,r,n)):(t.tag=0,t=Vs(null,t,e,r,n))}return t;case 0:return Vs(e,t,t.type,t.pendingProps,n);case 1:return Ws(e,t,r=t.type,i=Cs(r,t.pendingProps),n);case 3:e:{if(J(t,t.stateNode.containerInfo),null===e)throw Error(a(387));r=t.pendingProps;var o=t.memoizedState;i=o.element,bi(e,t),ki(t,r,null,n);var s=t.memoizedState;if(r=s.cache,Ta(0,Fa,r),r!==o.cache&&ja(t,[Fa],n,!0),Ci(),r=s.element,o.isDehydrated){if(o={element:r,isDehydrated:!1,cache:s.cache},t.updateQueue.baseState=o,t.memoizedState=o,256&t.flags){t=Ks(e,t,r,n);break e}if(r!==i){Ea(i=Jr(Error(a(424)),t)),t=Ks(e,t,r,n);break e}if(9===(e=t.stateNode.containerInfo).nodeType)e=e.body;else e="HTML"===e.nodeName?e.ownerDocument.body:e;for(pa=Md(e.firstChild),da=t,ha=!0,ma=null,fa=!0,n=gi(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(wa(),r===i){t=ol(e,t,n);break e}Ds(e,t,r,n)}t=t.child}return t;case 26:return Bs(e,t),null===e?(n=Yd(t.type,null,t.pendingProps,null))?t.memoizedState=n:ha||(n=t.type,e=t.pendingProps,(r=xd(W.current).createElement(n))[He]=t,r[$e]=e,md(r,n,e),nt(r),t.stateNode=r):t.memoizedState=Yd(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return X(t),null===e&&ha&&(r=t.stateNode=zd(t.type,t.pendingProps,W.current),da=t,fa=!0,i=pa,Id(t.type)?(Dd=i,pa=Md(r.firstChild)):pa=i),Ds(e,t,t.pendingProps.children,n),Bs(e,t),null===e&&(t.flags|=4194304),t.child;case 5:return null===e&&ha&&((i=r=pa)&&(null!==(r=function(e,t,n,r){for(;1===e.nodeType;){var a=n;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!r&&("INPUT"!==e.nodeName||"hidden"!==e.type))break}else if(r){if(!e[Je])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if("stylesheet"===(i=e.getAttribute("rel"))&&e.hasAttribute("data-precedence"))break;if(i!==a.rel||e.getAttribute("href")!==(null==a.href||""===a.href?null:a.href)||e.getAttribute("crossorigin")!==(null==a.crossOrigin?null:a.crossOrigin)||e.getAttribute("title")!==(null==a.title?null:a.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(((i=e.getAttribute("src"))!==(null==a.src?null:a.src)||e.getAttribute("type")!==(null==a.type?null:a.type)||e.getAttribute("crossorigin")!==(null==a.crossOrigin?null:a.crossOrigin))&&i&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else{if("input"!==t||"hidden"!==e.type)return e;var i=null==a.name?null:""+a.name;if("hidden"===a.type&&e.getAttribute("name")===i)return e}if(null===(e=Md(e.nextSibling)))break}return null}(r,t.type,t.pendingProps,fa))?(t.stateNode=r,da=t,pa=Md(r.firstChild),fa=!1,i=!0):i=!1),i||ya(t)),X(t),i=t.type,o=t.pendingProps,s=null!==e?e.memoizedProps:null,r=o.children,wd(i,o)?r=null:null!==s&&wd(i,s)&&(t.flags|=32),null!==t.memoizedState&&(i=no(e,t,io,null,null,n),pp._currentValue=i),Bs(e,t),Ds(e,t,r,n),t.child;case 6:return null===e&&ha&&((e=n=pa)&&(null!==(n=function(e,t,n){if(""===t)return null;for(;3!==e.nodeType;){if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!n)return null;if(null===(e=Md(e.nextSibling)))return null}return e}(n,t.pendingProps,fa))?(t.stateNode=n,da=t,pa=null,e=!0):e=!1),e||ya(t)),null;case 13:return Zs(e,t,n);case 4:return J(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=fi(t,null,r,n):Ds(e,t,r,n),t.child;case 11:return Ls(e,t,t.type,t.pendingProps,n);case 7:return Ds(e,t,t.pendingProps,n),t.child;case 8:case 12:return Ds(e,t,t.pendingProps.children,n),t.child;case 10:return r=t.pendingProps,Ta(0,t.type,r.value),Ds(e,t,r.children,n),t.child;case 9:return i=t.type._context,r=t.pendingProps.children,Pa(t),r=r(i=Ra(i)),t.flags|=1,Ds(e,t,r,n),t.child;case 14:return Us(e,t,t.type,t.pendingProps,n);case 15:return zs(e,t,t.type,t.pendingProps,n);case 19:return il(e,t,n);case 31:return function(e,t,n){var r=t.pendingProps,i=!!(128&t.flags);if(t.flags&=-129,null===e){if(ha){if("hidden"===r.mode)return e=Hs(t,r),t.lanes=536870912,Gs(null,e);if(Li(t),(e=pa)?null!==(e=null!==(e=Od(e,fa))&&"&"===e.data?e:null)&&(t.memoizedState={dehydrated:e,treeContext:null!==ra?{id:aa,overflow:ia}:null,retryLane:536870912,hydrationErrors:null},(n=Yr(e)).return=t,t.child=n,da=t,pa=null):e=null,null===e)throw ya(t);return t.lanes=536870912,null}return Hs(t,r)}var o=e.memoizedState;if(null!==o){var s=o.dehydrated;if(Li(t),i)if(256&t.flags)t.flags&=-257,t=$s(e,t,n);else{if(null===t.memoizedState)throw Error(a(558));t.child=e.child,t.flags|=128,t=null}else if(Ms||_a(e,t,n,!1),i=0!==(n&e.childLanes),Ms||i){if(null!==(r=gc)&&0!==(s=Le(r,n))&&s!==o.retryLane)throw o.retryLane=s,Mr(e,s),Jc(r,e,s),Rs;lu(),t=$s(e,t,n)}else e=o.treeContext,pa=Md(s.nextSibling),da=t,ha=!0,ma=null,fa=!1,null!==e&&ua(t,e),(t=Hs(t,r)).flags|=4096;return t}return(e=qr(e.child,{mode:r.mode,children:r.children})).ref=t.ref,t.child=e,e.return=t,e}(e,t,n);case 22:return Fs(e,t,n,t.pendingProps);case 24:return Pa(t),r=Ra(Fa),null===e?(null===(i=Ja())&&(i=gc,o=Ga(),i.pooledCache=o,o.refCount++,null!==o&&(i.pooledCacheLanes|=n),i=o),t.memoizedState={parent:r,cache:i},xi(t),Ta(0,Fa,i)):(0!==(e.lanes&n)&&(bi(e,t),ki(t,null,null,n),Ci()),i=e.memoizedState,o=t.memoizedState,i.parent!==r?(i={parent:r,cache:r},t.memoizedState=i,0===t.lanes&&(t.memoizedState=t.updateQueue.baseState=i),Ta(0,Fa,r)):(r=o.cache,Ta(0,Fa,r),r!==i.cache&&ja(t,[Fa],n,!0))),Ds(e,t,t.pendingProps.children,n),t.child;case 29:throw t.pendingProps}throw Error(a(156,t.tag))}function cl(e){e.flags|=4}function ul(e,t,n,r,a){if((t=!!(32&e.mode))&&(t=!1),t){if(e.flags|=16777216,(335544128&a)===a)if(e.stateNode.complete)e.flags|=8192;else{if(!iu())throw oi=ni,ei;e.flags|=8192}}else e.flags&=-16777217}function dl(e,t){if("stylesheet"!==t.type||4&t.state.loading)e.flags&=-16777217;else if(e.flags|=16777216,!op(t)){if(!iu())throw oi=ni,ei;e.flags|=8192}}function pl(e,t){null!==t&&(e.flags|=4),16384&e.flags&&(t=22!==e.tag?Oe():536870912,e.lanes|=t,jc|=t)}function hl(e,t){if(!ha)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function ml(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=65011712&a.subtreeFlags,r|=65011712&a.flags,a.return=e,a=a.sibling;else for(a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags,r|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function fl(e,t,n){var r=t.pendingProps;switch(ca(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:case 1:return ml(t),null;case 3:return n=t.stateNode,r=null,null!==e&&(r=e.memoizedState.cache),t.memoizedState.cache!==r&&(t.flags|=2048),Ia(Fa),Q(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(va(t)?cl(t):null===e||e.memoizedState.isDehydrated&&!(256&t.flags)||(t.flags|=1024,Na())),ml(t),null;case 26:var i=t.type,o=t.memoizedState;return null===e?(cl(t),null!==o?(ml(t),dl(t,o)):(ml(t),ul(t,i,0,0,n))):o?o!==e.memoizedState?(cl(t),ml(t),dl(t,o)):(ml(t),t.flags&=-16777217):((e=e.memoizedProps)!==r&&cl(t),ml(t),ul(t,i,0,0,n)),null;case 27:if(Z(t),n=W.current,i=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==r&&cl(t);else{if(!r){if(null===t.stateNode)throw Error(a(166));return ml(t),null}e=V.current,va(t)?xa(t):(e=zd(i,r,n),t.stateNode=e,cl(t))}return ml(t),null;case 5:if(Z(t),i=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==r&&cl(t);else{if(!r){if(null===t.stateNode)throw Error(a(166));return ml(t),null}if(o=V.current,va(t))xa(t);else{var s=xd(W.current);switch(o){case 1:o=s.createElementNS("http://www.w3.org/2000/svg",i);break;case 2:o=s.createElementNS("http://www.w3.org/1998/Math/MathML",i);break;default:switch(i){case"svg":o=s.createElementNS("http://www.w3.org/2000/svg",i);break;case"math":o=s.createElementNS("http://www.w3.org/1998/Math/MathML",i);break;case"script":(o=s.createElement("div")).innerHTML="<script><\/script>",o=o.removeChild(o.firstChild);break;case"select":o="string"==typeof r.is?s.createElement("select",{is:r.is}):s.createElement("select"),r.multiple?o.multiple=!0:r.size&&(o.size=r.size);break;default:o="string"==typeof r.is?s.createElement(i,{is:r.is}):s.createElement(i)}}o[He]=t,o[$e]=r;e:for(s=t.child;null!==s;){if(5===s.tag||6===s.tag)o.appendChild(s.stateNode);else if(4!==s.tag&&27!==s.tag&&null!==s.child){s.child.return=s,s=s.child;continue}if(s===t)break e;for(;null===s.sibling;){if(null===s.return||s.return===t)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}t.stateNode=o;e:switch(md(o,i,r),i){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}r&&cl(t)}}return ml(t),ul(t,t.type,null===e||e.memoizedProps,t.pendingProps,n),null;case 6:if(e&&null!=t.stateNode)e.memoizedProps!==r&&cl(t);else{if("string"!=typeof r&&null===t.stateNode)throw Error(a(166));if(e=W.current,va(t)){if(e=t.stateNode,n=t.memoizedProps,r=null,null!==(i=da))switch(i.tag){case 27:case 5:r=i.memoizedProps}e[He]=t,(e=!!(e.nodeValue===n||null!==r&&!0===r.suppressHydrationWarning||dd(e.nodeValue,n)))||ya(t,!0)}else(e=xd(e).createTextNode(r))[He]=t,t.stateNode=e}return ml(t),null;case 31:if(n=t.memoizedState,null===e||null!==e.memoizedState){if(r=va(t),null!==n){if(null===e){if(!r)throw Error(a(318));if(!(e=null!==(e=t.memoizedState)?e.dehydrated:null))throw Error(a(557));e[He]=t}else wa(),!(128&t.flags)&&(t.memoizedState=null),t.flags|=4;ml(t),e=!1}else n=Na(),null!==e&&null!==e.memoizedState&&(e.memoizedState.hydrationErrors=n),e=!0;if(!e)return 256&t.flags?(Fi(t),t):(Fi(t),null);if(128&t.flags)throw Error(a(558))}return ml(t),null;case 13:if(r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(i=va(t),null!==r&&null!==r.dehydrated){if(null===e){if(!i)throw Error(a(318));if(!(i=null!==(i=t.memoizedState)?i.dehydrated:null))throw Error(a(317));i[He]=t}else wa(),!(128&t.flags)&&(t.memoizedState=null),t.flags|=4;ml(t),i=!1}else i=Na(),null!==e&&null!==e.memoizedState&&(e.memoizedState.hydrationErrors=i),i=!0;if(!i)return 256&t.flags?(Fi(t),t):(Fi(t),null)}return Fi(t),128&t.flags?(t.lanes=n,t):(n=null!==r,e=null!==e&&null!==e.memoizedState,n&&(i=null,null!==(r=t.child).alternate&&null!==r.alternate.memoizedState&&null!==r.alternate.memoizedState.cachePool&&(i=r.alternate.memoizedState.cachePool.pool),o=null,null!==r.memoizedState&&null!==r.memoizedState.cachePool&&(o=r.memoizedState.cachePool.pool),o!==i&&(r.flags|=2048)),n!==e&&n&&(t.child.flags|=8192),pl(t,t.updateQueue),ml(t),null);case 4:return Q(),null===e&&td(t.stateNode.containerInfo),ml(t),null;case 10:return Ia(t.type),ml(t),null;case 19:if(q(Gi),null===(r=t.memoizedState))return ml(t),null;if(i=!!(128&t.flags),null===(o=r.rendering))if(i)hl(r,!1);else{if(0!==Cc||null!==e&&128&e.flags)for(e=t.child;null!==e;){if(null!==(o=qi(e))){for(t.flags|=128,hl(r,!1),e=o.updateQueue,t.updateQueue=e,pl(t,e),t.subtreeFlags=0,e=n,n=t.child;null!==n;)Hr(n,e),n=n.sibling;return H(Gi,1&Gi.current|2),ha&&oa(t,r.treeForkCount),t.child}e=e.sibling}null!==r.tail&&ue()>Dc&&(t.flags|=128,i=!0,hl(r,!1),t.lanes=4194304)}else{if(!i)if(null!==(e=qi(o))){if(t.flags|=128,i=!0,e=e.updateQueue,t.updateQueue=e,pl(t,e),hl(r,!0),null===r.tail&&"hidden"===r.tailMode&&!o.alternate&&!ha)return ml(t),null}else 2*ue()-r.renderingStartTime>Dc&&536870912!==n&&(t.flags|=128,i=!0,hl(r,!1),t.lanes=4194304);r.isBackwards?(o.sibling=t.child,t.child=o):(null!==(e=r.last)?e.sibling=o:t.child=o,r.last=o)}return null!==r.tail?(e=r.tail,r.rendering=e,r.tail=e.sibling,r.renderingStartTime=ue(),e.sibling=null,n=Gi.current,H(Gi,i?1&n|2:1&n),ha&&oa(t,r.treeForkCount),e):(ml(t),null);case 22:case 23:return Fi(t),Pi(),r=null!==t.memoizedState,null!==e?null!==e.memoizedState!==r&&(t.flags|=8192):r&&(t.flags|=8192),r?!!(536870912&n)&&!(128&t.flags)&&(ml(t),6&t.subtreeFlags&&(t.flags|=8192)):ml(t),null!==(n=t.updateQueue)&&pl(t,n.retryQueue),n=null,null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),r=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(r=t.memoizedState.cachePool.pool),r!==n&&(t.flags|=2048),null!==e&&q(Ka),null;case 24:return n=null,null!==e&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),Ia(Fa),ml(t),null;case 25:case 30:return null}throw Error(a(156,t.tag))}function gl(e,t){switch(ca(t),t.tag){case 1:return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Ia(Fa),Q(),65536&(e=t.flags)&&!(128&e)?(t.flags=-65537&e|128,t):null;case 26:case 27:case 5:return Z(t),null;case 31:if(null!==t.memoizedState){if(Fi(t),null===t.alternate)throw Error(a(340));wa()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 13:if(Fi(t),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(a(340));wa()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return q(Gi),null;case 4:return Q(),null;case 10:return Ia(t.type),null;case 22:case 23:return Fi(t),Pi(),null!==e&&q(Ka),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 24:return Ia(Fa),null;default:return null}}function yl(e,t){switch(ca(t),t.tag){case 3:Ia(Fa),Q();break;case 26:case 27:case 5:Z(t);break;case 4:Q();break;case 31:null!==t.memoizedState&&Fi(t);break;case 13:Fi(t);break;case 19:q(Gi);break;case 10:Ia(t.type);break;case 22:case 23:Fi(t),Pi(),null!==e&&q(Ka);break;case 24:Ia(Fa)}}function xl(e,t){try{var n=t.updateQueue,r=null!==n?n.lastEffect:null;if(null!==r){var a=r.next;n=a;do{if((n.tag&e)===e){r=void 0;var i=n.create,o=n.inst;r=i(),o.destroy=r}n=n.next}while(n!==a)}}catch(s){Cu(t,t.return,s)}}function bl(e,t,n){try{var r=t.updateQueue,a=null!==r?r.lastEffect:null;if(null!==a){var i=a.next;r=i;do{if((r.tag&e)===e){var o=r.inst,s=o.destroy;if(void 0!==s){o.destroy=void 0,a=t;var l=n,c=s;try{c()}catch(u){Cu(a,l,u)}}}r=r.next}while(r!==i)}}catch(u){Cu(t,t.return,u)}}function vl(e){var t=e.updateQueue;if(null!==t){var n=e.stateNode;try{Ii(t,n)}catch(r){Cu(e,e.return,r)}}}function wl(e,t,n){n.props=Cs(e.type,e.memoizedProps),n.state=e.memoizedState;try{n.componentWillUnmount()}catch(r){Cu(e,t,r)}}function Nl(e,t){try{var n=e.ref;if(null!==n){switch(e.tag){case 26:case 27:case 5:var r=e.stateNode;break;default:r=e.stateNode}"function"==typeof n?e.refCleanup=n(r):n.current=r}}catch(a){Cu(e,t,a)}}function El(e,t){var n=e.ref,r=e.refCleanup;if(null!==n)if("function"==typeof r)try{r()}catch(a){Cu(e,t,a)}finally{e.refCleanup=null,null!=(e=e.alternate)&&(e.refCleanup=null)}else if("function"==typeof n)try{n(null)}catch(i){Cu(e,t,i)}else n.current=null}function Sl(e){var t=e.type,n=e.memoizedProps,r=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":n.autoFocus&&r.focus();break e;case"img":n.src?r.src=n.src:n.srcSet&&(r.srcset=n.srcSet)}}catch(a){Cu(e,e.return,a)}}function Cl(e,t,n){try{var r=e.stateNode;!function(e,t,n,r){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var i=null,o=null,s=null,l=null,c=null,u=null,d=null;for(m in n){var p=n[m];if(n.hasOwnProperty(m)&&null!=p)switch(m){case"checked":case"value":break;case"defaultValue":c=p;default:r.hasOwnProperty(m)||pd(e,t,m,null,r,p)}}for(var h in r){var m=r[h];if(p=n[h],r.hasOwnProperty(h)&&(null!=m||null!=p))switch(h){case"type":o=m;break;case"name":i=m;break;case"checked":u=m;break;case"defaultChecked":d=m;break;case"value":s=m;break;case"defaultValue":l=m;break;case"children":case"dangerouslySetInnerHTML":if(null!=m)throw Error(a(137,t));break;default:m!==p&&pd(e,t,h,m,r,p)}}return void vt(e,s,l,c,u,d,o,i);case"select":for(o in m=s=l=h=null,n)if(c=n[o],n.hasOwnProperty(o)&&null!=c)switch(o){case"value":break;case"multiple":m=c;default:r.hasOwnProperty(o)||pd(e,t,o,null,r,c)}for(i in r)if(o=r[i],c=n[i],r.hasOwnProperty(i)&&(null!=o||null!=c))switch(i){case"value":h=o;break;case"defaultValue":l=o;break;case"multiple":s=o;default:o!==c&&pd(e,t,i,o,r,c)}return t=l,n=s,r=m,void(null!=h?Et(e,!!n,h,!1):!!r!=!!n&&(null!=t?Et(e,!!n,t,!0):Et(e,!!n,n?[]:"",!1)));case"textarea":for(l in m=h=null,n)if(i=n[l],n.hasOwnProperty(l)&&null!=i&&!r.hasOwnProperty(l))switch(l){case"value":case"children":break;default:pd(e,t,l,null,r,i)}for(s in r)if(i=r[s],o=n[s],r.hasOwnProperty(s)&&(null!=i||null!=o))switch(s){case"value":h=i;break;case"defaultValue":m=i;break;case"children":break;case"dangerouslySetInnerHTML":if(null!=i)throw Error(a(91));break;default:i!==o&&pd(e,t,s,i,r,o)}return void St(e,h,m);case"option":for(var f in n)if(h=n[f],n.hasOwnProperty(f)&&null!=h&&!r.hasOwnProperty(f))if("selected"===f)e.selected=!1;else pd(e,t,f,null,r,h);for(c in r)if(h=r[c],m=n[c],r.hasOwnProperty(c)&&h!==m&&(null!=h||null!=m))if("selected"===c)e.selected=h&&"function"!=typeof h&&"symbol"!=typeof h;else pd(e,t,c,h,r,m);return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var g in n)h=n[g],n.hasOwnProperty(g)&&null!=h&&!r.hasOwnProperty(g)&&pd(e,t,g,null,r,h);for(u in r)if(h=r[u],m=n[u],r.hasOwnProperty(u)&&h!==m&&(null!=h||null!=m))switch(u){case"children":case"dangerouslySetInnerHTML":if(null!=h)throw Error(a(137,t));break;default:pd(e,t,u,h,r,m)}return;default:if(jt(t)){for(var y in n)h=n[y],n.hasOwnProperty(y)&&void 0!==h&&!r.hasOwnProperty(y)&&hd(e,t,y,void 0,r,h);for(d in r)h=r[d],m=n[d],!r.hasOwnProperty(d)||h===m||void 0===h&&void 0===m||hd(e,t,d,h,r,m);return}}for(var x in n)h=n[x],n.hasOwnProperty(x)&&null!=h&&!r.hasOwnProperty(x)&&pd(e,t,x,null,r,h);for(p in r)h=r[p],m=n[p],!r.hasOwnProperty(p)||h===m||null==h&&null==m||pd(e,t,p,h,r,m)}(r,e.type,n,t),r[$e]=t}catch(i){Cu(e,e.return,i)}}function kl(e){return 5===e.tag||3===e.tag||26===e.tag||27===e.tag&&Id(e.type)||4===e.tag}function Tl(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||kl(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(27===e.tag&&Id(e.type))continue e;if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function Il(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?(9===n.nodeType?n.body:"HTML"===n.nodeName?n.ownerDocument.body:n).insertBefore(e,t):((t=9===n.nodeType?n.body:"HTML"===n.nodeName?n.ownerDocument.body:n).appendChild(e),null!=(n=n._reactRootContainer)||null!==t.onclick||(t.onclick=Rt));else if(4!==r&&(27===r&&Id(e.type)&&(n=e.stateNode,t=null),null!==(e=e.child)))for(Il(e,t,n),e=e.sibling;null!==e;)Il(e,t,n),e=e.sibling}function Al(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&(27===r&&Id(e.type)&&(n=e.stateNode),null!==(e=e.child)))for(Al(e,t,n),e=e.sibling;null!==e;)Al(e,t,n),e=e.sibling}function jl(e){var t=e.stateNode,n=e.memoizedProps;try{for(var r=e.type,a=t.attributes;a.length;)t.removeAttributeNode(a[0]);md(t,r,n),t[He]=e,t[$e]=n}catch(i){Cu(e,e.return,i)}}var _l=!1,Ol=!1,Pl=!1,Rl="function"==typeof WeakSet?WeakSet:Set,Ml=null;function Dl(e,t,n){var r=n.flags;switch(n.tag){case 0:case 11:case 15:Jl(e,n),4&r&&xl(5,n);break;case 1:if(Jl(e,n),4&r)if(e=n.stateNode,null===t)try{e.componentDidMount()}catch(o){Cu(n,n.return,o)}else{var a=Cs(n.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(a,t,e.__reactInternalSnapshotBeforeUpdate)}catch(s){Cu(n,n.return,s)}}64&r&&vl(n),512&r&&Nl(n,n.return);break;case 3:if(Jl(e,n),64&r&&null!==(e=n.updateQueue)){if(t=null,null!==n.child)switch(n.child.tag){case 27:case 5:case 1:t=n.child.stateNode}try{Ii(e,t)}catch(o){Cu(n,n.return,o)}}break;case 27:null===t&&4&r&&jl(n);case 26:case 5:Jl(e,n),null===t&&4&r&&Sl(n),512&r&&Nl(n,n.return);break;case 12:Jl(e,n);break;case 31:Jl(e,n),4&r&&ql(e,n);break;case 13:Jl(e,n),4&r&&Hl(e,n),64&r&&(null!==(e=n.memoizedState)&&(null!==(e=e.dehydrated)&&function(e,t){var n=e.ownerDocument;if("$~"===e.data)e._reactRetry=t;else if("$?"!==e.data||"loading"!==n.readyState)t();else{var r=function(){t(),n.removeEventListener("DOMContentLoaded",r)};n.addEventListener("DOMContentLoaded",r),e._reactRetry=r}}(e,n=Au.bind(null,n))));break;case 22:if(!(r=null!==n.memoizedState||_l)){t=null!==t&&null!==t.memoizedState||Ol,a=_l;var i=Ol;_l=r,(Ol=t)&&!i?Xl(e,n,!!(8772&n.subtreeFlags)):Jl(e,n),_l=a,Ol=i}break;case 30:break;default:Jl(e,n)}}function Ll(e){var t=e.alternate;null!==t&&(e.alternate=null,Ll(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&Qe(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var Ul=null,zl=!1;function Fl(e,t,n){for(n=n.child;null!==n;)Gl(e,t,n),n=n.sibling}function Gl(e,t,n){if(ve&&"function"==typeof ve.onCommitFiberUnmount)try{ve.onCommitFiberUnmount(be,n)}catch(i){}switch(n.tag){case 26:Ol||El(n,t),Fl(e,t,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode).parentNode.removeChild(n);break;case 27:Ol||El(n,t);var r=Ul,a=zl;Id(n.type)&&(Ul=n.stateNode,zl=!1),Fl(e,t,n),Fd(n.stateNode),Ul=r,zl=a;break;case 5:Ol||El(n,t);case 6:if(r=Ul,a=zl,Ul=null,Fl(e,t,n),zl=a,null!==(Ul=r))if(zl)try{(9===Ul.nodeType?Ul.body:"HTML"===Ul.nodeName?Ul.ownerDocument.body:Ul).removeChild(n.stateNode)}catch(o){Cu(n,t,o)}else try{Ul.removeChild(n.stateNode)}catch(o){Cu(n,t,o)}break;case 18:null!==Ul&&(zl?(Ad(9===(e=Ul).nodeType?e.body:"HTML"===e.nodeName?e.ownerDocument.body:e,n.stateNode),Vp(e)):Ad(Ul,n.stateNode));break;case 4:r=Ul,a=zl,Ul=n.stateNode.containerInfo,zl=!0,Fl(e,t,n),Ul=r,zl=a;break;case 0:case 11:case 14:case 15:bl(2,n,t),Ol||bl(4,n,t),Fl(e,t,n);break;case 1:Ol||(El(n,t),"function"==typeof(r=n.stateNode).componentWillUnmount&&wl(n,t,r)),Fl(e,t,n);break;case 21:Fl(e,t,n);break;case 22:Ol=(r=Ol)||null!==n.memoizedState,Fl(e,t,n),Ol=r;break;default:Fl(e,t,n)}}function ql(e,t){if(null===t.memoizedState&&(null!==(e=t.alternate)&&null!==(e=e.memoizedState))){e=e.dehydrated;try{Vp(e)}catch(n){Cu(t,t.return,n)}}}function Hl(e,t){if(null===t.memoizedState&&(null!==(e=t.alternate)&&(null!==(e=e.memoizedState)&&null!==(e=e.dehydrated))))try{Vp(e)}catch(n){Cu(t,t.return,n)}}function $l(e,t){var n=function(e){switch(e.tag){case 31:case 13:case 19:var t=e.stateNode;return null===t&&(t=e.stateNode=new Rl),t;case 22:return null===(t=(e=e.stateNode)._retryCache)&&(t=e._retryCache=new Rl),t;default:throw Error(a(435,e.tag))}}(e);t.forEach(function(t){if(!n.has(t)){n.add(t);var r=ju.bind(null,e,t);t.then(r,r)}})}function Bl(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var i=n[r],o=e,s=t,l=s;e:for(;null!==l;){switch(l.tag){case 27:if(Id(l.type)){Ul=l.stateNode,zl=!1;break e}break;case 5:Ul=l.stateNode,zl=!1;break e;case 3:case 4:Ul=l.stateNode.containerInfo,zl=!0;break e}l=l.return}if(null===Ul)throw Error(a(160));Gl(o,s,i),Ul=null,zl=!1,null!==(o=i.alternate)&&(o.return=null),i.return=null}if(13886&t.subtreeFlags)for(t=t.child;null!==t;)Yl(t,e),t=t.sibling}var Vl=null;function Yl(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Bl(t,e),Wl(e),4&r&&(bl(3,e,e.return),xl(3,e),bl(5,e,e.return));break;case 1:Bl(t,e),Wl(e),512&r&&(Ol||null===n||El(n,n.return)),64&r&&_l&&(null!==(e=e.updateQueue)&&(null!==(r=e.callbacks)&&(n=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=null===n?r:n.concat(r))));break;case 26:var i=Vl;if(Bl(t,e),Wl(e),512&r&&(Ol||null===n||El(n,n.return)),4&r){var o=null!==n?n.memoizedState:null;if(r=e.memoizedState,null===n)if(null===r)if(null===e.stateNode){e:{r=e.type,n=e.memoizedProps,i=i.ownerDocument||i;t:switch(r){case"title":(!(o=i.getElementsByTagName("title")[0])||o[Je]||o[He]||"http://www.w3.org/2000/svg"===o.namespaceURI||o.hasAttribute("itemprop"))&&(o=i.createElement(r),i.head.insertBefore(o,i.querySelector("head > title"))),md(o,r,n),o[He]=e,nt(o),r=o;break e;case"link":var s=ap("link","href",i).get(r+(n.href||""));if(s)for(var l=0;l<s.length;l++)if((o=s[l]).getAttribute("href")===(null==n.href||""===n.href?null:n.href)&&o.getAttribute("rel")===(null==n.rel?null:n.rel)&&o.getAttribute("title")===(null==n.title?null:n.title)&&o.getAttribute("crossorigin")===(null==n.crossOrigin?null:n.crossOrigin)){s.splice(l,1);break t}md(o=i.createElement(r),r,n),i.head.appendChild(o);break;case"meta":if(s=ap("meta","content",i).get(r+(n.content||"")))for(l=0;l<s.length;l++)if((o=s[l]).getAttribute("content")===(null==n.content?null:""+n.content)&&o.getAttribute("name")===(null==n.name?null:n.name)&&o.getAttribute("property")===(null==n.property?null:n.property)&&o.getAttribute("http-equiv")===(null==n.httpEquiv?null:n.httpEquiv)&&o.getAttribute("charset")===(null==n.charSet?null:n.charSet)){s.splice(l,1);break t}md(o=i.createElement(r),r,n),i.head.appendChild(o);break;default:throw Error(a(468,r))}o[He]=e,nt(o),r=o}e.stateNode=r}else ip(i,e.type,e.stateNode);else e.stateNode=Zd(i,r,e.memoizedProps);else o!==r?(null===o?null!==n.stateNode&&(n=n.stateNode).parentNode.removeChild(n):o.count--,null===r?ip(i,e.type,e.stateNode):Zd(i,r,e.memoizedProps)):null===r&&null!==e.stateNode&&Cl(e,e.memoizedProps,n.memoizedProps)}break;case 27:Bl(t,e),Wl(e),512&r&&(Ol||null===n||El(n,n.return)),null!==n&&4&r&&Cl(e,e.memoizedProps,n.memoizedProps);break;case 5:if(Bl(t,e),Wl(e),512&r&&(Ol||null===n||El(n,n.return)),32&e.flags){i=e.stateNode;try{kt(i,"")}catch(f){Cu(e,e.return,f)}}4&r&&null!=e.stateNode&&Cl(e,i=e.memoizedProps,null!==n?n.memoizedProps:i),1024&r&&(Pl=!0);break;case 6:if(Bl(t,e),Wl(e),4&r){if(null===e.stateNode)throw Error(a(162));r=e.memoizedProps,n=e.stateNode;try{n.nodeValue=r}catch(f){Cu(e,e.return,f)}}break;case 3:if(rp=null,i=Vl,Vl=Hd(t.containerInfo),Bl(t,e),Vl=i,Wl(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Vp(t.containerInfo)}catch(f){Cu(e,e.return,f)}Pl&&(Pl=!1,Kl(e));break;case 4:r=Vl,Vl=Hd(e.stateNode.containerInfo),Bl(t,e),Wl(e),Vl=r;break;case 12:default:Bl(t,e),Wl(e);break;case 31:case 19:Bl(t,e),Wl(e),4&r&&(null!==(r=e.updateQueue)&&(e.updateQueue=null,$l(e,r)));break;case 13:Bl(t,e),Wl(e),8192&e.child.flags&&null!==e.memoizedState!=(null!==n&&null!==n.memoizedState)&&(Rc=ue()),4&r&&(null!==(r=e.updateQueue)&&(e.updateQueue=null,$l(e,r)));break;case 22:i=null!==e.memoizedState;var c=null!==n&&null!==n.memoizedState,u=_l,d=Ol;if(_l=u||i,Ol=d||c,Bl(t,e),Ol=d,_l=u,Wl(e),8192&r)e:for(t=e.stateNode,t._visibility=i?-2&t._visibility:1|t._visibility,i&&(null===n||c||_l||Ol||Ql(e)),n=null,t=e;;){if(5===t.tag||26===t.tag){if(null===n){c=n=t;try{if(o=c.stateNode,i)"function"==typeof(s=o.style).setProperty?s.setProperty("display","none","important"):s.display="none";else{l=c.stateNode;var p=c.memoizedProps.style,h=null!=p&&p.hasOwnProperty("display")?p.display:null;l.style.display=null==h||"boolean"==typeof h?"":(""+h).trim()}}catch(f){Cu(c,c.return,f)}}}else if(6===t.tag){if(null===n){c=t;try{c.stateNode.nodeValue=i?"":c.memoizedProps}catch(f){Cu(c,c.return,f)}}}else if(18===t.tag){if(null===n){c=t;try{var m=c.stateNode;i?jd(m,!0):jd(c.stateNode,!1)}catch(f){Cu(c,c.return,f)}}}else if((22!==t.tag&&23!==t.tag||null===t.memoizedState||t===e)&&null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;null===t.sibling;){if(null===t.return||t.return===e)break e;n===t&&(n=null),t=t.return}n===t&&(n=null),t.sibling.return=t.return,t=t.sibling}4&r&&(null!==(r=e.updateQueue)&&(null!==(n=r.retryQueue)&&(r.retryQueue=null,$l(e,n))));case 30:case 21:}}function Wl(e){var t=e.flags;if(2&t){try{for(var n,r=e.return;null!==r;){if(kl(r)){n=r;break}r=r.return}if(null==n)throw Error(a(160));switch(n.tag){case 27:var i=n.stateNode;Al(e,Tl(e),i);break;case 5:var o=n.stateNode;32&n.flags&&(kt(o,""),n.flags&=-33),Al(e,Tl(e),o);break;case 3:case 4:var s=n.stateNode.containerInfo;Il(e,Tl(e),s);break;default:throw Error(a(161))}}catch(l){Cu(e,e.return,l)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function Kl(e){if(1024&e.subtreeFlags)for(e=e.child;null!==e;){var t=e;Kl(t),5===t.tag&&1024&t.flags&&t.stateNode.reset(),e=e.sibling}}function Jl(e,t){if(8772&t.subtreeFlags)for(t=t.child;null!==t;)Dl(e,t.alternate,t),t=t.sibling}function Ql(e){for(e=e.child;null!==e;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:bl(4,t,t.return),Ql(t);break;case 1:El(t,t.return);var n=t.stateNode;"function"==typeof n.componentWillUnmount&&wl(t,t.return,n),Ql(t);break;case 27:Fd(t.stateNode);case 26:case 5:El(t,t.return),Ql(t);break;case 22:null===t.memoizedState&&Ql(t);break;default:Ql(t)}e=e.sibling}}function Xl(e,t,n){for(n=n&&!!(8772&t.subtreeFlags),t=t.child;null!==t;){var r=t.alternate,a=e,i=t,o=i.flags;switch(i.tag){case 0:case 11:case 15:Xl(a,i,n),xl(4,i);break;case 1:if(Xl(a,i,n),"function"==typeof(a=(r=i).stateNode).componentDidMount)try{a.componentDidMount()}catch(c){Cu(r,r.return,c)}if(null!==(a=(r=i).updateQueue)){var s=r.stateNode;try{var l=a.shared.hiddenCallbacks;if(null!==l)for(a.shared.hiddenCallbacks=null,a=0;a<l.length;a++)Ti(l[a],s)}catch(c){Cu(r,r.return,c)}}n&&64&o&&vl(i),Nl(i,i.return);break;case 27:jl(i);case 26:case 5:Xl(a,i,n),n&&null===r&&4&o&&Sl(i),Nl(i,i.return);break;case 12:Xl(a,i,n);break;case 31:Xl(a,i,n),n&&4&o&&ql(a,i);break;case 13:Xl(a,i,n),n&&4&o&&Hl(a,i);break;case 22:null===i.memoizedState&&Xl(a,i,n),Nl(i,i.return);break;case 30:break;default:Xl(a,i,n)}t=t.sibling}}function Zl(e,t){var n=null;null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),e=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(e=t.memoizedState.cachePool.pool),e!==n&&(null!=e&&e.refCount++,null!=n&&qa(n))}function ec(e,t){e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&qa(e))}function tc(e,t,n,r){if(10256&t.subtreeFlags)for(t=t.child;null!==t;)nc(e,t,n,r),t=t.sibling}function nc(e,t,n,r){var a=t.flags;switch(t.tag){case 0:case 11:case 15:tc(e,t,n,r),2048&a&&xl(9,t);break;case 1:case 31:case 13:default:tc(e,t,n,r);break;case 3:tc(e,t,n,r),2048&a&&(e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&qa(e)));break;case 12:if(2048&a){tc(e,t,n,r),e=t.stateNode;try{var i=t.memoizedProps,o=i.id,s=i.onPostCommit;"function"==typeof s&&s(o,null===t.alternate?"mount":"update",e.passiveEffectDuration,-0)}catch(l){Cu(t,t.return,l)}}else tc(e,t,n,r);break;case 23:break;case 22:i=t.stateNode,o=t.alternate,null!==t.memoizedState?2&i._visibility?tc(e,t,n,r):ac(e,t):2&i._visibility?tc(e,t,n,r):(i._visibility|=2,rc(e,t,n,r,!!(10256&t.subtreeFlags)||!1)),2048&a&&Zl(o,t);break;case 24:tc(e,t,n,r),2048&a&&ec(t.alternate,t)}}function rc(e,t,n,r,a){for(a=a&&(!!(10256&t.subtreeFlags)||!1),t=t.child;null!==t;){var i=e,o=t,s=n,l=r,c=o.flags;switch(o.tag){case 0:case 11:case 15:rc(i,o,s,l,a),xl(8,o);break;case 23:break;case 22:var u=o.stateNode;null!==o.memoizedState?2&u._visibility?rc(i,o,s,l,a):ac(i,o):(u._visibility|=2,rc(i,o,s,l,a)),a&&2048&c&&Zl(o.alternate,o);break;case 24:rc(i,o,s,l,a),a&&2048&c&&ec(o.alternate,o);break;default:rc(i,o,s,l,a)}t=t.sibling}}function ac(e,t){if(10256&t.subtreeFlags)for(t=t.child;null!==t;){var n=e,r=t,a=r.flags;switch(r.tag){case 22:ac(n,r),2048&a&&Zl(r.alternate,r);break;case 24:ac(n,r),2048&a&&ec(r.alternate,r);break;default:ac(n,r)}t=t.sibling}}var ic=8192;function oc(e,t,n){if(e.subtreeFlags&ic)for(e=e.child;null!==e;)sc(e,t,n),e=e.sibling}function sc(e,t,n){switch(e.tag){case 26:oc(e,t,n),e.flags&ic&&null!==e.memoizedState&&function(e,t,n,r){if(!("stylesheet"!==n.type||"string"==typeof r.media&&!1===matchMedia(r.media).matches||4&n.state.loading)){if(null===n.instance){var a=Wd(r.href),i=t.querySelector(Kd(a));if(i)return null!==(t=i._p)&&"object"==typeof t&&"function"==typeof t.then&&(e.count++,e=lp.bind(e),t.then(e,e)),n.state.loading|=4,n.instance=i,void nt(i);i=t.ownerDocument||t,r=Jd(r),(a=Gd.get(a))&&tp(r,a),nt(i=i.createElement("link"));var o=i;o._p=new Promise(function(e,t){o.onload=e,o.onerror=t}),md(i,"link",r),n.instance=i}null===e.stylesheets&&(e.stylesheets=new Map),e.stylesheets.set(n,t),(t=n.state.preload)&&!(3&n.state.loading)&&(e.count++,n=lp.bind(e),t.addEventListener("load",n),t.addEventListener("error",n))}}(n,Vl,e.memoizedState,e.memoizedProps);break;case 5:default:oc(e,t,n);break;case 3:case 4:var r=Vl;Vl=Hd(e.stateNode.containerInfo),oc(e,t,n),Vl=r;break;case 22:null===e.memoizedState&&(null!==(r=e.alternate)&&null!==r.memoizedState?(r=ic,ic=16777216,oc(e,t,n),ic=r):oc(e,t,n))}}function lc(e){var t=e.alternate;if(null!==t&&null!==(e=t.child)){t.child=null;do{t=e.sibling,e.sibling=null,e=t}while(null!==e)}}function cc(e){var t=e.deletions;if(16&e.flags){if(null!==t)for(var n=0;n<t.length;n++){var r=t[n];Ml=r,pc(r,e)}lc(e)}if(10256&e.subtreeFlags)for(e=e.child;null!==e;)uc(e),e=e.sibling}function uc(e){switch(e.tag){case 0:case 11:case 15:cc(e),2048&e.flags&&bl(9,e,e.return);break;case 3:case 12:default:cc(e);break;case 22:var t=e.stateNode;null!==e.memoizedState&&2&t._visibility&&(null===e.return||13!==e.return.tag)?(t._visibility&=-3,dc(e)):cc(e)}}function dc(e){var t=e.deletions;if(16&e.flags){if(null!==t)for(var n=0;n<t.length;n++){var r=t[n];Ml=r,pc(r,e)}lc(e)}for(e=e.child;null!==e;){switch((t=e).tag){case 0:case 11:case 15:bl(8,t,t.return),dc(t);break;case 22:2&(n=t.stateNode)._visibility&&(n._visibility&=-3,dc(t));break;default:dc(t)}e=e.sibling}}function pc(e,t){for(;null!==Ml;){var n=Ml;switch(n.tag){case 0:case 11:case 15:bl(8,n,t);break;case 23:case 22:if(null!==n.memoizedState&&null!==n.memoizedState.cachePool){var r=n.memoizedState.cachePool.pool;null!=r&&r.refCount++}break;case 24:qa(n.memoizedState.cache)}if(null!==(r=n.child))r.return=n,Ml=r;else e:for(n=e;null!==Ml;){var a=(r=Ml).sibling,i=r.return;if(Ll(r),r===n){Ml=null;break e}if(null!==a){a.return=i,Ml=a;break e}Ml=i}}}var hc={getCacheForType:function(e){var t=Ra(Fa),n=t.data.get(e);return void 0===n&&(n=e(),t.data.set(e,n)),n},cacheSignal:function(){return Ra(Fa).controller.signal}},mc="function"==typeof WeakMap?WeakMap:Map,fc=0,gc=null,yc=null,xc=0,bc=0,vc=null,wc=!1,Nc=!1,Ec=!1,Sc=0,Cc=0,kc=0,Tc=0,Ic=0,Ac=0,jc=0,_c=null,Oc=null,Pc=!1,Rc=0,Mc=0,Dc=1/0,Lc=null,Uc=null,zc=0,Fc=null,Gc=null,qc=0,Hc=0,$c=null,Bc=null,Vc=0,Yc=null;function Wc(){return 2&fc&&0!==xc?xc&-xc:null!==R.T?$u():Fe()}function Kc(){if(0===Ac)if(536870912&xc&&!ha)Ac=536870912;else{var e=ke;!(3932160&(ke<<=1))&&(ke=262144),Ac=e}return null!==(e=Ri.current)&&(e.flags|=32),Ac}function Jc(e,t,n){(e!==gc||2!==bc&&9!==bc)&&null===e.cancelPendingCommit||(ru(e,0),eu(e,xc,Ac,!1)),Re(e,n),2&fc&&e===gc||(e===gc&&(!(2&fc)&&(Tc|=n),4===Cc&&eu(e,xc,Ac,!1)),Lu(e))}function Qc(e,t,n){if(6&fc)throw Error(a(327));for(var r=!n&&!(127&t)&&0===(t&e.expiredLanes)||je(e,t),i=r?function(e,t){var n=fc;fc|=2;var r=ou(),i=su();gc!==e||xc!==t?(Lc=null,Dc=ue()+500,ru(e,t)):Nc=je(e,t);e:for(;;)try{if(0!==bc&&null!==yc){t=yc;var o=vc;t:switch(bc){case 1:bc=0,vc=null,mu(e,t,o,1);break;case 2:case 9:if(ri(o)){bc=0,vc=null,hu(t);break}t=function(){2!==bc&&9!==bc||gc!==e||(bc=7),Lu(e)},o.then(t,t);break e;case 3:bc=7;break e;case 4:bc=5;break e;case 7:ri(o)?(bc=0,vc=null,hu(t)):(bc=0,vc=null,mu(e,t,o,7));break;case 5:var s=null;switch(yc.tag){case 26:s=yc.memoizedState;case 5:case 27:var l=yc;if(s?op(s):l.stateNode.complete){bc=0,vc=null;var c=l.sibling;if(null!==c)yc=c;else{var u=l.return;null!==u?(yc=u,fu(u)):yc=null}break t}}bc=0,vc=null,mu(e,t,o,5);break;case 6:bc=0,vc=null,mu(e,t,o,6);break;case 8:nu(),Cc=6;break e;default:throw Error(a(462))}}du();break}catch(d){au(e,d)}return ka=Ca=null,R.H=r,R.A=i,fc=n,null!==yc?0:(gc=null,xc=0,Or(),Cc)}(e,t):cu(e,t,!0),o=r;;){if(0===i){Nc&&!r&&eu(e,t,0,!1);break}if(n=e.current.alternate,!o||Zc(n)){if(2===i){if(o=t,e.errorRecoveryDisabledLanes&o)var s=0;else s=0!==(s=-536870913&e.pendingLanes)?s:536870912&s?536870912:0;if(0!==s){t=s;e:{var l=e;i=_c;var c=l.current.memoizedState.isDehydrated;if(c&&(ru(l,s).flags|=256),2!==(s=cu(l,s,!1))){if(Ec&&!c){l.errorRecoveryDisabledLanes|=o,Tc|=o,i=4;break e}o=Oc,Oc=i,null!==o&&(null===Oc?Oc=o:Oc.push.apply(Oc,o))}i=s}if(o=!1,2!==i)continue}}if(1===i){ru(e,0),eu(e,t,0,!0);break}e:{switch(r=e,o=i){case 0:case 1:throw Error(a(345));case 4:if((4194048&t)!==t)break;case 6:eu(r,t,Ac,!wc);break e;case 2:Oc=null;break;case 3:case 5:break;default:throw Error(a(329))}if((62914560&t)===t&&10<(i=Rc+300-ue())){if(eu(r,t,Ac,!wc),0!==Ae(r,0,!0))break e;qc=t,r.timeoutHandle=Ed(Xc.bind(null,r,n,Oc,Lc,Pc,t,Ac,Tc,jc,wc,o,"Throttled",-0,0),i)}else Xc(r,n,Oc,Lc,Pc,t,Ac,Tc,jc,wc,o,null,-0,0)}break}i=cu(e,t,!1),o=!1}Lu(e)}function Xc(e,t,n,r,a,i,o,s,l,c,u,d,p,h){if(e.timeoutHandle=-1,8192&(d=t.subtreeFlags)||!(16785408&~d)){sc(t,i,d={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Rt});var m=(62914560&i)===i?Rc-ue():(4194048&i)===i?Mc-ue():0;if(null!==(m=function(e,t){return e.stylesheets&&0===e.count&&up(e,e.stylesheets),0<e.count||0<e.imgCount?function(n){var r=setTimeout(function(){if(e.stylesheets&&up(e,e.stylesheets),e.unsuspend){var t=e.unsuspend;e.unsuspend=null,t()}},6e4+t);0<e.imgBytes&&0===sp&&(sp=62500*function(){if("function"==typeof performance.getEntriesByType){for(var e=0,t=0,n=performance.getEntriesByType("resource"),r=0;r<n.length;r++){var a=n[r],i=a.transferSize,o=a.initiatorType,s=a.duration;if(i&&s&&fd(o)){for(o=0,s=a.responseEnd,r+=1;r<n.length;r++){var l=n[r],c=l.startTime;if(c>s)break;var u=l.transferSize,d=l.initiatorType;u&&fd(d)&&(o+=u*((l=l.responseEnd)<s?1:(s-c)/(l-c)))}if(--r,t+=8*(i+o)/(a.duration/1e3),10<++e)break}}if(0<e)return t/e/1e6}return navigator.connection&&"number"==typeof(e=navigator.connection.downlink)?e:5}());var a=setTimeout(function(){if(e.waitingForImages=!1,0===e.count&&(e.stylesheets&&up(e,e.stylesheets),e.unsuspend)){var t=e.unsuspend;e.unsuspend=null,t()}},(e.imgBytes>sp?50:800)+t);return e.unsuspend=n,function(){e.unsuspend=null,clearTimeout(r),clearTimeout(a)}}:null}(d,m)))return qc=i,e.cancelPendingCommit=m(yu.bind(null,e,t,i,n,r,a,o,s,l,u,d,null,p,h)),void eu(e,i,o,!c)}yu(e,t,i,n,r,a,o,s,l)}function Zc(e){for(var t=e;;){var n=t.tag;if((0===n||11===n||15===n)&&16384&t.flags&&(null!==(n=t.updateQueue)&&null!==(n=n.stores)))for(var r=0;r<n.length;r++){var a=n[r],i=a.getSnapshot;a=a.value;try{if(!er(i(),a))return!1}catch(o){return!1}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function eu(e,t,n,r){t&=~Ic,t&=~Tc,e.suspendedLanes|=t,e.pingedLanes&=~t,r&&(e.warmLanes|=t),r=e.expirationTimes;for(var a=t;0<a;){var i=31-Ne(a),o=1<<i;r[i]=-1,a&=~o}0!==n&&Me(e,n,t)}function tu(){return!!(6&fc)||(Uu(0),!1)}function nu(){if(null!==yc){if(0===bc)var e=yc.return;else ka=Ca=null,lo(e=yc),ci=null,ui=0,e=yc;for(;null!==e;)yl(e.alternate,e),e=e.return;yc=null}}function ru(e,t){var n=e.timeoutHandle;-1!==n&&(e.timeoutHandle=-1,Sd(n)),null!==(n=e.cancelPendingCommit)&&(e.cancelPendingCommit=null,n()),qc=0,nu(),gc=e,yc=n=qr(e.current,null),xc=t,bc=0,vc=null,wc=!1,Nc=je(e,t),Ec=!1,jc=Ac=Ic=Tc=kc=Cc=0,Oc=_c=null,Pc=!1,8&t&&(t|=32&t);var r=e.entangledLanes;if(0!==r)for(e=e.entanglements,r&=t;0<r;){var a=31-Ne(r),i=1<<a;t|=e[a],r&=~i}return Sc=t,Or(),n}function au(e,t){$i=null,R.H=ys,t===Za||t===ti?(t=si(),bc=3):t===ei?(t=si(),bc=4):bc=t===Rs?8:null!==t&&"object"==typeof t&&"function"==typeof t.then?6:1,vc=t,null===yc&&(Cc=1,As(e,Jr(t,e.current)))}function iu(){var e=Ri.current;return null===e||((4194048&xc)===xc?null===Mi:!!((62914560&xc)===xc||536870912&xc)&&e===Mi)}function ou(){var e=R.H;return R.H=ys,null===e?ys:e}function su(){var e=R.A;return R.A=hc,e}function lu(){Cc=4,wc||(4194048&xc)!==xc&&null!==Ri.current||(Nc=!0),!(134217727&kc)&&!(134217727&Tc)||null===gc||eu(gc,xc,Ac,!1)}function cu(e,t,n){var r=fc;fc|=2;var a=ou(),i=su();gc===e&&xc===t||(Lc=null,ru(e,t)),t=!1;var o=Cc;e:for(;;)try{if(0!==bc&&null!==yc){var s=yc,l=vc;switch(bc){case 8:nu(),o=6;break e;case 3:case 2:case 9:case 6:null===Ri.current&&(t=!0);var c=bc;if(bc=0,vc=null,mu(e,s,l,c),n&&Nc){o=0;break e}break;default:c=bc,bc=0,vc=null,mu(e,s,l,c)}}uu(),o=Cc;break}catch(u){au(e,u)}return t&&e.shellSuspendCounter++,ka=Ca=null,fc=r,R.H=a,R.A=i,null===yc&&(gc=null,xc=0,Or()),o}function uu(){for(;null!==yc;)pu(yc)}function du(){for(;null!==yc&&!le();)pu(yc)}function pu(e){var t=ll(e.alternate,e,Sc);e.memoizedProps=e.pendingProps,null===t?fu(e):yc=t}function hu(e){var t=e,n=t.alternate;switch(t.tag){case 15:case 0:t=Ys(n,t,t.pendingProps,t.type,void 0,xc);break;case 11:t=Ys(n,t,t.pendingProps,t.type.render,t.ref,xc);break;case 5:lo(t);default:yl(n,t),t=ll(n,t=yc=Hr(t,Sc),Sc)}e.memoizedProps=e.pendingProps,null===t?fu(e):yc=t}function mu(e,t,n,r){ka=Ca=null,lo(t),ci=null,ui=0;var i=t.return;try{if(function(e,t,n,r,i){if(n.flags|=32768,null!==r&&"object"==typeof r&&"function"==typeof r.then){if(null!==(t=n.alternate)&&_a(t,n,i,!0),null!==(n=Ri.current)){switch(n.tag){case 31:case 13:return null===Mi?lu():null===n.alternate&&0===Cc&&(Cc=3),n.flags&=-257,n.flags|=65536,n.lanes=i,r===ni?n.flags|=16384:(null===(t=n.updateQueue)?n.updateQueue=new Set([r]):t.add(r),ku(e,r,i)),!1;case 22:return n.flags|=65536,r===ni?n.flags|=16384:(null===(t=n.updateQueue)?(t={transitions:null,markerInstances:null,retryQueue:new Set([r])},n.updateQueue=t):null===(n=t.retryQueue)?t.retryQueue=new Set([r]):n.add(r),ku(e,r,i)),!1}throw Error(a(435,n.tag))}return ku(e,r,i),lu(),!1}if(ha)return null!==(t=Ri.current)?(!(65536&t.flags)&&(t.flags|=256),t.flags|=65536,t.lanes=i,r!==ga&&Ea(Jr(e=Error(a(422),{cause:r}),n))):(r!==ga&&Ea(Jr(t=Error(a(423),{cause:r}),n)),(e=e.current.alternate).flags|=65536,i&=-i,e.lanes|=i,r=Jr(r,n),Ei(e,i=_s(e.stateNode,r,i)),4!==Cc&&(Cc=2)),!1;var o=Error(a(520),{cause:r});if(o=Jr(o,n),null===_c?_c=[o]:_c.push(o),4!==Cc&&(Cc=2),null===t)return!0;r=Jr(r,n),n=t;do{switch(n.tag){case 3:return n.flags|=65536,e=i&-i,n.lanes|=e,Ei(n,e=_s(n.stateNode,r,e)),!1;case 1:if(t=n.type,o=n.stateNode,!(128&n.flags||"function"!=typeof t.getDerivedStateFromError&&(null===o||"function"!=typeof o.componentDidCatch||null!==Uc&&Uc.has(o))))return n.flags|=65536,i&=-i,n.lanes|=i,Ps(i=Os(i),e,n,r),Ei(n,i),!1}n=n.return}while(null!==n);return!1}(e,i,t,n,xc))return Cc=1,As(e,Jr(n,e.current)),void(yc=null)}catch(o){if(null!==i)throw yc=i,o;return Cc=1,As(e,Jr(n,e.current)),void(yc=null)}32768&t.flags?(ha||1===r?e=!0:Nc||536870912&xc?e=!1:(wc=e=!0,(2===r||9===r||3===r||6===r)&&(null!==(r=Ri.current)&&13===r.tag&&(r.flags|=16384))),gu(t,e)):fu(t)}function fu(e){var t=e;do{if(32768&t.flags)return void gu(t,wc);e=t.return;var n=fl(t.alternate,t,Sc);if(null!==n)return void(yc=n);if(null!==(t=t.sibling))return void(yc=t);yc=t=e}while(null!==t);0===Cc&&(Cc=5)}function gu(e,t){do{var n=gl(e.alternate,e);if(null!==n)return n.flags&=32767,void(yc=n);if(null!==(n=e.return)&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!t&&null!==(e=e.sibling))return void(yc=e);yc=e=n}while(null!==e);Cc=6,yc=null}function yu(e,t,n,r,i,o,s,l,c){e.cancelPendingCommit=null;do{Nu()}while(0!==zc);if(6&fc)throw Error(a(327));if(null!==t){if(t===e.current)throw Error(a(177));if(o=t.lanes|t.childLanes,function(e,t,n,r,a,i){var o=e.pendingLanes;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=n,e.entangledLanes&=n,e.errorRecoveryDisabledLanes&=n,e.shellSuspendCounter=0;var s=e.entanglements,l=e.expirationTimes,c=e.hiddenUpdates;for(n=o&~n;0<n;){var u=31-Ne(n),d=1<<u;s[u]=0,l[u]=-1;var p=c[u];if(null!==p)for(c[u]=null,u=0;u<p.length;u++){var h=p[u];null!==h&&(h.lane&=-536870913)}n&=~d}0!==r&&Me(e,r,0),0!==i&&0===a&&0!==e.tag&&(e.suspendedLanes|=i&~(o&~t))}(e,n,o|=_r,s,l,c),e===gc&&(yc=gc=null,xc=0),Gc=t,Fc=e,qc=n,Hc=o,$c=i,Bc=r,10256&t.subtreeFlags||10256&t.flags?(e.callbackNode=null,e.callbackPriority=0,oe(me,function(){return Eu(),null})):(e.callbackNode=null,e.callbackPriority=0),r=!!(13878&t.flags),13878&t.subtreeFlags||r){r=R.T,R.T=null,i=D.p,D.p=2,s=fc,fc|=4;try{!function(e,t){if(e=e.containerInfo,gd=wp,or(e=ir(e))){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var i=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch(g){n=null;break e}var s=0,l=-1,c=-1,u=0,d=0,p=e,h=null;t:for(;;){for(var m;p!==n||0!==i&&3!==p.nodeType||(l=s+i),p!==o||0!==r&&3!==p.nodeType||(c=s+r),3===p.nodeType&&(s+=p.nodeValue.length),null!==(m=p.firstChild);)h=p,p=m;for(;;){if(p===e)break t;if(h===n&&++u===i&&(l=s),h===o&&++d===r&&(c=s),null!==(m=p.nextSibling))break;h=(p=h).parentNode}p=m}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(yd={focusedElem:e,selectionRange:n},wp=!1,Ml=t;null!==Ml;)if(e=(t=Ml).child,1028&t.subtreeFlags&&null!==e)e.return=t,Ml=e;else for(;null!==Ml;){switch(o=(t=Ml).alternate,e=t.flags,t.tag){case 0:if(4&e&&null!==(e=null!==(e=t.updateQueue)?e.events:null))for(n=0;n<e.length;n++)(i=e[n]).ref.impl=i.nextImpl;break;case 11:case 15:case 5:case 26:case 27:case 6:case 4:case 17:break;case 1:if(1024&e&&null!==o){e=void 0,n=t,i=o.memoizedProps,o=o.memoizedState,r=n.stateNode;try{var f=Cs(n.type,i);e=r.getSnapshotBeforeUpdate(f,o),r.__reactInternalSnapshotBeforeUpdate=e}catch(y){Cu(n,n.return,y)}}break;case 3:if(1024&e)if(9===(n=(e=t.stateNode.containerInfo).nodeType))_d(e);else if(1===n)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":_d(e);break;default:e.textContent=""}break;default:if(1024&e)throw Error(a(163))}if(null!==(e=t.sibling)){e.return=t.return,Ml=e;break}Ml=t.return}}(e,t)}finally{fc=s,D.p=i,R.T=r}}zc=1,xu(),bu(),vu()}}function xu(){if(1===zc){zc=0;var e=Fc,t=Gc,n=!!(13878&t.flags);if(13878&t.subtreeFlags||n){n=R.T,R.T=null;var r=D.p;D.p=2;var a=fc;fc|=4;try{Yl(t,e);var i=yd,o=ir(e.containerInfo),s=i.focusedElem,l=i.selectionRange;if(o!==s&&s&&s.ownerDocument&&ar(s.ownerDocument.documentElement,s)){if(null!==l&&or(s)){var c=l.start,u=l.end;if(void 0===u&&(u=c),"selectionStart"in s)s.selectionStart=c,s.selectionEnd=Math.min(u,s.value.length);else{var d=s.ownerDocument||document,p=d&&d.defaultView||window;if(p.getSelection){var h=p.getSelection(),m=s.textContent.length,f=Math.min(l.start,m),g=void 0===l.end?f:Math.min(l.end,m);!h.extend&&f>g&&(o=g,g=f,f=o);var y=rr(s,f),x=rr(s,g);if(y&&x&&(1!==h.rangeCount||h.anchorNode!==y.node||h.anchorOffset!==y.offset||h.focusNode!==x.node||h.focusOffset!==x.offset)){var b=d.createRange();b.setStart(y.node,y.offset),h.removeAllRanges(),f>g?(h.addRange(b),h.extend(x.node,x.offset)):(b.setEnd(x.node,x.offset),h.addRange(b))}}}}for(d=[],h=s;h=h.parentNode;)1===h.nodeType&&d.push({element:h,left:h.scrollLeft,top:h.scrollTop});for("function"==typeof s.focus&&s.focus(),s=0;s<d.length;s++){var v=d[s];v.element.scrollLeft=v.left,v.element.scrollTop=v.top}}wp=!!gd,yd=gd=null}finally{fc=a,D.p=r,R.T=n}}e.current=t,zc=2}}function bu(){if(2===zc){zc=0;var e=Fc,t=Gc,n=!!(8772&t.flags);if(8772&t.subtreeFlags||n){n=R.T,R.T=null;var r=D.p;D.p=2;var a=fc;fc|=4;try{Dl(e,t.alternate,t)}finally{fc=a,D.p=r,R.T=n}}zc=3}}function vu(){if(4===zc||3===zc){zc=0,ce();var e=Fc,t=Gc,n=qc,r=Bc;10256&t.subtreeFlags||10256&t.flags?zc=5:(zc=0,Gc=Fc=null,wu(e,e.pendingLanes));var a=e.pendingLanes;if(0===a&&(Uc=null),ze(n),t=t.stateNode,ve&&"function"==typeof ve.onCommitFiberRoot)try{ve.onCommitFiberRoot(be,t,void 0,!(128&~t.current.flags))}catch(l){}if(null!==r){t=R.T,a=D.p,D.p=2,R.T=null;try{for(var i=e.onRecoverableError,o=0;o<r.length;o++){var s=r[o];i(s.value,{componentStack:s.stack})}}finally{R.T=t,D.p=a}}3&qc&&Nu(),Lu(e),a=e.pendingLanes,261930&n&&42&a?e===Yc?Vc++:(Vc=0,Yc=e):Vc=0,Uu(0)}}function wu(e,t){0===(e.pooledCacheLanes&=t)&&(null!=(t=e.pooledCache)&&(e.pooledCache=null,qa(t)))}function Nu(){return xu(),bu(),vu(),Eu()}function Eu(){if(5!==zc)return!1;var e=Fc,t=Hc;Hc=0;var n=ze(qc),r=R.T,i=D.p;try{D.p=32>n?32:n,R.T=null,n=$c,$c=null;var o=Fc,s=qc;if(zc=0,Gc=Fc=null,qc=0,6&fc)throw Error(a(331));var l=fc;if(fc|=4,uc(o.current),nc(o,o.current,s,n),fc=l,Uu(0,!1),ve&&"function"==typeof ve.onPostCommitFiberRoot)try{ve.onPostCommitFiberRoot(be,o)}catch(c){}return!0}finally{D.p=i,R.T=r,wu(e,t)}}function Su(e,t,n){t=Jr(n,t),null!==(e=wi(e,t=_s(e.stateNode,t,2),2))&&(Re(e,2),Lu(e))}function Cu(e,t,n){if(3===e.tag)Su(e,e,n);else for(;null!==t;){if(3===t.tag){Su(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"==typeof t.type.getDerivedStateFromError||"function"==typeof r.componentDidCatch&&(null===Uc||!Uc.has(r))){e=Jr(n,e),null!==(r=wi(t,n=Os(2),2))&&(Ps(n,r,t,e),Re(r,2),Lu(r));break}}t=t.return}}function ku(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new mc;var a=new Set;r.set(t,a)}else void 0===(a=r.get(t))&&(a=new Set,r.set(t,a));a.has(n)||(Ec=!0,a.add(n),e=Tu.bind(null,e,t,n),t.then(e,e))}function Tu(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),e.pingedLanes|=e.suspendedLanes&n,e.warmLanes&=~n,gc===e&&(xc&n)===n&&(4===Cc||3===Cc&&(62914560&xc)===xc&&300>ue()-Rc?!(2&fc)&&ru(e,0):Ic|=n,jc===xc&&(jc=0)),Lu(e)}function Iu(e,t){0===t&&(t=Oe()),null!==(e=Mr(e,t))&&(Re(e,t),Lu(e))}function Au(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Iu(e,n)}function ju(e,t){var n=0;switch(e.tag){case 31:case 13:var r=e.stateNode,i=e.memoizedState;null!==i&&(n=i.retryLane);break;case 19:r=e.stateNode;break;case 22:r=e.stateNode._retryCache;break;default:throw Error(a(314))}null!==r&&r.delete(t),Iu(e,n)}var _u=null,Ou=null,Pu=!1,Ru=!1,Mu=!1,Du=0;function Lu(e){e!==Ou&&null===e.next&&(null===Ou?_u=Ou=e:Ou=Ou.next=e),Ru=!0,Pu||(Pu=!0,kd(function(){6&fc?oe(pe,zu):Fu()}))}function Uu(e,t){if(!Mu&&Ru){Mu=!0;do{for(var n=!1,r=_u;null!==r;){if(0!==e){var a=r.pendingLanes;if(0===a)var i=0;else{var o=r.suspendedLanes,s=r.pingedLanes;i=(1<<31-Ne(42|e)+1)-1,i=201326741&(i&=a&~(o&~s))?201326741&i|1:i?2|i:0}0!==i&&(n=!0,Hu(r,i))}else i=xc,!(3&(i=Ae(r,r===gc?i:0,null!==r.cancelPendingCommit||-1!==r.timeoutHandle)))||je(r,i)||(n=!0,Hu(r,i));r=r.next}}while(n);Mu=!1}}function zu(){Fu()}function Fu(){Ru=Pu=!1;var e=0;0!==Du&&function(){var e=window.event;if(e&&"popstate"===e.type)return e!==Nd&&(Nd=e,!0);return Nd=null,!1}()&&(e=Du);for(var t=ue(),n=null,r=_u;null!==r;){var a=r.next,i=Gu(r,t);0===i?(r.next=null,null===n?_u=a:n.next=a,null===a&&(Ou=n)):(n=r,(0!==e||3&i)&&(Ru=!0)),r=a}0!==zc&&5!==zc||Uu(e),0!==Du&&(Du=0)}function Gu(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,a=e.expirationTimes,i=-62914561&e.pendingLanes;0<i;){var o=31-Ne(i),s=1<<o,l=a[o];-1===l?0!==(s&n)&&0===(s&r)||(a[o]=_e(s,t)):l<=t&&(e.expiredLanes|=s),i&=~s}if(n=xc,n=Ae(e,e===(t=gc)?n:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle),r=e.callbackNode,0===n||e===t&&(2===bc||9===bc)||null!==e.cancelPendingCommit)return null!==r&&null!==r&&se(r),e.callbackNode=null,e.callbackPriority=0;if(!(3&n)||je(e,n)){if((t=n&-n)===e.callbackPriority)return t;switch(null!==r&&se(r),ze(n)){case 2:case 8:n=he;break;case 32:default:n=me;break;case 268435456:n=ge}return r=qu.bind(null,e),n=oe(n,r),e.callbackPriority=t,e.callbackNode=n,t}return null!==r&&null!==r&&se(r),e.callbackPriority=2,e.callbackNode=null,2}function qu(e,t){if(0!==zc&&5!==zc)return e.callbackNode=null,e.callbackPriority=0,null;var n=e.callbackNode;if(Nu()&&e.callbackNode!==n)return null;var r=xc;return 0===(r=Ae(e,e===gc?r:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle))?null:(Qc(e,r,t),Gu(e,ue()),null!=e.callbackNode&&e.callbackNode===n?qu.bind(null,e):null)}function Hu(e,t){if(Nu())return null;Qc(e,t,!0)}function $u(){if(0===Du){var e=Ba;0===e&&(e=Ce,!(261888&(Ce<<=1))&&(Ce=256)),Du=e}return Du}function Bu(e){return null==e||"symbol"==typeof e||"boolean"==typeof e?null:"function"==typeof e?e:Pt(""+e)}function Vu(e,t){var n=t.ownerDocument.createElement("input");return n.name=t.name,n.value=t.value,e.id&&n.setAttribute("form",e.id),t.parentNode.insertBefore(n,t),e=new FormData(e),n.parentNode.removeChild(n),e}for(var Yu=0;Yu<kr.length;Yu++){var Wu=kr[Yu];Tr(Wu.toLowerCase(),"on"+(Wu[0].toUpperCase()+Wu.slice(1)))}Tr(xr,"onAnimationEnd"),Tr(br,"onAnimationIteration"),Tr(vr,"onAnimationStart"),Tr("dblclick","onDoubleClick"),Tr("focusin","onFocus"),Tr("focusout","onBlur"),Tr(wr,"onTransitionRun"),Tr(Nr,"onTransitionStart"),Tr(Er,"onTransitionCancel"),Tr(Sr,"onTransitionEnd"),ot("onMouseEnter",["mouseout","mouseover"]),ot("onMouseLeave",["mouseout","mouseover"]),ot("onPointerEnter",["pointerout","pointerover"]),ot("onPointerLeave",["pointerout","pointerover"]),it("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),it("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),it("onBeforeInput",["compositionend","keypress","textInput","paste"]),it("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),it("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),it("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ku="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ju=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Ku));function Qu(e,t){t=!!(4&t);for(var n=0;n<e.length;n++){var r=e[n],a=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var o=r.length-1;0<=o;o--){var s=r[o],l=s.instance,c=s.currentTarget;if(s=s.listener,l!==i&&a.isPropagationStopped())break e;i=s,a.currentTarget=c;try{i(a)}catch(u){Ir(u)}a.currentTarget=null,i=l}else for(o=0;o<r.length;o++){if(l=(s=r[o]).instance,c=s.currentTarget,s=s.listener,l!==i&&a.isPropagationStopped())break e;i=s,a.currentTarget=c;try{i(a)}catch(u){Ir(u)}a.currentTarget=null,i=l}}}}function Xu(e,t){var n=t[Ve];void 0===n&&(n=t[Ve]=new Set);var r=e+"__bubble";n.has(r)||(nd(t,e,2,!1),n.add(r))}function Zu(e,t,n){var r=0;t&&(r|=4),nd(n,e,r,t)}var ed="_reactListening"+Math.random().toString(36).slice(2);function td(e){if(!e[ed]){e[ed]=!0,rt.forEach(function(t){"selectionchange"!==t&&(Ju.has(t)||Zu(t,!1,e),Zu(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[ed]||(t[ed]=!0,Zu("selectionchange",!1,t))}}function nd(e,t,n,r){switch(Ip(t)){case 2:var a=Np;break;case 8:a=Ep;break;default:a=Sp}n=a.bind(null,t,n,e),a=void 0,!$t||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(a=!0),r?void 0!==a?e.addEventListener(t,n,{capture:!0,passive:a}):e.addEventListener(t,n,!0):void 0!==a?e.addEventListener(t,n,{passive:a}):e.addEventListener(t,n,!1)}function rd(e,t,n,r,a){var i=r;if(!(1&t||2&t||null===r))e:for(;;){if(null===r)return;var o=r.tag;if(3===o||4===o){var l=r.stateNode.containerInfo;if(l===a)break;if(4===o)for(o=r.return;null!==o;){var c=o.tag;if((3===c||4===c)&&o.stateNode.containerInfo===a)return;o=o.return}for(;null!==l;){if(null===(o=Xe(l)))return;if(5===(c=o.tag)||6===c||26===c||27===c){r=i=o;continue e}l=l.parentNode}}r=r.return}Gt(function(){var r=i,a=Dt(n),o=[];e:{var l=Cr.get(e);if(void 0!==l){var c=an,u=e;switch(e){case"keypress":if(0===Jt(n))break e;case"keydown":case"keyup":c=vn;break;case"focusin":u="focus",c=dn;break;case"focusout":u="blur",c=dn;break;case"beforeblur":case"afterblur":c=dn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":c=cn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":c=un;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":c=Nn;break;case xr:case br:case vr:c=pn;break;case Sr:c=En;break;case"scroll":case"scrollend":c=sn;break;case"wheel":c=Sn;break;case"copy":case"cut":case"paste":c=hn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":c=wn;break;case"toggle":case"beforetoggle":c=Cn}var d=!!(4&t),p=!d&&("scroll"===e||"scrollend"===e),h=d?null!==l?l+"Capture":null:l;d=[];for(var m,f=r;null!==f;){var g=f;if(m=g.stateNode,5!==(g=g.tag)&&26!==g&&27!==g||null===m||null===h||null!=(g=qt(f,h))&&d.push(ad(f,g,m)),p)break;f=f.return}0<d.length&&(l=new c(l,u,null,n,a),o.push({event:l,listeners:d}))}}if(!(7&t)){if(c="mouseout"===e||"pointerout"===e,(!(l="mouseover"===e||"pointerover"===e)||n===Mt||!(u=n.relatedTarget||n.fromElement)||!Xe(u)&&!u[Be])&&(c||l)&&(l=a.window===a?a:(l=a.ownerDocument)?l.defaultView||l.parentWindow:window,c?(c=r,null!==(u=(u=n.relatedTarget||n.toElement)?Xe(u):null)&&(p=s(u),d=u.tag,u!==p||5!==d&&27!==d&&6!==d)&&(u=null)):(c=null,u=r),c!==u)){if(d=cn,g="onMouseLeave",h="onMouseEnter",f="mouse","pointerout"!==e&&"pointerover"!==e||(d=wn,g="onPointerLeave",h="onPointerEnter",f="pointer"),p=null==c?l:et(c),m=null==u?l:et(u),(l=new d(g,f+"leave",c,n,a)).target=p,l.relatedTarget=m,g=null,Xe(a)===r&&((d=new d(h,f+"enter",u,n,a)).target=m,d.relatedTarget=p,g=d),p=g,c&&u)e:{for(d=od,f=u,m=0,g=h=c;g;g=d(g))m++;g=0;for(var y=f;y;y=d(y))g++;for(;0<m-g;)h=d(h),m--;for(;0<g-m;)f=d(f),g--;for(;m--;){if(h===f||null!==f&&h===f.alternate){d=h;break e}h=d(h),f=d(f)}d=null}else d=null;null!==c&&sd(o,l,c,d,!1),null!==u&&null!==p&&sd(o,p,u,d,!0)}if("select"===(c=(l=r?et(r):window).nodeName&&l.nodeName.toLowerCase())||"input"===c&&"file"===l.type)var x=Hn;else if(Ln(l))if($n)x=Zn;else{x=Qn;var b=Jn}else!(c=l.nodeName)||"input"!==c.toLowerCase()||"checkbox"!==l.type&&"radio"!==l.type?r&&jt(r.elementType)&&(x=Hn):x=Xn;switch(x&&(x=x(e,r))?Un(o,x,n,a):(b&&b(e,l,r),"focusout"===e&&r&&"number"===l.type&&null!=r.memoizedProps.value&&Nt(l,"number",l.value)),b=r?et(r):window,e){case"focusin":(Ln(b)||"true"===b.contentEditable)&&(lr=b,cr=r,ur=null);break;case"focusout":ur=cr=lr=null;break;case"mousedown":dr=!0;break;case"contextmenu":case"mouseup":case"dragend":dr=!1,pr(o,n,a);break;case"selectionchange":if(sr)break;case"keydown":case"keyup":pr(o,n,a)}var v;if(Tn)e:{switch(e){case"compositionstart":var w="onCompositionStart";break e;case"compositionend":w="onCompositionEnd";break e;case"compositionupdate":w="onCompositionUpdate";break e}w=void 0}else Mn?Pn(e,n)&&(w="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(w="onCompositionStart");w&&(jn&&"ko"!==n.locale&&(Mn||"onCompositionStart"!==w?"onCompositionEnd"===w&&Mn&&(v=Kt()):(Yt="value"in(Vt=a)?Vt.value:Vt.textContent,Mn=!0)),0<(b=id(r,w)).length&&(w=new mn(w,e,null,n,a),o.push({event:w,listeners:b}),v?w.data=v:null!==(v=Rn(n))&&(w.data=v))),(v=An?function(e,t){switch(e){case"compositionend":return Rn(t);case"keypress":return 32!==t.which?null:(On=!0,_n);case"textInput":return(e=t.data)===_n&&On?null:e;default:return null}}(e,n):function(e,t){if(Mn)return"compositionend"===e||!Tn&&Pn(e,t)?(e=Kt(),Wt=Yt=Vt=null,Mn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return jn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(w=id(r,"onBeforeInput")).length&&(b=new mn("onBeforeInput","beforeinput",null,n,a),o.push({event:b,listeners:w}),b.data=v)),function(e,t,n,r,a){if("submit"===t&&n&&n.stateNode===a){var i=Bu((a[$e]||null).action),o=r.submitter;o&&null!==(t=(t=o[$e]||null)?Bu(t.formAction):o.getAttribute("formAction"))&&(i=t,o=null);var s=new an("action","action",null,r,a);e.push({event:s,listeners:[{instance:null,listener:function(){if(r.defaultPrevented){if(0!==Du){var e=o?Vu(a,o):new FormData(a);rs(n,{pending:!0,data:e,method:a.method,action:i},null,e)}}else"function"==typeof i&&(s.preventDefault(),e=o?Vu(a,o):new FormData(a),rs(n,{pending:!0,data:e,method:a.method,action:i},i,e))},currentTarget:a}]})}}(o,e,r,n,a)}Qu(o,t)})}function ad(e,t,n){return{instance:e,listener:t,currentTarget:n}}function id(e,t){for(var n=t+"Capture",r=[];null!==e;){var a=e,i=a.stateNode;if(5!==(a=a.tag)&&26!==a&&27!==a||null===i||(null!=(a=qt(e,n))&&r.unshift(ad(e,a,i)),null!=(a=qt(e,t))&&r.push(ad(e,a,i))),3===e.tag)return r;e=e.return}return[]}function od(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag&&27!==e.tag);return e||null}function sd(e,t,n,r,a){for(var i=t._reactName,o=[];null!==n&&n!==r;){var s=n,l=s.alternate,c=s.stateNode;if(s=s.tag,null!==l&&l===r)break;5!==s&&26!==s&&27!==s||null===c||(l=c,a?null!=(c=qt(n,i))&&o.unshift(ad(n,c,l)):a||null!=(c=qt(n,i))&&o.push(ad(n,c,l))),n=n.return}0!==o.length&&e.push({event:t,listeners:o})}var ld=/\r\n?/g,cd=/\u0000|\uFFFD/g;function ud(e){return("string"==typeof e?e:""+e).replace(ld,"\n").replace(cd,"")}function dd(e,t){return t=ud(t),ud(e)===t}function pd(e,t,n,r,i,o){switch(n){case"children":"string"==typeof r?"body"===t||"textarea"===t&&""===r||kt(e,r):("number"==typeof r||"bigint"==typeof r)&&"body"!==t&&kt(e,""+r);break;case"className":dt(e,"class",r);break;case"tabIndex":dt(e,"tabindex",r);break;case"dir":case"role":case"viewBox":case"width":case"height":dt(e,n,r);break;case"style":At(e,r,o);break;case"data":if("object"!==t){dt(e,"data",r);break}case"src":case"href":if(""===r&&("a"!==t||"href"!==n)){e.removeAttribute(n);break}if(null==r||"function"==typeof r||"symbol"==typeof r||"boolean"==typeof r){e.removeAttribute(n);break}r=Pt(""+r),e.setAttribute(n,r);break;case"action":case"formAction":if("function"==typeof r){e.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}if("function"==typeof o&&("formAction"===n?("input"!==t&&pd(e,t,"name",i.name,i,null),pd(e,t,"formEncType",i.formEncType,i,null),pd(e,t,"formMethod",i.formMethod,i,null),pd(e,t,"formTarget",i.formTarget,i,null)):(pd(e,t,"encType",i.encType,i,null),pd(e,t,"method",i.method,i,null),pd(e,t,"target",i.target,i,null))),null==r||"symbol"==typeof r||"boolean"==typeof r){e.removeAttribute(n);break}r=Pt(""+r),e.setAttribute(n,r);break;case"onClick":null!=r&&(e.onclick=Rt);break;case"onScroll":null!=r&&Xu("scroll",e);break;case"onScrollEnd":null!=r&&Xu("scrollend",e);break;case"dangerouslySetInnerHTML":if(null!=r){if("object"!=typeof r||!("__html"in r))throw Error(a(61));if(null!=(n=r.__html)){if(null!=i.children)throw Error(a(60));e.innerHTML=n}}break;case"multiple":e.multiple=r&&"function"!=typeof r&&"symbol"!=typeof r;break;case"muted":e.muted=r&&"function"!=typeof r&&"symbol"!=typeof r;break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":case"autoFocus":break;case"xlinkHref":if(null==r||"function"==typeof r||"boolean"==typeof r||"symbol"==typeof r){e.removeAttribute("xlink:href");break}n=Pt(""+r),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":null!=r&&"function"!=typeof r&&"symbol"!=typeof r?e.setAttribute(n,""+r):e.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":r&&"function"!=typeof r&&"symbol"!=typeof r?e.setAttribute(n,""):e.removeAttribute(n);break;case"capture":case"download":!0===r?e.setAttribute(n,""):!1!==r&&null!=r&&"function"!=typeof r&&"symbol"!=typeof r?e.setAttribute(n,r):e.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":null!=r&&"function"!=typeof r&&"symbol"!=typeof r&&!isNaN(r)&&1<=r?e.setAttribute(n,r):e.removeAttribute(n);break;case"rowSpan":case"start":null==r||"function"==typeof r||"symbol"==typeof r||isNaN(r)?e.removeAttribute(n):e.setAttribute(n,r);break;case"popover":Xu("beforetoggle",e),Xu("toggle",e),ut(e,"popover",r);break;case"xlinkActuate":pt(e,"http://www.w3.org/1999/xlink","xlink:actuate",r);break;case"xlinkArcrole":pt(e,"http://www.w3.org/1999/xlink","xlink:arcrole",r);break;case"xlinkRole":pt(e,"http://www.w3.org/1999/xlink","xlink:role",r);break;case"xlinkShow":pt(e,"http://www.w3.org/1999/xlink","xlink:show",r);break;case"xlinkTitle":pt(e,"http://www.w3.org/1999/xlink","xlink:title",r);break;case"xlinkType":pt(e,"http://www.w3.org/1999/xlink","xlink:type",r);break;case"xmlBase":pt(e,"http://www.w3.org/XML/1998/namespace","xml:base",r);break;case"xmlLang":pt(e,"http://www.w3.org/XML/1998/namespace","xml:lang",r);break;case"xmlSpace":pt(e,"http://www.w3.org/XML/1998/namespace","xml:space",r);break;case"is":ut(e,"is",r);break;case"innerText":case"textContent":break;default:(!(2<n.length)||"o"!==n[0]&&"O"!==n[0]||"n"!==n[1]&&"N"!==n[1])&&ut(e,n=_t.get(n)||n,r)}}function hd(e,t,n,r,i,o){switch(n){case"style":At(e,r,o);break;case"dangerouslySetInnerHTML":if(null!=r){if("object"!=typeof r||!("__html"in r))throw Error(a(61));if(null!=(n=r.__html)){if(null!=i.children)throw Error(a(60));e.innerHTML=n}}break;case"children":"string"==typeof r?kt(e,r):("number"==typeof r||"bigint"==typeof r)&&kt(e,""+r);break;case"onScroll":null!=r&&Xu("scroll",e);break;case"onScrollEnd":null!=r&&Xu("scrollend",e);break;case"onClick":null!=r&&(e.onclick=Rt);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":case"innerText":case"textContent":break;default:at.hasOwnProperty(n)||("o"!==n[0]||"n"!==n[1]||(i=n.endsWith("Capture"),t=n.slice(2,i?n.length-7:void 0),"function"==typeof(o=null!=(o=e[$e]||null)?o[n]:null)&&e.removeEventListener(t,o,i),"function"!=typeof r)?n in e?e[n]=r:!0===r?e.setAttribute(n,""):ut(e,n,r):("function"!=typeof o&&null!==o&&(n in e?e[n]=null:e.hasAttribute(n)&&e.removeAttribute(n)),e.addEventListener(t,r,i)))}}function md(e,t,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Xu("error",e),Xu("load",e);var r,i=!1,o=!1;for(r in n)if(n.hasOwnProperty(r)){var s=n[r];if(null!=s)switch(r){case"src":i=!0;break;case"srcSet":o=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(a(137,t));default:pd(e,t,r,s,n,null)}}return o&&pd(e,t,"srcSet",n.srcSet,n,null),void(i&&pd(e,t,"src",n.src,n,null));case"input":Xu("invalid",e);var l=r=s=o=null,c=null,u=null;for(i in n)if(n.hasOwnProperty(i)){var d=n[i];if(null!=d)switch(i){case"name":o=d;break;case"type":s=d;break;case"checked":c=d;break;case"defaultChecked":u=d;break;case"value":r=d;break;case"defaultValue":l=d;break;case"children":case"dangerouslySetInnerHTML":if(null!=d)throw Error(a(137,t));break;default:pd(e,t,i,d,n,null)}}return void wt(e,r,l,c,u,s,o,!1);case"select":for(o in Xu("invalid",e),i=s=r=null,n)if(n.hasOwnProperty(o)&&null!=(l=n[o]))switch(o){case"value":r=l;break;case"defaultValue":s=l;break;case"multiple":i=l;default:pd(e,t,o,l,n,null)}return t=r,n=s,e.multiple=!!i,void(null!=t?Et(e,!!i,t,!1):null!=n&&Et(e,!!i,n,!0));case"textarea":for(s in Xu("invalid",e),r=o=i=null,n)if(n.hasOwnProperty(s)&&null!=(l=n[s]))switch(s){case"value":i=l;break;case"defaultValue":o=l;break;case"children":r=l;break;case"dangerouslySetInnerHTML":if(null!=l)throw Error(a(91));break;default:pd(e,t,s,l,n,null)}return void Ct(e,i,o,r);case"option":for(c in n)if(n.hasOwnProperty(c)&&null!=(i=n[c]))if("selected"===c)e.selected=i&&"function"!=typeof i&&"symbol"!=typeof i;else pd(e,t,c,i,n,null);return;case"dialog":Xu("beforetoggle",e),Xu("toggle",e),Xu("cancel",e),Xu("close",e);break;case"iframe":case"object":Xu("load",e);break;case"video":case"audio":for(i=0;i<Ku.length;i++)Xu(Ku[i],e);break;case"image":Xu("error",e),Xu("load",e);break;case"details":Xu("toggle",e);break;case"embed":case"source":case"link":Xu("error",e),Xu("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(u in n)if(n.hasOwnProperty(u)&&null!=(i=n[u]))switch(u){case"children":case"dangerouslySetInnerHTML":throw Error(a(137,t));default:pd(e,t,u,i,n,null)}return;default:if(jt(t)){for(d in n)n.hasOwnProperty(d)&&(void 0!==(i=n[d])&&hd(e,t,d,i,n,void 0));return}}for(l in n)n.hasOwnProperty(l)&&(null!=(i=n[l])&&pd(e,t,l,i,n,null))}function fd(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}var gd=null,yd=null;function xd(e){return 9===e.nodeType?e:e.ownerDocument}function bd(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function vd(e,t){if(0===e)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return 1===e&&"foreignObject"===t?0:e}function wd(e,t){return"textarea"===e||"noscript"===e||"string"==typeof t.children||"number"==typeof t.children||"bigint"==typeof t.children||"object"==typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var Nd=null;var Ed="function"==typeof setTimeout?setTimeout:void 0,Sd="function"==typeof clearTimeout?clearTimeout:void 0,Cd="function"==typeof Promise?Promise:void 0,kd="function"==typeof queueMicrotask?queueMicrotask:void 0!==Cd?function(e){return Cd.resolve(null).then(e).catch(Td)}:Ed;function Td(e){setTimeout(function(){throw e})}function Id(e){return"head"===e}function Ad(e,t){var n=t,r=0;do{var a=n.nextSibling;if(e.removeChild(n),a&&8===a.nodeType)if("/$"===(n=a.data)||"/&"===n){if(0===r)return e.removeChild(a),void Vp(t);r--}else if("$"===n||"$?"===n||"$~"===n||"$!"===n||"&"===n)r++;else if("html"===n)Fd(e.ownerDocument.documentElement);else if("head"===n){Fd(n=e.ownerDocument.head);for(var i=n.firstChild;i;){var o=i.nextSibling,s=i.nodeName;i[Je]||"SCRIPT"===s||"STYLE"===s||"LINK"===s&&"stylesheet"===i.rel.toLowerCase()||n.removeChild(i),i=o}}else"body"===n&&Fd(e.ownerDocument.body);n=a}while(n);Vp(t)}function jd(e,t){var n=e;e=0;do{var r=n.nextSibling;if(1===n.nodeType?t?(n._stashedDisplay=n.style.display,n.style.display="none"):(n.style.display=n._stashedDisplay||"",""===n.getAttribute("style")&&n.removeAttribute("style")):3===n.nodeType&&(t?(n._stashedText=n.nodeValue,n.nodeValue=""):n.nodeValue=n._stashedText||""),r&&8===r.nodeType)if("/$"===(n=r.data)){if(0===e)break;e--}else"$"!==n&&"$?"!==n&&"$~"!==n&&"$!"!==n||e++;n=r}while(n)}function _d(e){var t=e.firstChild;for(t&&10===t.nodeType&&(t=t.nextSibling);t;){var n=t;switch(t=t.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":_d(n),Qe(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if("stylesheet"===n.rel.toLowerCase())continue}e.removeChild(n)}}function Od(e,t){for(;8!==e.nodeType;){if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!t)return null;if(null===(e=Md(e.nextSibling)))return null}return e}function Pd(e){return"$?"===e.data||"$~"===e.data}function Rd(e){return"$!"===e.data||"$?"===e.data&&"loading"!==e.ownerDocument.readyState}function Md(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t||"$~"===t||"&"===t||"F!"===t||"F"===t)break;if("/$"===t||"/&"===t)return null}}return e}var Dd=null;function Ld(e){e=e.nextSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n||"/&"===n){if(0===t)return Md(e.nextSibling);t--}else"$"!==n&&"$!"!==n&&"$?"!==n&&"$~"!==n&&"&"!==n||t++}e=e.nextSibling}return null}function Ud(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n||"$~"===n||"&"===n){if(0===t)return e;t--}else"/$"!==n&&"/&"!==n||t++}e=e.previousSibling}return null}function zd(e,t,n){switch(t=xd(n),e){case"html":if(!(e=t.documentElement))throw Error(a(452));return e;case"head":if(!(e=t.head))throw Error(a(453));return e;case"body":if(!(e=t.body))throw Error(a(454));return e;default:throw Error(a(451))}}function Fd(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);Qe(e)}var Gd=new Map,qd=new Set;function Hd(e){return"function"==typeof e.getRootNode?e.getRootNode():9===e.nodeType?e:e.ownerDocument}var $d=D.d;D.d={f:function(){var e=$d.f(),t=tu();return e||t},r:function(e){var t=Ze(e);null!==t&&5===t.tag&&"form"===t.type?is(t):$d.r(e)},D:function(e){$d.D(e),Vd("dns-prefetch",e,null)},C:function(e,t){$d.C(e,t),Vd("preconnect",e,t)},L:function(e,t,n){$d.L(e,t,n);var r=Bd;if(r&&e&&t){var a='link[rel="preload"][as="'+bt(t)+'"]';"image"===t&&n&&n.imageSrcSet?(a+='[imagesrcset="'+bt(n.imageSrcSet)+'"]',"string"==typeof n.imageSizes&&(a+='[imagesizes="'+bt(n.imageSizes)+'"]')):a+='[href="'+bt(e)+'"]';var i=a;switch(t){case"style":i=Wd(e);break;case"script":i=Qd(e)}Gd.has(i)||(e=p({rel:"preload",href:"image"===t&&n&&n.imageSrcSet?void 0:e,as:t},n),Gd.set(i,e),null!==r.querySelector(a)||"style"===t&&r.querySelector(Kd(i))||"script"===t&&r.querySelector(Xd(i))||(md(t=r.createElement("link"),"link",e),nt(t),r.head.appendChild(t)))}},m:function(e,t){$d.m(e,t);var n=Bd;if(n&&e){var r=t&&"string"==typeof t.as?t.as:"script",a='link[rel="modulepreload"][as="'+bt(r)+'"][href="'+bt(e)+'"]',i=a;switch(r){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":i=Qd(e)}if(!Gd.has(i)&&(e=p({rel:"modulepreload",href:e},t),Gd.set(i,e),null===n.querySelector(a))){switch(r){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector(Xd(i)))return}md(r=n.createElement("link"),"link",e),nt(r),n.head.appendChild(r)}}},X:function(e,t){$d.X(e,t);var n=Bd;if(n&&e){var r=tt(n).hoistableScripts,a=Qd(e),i=r.get(a);i||((i=n.querySelector(Xd(a)))||(e=p({src:e,async:!0},t),(t=Gd.get(a))&&np(e,t),nt(i=n.createElement("script")),md(i,"link",e),n.head.appendChild(i)),i={type:"script",instance:i,count:1,state:null},r.set(a,i))}},S:function(e,t,n){$d.S(e,t,n);var r=Bd;if(r&&e){var a=tt(r).hoistableStyles,i=Wd(e);t=t||"default";var o=a.get(i);if(!o){var s={loading:0,preload:null};if(o=r.querySelector(Kd(i)))s.loading=5;else{e=p({rel:"stylesheet",href:e,"data-precedence":t},n),(n=Gd.get(i))&&tp(e,n);var l=o=r.createElement("link");nt(l),md(l,"link",e),l._p=new Promise(function(e,t){l.onload=e,l.onerror=t}),l.addEventListener("load",function(){s.loading|=1}),l.addEventListener("error",function(){s.loading|=2}),s.loading|=4,ep(o,t,r)}o={type:"stylesheet",instance:o,count:1,state:s},a.set(i,o)}}},M:function(e,t){$d.M(e,t);var n=Bd;if(n&&e){var r=tt(n).hoistableScripts,a=Qd(e),i=r.get(a);i||((i=n.querySelector(Xd(a)))||(e=p({src:e,async:!0,type:"module"},t),(t=Gd.get(a))&&np(e,t),nt(i=n.createElement("script")),md(i,"link",e),n.head.appendChild(i)),i={type:"script",instance:i,count:1,state:null},r.set(a,i))}}};var Bd="undefined"==typeof document?null:document;function Vd(e,t,n){var r=Bd;if(r&&"string"==typeof t&&t){var a=bt(t);a='link[rel="'+e+'"][href="'+a+'"]',"string"==typeof n&&(a+='[crossorigin="'+n+'"]'),qd.has(a)||(qd.add(a),e={rel:e,crossOrigin:n,href:t},null===r.querySelector(a)&&(md(t=r.createElement("link"),"link",e),nt(t),r.head.appendChild(t)))}}function Yd(e,t,n,r){var i,o,s,l,c=(c=W.current)?Hd(c):null;if(!c)throw Error(a(446));switch(e){case"meta":case"title":return null;case"style":return"string"==typeof n.precedence&&"string"==typeof n.href?(t=Wd(n.href),(r=(n=tt(c).hoistableStyles).get(t))||(r={type:"style",instance:null,count:0,state:null},n.set(t,r)),r):{type:"void",instance:null,count:0,state:null};case"link":if("stylesheet"===n.rel&&"string"==typeof n.href&&"string"==typeof n.precedence){e=Wd(n.href);var u=tt(c).hoistableStyles,d=u.get(e);if(d||(c=c.ownerDocument||c,d={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},u.set(e,d),(u=c.querySelector(Kd(e)))&&!u._p&&(d.instance=u,d.state.loading=5),Gd.has(e)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},Gd.set(e,n),u||(i=c,o=e,s=n,l=d.state,i.querySelector('link[rel="preload"][as="style"]['+o+"]")?l.loading=1:(o=i.createElement("link"),l.preload=o,o.addEventListener("load",function(){return l.loading|=1}),o.addEventListener("error",function(){return l.loading|=2}),md(o,"link",s),nt(o),i.head.appendChild(o))))),t&&null===r)throw Error(a(528,""));return d}if(t&&null!==r)throw Error(a(529,""));return null;case"script":return t=n.async,"string"==typeof(n=n.src)&&t&&"function"!=typeof t&&"symbol"!=typeof t?(t=Qd(n),(r=(n=tt(c).hoistableScripts).get(t))||(r={type:"script",instance:null,count:0,state:null},n.set(t,r)),r):{type:"void",instance:null,count:0,state:null};default:throw Error(a(444,e))}}function Wd(e){return'href="'+bt(e)+'"'}function Kd(e){return'link[rel="stylesheet"]['+e+"]"}function Jd(e){return p({},e,{"data-precedence":e.precedence,precedence:null})}function Qd(e){return'[src="'+bt(e)+'"]'}function Xd(e){return"script[async]"+e}function Zd(e,t,n){if(t.count++,null===t.instance)switch(t.type){case"style":var r=e.querySelector('style[data-href~="'+bt(n.href)+'"]');if(r)return t.instance=r,nt(r),r;var i=p({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return nt(r=(e.ownerDocument||e).createElement("style")),md(r,"style",i),ep(r,n.precedence,e),t.instance=r;case"stylesheet":i=Wd(n.href);var o=e.querySelector(Kd(i));if(o)return t.state.loading|=4,t.instance=o,nt(o),o;r=Jd(n),(i=Gd.get(i))&&tp(r,i),nt(o=(e.ownerDocument||e).createElement("link"));var s=o;return s._p=new Promise(function(e,t){s.onload=e,s.onerror=t}),md(o,"link",r),t.state.loading|=4,ep(o,n.precedence,e),t.instance=o;case"script":return o=Qd(n.src),(i=e.querySelector(Xd(o)))?(t.instance=i,nt(i),i):(r=n,(i=Gd.get(o))&&np(r=p({},n),i),nt(i=(e=e.ownerDocument||e).createElement("script")),md(i,"link",r),e.head.appendChild(i),t.instance=i);case"void":return null;default:throw Error(a(443,t.type))}else"stylesheet"===t.type&&!(4&t.state.loading)&&(r=t.instance,t.state.loading|=4,ep(r,n.precedence,e));return t.instance}function ep(e,t,n){for(var r=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),a=r.length?r[r.length-1]:null,i=a,o=0;o<r.length;o++){var s=r[o];if(s.dataset.precedence===t)i=s;else if(i!==a)break}i?i.parentNode.insertBefore(e,i.nextSibling):(t=9===n.nodeType?n.head:n).insertBefore(e,t.firstChild)}function tp(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.title&&(e.title=t.title)}function np(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.integrity&&(e.integrity=t.integrity)}var rp=null;function ap(e,t,n){if(null===rp){var r=new Map,a=rp=new Map;a.set(n,r)}else(r=(a=rp).get(n))||(r=new Map,a.set(n,r));if(r.has(e))return r;for(r.set(e,null),n=n.getElementsByTagName(e),a=0;a<n.length;a++){var i=n[a];if(!(i[Je]||i[He]||"link"===e&&"stylesheet"===i.getAttribute("rel"))&&"http://www.w3.org/2000/svg"!==i.namespaceURI){var o=i.getAttribute(t)||"";o=e+o;var s=r.get(o);s?s.push(i):r.set(o,[i])}}return r}function ip(e,t,n){(e=e.ownerDocument||e).head.insertBefore(n,"title"===t?e.querySelector("head > title"):null)}function op(e){return!!("stylesheet"!==e.type||3&e.state.loading)}var sp=0;function lp(){if(this.count--,0===this.count&&(0===this.imgCount||!this.waitingForImages))if(this.stylesheets)up(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}var cp=null;function up(e,t){e.stylesheets=null,null!==e.unsuspend&&(e.count++,cp=new Map,t.forEach(dp,e),cp=null,lp.call(e))}function dp(e,t){if(!(4&t.state.loading)){var n=cp.get(e);if(n)var r=n.get(null);else{n=new Map,cp.set(e,n);for(var a=e.querySelectorAll("link[data-precedence],style[data-precedence]"),i=0;i<a.length;i++){var o=a[i];"LINK"!==o.nodeName&&"not all"===o.getAttribute("media")||(n.set(o.dataset.precedence,o),r=o)}r&&n.set(null,r)}o=(a=t.instance).getAttribute("data-precedence"),(i=n.get(o)||r)===r&&n.set(null,a),n.set(o,a),this.count++,r=lp.bind(this),a.addEventListener("load",r),a.addEventListener("error",r),i?i.parentNode.insertBefore(a,i.nextSibling):(e=9===e.nodeType?e.head:e).insertBefore(a,e.firstChild),t.state.loading|=4}}var pp={$$typeof:v,Provider:null,Consumer:null,_currentValue:L,_currentValue2:L,_threadCount:0};function hp(e,t,n,r,a,i,o,s,l){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Pe(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Pe(0),this.hiddenUpdates=Pe(null),this.identifierPrefix=r,this.onUncaughtError=a,this.onCaughtError=i,this.onRecoverableError=o,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=l,this.incompleteTransitions=new Map}function mp(e,t,n,r,a,i,o,s,l,c,u,d){return e=new hp(e,t,n,o,l,c,u,d,s),t=1,!0===i&&(t|=24),i=Fr(3,null,null,t),e.current=i,i.stateNode=e,(t=Ga()).refCount++,e.pooledCache=t,t.refCount++,i.memoizedState={element:r,isDehydrated:n,cache:t},xi(i),e}function fp(e){return e?e=Ur:Ur}function gp(e,t,n,r,a,i){a=fp(a),null===r.context?r.context=a:r.pendingContext=a,(r=vi(t)).payload={element:n},null!==(i=void 0===i?null:i)&&(r.callback=i),null!==(n=wi(e,r,t))&&(Jc(n,0,t),Ni(n,e,t))}function yp(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function xp(e,t){yp(e,t),(e=e.alternate)&&yp(e,t)}function bp(e){if(13===e.tag||31===e.tag){var t=Mr(e,67108864);null!==t&&Jc(t,0,67108864),xp(e,67108864)}}function vp(e){if(13===e.tag||31===e.tag){var t=Wc(),n=Mr(e,t=Ue(t));null!==n&&Jc(n,0,t),xp(e,t)}}var wp=!0;function Np(e,t,n,r){var a=R.T;R.T=null;var i=D.p;try{D.p=2,Sp(e,t,n,r)}finally{D.p=i,R.T=a}}function Ep(e,t,n,r){var a=R.T;R.T=null;var i=D.p;try{D.p=8,Sp(e,t,n,r)}finally{D.p=i,R.T=a}}function Sp(e,t,n,r){if(wp){var a=Cp(r);if(null===a)rd(e,t,r,kp,n),Lp(e,r);else if(function(e,t,n,r,a){switch(t){case"focusin":return jp=Up(jp,e,t,n,r,a),!0;case"dragenter":return _p=Up(_p,e,t,n,r,a),!0;case"mouseover":return Op=Up(Op,e,t,n,r,a),!0;case"pointerover":var i=a.pointerId;return Pp.set(i,Up(Pp.get(i)||null,e,t,n,r,a)),!0;case"gotpointercapture":return i=a.pointerId,Rp.set(i,Up(Rp.get(i)||null,e,t,n,r,a)),!0}return!1}(a,e,t,n,r))r.stopPropagation();else if(Lp(e,r),4&t&&-1<Dp.indexOf(e)){for(;null!==a;){var i=Ze(a);if(null!==i)switch(i.tag){case 3:if((i=i.stateNode).current.memoizedState.isDehydrated){var o=Ie(i.pendingLanes);if(0!==o){var s=i;for(s.pendingLanes|=2,s.entangledLanes|=2;o;){var l=1<<31-Ne(o);s.entanglements[1]|=l,o&=~l}Lu(i),!(6&fc)&&(Dc=ue()+500,Uu(0))}}break;case 31:case 13:null!==(s=Mr(i,2))&&Jc(s,0,2),tu(),xp(i,2)}if(null===(i=Cp(r))&&rd(e,t,r,kp,n),i===a)break;a=i}null!==a&&r.stopPropagation()}else rd(e,t,r,null,n)}}function Cp(e){return Tp(e=Dt(e))}var kp=null;function Tp(e){if(kp=null,null!==(e=Xe(e))){var t=s(e);if(null===t)e=null;else{var n=t.tag;if(13===n){if(null!==(e=l(t)))return e;e=null}else if(31===n){if(null!==(e=c(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return kp=e,null}function Ip(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(de()){case pe:return 2;case he:return 8;case me:case fe:return 32;case ge:return 268435456;default:return 32}default:return 32}}var Ap=!1,jp=null,_p=null,Op=null,Pp=new Map,Rp=new Map,Mp=[],Dp="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Lp(e,t){switch(e){case"focusin":case"focusout":jp=null;break;case"dragenter":case"dragleave":_p=null;break;case"mouseover":case"mouseout":Op=null;break;case"pointerover":case"pointerout":Pp.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Rp.delete(t.pointerId)}}function Up(e,t,n,r,a,i){return null===e||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[a]},null!==t&&(null!==(t=Ze(t))&&bp(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==a&&-1===t.indexOf(a)&&t.push(a),e)}function zp(e){var t=Xe(e.target);if(null!==t){var n=s(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=l(n)))return e.blockedOn=t,void Ge(e.priority,function(){vp(n)})}else if(31===t){if(null!==(t=c(n)))return e.blockedOn=t,void Ge(e.priority,function(){vp(n)})}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Fp(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Cp(e.nativeEvent);if(null!==n)return null!==(t=Ze(n))&&bp(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);Mt=r,n.target.dispatchEvent(r),Mt=null,t.shift()}return!0}function Gp(e,t,n){Fp(e)&&n.delete(t)}function qp(){Ap=!1,null!==jp&&Fp(jp)&&(jp=null),null!==_p&&Fp(_p)&&(_p=null),null!==Op&&Fp(Op)&&(Op=null),Pp.forEach(Gp),Rp.forEach(Gp)}function Hp(t,n){t.blockedOn===n&&(t.blockedOn=null,Ap||(Ap=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,qp)))}var $p=null;function Bp(t){$p!==t&&($p=t,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){$p===t&&($p=null);for(var e=0;e<t.length;e+=3){var n=t[e],r=t[e+1],a=t[e+2];if("function"!=typeof r){if(null===Tp(r||n))continue;break}var i=Ze(n);null!==i&&(t.splice(e,3),e-=3,rs(i,{pending:!0,data:a,method:n.method,action:r},r,a))}}))}function Vp(e){function t(t){return Hp(t,e)}null!==jp&&Hp(jp,e),null!==_p&&Hp(_p,e),null!==Op&&Hp(Op,e),Pp.forEach(t),Rp.forEach(t);for(var n=0;n<Mp.length;n++){var r=Mp[n];r.blockedOn===e&&(r.blockedOn=null)}for(;0<Mp.length&&null===(n=Mp[0]).blockedOn;)zp(n),null===n.blockedOn&&Mp.shift();if(null!=(n=(e.ownerDocument||e).$$reactFormReplay))for(r=0;r<n.length;r+=3){var a=n[r],i=n[r+1],o=a[$e]||null;if("function"==typeof i)o||Bp(n);else if(o){var s=null;if(i&&i.hasAttribute("formAction")){if(a=i,o=i[$e]||null)s=o.formAction;else if(null!==Tp(a))continue}else s=o.action;"function"==typeof s?n[r+1]=s:(n.splice(r,3),r-=3),Bp(n)}}}function Yp(){function e(e){e.canIntercept&&"react-transition"===e.info&&e.intercept({handler:function(){return new Promise(function(e){return a=e})},focusReset:"manual",scroll:"manual"})}function t(){null!==a&&(a(),a=null),r||setTimeout(n,20)}function n(){if(!r&&!navigation.transition){var e=navigation.currentEntry;e&&null!=e.url&&navigation.navigate(e.url,{state:e.getState(),info:"react-transition",history:"replace"})}}if("object"==typeof navigation){var r=!1,a=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",t),navigation.addEventListener("navigateerror",t),setTimeout(n,100),function(){r=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",t),navigation.removeEventListener("navigateerror",t),null!==a&&(a(),a=null)}}}function Wp(e){this._internalRoot=e}function Kp(e){this._internalRoot=e}Kp.prototype.render=Wp.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(a(409));gp(t.current,Wc(),e,t,null,null)},Kp.prototype.unmount=Wp.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;gp(e.current,2,null,e,null,null),tu(),t[Be]=null}},Kp.prototype.unstable_scheduleHydration=function(e){if(e){var t=Fe();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Mp.length&&0!==t&&t<Mp[n].priority;n++);Mp.splice(n,0,e),0===n&&zp(e)}};var Jp=t.version;if("19.2.0"!==Jp)throw Error(a(527,Jp,"19.2.0"));D.findDOMNode=function(e){var t=e._reactInternals;if(void 0===t){if("function"==typeof e.render)throw Error(a(188));throw e=Object.keys(e).join(","),Error(a(268,e))}return e=function(e){var t=e.alternate;if(!t){if(null===(t=s(e)))throw Error(a(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(null===i)break;var o=i.alternate;if(null===o){if(null!==(r=i.return)){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return u(i),e;if(o===r)return u(i),t;o=o.sibling}throw Error(a(188))}if(n.return!==r.return)n=i,r=o;else{for(var l=!1,c=i.child;c;){if(c===n){l=!0,n=i,r=o;break}if(c===r){l=!0,r=i,n=o;break}c=c.sibling}if(!l){for(c=o.child;c;){if(c===n){l=!0,n=o,r=i;break}if(c===r){l=!0,r=o,n=i;break}c=c.sibling}if(!l)throw Error(a(189))}}if(n.alternate!==r)throw Error(a(190))}if(3!==n.tag)throw Error(a(188));return n.stateNode.current===n?e:t}(t),e=null===(e=null!==e?d(e):null)?null:e.stateNode};var Qp={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:R,reconcilerVersion:"19.2.0"};if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var Xp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Xp.isDisabled&&Xp.supportsFiber)try{be=Xp.inject(Qp),ve=Xp}catch(eh){}}return M.createRoot=function(e,t){if(!o(e))throw Error(a(299));var n=!1,r="",i=ks,s=Ts,l=Is;return null!=t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onUncaughtError&&(i=t.onUncaughtError),void 0!==t.onCaughtError&&(s=t.onCaughtError),void 0!==t.onRecoverableError&&(l=t.onRecoverableError)),t=mp(e,1,!1,null,0,n,r,null,i,s,l,Yp),e[Be]=t.current,td(e),new Wp(t)},M.hydrateRoot=function(e,t,n){if(!o(e))throw Error(a(299));var r=!1,i="",s=ks,l=Ts,c=Is,u=null;return null!=n&&(!0===n.unstable_strictMode&&(r=!0),void 0!==n.identifierPrefix&&(i=n.identifierPrefix),void 0!==n.onUncaughtError&&(s=n.onUncaughtError),void 0!==n.onCaughtError&&(l=n.onCaughtError),void 0!==n.onRecoverableError&&(c=n.onRecoverableError),void 0!==n.formState&&(u=n.formState)),(t=mp(e,1,!0,t,0,r,i,u,s,l,c,Yp)).context=fp(null),n=t.current,(i=vi(r=Ue(r=Wc()))).callback=null,wi(n,i,r),n=r,t.current.lanes=n,Re(t,n),Lu(t),e[Be]=t.current,td(e),new Kp(t)},M.version="19.2.0",M}const F=a((P||(P=1,function e(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){}}(),R.exports=z()),R.exports));const G=a(i()),q=e=>{const t=(e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,n)=>n?n.toUpperCase():t.toLowerCase()))(e);return t.charAt(0).toUpperCase()+t.slice(1)},H=(...e)=>e.filter((e,t,n)=>Boolean(e)&&""!==e.trim()&&n.indexOf(e)===t).join(" ").trim(),$=e=>{for(const t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};
/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
var B={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};
/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=I.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:a="",children:i,iconNode:o,...s},l)=>I.createElement("svg",{ref:l,...B,width:t,height:t,stroke:e,strokeWidth:r?24*Number(n)/Number(t):n,className:H("lucide",a),...!i&&!$(s)&&{"aria-hidden":"true"},...s},[...o.map(([e,t])=>I.createElement(e,t)),...Array.isArray(i)?i:[i]])),Y=(e,t)=>{const n=I.forwardRef(({className:n,...r},a)=>{return I.createElement(V,{ref:a,iconNode:t,className:H(`lucide-${i=q(e),i.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${e}`,n),...r});var i});return n.displayName=q(e),n},W=Y("activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]),K=Y("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),J=Y("arrow-right",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),Q=Y("atom",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["path",{d:"M20.2 20.2c2.04-2.03.02-7.36-4.5-11.9-4.54-4.52-9.87-6.54-11.9-4.5-2.04 2.03-.02 7.36 4.5 11.9 4.54 4.52 9.87 6.54 11.9 4.5Z",key:"1l2ple"}],["path",{d:"M15.7 15.7c4.52-4.54 6.54-9.87 4.5-11.9-2.03-2.04-7.36-.02-11.9 4.5-4.52 4.54-6.54 9.87-4.5 11.9 2.03 2.04 7.36.02 11.9-4.5Z",key:"1wam0m"}]]),X=Y("book-open",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]),Z=Y("brain-circuit",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M9 13a4.5 4.5 0 0 0 3-4",key:"10igwf"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M12 13h4",key:"1ku699"}],["path",{d:"M12 18h6a2 2 0 0 1 2 2v1",key:"105ag5"}],["path",{d:"M12 8h8",key:"1lhi5i"}],["path",{d:"M16 8V5a2 2 0 0 1 2-2",key:"u6izg6"}],["circle",{cx:"16",cy:"13",r:".5",key:"ry7gng"}],["circle",{cx:"18",cy:"3",r:".5",key:"1aiba7"}],["circle",{cx:"20",cy:"21",r:".5",key:"yhc1fs"}],["circle",{cx:"20",cy:"8",r:".5",key:"1e43v0"}]]),ee=Y("brain",[["path",{d:"M12 18V5",key:"adv99a"}],["path",{d:"M15 13a4.17 4.17 0 0 1-3-4 4.17 4.17 0 0 1-3 4",key:"1e3is1"}],["path",{d:"M17.598 6.5A3 3 0 1 0 12 5a3 3 0 1 0-5.598 1.5",key:"1gqd8o"}],["path",{d:"M17.997 5.125a4 4 0 0 1 2.526 5.77",key:"iwvgf7"}],["path",{d:"M18 18a4 4 0 0 0 2-7.464",key:"efp6ie"}],["path",{d:"M19.967 17.483A4 4 0 1 1 12 18a4 4 0 1 1-7.967-.517",key:"1gq6am"}],["path",{d:"M6 18a4 4 0 0 1-2-7.464",key:"k1g0md"}],["path",{d:"M6.003 5.125a4 4 0 0 0-2.526 5.77",key:"q97ue3"}]]),te=Y("cake",[["path",{d:"M20 21v-8a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v8",key:"1w3rig"}],["path",{d:"M4 16s.5-1 2-1 2.5 2 4 2 2.5-2 4-2 2.5 2 4 2 2-1 2-1",key:"n2jgmb"}],["path",{d:"M2 21h20",key:"1nyx9w"}],["path",{d:"M7 8v3",key:"1qtyvj"}],["path",{d:"M12 8v3",key:"hwp4zt"}],["path",{d:"M17 8v3",key:"1i6e5u"}],["path",{d:"M7 4h.01",key:"1bh4kh"}],["path",{d:"M12 4h.01",key:"1ujb9j"}],["path",{d:"M17 4h.01",key:"1upcoc"}]]),ne=Y("camera",[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]),re=Y("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),ae=Y("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),ie=Y("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),oe=Y("chevron-up",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]),se=Y("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),le=Y("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),ce=Y("circle-check",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),ue=Y("circle-question-mark",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),de=Y("circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),pe=Y("clipboard-check",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]]),he=Y("cloud-upload",[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]]),me=Y("coffee",[["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M14 2v2",key:"6buw04"}],["path",{d:"M16 8a1 1 0 0 1 1 1v8a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4V9a1 1 0 0 1 1-1h14a4 4 0 1 1 0 8h-1",key:"pwadti"}],["path",{d:"M6 2v2",key:"colzsn"}]]),fe=Y("copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),ge=Y("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]),ye=Y("external-link",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]),xe=Y("eye-off",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]),be=Y("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),ve=Y("fast-forward",[["path",{d:"M12 6a2 2 0 0 1 3.414-1.414l6 6a2 2 0 0 1 0 2.828l-6 6A2 2 0 0 1 12 18z",key:"b19h5q"}],["path",{d:"M2 6a2 2 0 0 1 3.414-1.414l6 6a2 2 0 0 1 0 2.828l-6 6A2 2 0 0 1 2 18z",key:"h7h5ge"}]]),we=Y("file-braces",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 12a1 1 0 0 0-1 1v1a1 1 0 0 1-1 1 1 1 0 0 1 1 1v1a1 1 0 0 0 1 1",key:"1oajmo"}],["path",{d:"M14 18a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1 1 1 0 0 1-1-1v-1a1 1 0 0 0-1-1",key:"mpwhp6"}]]),Ne=Y("file-headphone",[["path",{d:"M4 6.835V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.706.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2h-.343",key:"1vfytu"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M2 19a2 2 0 0 1 4 0v1a2 2 0 0 1-4 0v-4a6 6 0 0 1 12 0v4a2 2 0 0 1-4 0v-1a2 2 0 0 1 4 0",key:"1etmh7"}]]),Ee=Y("file-image",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["circle",{cx:"10",cy:"12",r:"2",key:"737tya"}],["path",{d:"m20 17-1.296-1.296a2.41 2.41 0 0 0-3.408 0L9 22",key:"wt3hpn"}]]),Se=Y("file-search",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["circle",{cx:"11.5",cy:"14.5",r:"2.5",key:"1bq0ko"}],["path",{d:"M13.3 16.3 15 18",key:"2quom7"}]]),Ce=Y("file-text",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]),ke=Y("flask-conical",[["path",{d:"M14 2v6a2 2 0 0 0 .245.96l5.51 10.08A2 2 0 0 1 18 22H6a2 2 0 0 1-1.755-2.96l5.51-10.08A2 2 0 0 0 10 8V2",key:"18mbvz"}],["path",{d:"M6.453 15h11.094",key:"3shlmq"}],["path",{d:"M8.5 2h7",key:"csnxdl"}]]),Te=Y("git-compare",[["circle",{cx:"18",cy:"18",r:"3",key:"1xkwt0"}],["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M13 6h3a2 2 0 0 1 2 2v7",key:"1yeb86"}],["path",{d:"M11 18H8a2 2 0 0 1-2-2V9",key:"19pyzm"}]]),Ie=Y("globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]),Ae=Y("graduation-cap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]),je=Y("headphones",[["path",{d:"M3 14h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-7a9 9 0 0 1 18 0v7a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3",key:"1xhozi"}]]),_e=Y("heart-pulse",[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}],["path",{d:"M3.22 13H9.5l.5-1 2 4.5 2-7 1.5 3.5h5.27",key:"auskq0"}]]),Oe=Y("heart",[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]]),Pe=Y("info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),Re=Y("key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]),Me=Y("layers",[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]]),De=Y("library",[["path",{d:"m16 6 4 14",key:"ji33uf"}],["path",{d:"M12 6v14",key:"1n7gus"}],["path",{d:"M8 8v12",key:"1gg7y9"}],["path",{d:"M4 4v16",key:"6qkkli"}]]),Le=Y("lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]),Ue=Y("link-2",[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]]),ze=Y("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),Fe=Y("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),Ge=Y("message-circle",[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]]),qe=Y("mic-vocal",[["path",{d:"m11 7.601-5.994 8.19a1 1 0 0 0 .1 1.298l.817.818a1 1 0 0 0 1.314.087L15.09 12",key:"80a601"}],["path",{d:"M16.5 21.174C15.5 20.5 14.372 20 13 20c-2.058 0-3.928 2.356-6 2-2.072-.356-2.775-3.369-1.5-4.5",key:"j0ngtp"}],["circle",{cx:"16",cy:"7",r:"5",key:"d08jfb"}]]),He=Y("microscope",[["path",{d:"M6 18h8",key:"1borvv"}],["path",{d:"M3 22h18",key:"8prr45"}],["path",{d:"M14 22a7 7 0 1 0 0-14h-1",key:"1jwaiy"}],["path",{d:"M9 14h2",key:"197e7h"}],["path",{d:"M9 12a2 2 0 0 1-2-2V6h6v4a2 2 0 0 1-2 2Z",key:"1bmzmy"}],["path",{d:"M12 6V3a1 1 0 0 0-1-1H9a1 1 0 0 0-1 1v3",key:"1drr47"}]]),$e=Y("moon",[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",key:"kfwtm"}]]),Be=Y("network",[["rect",{x:"16",y:"16",width:"6",height:"6",rx:"1",key:"4q2zg0"}],["rect",{x:"2",y:"16",width:"6",height:"6",rx:"1",key:"8cvhb9"}],["rect",{x:"9",y:"2",width:"6",height:"6",rx:"1",key:"1egb70"}],["path",{d:"M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3",key:"1jsf9p"}],["path",{d:"M12 12V8",key:"2874zd"}]]),Ve=Y("package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]),Ye=Y("palette",[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]]),We=Y("pause",[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]]),Ke=Y("pen-tool",[["path",{d:"M15.707 21.293a1 1 0 0 1-1.414 0l-1.586-1.586a1 1 0 0 1 0-1.414l5.586-5.586a1 1 0 0 1 1.414 0l1.586 1.586a1 1 0 0 1 0 1.414z",key:"nt11vn"}],["path",{d:"m18 13-1.375-6.874a1 1 0 0 0-.746-.776L3.235 2.028a1 1 0 0 0-1.207 1.207L5.35 15.879a1 1 0 0 0 .776.746L13 18",key:"15qc1e"}],["path",{d:"m2.3 2.3 7.286 7.286",key:"1wuzzi"}],["circle",{cx:"11",cy:"11",r:"2",key:"xmgehs"}]]),Je=Y("pill",[["path",{d:"m10.5 20.5 10-10a4.95 4.95 0 1 0-7-7l-10 10a4.95 4.95 0 1 0 7 7Z",key:"wa1lgi"}],["path",{d:"m8.5 8.5 7 7",key:"rvfmvr"}]]),Qe=Y("play",[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]]),Xe=Y("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),Ze=Y("quote",[["path",{d:"M16 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z",key:"rib7q0"}],["path",{d:"M5 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z",key:"1ymkrd"}]]),et=Y("rewind",[["path",{d:"M12 6a2 2 0 0 0-3.414-1.414l-6 6a2 2 0 0 0 0 2.828l6 6A2 2 0 0 0 12 18z",key:"2a1g8i"}],["path",{d:"M22 6a2 2 0 0 0-3.414-1.414l-6 6a2 2 0 0 0 0 2.828l6 6A2 2 0 0 0 22 18z",key:"rg3s36"}]]),tt=Y("rotate-ccw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),nt=Y("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]),rt=Y("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]),at=Y("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]),it=Y("settings",[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),ot=Y("shield-check",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),st=Y("sparkles",[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]]),lt=Y("stethoscope",[["path",{d:"M11 2v2",key:"1539x4"}],["path",{d:"M5 2v2",key:"1yf1q8"}],["path",{d:"M5 3H4a2 2 0 0 0-2 2v4a6 6 0 0 0 12 0V5a2 2 0 0 0-2-2h-1",key:"rb5t3r"}],["path",{d:"M8 15a6 6 0 0 0 12 0v-3",key:"x18d4x"}],["circle",{cx:"20",cy:"10",r:"2",key:"ts1r5v"}]]),ct=Y("sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]),ut=Y("sunrise",[["path",{d:"M12 2v8",key:"1q4o3n"}],["path",{d:"m4.93 10.93 1.41 1.41",key:"2a7f42"}],["path",{d:"M2 18h2",key:"j10viu"}],["path",{d:"M20 18h2",key:"wocana"}],["path",{d:"m19.07 10.93-1.41 1.41",key:"15zs5n"}],["path",{d:"M22 22H2",key:"19qnx5"}],["path",{d:"m8 6 4-4 4 4",key:"ybng9g"}],["path",{d:"M16 18a4 4 0 0 0-8 0",key:"1lzouq"}]]),dt=Y("sunset",[["path",{d:"M12 10V2",key:"16sf7g"}],["path",{d:"m4.93 10.93 1.41 1.41",key:"2a7f42"}],["path",{d:"M2 18h2",key:"j10viu"}],["path",{d:"M20 18h2",key:"wocana"}],["path",{d:"m19.07 10.93-1.41 1.41",key:"15zs5n"}],["path",{d:"M22 22H2",key:"19qnx5"}],["path",{d:"m16 6-4 4-4-4",key:"6wukr"}],["path",{d:"M16 18a4 4 0 0 0-8 0",key:"1lzouq"}]]),pt=Y("tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]),ht=Y("target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),mt=Y("test-tube",[["path",{d:"M14.5 2v17.5c0 1.4-1.1 2.5-2.5 2.5c-1.4 0-2.5-1.1-2.5-2.5V2",key:"125lnx"}],["path",{d:"M8.5 2h7",key:"csnxdl"}],["path",{d:"M14.5 16h-5",key:"1ox875"}]]),ft=Y("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]),gt=Y("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),yt=Y("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),xt=Y("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),bt=Y("zoom-in",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),vt=Y("zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),wt=Y("zoom-out",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),Nt=18,Et=3,St=200,Ct=-800,kt=50,Tt={1:{name:"Core Concept",color:"#06b6d4",dark:"#0891b2",icon:""},2:{name:"Pathology",color:"#f43f5e",dark:"#e11d48",icon:""},3:{name:"Medication",color:"#8b5cf6",dark:"#7c3aed",icon:""},4:{name:"Anatomy",color:"#14b8a6",dark:"#0d9488",icon:""},5:{name:"Physiology",color:"#f59e0b",dark:"#d97706",icon:""},6:{name:"Diagnostic",color:"#3b82f6",dark:"#2563eb",icon:""},7:{name:"Clinical Sign",color:"#f97316",dark:"#ea580c",icon:""}},It=e=>Tt[e]||{name:"Other",color:"#64748b",dark:"#475569",icon:""},At=I.memo(({data:t,className:n,onNodeSelect:r,selectedNodeId:a})=>{const i=I.useRef(null),b=I.useRef(null),[v,w]=I.useState(""),[N,E]=I.useState(!1),[S,C]=I.useState(new Set([1,2,3,4,5,6,7])),[k,T]=I.useState(!0),[A,j]=I.useState("clustered"),[_,O]=I.useState(null),P=I.useRef(null),R=I.useRef(null),M=I.useRef(null),D=I.useRef(null),L=I.useRef(null),U=I.useRef(null),z=I.useRef(null),F=I.useMemo(()=>{let e=t.nodes.filter(e=>S.has(e.group));if(v.trim()){const t=v.toLowerCase();e=e.filter(e=>e.label.toLowerCase().includes(t)||e.description?.toLowerCase().includes(t))}const n=new Set(e.map(e=>e.id)),r=t.links.filter(e=>{const t="object"==typeof e.source?e.source.id:e.source,r="object"==typeof e.target?e.target.id:e.target;return n.has(t)&&n.has(r)});return{nodes:e.map(e=>({...e})),links:r.map(e=>({...e}))}},[t,S,v]),G=I.useMemo(()=>{if(!a)return new Set;const e=new Set;return F.links.forEach(t=>{const n="object"==typeof t.source?t.source.id:t.source,r="object"==typeof t.target?t.target.id:t.target;n===a&&e.add(r),r===a&&e.add(n)}),e},[a,F.links]),q=I.useMemo(()=>{const e={};return F.links.forEach(t=>{const n="object"==typeof t.source?t.source.id:t.source,r="object"==typeof t.target?t.target.id:t.target;e[n]=(e[n]||0)+1,e[r]=(e[r]||0)+1}),e},[F.links]),H=I.useCallback(e=>{const t=q[e.id]||0;return Nt+Math.min(t*Et,20)},[q]);I.useEffect(()=>{if(!i.current||!b.current||!F.nodes.length)return;const e=b.current.clientWidth,t=b.current.clientHeight,n=e/2,g=t/2;o(i.current).selectAll("*").remove();const y=o(i.current).attr("viewBox",[0,0,e,t]);U.current=y;const x=y.append("defs"),v=x.append("filter").attr("id","glow").attr("x","-50%").attr("y","-50%").attr("width","200%").attr("height","200%");v.append("feGaussianBlur").attr("stdDeviation",4).attr("result","coloredBlur");const w=v.append("feMerge");w.append("feMergeNode").attr("in","coloredBlur"),w.append("feMergeNode").attr("in","SourceGraphic");const N=x.append("filter").attr("id","strong-glow").attr("x","-50%").attr("y","-50%").attr("width","200%").attr("height","200%");N.append("feGaussianBlur").attr("stdDeviation",8).attr("result","coloredBlur");const E=N.append("feMerge");E.append("feMergeNode").attr("in","coloredBlur"),E.append("feMergeNode").attr("in","SourceGraphic"),Object.entries(Tt).forEach(([e,t])=>{const n=x.append("radialGradient").attr("id",`gradient-${e}`).attr("cx","30%").attr("cy","30%");n.append("stop").attr("offset","0%").attr("stop-color",t.color).attr("stop-opacity",1),n.append("stop").attr("offset","100%").attr("stop-color",t.dark).attr("stop-opacity",.9)}),x.append("marker").attr("id","arrow").attr("viewBox","0 -5 10 10").attr("refX",25).attr("refY",0).attr("markerWidth",5).attr("markerHeight",5).attr("orient","auto").append("path").attr("fill","#9ca3af").attr("d","M0,-5L10,0L0,5"),x.append("marker").attr("id","arrow-active").attr("viewBox","0 -5 10 10").attr("refX",25).attr("refY",0).attr("markerWidth",6).attr("markerHeight",6).attr("orient","auto").append("path").attr("fill","#ffffff").attr("d","M0,-5L10,0L0,5");const S=y.append("g");z.current=S;x.append("pattern").attr("id","grid").attr("width",60).attr("height",60).attr("patternUnits","userSpaceOnUse").append("circle").attr("cx",1).attr("cy",1).attr("r",1).attr("fill","rgba(255, 255, 255, 0.05)"),S.append("rect").attr("width",4*e).attr("height",4*t).attr("x",1.5*-e).attr("y",1.5*-t).attr("fill","url(#grid)").style("pointer-events","none");const C=s().scaleExtent([.1,4]).touchable(()=>!0).filter(e=>"dblclick"!==e.type&&("touchstart"===e.type||"touchmove"===e.type||"touchend"===e.type?!e.touches||e.touches.length>=2:!e.button)).on("zoom",e=>S.attr("transform",e.transform));y.call(C).on("dblclick.zoom",null),L.current=C;const T=F.nodes,I=F.links;T.forEach(e=>{e.x||(e.x=n+200*(Math.random()-.5)),e.y||(e.y=g+200*(Math.random()-.5))});const j=l(T).force("link",c(I).id(e=>e.id).distance(St)).force("charge",u().strength(Ct)).force("collide",d().radius(e=>H(e)+kt).strength(.8)).force("center",p(n,g).strength(.05)).force("bounds",()=>{const n=1.5*e,r=1.5*t;T.forEach(e=>{e.x>n&&(e.x=n),e.x<-n/2&&(e.x=-n/2),e.y>r&&(e.y=r),e.y<-r/2&&(e.y=-r/2)})});D.current=j;const _=S.append("g").attr("class","hulls"),P=S.append("g").attr("class","links").selectAll("path").data(I).join("path").attr("fill","none").attr("stroke","#374151").attr("stroke-width",1.5).attr("stroke-opacity",.3).attr("marker-end","url(#arrow)"),R=S.append("g").attr("class","link-labels").selectAll("g").data(I).join("g").attr("opacity",0);R.append("rect").attr("rx",4).attr("ry",4).attr("fill","#000").attr("fill-opacity",.7),R.append("text").text(e=>e.relationship).attr("font-family","Inter, sans-serif").attr("font-size","10px").attr("fill","#9ca3af").attr("text-anchor","middle").attr("dy","0.35em");const M=S.append("g").attr("class","nodes").selectAll("g").data(T).join("g").attr("cursor","pointer").call(h().touchable(()=>!0).on("start",(e,t)=>{e.sourceEvent&&(e.sourceEvent.stopPropagation(),e.sourceEvent.type?.startsWith("touch")&&e.sourceEvent.preventDefault()),e.active||j.alphaTarget(.3).restart(),t.fx=t.x,t.fy=t.y}).on("drag",(e,t)=>{t.fx=e.x,t.fy=e.y}).on("end",(e,t)=>{e.active||j.alphaTarget(0),t.id!==a&&(t.fx=null,t.fy=null)}));M.on("click",(e,t)=>{e.stopPropagation(),O(null),requestAnimationFrame(()=>{r(t.id===a?null:t)})}),M.on("touchend",(e,t)=>{if(e.defaultPrevented)return;const n=e.changedTouches?.[0];n&&(e.preventDefault(),e.stopPropagation(),O(null),requestAnimationFrame(()=>{r(t.id===a?null:t)}))}),M.on("mouseenter",function(e,t){t.id!==a&&O(t),o(this).select(".node-main").transition().duration(200).attr("filter",t.id===a?"url(#strong-glow)":"url(#glow)")}).on("mouseleave",function(e,t){O(null),o(this).select(".node-main").transition().duration(200).attr("filter",t.id===a?"url(#strong-glow)":null)}),M.append("circle").attr("class","node-ring").attr("r",e=>H(e)+6).attr("fill","none").attr("stroke",e=>It(e.group).color).attr("stroke-width",1).attr("stroke-opacity",.2).attr("stroke-dasharray","4,4"),M.append("circle").attr("class","node-main").attr("r",e=>H(e)).attr("fill",e=>`url(#gradient-${e.group})`).attr("stroke",e=>It(e.group).color).attr("stroke-width",2),M.append("text").attr("class","node-icon").text(e=>It(e.group).icon).attr("text-anchor","middle").attr("dominant-baseline","central").attr("font-size",e=>Math.max(12,.6*H(e))).attr("fill","white").style("pointer-events","none");const G=S.append("g").attr("class","labels").selectAll("g").data(T).join("g").style("opacity",k?1:0);return G.append("rect").attr("fill","rgba(0,0,0,0.6)").attr("rx",4).attr("ry",4).attr("stroke","#333").attr("stroke-width",.5),G.append("text").text(e=>e.label).attr("font-family","Inter, sans-serif").attr("font-size","11px").attr("font-weight","500").attr("fill","#e5e7eb").attr("text-anchor","middle").attr("dy","0.35em").each(function(e){const t=this.getBBox();o(this.parentNode).select("rect").attr("x",t.x-6).attr("y",t.y-4).attr("width",t.width+12).attr("height",t.height+8)}),j.on("tick",()=>{if("clustered"!==A||a)_.selectAll("path").remove();else{const e=m(T,e=>e.group),t=Array.from(e.entries());_.selectAll("path").data(t).join("path").attr("fill",e=>It(e[0]).color).attr("fill-opacity",.05).attr("stroke",e=>It(e[0]).color).attr("stroke-width",20).attr("stroke-linejoin","round").attr("stroke-opacity",.05).attr("d",e=>{const t=e[1].map(e=>[e.x,e.y]);if(t.length<3)return null;const n=f(t);return n?"M"+n.join("L")+"Z":null})}P.attr("d",e=>{const t=e.source,n=e.target,r=(t.x+n.x)/2,a=(t.y+n.y)/2,i=n.x-t.x,o=n.y-t.y,s=Math.sqrt(i*i+o*o),l=.1*s,c=r+-o/s*l,u=a+i/s*l;return`M${t.x},${t.y} Q${c},${u} ${n.x},${n.y}`}),R.attr("transform",e=>{const t=e.source,n=e.target,r=(t.x+n.x)/2,a=(t.y+n.y)/2,i=n.x-t.x,o=n.y-t.y,s=Math.sqrt(i*i+o*o),l=.1*s;return`translate(${r+-o/s*l},${a+i/s*l})`}),M.attr("transform",e=>`translate(${e.x},${e.y})`),G.attr("transform",e=>`translate(${e.x},${e.y+H(e)+20})`)}),()=>{j.stop()}},[F,H,r,k]),I.useEffect(()=>{if(!D.current||!b.current)return;const e=D.current,t=b.current.clientWidth/2,n=b.current.clientHeight/2;if(a?(e.alpha(.5).restart(),e.force("center",null),e.force("radial",null),e.force("cluster",null),e.force("radial",g(e=>e.id===a?0:G.has(e.id)?200:600,t,n).strength(e=>e.id===a?1:G.has(e.id)?.8:.6)),e.force("collide",d().radius(e=>H(e)+50).strength(1)),e.force("charge",u().strength(e=>e.id===a?-2e3:-1e3))):(e.force("center",p(t,n).strength(.05)),e.force("radial",null),"clustered"===A&&e.force("charge",u().strength(Ct)),e.alpha(.3).restart()),!z.current)return;const r=z.current,i=r.selectAll(".nodes g"),s=r.selectAll(".links path"),l=r.selectAll(".link-labels g"),c=r.selectAll(".labels g");if(!a)return i.style("opacity",1),i.select(".node-main").attr("filter",null).attr("stroke-width",2),i.select(".node-ring").attr("stroke-opacity",.2).attr("stroke",e=>It(e.group).color),s.attr("stroke","#374151").attr("stroke-opacity",.3).attr("stroke-width",1.5).attr("marker-end","url(#arrow)").attr("stroke-dasharray",null).classed("animate-flow",!1),l.transition().duration(200).attr("opacity",0),void c.style("opacity",k?1:0);i.transition().duration(400).style("opacity",e=>e.id===a||G.has(e.id)?1:.1),i.select(".node-main").transition().duration(400).attr("filter",e=>e.id===a?"url(#strong-glow)":G.has(e.id)?"url(#glow)":null).attr("stroke-width",e=>e.id===a?4:2),i.select(".node-ring").transition().duration(400).attr("stroke",e=>e.id===a?"#ffffff":It(e.group).color).attr("stroke-opacity",e=>e.id===a?.8:G.has(e.id)?.5:.1),s.transition().duration(400).attr("stroke",e=>{const t=e.source.id,n=e.target.id;return t===a||n===a?"#ffffff":"#374151"}).attr("stroke-opacity",e=>{const t=e.source.id,n=e.target.id;return t===a||n===a?1:.05}).attr("stroke-width",e=>{const t=e.source.id,n=e.target.id;return t===a||n===a?3:1}).attr("marker-end",e=>{const t=e.source.id,n=e.target.id;return t===a||n===a?"url(#arrow-active)":"url(#arrow)"}).on("end",function(e){const t=e.source.id,n=e.target.id;t!==a&&n!==a||o(this).attr("stroke-dasharray","10,5").classed("animate-flow",!0)}),l.transition().duration(400).attr("opacity",e=>{const t=e.source.id,n=e.target.id;return t===a||n===a?1:0}),c.transition().duration(400).style("opacity",e=>e.id===a||G.has(e.id)?1:0),U.current&&L.current&&U.current.transition().duration(800).call(L.current.transform,y.translate(t-t,n-n).scale(1))},[a,G,A]),I.useEffect(()=>{const e=e=>{N&&P.current&&R.current&&!P.current.contains(e.target)&&!R.current.contains(e.target)&&(E(!1),w(""),M.current&&M.current.blur())};return N&&(document.addEventListener("mousedown",e),M.current&&M.current.focus()),()=>{document.removeEventListener("mousedown",e)}},[N]),I.useEffect(()=>{const e=e=>{"Escape"===e.key&&N&&(E(!1),w(""),M.current&&M.current.blur())};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[N]);return e.jsxs("div",{ref:b,className:`relative overflow-hidden bg-[#030406] ${n}`,style:{touchAction:"none"},children:[e.jsx("style",{children:"\n            @keyframes flow {\n                to { stroke-dashoffset: -30; }\n            }\n            @keyframes fadeInUp {\n                from { opacity: 0; transform: translateX(-50%) translateY(10px); }\n                to { opacity: 1; transform: translateX(-50%) translateY(0); }\n            }\n            .animate-flow {\n                animation: flow 1s linear infinite;\n            }\n            \n            /* Touch device detection via media query */\n            @media (pointer: coarse) {\n              .touch-device\\:block { display: block !important; }\n              .touch-device\\:hidden { display: none !important; }\n            }\n            @media (pointer: fine) {\n              .touch-device\\:block { display: none !important; }\n            }\n            \n            /* Touch optimization for tablets/iPads */\n            .kg-touch-target {\n              touch-action: manipulation;\n              -webkit-tap-highlight-color: transparent;\n            }\n            \n            /* Tablet-optimized font sizes and touch targets */\n            @media (pointer: coarse) {\n              .kg-filter-pill {\n                min-height: 44px;\n                min-width: 44px;\n                padding: 0.75rem 1rem;\n                font-size: 12px; /* Larger font for tablet readability */\n              }\n              .kg-control-btn {\n                min-height: 44px;\n                min-width: 44px;\n              }\n              \n              /* Increase overall text sizes for tablet readability */\n              .kg-tablet-text {\n                font-size: 13px;\n              }\n              .kg-tablet-text-sm {\n                font-size: 11px;\n              }\n              .kg-tablet-text-lg {\n                font-size: 15px;\n              }\n            }\n            \n            /* Better tooltip positioning on touch devices */\n            @media (hover: none) {\n              .kg-tooltip {\n                display: none;\n              }\n            }\n\n            /* smooth width/opacity transition and improved caret/line-height for search input */\n            .kg-search-input {\n              transition: opacity 180ms ease, width 220ms cubic-bezier(.2,.9,.2,1);\n              font-size: 14px;\n              line-height: 20px; /* keep caret normal height */\n              height: 40px;\n              padding: 0 8px;\n              caret-color: #06b6d4; /* clinical cyan */\n              outline: none;\n              box-shadow: none;\n              border: none;\n              background: transparent;\n              appearance: none;\n            }\n\n            /* When collapsed, hide the caret completely without leaving artifacts */\n            .kg-search-input.caret-hidden {\n              caret-color: transparent !important;\n            }\n        "}),_&&e.jsx("div",{className:"absolute z-50 pointer-events-none",style:{left:0,top:0,transform:`translate(${_.x+20}px, ${_.y-20}px)`},children:e.jsxs("div",{className:"bg-black/80 backdrop-blur-xl border border-white/10 p-3 rounded-xl shadow-2xl min-w-[200px] animate-[fadeIn_0.2s_ease-out]",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"text-lg",children:It(_.group).icon}),e.jsx("span",{className:"text-xs font-bold uppercase tracking-wider",style:{color:It(_.group).color},children:It(_.group).name})]}),e.jsx("div",{className:"text-sm font-semibold text-white mb-1",children:_.label}),_.description&&e.jsx("div",{className:"text-[10px] text-gray-200 leading-relaxed mb-2 max-w-[200px]",children:_.description}),e.jsxs("div",{className:"flex items-center gap-2 pt-2 border-t border-white/10",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ue,{size:10,className:"text-gray-500"}),e.jsxs("span",{className:"text-[10px] text-gray-300",children:[q[_.id]||0," connections"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(vt,{size:10,className:"text-clinical-amber"}),e.jsxs("span",{className:"text-[10px] text-gray-300",children:[10*_.val,"% relevance"]})]})]})]})}),e.jsxs("div",{className:"absolute top-4 left-4 right-4 z-20 flex items-start justify-between gap-4 pointer-events-none",children:[e.jsxs("div",{className:"flex flex-col gap-3 pointer-events-auto",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("div",{className:"bg-black/70 backdrop-blur-lg px-3 py-2 rounded-lg border border-white/10 flex items-center gap-3 shadow-xl",children:[e.jsx(Q,{size:14,className:"text-clinical-cyan"}),e.jsxs("span",{className:"text-[11px] font-medium text-gray-200",children:[F.nodes.length," nodes "," ",F.links.length," connections"]})]})}),e.jsx("div",{className:"flex gap-2 flex-wrap max-w-[320px] md:max-w-[400px]",children:[1,2,3,4,5,6,7].map(t=>{const n=It(t),r=(e=>{switch(e){case 1:return ee;case 2:return gt;case 3:return Je;case 4:return Oe;case 5:return W;case 6:return mt;case 7:return lt;default:return de}})(t),a=S.has(t);return e.jsxs("button",{onClick:()=>(e=>{C(t=>{const n=new Set(t);return n.has(e)?n.size>1&&n.delete(e):n.add(e),n})})(t),className:`\n                      kg-filter-pill kg-touch-target flex items-center gap-1.5 px-2.5 py-1.5 rounded-md text-[10px] font-semibold tracking-wide uppercase transition-all border\n                      ${a?`bg-${n.color}/10 border-${n.color}/30 text-white shadow-[0_0_10px_rgba(0,0,0,0.3)]`:"bg-black/40 border-white/5 text-gray-300 hover:bg-white/5 hover:text-gray-200 active:bg-white/10"}\n                    `,style:{borderColor:a?n.color:void 0,backgroundColor:a?`${n.color}20`:void 0},children:[e.jsx(r,{size:12,className:a?"text-white":"text-gray-300"}),e.jsx("span",{className:"hidden sm:inline",children:n.name}),e.jsx("span",{className:"sm:hidden",children:n.name.split(" ")[0]})]},t)})})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-end sm:items-center gap-3 pointer-events-auto justify-end",children:[e.jsxs("div",{ref:R,className:"flex gap-2 items-center",style:{minWidth:0},children:[e.jsx("button",{onClick:()=>T(!k),className:"kg-control-btn kg-touch-target p-2.5 rounded-lg border transition-all "+(k?"bg-white/10 border-white/20 text-white":"bg-black/40 border-white/5 text-gray-500 active:bg-white/10"),title:"Toggle Labels (L)",children:k?e.jsx(be,{size:18}):e.jsx(xe,{size:18})}),e.jsx("button",{onClick:()=>{if(U.current&&L.current&&b.current){const e=U.current.node(),t=x(e),n=b.current.clientWidth/2,r=b.current.clientHeight/2,a=Math.min(1.5*t.k,4),i=a/t.k,o=n-(n-t.x)*i,s=r-(r-t.y)*i;U.current.transition().duration(300).call(L.current.transform,y.translate(o,s).scale(a))}},className:"kg-control-btn kg-touch-target p-2.5 rounded-lg bg-black/40 border border-white/5 text-gray-300 hover:text-white hover:bg-white/10 active:bg-white/15 transition-all",title:"Zoom In",children:e.jsx(bt,{size:18})}),e.jsx("button",{onClick:()=>{if(U.current&&L.current&&b.current){const e=U.current.node(),t=x(e),n=b.current.clientWidth/2,r=b.current.clientHeight/2,a=Math.max(.67*t.k,.1),i=a/t.k,o=n-(n-t.x)*i,s=r-(r-t.y)*i;U.current.transition().duration(300).call(L.current.transform,y.translate(o,s).scale(a))}},className:"kg-control-btn kg-touch-target p-2.5 rounded-lg bg-black/40 border border-white/5 text-gray-300 hover:text-white hover:bg-white/10 active:bg-white/15 transition-all",title:"Zoom Out",children:e.jsx(wt,{size:18})}),e.jsx("button",{onClick:()=>{U.current&&L.current&&U.current.transition().duration(500).call(L.current.transform,y)},className:"kg-control-btn kg-touch-target p-2.5 rounded-lg bg-black/40 border border-white/5 text-gray-300 hover:text-white hover:bg-white/10 active:bg-white/15 transition-all",title:"Reset View",children:e.jsx(tt,{size:18})})]}),e.jsxs("div",{ref:P,className:`\n                flex items-center bg-black/80 backdrop-blur-xl border border-white/10 rounded-lg overflow-hidden transition-all duration-300 shrink-0\n                ${N?"shadow-[0_0_20px_rgba(6,182,212,0.15)] ring-1 ring-clinical-cyan/30":"bg-transparent border-transparent"}\n             `,style:{width:N?256:40,minWidth:N?256:40},children:[e.jsx("button",{onClick:()=>{N?(E(!1),w(""),M.current&&M.current.blur()):E(!0)},className:"w-10 h-10 flex items-center justify-center text-gray-200 hover:text-white transition-colors flex-shrink-0",children:e.jsx(rt,{size:16})}),e.jsx("input",{type:"text",value:v,onChange:e=>w(e.target.value),ref:M,placeholder:"Search nodes...",className:`kg-search-input w-full bg-transparent border-none text-sm text-white placeholder-gray-400 focus:ring-0 h-10 pr-3 ${N?"opacity-100":"opacity-0"} ${N?"":"caret-hidden"}`,spellCheck:!1}),v&&e.jsx("button",{onClick:()=>w(""),className:"mr-2 text-gray-500 hover:text-white",children:e.jsx(xt,{size:12})})]})]})]}),e.jsx("svg",{ref:i,className:"w-full h-full cursor-grab active:cursor-grabbing",onClick:()=>{N&&(E(!1),w(""),M.current&&M.current.blur())}}),!a&&e.jsx("div",{className:"absolute bottom-10 left-1/2 -translate-x-1/2 glass-slide border border-white/[0.06] px-8 py-4 rounded-2xl shadow-2xl flex items-center gap-4 animate-[fadeInUp_0.5s_ease-out_1s_both] pointer-events-none",children:e.jsxs("div",{className:"flex items-center gap-3 text-gray-400",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-vital-cyan/60 animate-pulse"}),e.jsx("span",{className:"text-sm md:text-base font-medium",children:"Tap a node to explore"})]})}),e.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 pointer-events-none hidden touch-device:block",children:e.jsxs("div",{className:"bg-black/50 backdrop-blur-sm px-4 py-2 rounded-xl text-[10px] md:text-xs text-gray-500 font-mono flex items-center gap-3",children:[e.jsx("span",{children:"Pinch to zoom"}),e.jsx("span",{className:"w-1 h-1 rounded-full bg-gray-600"}),e.jsx("span",{children:"Drag to pan"}),e.jsx("span",{className:"w-1 h-1 rounded-full bg-gray-600"}),e.jsx("span",{children:"Tap node to select"})]})})]})}),jt=({script:t,audioBase64:n})=>{const[r,a]=I.useState(!1),[i,o]=I.useState(0),[s,l]=I.useState(0),c=I.useRef(null);I.useEffect(()=>{if(n){const e=atob(n),t=new Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);const r=new Uint8Array(t),a=new Blob([r],{type:"audio/wav"}),i=URL.createObjectURL(a);return c.current&&(c.current.src=i,c.current.load()),()=>{URL.revokeObjectURL(i)}}},[n]);return t&&0!==t.length?e.jsxs("div",{className:"bg-charcoal border-t border-glass-border p-4 flex flex-col gap-4 shadow-2xl z-40 relative",children:[e.jsx("audio",{ref:c,onTimeUpdate:()=>{c.current&&(o(c.current.currentTime),l(c.current.duration||0))},onEnded:()=>{a(!1),o(0)},className:"hidden"}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-clinical-slate uppercase tracking-wider",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(qe,{size:14,className:"text-clinical-rose "+(r?"animate-pulse":"")}),e.jsxs("span",{children:["Neural Audio (Gemini 2.5 Flash) "," ",r?"Speaking":"Paused"]})]}),e.jsxs("span",{children:[_t(i)," / ",_t(s)]})]}),e.jsxs("div",{className:"flex gap-4 items-center",children:[e.jsxs("div",{className:"flex -space-x-3 shrink-0",children:[e.jsx("div",{className:"w-12 h-12 rounded-full border-2 border-clinical-cyan bg-slate-800 flex items-center justify-center overflow-hidden",children:e.jsx("img",{src:"https://api.dicebear.com/7.x/avataaars/svg?seed=Professor&backgroundColor=b6e3f4",alt:"Prof"})}),e.jsx("div",{className:"w-12 h-12 rounded-full border-2 border-clinical-amber bg-slate-800 flex items-center justify-center overflow-hidden",children:e.jsx("img",{src:"https://api.dicebear.com/7.x/avataaars/svg?seed=Student&backgroundColor=ffdfbf",alt:"Stu"})})]}),e.jsx("div",{className:"flex-1 bg-obsidian/50 p-3 rounded-lg border border-glass-border relative overflow-hidden h-24 overflow-y-auto custom-scrollbar",children:t.map((t,n)=>e.jsxs("div",{className:"mb-2 text-sm",children:[e.jsxs("span",{className:"font-bold text-xs "+("Professor"===t.speaker?"text-clinical-cyan":"text-clinical-amber"),children:[t.speaker,":"," "]}),e.jsx("span",{className:"text-gray-200",children:t.text})]},n))})]}),e.jsxs("div",{className:"flex items-center justify-center gap-6",children:[e.jsx("button",{className:"text-gray-200 hover:text-white",onClick:()=>{c.current&&(c.current.currentTime-=10)},children:e.jsx(et,{size:20})}),n?e.jsx("button",{onClick:()=>{c.current&&(r?c.current.pause():c.current.play(),a(!r))},className:"w-12 h-12 rounded-full flex items-center justify-center transition-all shadow-lg "+(r?"bg-clinical-rose text-white shadow-clinical-rose/20":"bg-clinical-cyan text-black shadow-clinical-cyan/20 hover:scale-105"),children:r?e.jsx(We,{size:20,fill:"currentColor"}):e.jsx(Qe,{size:20,fill:"currentColor",className:"ml-1"})}):e.jsx("div",{className:"w-12 h-12 rounded-full bg-gray-800 flex items-center justify-center",children:e.jsx(ze,{className:"animate-spin text-gray-500",size:20})}),e.jsx("button",{className:"text-gray-200 hover:text-white",onClick:()=>{c.current&&(c.current.currentTime+=10)},children:e.jsx(ve,{size:20})})]})]}):null},_t=e=>{if(!e||isNaN(e))return"0:00";const t=Math.floor(e/60),n=Math.floor(e%60);return`${t}:${n<10?"0":""}${n}`},Ot=({isThinking:t,stage:n,currentThought:r,markdownProgress:a=0})=>{const[i,o]=I.useState(0),[s,l]=I.useState([]),[c,u]=I.useState(""),[d,p]=I.useState(!1),h=I.useRef(null),m=I.useRef(null),f=I.useRef(null),g="citing"===n;I.useEffect(()=>{if(t)return f.current=setInterval(()=>o(e=>e+.1),100),()=>{f.current&&(clearInterval(f.current),f.current=null)};f.current&&(clearInterval(f.current),f.current=null)},[t]),I.useEffect(()=>{t&&(l([]),u(""),o(0))},[t]),I.useEffect(()=>{if(!r||!r.trim())return;const e=r.trim();if(0===s.length||!s[s.length-1].includes(e.substring(0,50))){l(t=>{const n=[...t,e];return n.length>50?n.slice(-50):n}),p(!0);let t=c.length;const n=[...s,e].join("\n\n");m.current&&(clearInterval(m.current),m.current=null),m.current=setInterval(()=>{t<n.length?(u(n.substring(0,t+3)),t+=3):(u(n),p(!1),m.current&&(clearInterval(m.current),m.current=null))},10)}return()=>{m.current&&(clearInterval(m.current),m.current=null)}},[r]),I.useEffect(()=>{h.current&&requestAnimationFrame(()=>{h.current&&(h.current.scrollTop=h.current.scrollHeight)})},[c]);const y=I.useMemo(()=>(t=>{if(!t)return[];const n=[];let r=0;const a=/\*\*([^*]+)\*\*/g;let i,o=0;for(;null!==(i=a.exec(t));)i.index>o&&n.push(e.jsx("span",{className:"text-gray-200",children:t.substring(o,i.index)},r++)),n.push(e.jsx("span",{className:"block text-clinical-cyan font-semibold text-sm tracking-wide mt-3 mb-1 first:mt-0",children:i[1]},r++)),o=i.index+i[0].length;return o<t.length&&n.push(e.jsx("span",{className:"text-gray-300 leading-relaxed",children:t.substring(o)},r++)),n.length>0?n:[e.jsx("span",{className:"text-gray-300",children:t},"0")]})(c),[c]);if(!t)return null;const x={extracting:{icon:Se,title:"Extracting Content",subtitle:"READING & PARSING UPLOADED FILES",color:"clinical-cyan",gradient:"from-cyan-500/20 to-teal-500/10",phase:1,phaseStep:1},verifying:{icon:Ie,title:"Verifying Information",subtitle:"CROSS-REFERENCING WITH GOOGLE SEARCH",color:"clinical-teal",gradient:"from-teal-500/20 to-emerald-500/10",phase:1,phaseStep:2},graphing:{icon:Be,title:"Building Knowledge Graph",subtitle:"CONSTRUCTING CLINICAL CONSTELLATION",color:"clinical-purple",gradient:"from-purple-500/20 to-violet-500/10",phase:1,phaseStep:3},structuring:{icon:X,title:"Structuring Guide",subtitle:"PLANNING COMPREHENSIVE LAYOUT",color:"clinical-amber",gradient:"from-amber-500/20 to-yellow-500/10",phase:2,phaseStep:1},writing:{icon:Ke,title:"Writing Content",subtitle:"SYNTHESIZING DETAILED SECTIONS",color:"clinical-rose",gradient:"from-rose-500/20 to-pink-500/10",phase:2,phaseStep:2},citing:{icon:Ze,title:"Adding Citations",subtitle:"VERIFYING & LINKING SOURCES",color:"clinical-teal",gradient:"from-teal-500/20 to-cyan-500/10",phase:2,phaseStep:3}}[n],b=x.icon,v=2===x.phase,w=["extracting","verifying","graphing"],N=["structuring","writing","citing"],E=w.indexOf(n),S=N.indexOf(n);return e.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 bg-bio-void/20 backdrop-blur-xl"}),e.jsxs("div",{className:"absolute inset-0 pointer-events-none overflow-hidden",children:[e.jsx("div",{className:"absolute top-1/4 left-1/4 w-96 h-96 bg-vital-cyan/[0.03] rounded-full blur-[120px] animate-pulse",style:{animationDuration:"4s"}}),e.jsx("div",{className:"absolute bottom-1/4 right-1/4 w-96 h-96 bg-neural-purple/[0.03] rounded-full blur-[120px] animate-pulse",style:{animationDuration:"6s",animationDelay:"2s"}}),v&&e.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[700px] h-[700px] bg-synapse-amber/[0.02] rounded-full blur-[160px] animate-pulse",style:{animationDuration:"3s"}})]}),e.jsxs("div",{className:"relative w-full max-w-4xl mx-6 animate-[fadeIn_0.5s_ease-out]",children:[e.jsxs("div",{className:"flex justify-center gap-4 mb-8",children:[e.jsxs("div",{className:"flex items-center gap-2.5 px-5 py-2.5 rounded-2xl border transition-all duration-500 "+(1===x.phase?"bg-vital-cyan/10 border-vital-cyan/30 text-vital-cyan shadow-[0_0_30px_rgba(42,212,212,0.2)]":"bg-vital-cyan/5 border-vital-cyan/20 text-vital-cyan/70"),children:[x.phase>1?e.jsx(le,{size:14,className:"text-vital-cyan"}):e.jsx(Be,{size:14,className:"animate-pulse"}),e.jsx("span",{className:"text-xs font-mono tracking-wider",children:"Phase 1: Graph"})]}),e.jsxs("div",{className:"flex items-center gap-2.5 px-5 py-2.5 rounded-2xl border transition-all duration-500 "+(2===x.phase?"bg-synapse-amber/10 border-synapse-amber/30 text-synapse-amber shadow-[0_0_30px_rgba(240,180,41,0.2)]":"bg-white/[0.02] border-white/[0.06] text-gray-500"),children:[2===x.phase?e.jsx(st,{size:14,className:"animate-pulse"}):e.jsx("div",{className:"w-3.5 h-3.5 rounded-full border border-gray-500"}),e.jsx("span",{className:"text-xs font-mono tracking-wider",children:"Phase 2: Guide"})]})]}),e.jsxs("div",{className:"relative glass-slide border border-white/[0.08] rounded-3xl overflow-hidden shadow-2xl transition-all duration-500",children:[e.jsxs("div",{className:"relative px-8 pt-8 pb-6 border-b border-white/[0.04]",children:[e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 blur-xl rounded-full animate-pulse",style:{backgroundColor:v?"rgba(240, 180, 41, 0.3)":"rgba(42, 212, 212, 0.3)"}}),e.jsx("div",{className:"relative w-16 h-16 rounded-2xl bg-white/[0.05] border border-white/[0.1] flex items-center justify-center transition-all duration-300 "+(v?"shadow-[0_0_40px_rgba(240,180,41,0.3)]":"shadow-[0_0_40px_rgba(42,212,212,0.3)]"),children:e.jsx(b,{size:32,className:"text-serum-white transition-all duration-300",style:{animation:"verifying"===n||"citing"===n?"spin 3s linear infinite":"writing"===n?"pulse 1s ease-in-out infinite":"pulse 2s ease-in-out infinite"}})})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"text-2xl font-serif font-light text-serum-white tracking-tight mb-2 transition-all duration-300",children:x.title}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-2 h-2 rounded-full animate-pulse shadow-[0_0_10px_currentColor] "+(v?"bg-synapse-amber":"bg-vital-cyan")}),e.jsx("span",{className:"text-[10px] font-mono text-gray-300 tracking-[0.2em] transition-all duration-300",children:x.subtitle})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-3xl font-mono font-light text-serum-white tabular-nums",children:[i.toFixed(1),"s"]}),v&&a>0&&e.jsxs("div",{className:"text-[10px] font-mono text-synapse-amber tracking-wider mt-1",children:[(a/1e3).toFixed(1),"K chars"]})]})]}),v&&e.jsxs("div",{className:"mt-6",children:[e.jsxs("div",{className:"flex justify-between text-[10px] font-mono text-gray-500 mb-2",children:[e.jsx("span",{children:"MARKDOWN GENERATION"}),e.jsx("span",{children:g?"100%":a>0?`${(a/1e3).toFixed(1)}K chars`:"Starting..."})]}),e.jsx("div",{className:"h-2 bg-white/[0.04] rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full rounded-full transition-all "+(g?"w-full bg-vital-cyan shadow-[0_0_10px_rgba(42,212,212,0.5)]":"bg-synapse-amber shadow-[0_0_10px_rgba(240,180,41,0.5)]"),style:{width:g?"100%":a>0?`${Math.min(Math.max(a/45e3*100,3),98)}%`:"3%",transitionDuration:g?"600ms":"300ms",transitionTimingFunction:"cubic-bezier(0.4, 0, 0.2, 1)"}})})]})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"px-8 pt-6 pb-3 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Le,{size:14,className:"text-white/60"}),e.jsx("span",{className:"text-xs font-semibold text-gray-300 uppercase tracking-wider",children:v?"Synthesis Reasoning":"Gemini's Reasoning"})]}),s.length>0&&e.jsxs("span",{className:"text-[10px] font-mono text-gray-500",children:[s.length," thought",1!==s.length?"s":""," captured"]})]}),e.jsx("div",{ref:h,className:"h-[280px] overflow-y-auto px-8 pb-6 scroll-smooth custom-scrollbar",children:c?e.jsxs("div",{className:"font-mono text-sm leading-relaxed",children:[y,d&&e.jsx("span",{className:"inline-block w-2 h-4 bg-white ml-0.5 animate-pulse"})]}):e.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-center",children:[e.jsx("div",{className:"flex gap-1.5 mb-4",children:[0,1,2].map(t=>e.jsx("div",{className:"w-2 h-2 bg-white/40 rounded-full animate-bounce",style:{animationDelay:.15*t+"s"}},t))}),e.jsx("p",{className:"text-gray-500 text-sm font-mono",children:"extracting"===n?"Parsing uploaded content...":"verifying"===n?"Cross-referencing sources...":"graphing"===n?"Building knowledge connections...":"structuring"===n?"Planning guide structure...":"writing"===n?"Synthesizing content...":"Verifying citations..."})]})}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-12 bg-gradient-to-t from-black/40 to-transparent pointer-events-none"})]}),e.jsx("div",{className:"px-8 py-4 border-t border-white/5 bg-black/20",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[w.map((t,r)=>{const a=2===x.phase||1===x.phase&&r<E,i=t===n;return e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full transition-all duration-300 "+(a?"bg-clinical-teal shadow-[0_0_6px_rgba(20,184,166,0.8)]":i?"bg-white shadow-[0_0_6px_white]":"bg-gray-700")}),e.jsx("span",{className:"text-[8px] font-mono uppercase tracking-wider transition-all duration-300 "+(a?"text-clinical-teal":i?"text-white":"text-gray-500"),children:"extracting"===t?"Extract":"verifying"===t?"Verify":"Graph"})]},t)}),e.jsx("div",{className:"w-px h-3 bg-gray-700 mx-1"}),N.map((t,r)=>{const a=2===x.phase&&r<S,i=t===n;return e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full transition-all duration-300 "+(a?"bg-clinical-teal shadow-[0_0_6px_rgba(20,184,166,0.8)]":i?"bg-white shadow-[0_0_6px_white]":"bg-gray-700")}),e.jsx("span",{className:"text-[8px] font-mono uppercase tracking-wider transition-all duration-300 "+(a?"text-clinical-teal":i?"text-white":"text-gray-500"),children:"structuring"===t?"Plan":"writing"===t?"Write":"Cite"})]},t)})]}),e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 rounded-full bg-white/5 border border-white/10",children:[e.jsx(vt,{size:12,className:"text-clinical-amber"}),e.jsx("span",{className:"text-[10px] font-mono text-gray-300 tracking-wide",children:"GEMINI 2.5 FLASH"})]})]})})]})]}),e.jsx("style",{children:"\n        .custom-scrollbar::-webkit-scrollbar { width: 4px; }\n        .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }\n        .custom-scrollbar::-webkit-scrollbar-thumb { background: rgba(255, 255, 255, 0.1); border-radius: 2px; }\n        @keyframes fadeIn { from { opacity: 0; transform: scale(0.95); } to { opacity: 1; transform: scale(1); } }\n      "})]})},Pt={1:{text:"text-clinical-cyan",border:"border-clinical-cyan",bg:"bg-clinical-cyan",hex:"#06b6d4"},2:{text:"text-clinical-rose",border:"border-clinical-rose",bg:"bg-clinical-rose",hex:"#f43f5e"},3:{text:"text-clinical-purple",border:"border-clinical-purple",bg:"bg-clinical-purple",hex:"#8b5cf6"},4:{text:"text-clinical-teal",border:"border-clinical-teal",bg:"bg-clinical-teal",hex:"#14b8a6"},5:{text:"text-clinical-amber",border:"border-clinical-amber",bg:"bg-clinical-amber",hex:"#f59e0b"},6:{text:"text-blue-400",border:"border-blue-400",bg:"bg-blue-400",hex:"#3b82f6"},7:{text:"text-orange-400",border:"border-orange-400",bg:"bg-orange-400",hex:"#f97316"}},Rt={text:"text-gray-300",border:"border-gray-400",bg:"bg-gray-400",hex:"#9ca3af"},Mt={1:ee,2:gt,3:Je,4:Oe,5:W,6:mt,7:lt},Dt={1:"Core Concept",2:"Pathology",3:"Medication",4:"Anatomy",5:"Physiology",6:"Diagnostic",7:"Clinical Sign"},Lt=e=>Pt[e]||Rt,Ut=I.memo(({node:r,graphData:a,onClose:i,onNodeClick:o})=>{const[s,l]=I.useState(null),[c,u]=I.useState("details"),{outgoingLinks:d,incomingLinks:p,connectionCount:h}=I.useMemo(()=>{if(!r)return{outgoingLinks:[],incomingLinks:[],connectionCount:0};const e=a.links.filter(e=>e.source===r.id||"object"==typeof e.source&&e.source.id===r.id),t=a.links.filter(e=>e.target===r.id||"object"==typeof e.target&&e.target.id===r.id);return{outgoingLinks:e,incomingLinks:t,connectionCount:e.length+t.length}},[r?.id,a.links]),m=I.useMemo(()=>r?Lt(r.group):Rt,[r?.group]),f=I.useMemo(()=>{return r?(e=r.group,Mt[e]||de):de;var e},[r?.group]),g=I.useMemo(()=>{return r?(e=r.group,Dt[e]||"Entity"):"Entity";var e},[r?.group]),y=I.useCallback((e,t)=>{navigator.clipboard.writeText(e),l(t),setTimeout(()=>l(null),2e3)},[]);return r?e.jsx("div",{className:"fixed inset-y-0 right-0 w-[520px] z-30 animate-[slideInRight_0.35s_cubic-bezier(0.16,1,0.3,1)] pointer-events-none",children:e.jsxs("div",{className:"h-full bg-[#030406] backdrop-blur-3xl border-l border-white/[0.06] shadow-[-40px_0_80px_rgba(0,0,0,0.9)] flex flex-col pointer-events-auto relative",children:[e.jsx("div",{className:"absolute -top-20 -right-20 w-80 h-80 rounded-full opacity-30 blur-3xl pointer-events-none",style:{background:`radial-gradient(circle, ${m.hex}25 0%, transparent 70%)`}}),e.jsxs("div",{className:"p-6 pb-4 border-b border-white/[0.06] relative z-10",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:`inline-flex items-center gap-2 px-3 py-1.5 rounded-md border backdrop-blur-sm ${m.border}/30 ${m.text} bg-black/40`,children:[e.jsx(f,{size:12,strokeWidth:2.5}),e.jsx("span",{className:"text-[9px] font-black tracking-widest uppercase",children:g})]}),e.jsx("button",{onClick:i,className:"p-2 text-gray-300 hover:text-white hover:bg-white/5 rounded-lg transition-all",children:e.jsx(xt,{size:16})})]}),e.jsx("h2",{className:"text-4xl font-sans font-medium text-white leading-tight tracking-tight mb-3",children:r.label}),r.description&&e.jsx("p",{className:"text-[15px] text-gray-100 leading-relaxed",children:r.description}),r.synonyms&&r.synonyms.length>0&&e.jsxs("div",{className:"flex items-center gap-2 mt-4 flex-wrap",children:[e.jsx(pt,{size:11,className:"text-gray-400"}),r.synonyms.map((t,n)=>e.jsx("span",{className:"text-[12px] px-2.5 py-1 bg-white/5 border border-white/10 rounded text-gray-300",children:t},n))]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mt-6 pt-5 border-t border-white/[0.06]",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-[10px] text-gray-400 uppercase tracking-widest block mb-2",children:"Links"}),e.jsx("span",{className:"text-2xl font-mono font-light text-white",children:h})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-[10px] text-gray-400 uppercase tracking-widest block mb-2",children:"Weight"}),e.jsxs("span",{className:"text-2xl font-mono font-light text-white",children:[r.val,e.jsx("span",{className:"text-xs text-gray-400",children:"/20"})]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-[10px] text-gray-400 uppercase tracking-widest block mb-2",children:"ID"}),e.jsxs("button",{onClick:()=>y(r.id,r.id),className:"flex items-center gap-1 text-[11px] font-mono text-gray-300 hover:text-white transition-all",children:[s===r.id?e.jsx(re,{size:10,className:"text-green-500"}):e.jsx(fe,{size:10}),e.jsx("span",{className:"truncate max-w-[70px]",children:r.id})]})]})]})]}),e.jsx("div",{className:"flex border-b border-white/[0.06] px-6",children:[{id:"details",label:"Clinical",icon:Ce},{id:"network",label:"Network",icon:st},{id:"resources",label:"Resources",icon:X}].map(t=>e.jsxs("button",{onClick:()=>u(t.id),className:"flex items-center gap-2 px-4 py-3 text-[11px] font-bold uppercase tracking-wider border-b-2 transition-all "+(c===t.id?`${m.text} border-current`:"text-gray-400 border-transparent hover:text-gray-300"),children:[e.jsx(t.icon,{size:13}),t.label]},t.id))}),e.jsxs("div",{className:"flex-1 overflow-y-auto px-6 py-5 space-y-6",children:["details"===c&&e.jsxs(e.Fragment,{children:[r.clinicalPearl&&e.jsxs("div",{className:"p-4 rounded-lg bg-gradient-to-r from-amber-500/10 to-transparent border border-amber-500/20",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(Le,{size:15,className:"text-amber-400"}),e.jsx("span",{className:"text-[11px] font-bold text-amber-300 uppercase tracking-wider",children:"High-Yield Pearl"})]}),e.jsx("p",{className:"text-[15px] text-gray-100 leading-relaxed",children:r.clinicalPearl})]}),r.details&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-[11px] font-bold text-gray-200 uppercase tracking-widest flex items-center gap-2 pb-3 border-b border-white/[0.06]",children:[e.jsx(He,{size:13,className:"text-clinical-cyan"}),"In-Depth Analysis"]}),e.jsx("div",{className:"prose prose-sm prose-invert max-w-none text-[15.7px] leading-relaxed",style:{fontFamily:'"Source Sans 3", "Plus Jakarta Sans", "DM Sans", system-ui, sans-serif'},children:e.jsx(t,{remarkPlugins:[n],components:{p:({children:t})=>e.jsx("p",{className:"mb-4 text-gray-100",children:t}),strong:({children:t})=>e.jsx("strong",{className:"text-white font-semibold",children:t}),em:({children:t})=>e.jsx("em",{className:"text-clinical-cyan",children:t}),ul:({children:t})=>e.jsx("ul",{className:"list-disc pl-5 space-y-2",children:t}),li:({children:t})=>e.jsx("li",{className:"text-gray-100",children:t})},children:r.details})})]}),r.differentials&&r.differentials.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"text-[11px] font-bold text-gray-300 uppercase tracking-widest",children:"Differential Diagnosis"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:r.differentials.map((t,n)=>e.jsx("span",{className:"text-[13px] px-3 py-1.5 bg-clinical-rose/10 border border-clinical-rose/20 text-clinical-rose/90 rounded",children:t},n))})]})]}),"network"===c&&e.jsxs(e.Fragment,{children:[d.length>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-[11px] font-bold text-emerald-400 uppercase tracking-wider",children:[e.jsx(J,{size:13}),"Downstream (",d.length,")"]}),e.jsx("div",{className:"space-y-2",children:d.map((t,n)=>{const r="object"==typeof t.target?t.target.id:t.target,i=a.nodes.find(e=>e.id===r);if(!i)return null;const s=Lt(i.group);return e.jsxs("button",{onClick:()=>o(i.id),className:"w-full group flex items-center gap-3 p-3 rounded-lg bg-white/[0.02] hover:bg-white/[0.06] border border-white/[0.04] hover:border-white/[0.1] transition-all text-left",children:[e.jsx("div",{className:`w-1.5 h-8 rounded-full ${s.bg}/50`}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-[10px] text-gray-400 font-mono uppercase",children:t.relationship}),e.jsx("div",{className:"text-[15px] text-gray-100 group-hover:text-white truncate",children:i.label})]}),e.jsx(ie,{size:14,className:"text-gray-500 group-hover:text-white opacity-0 group-hover:opacity-100 transition-all"})]},n)})})]}),p.length>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-[11px] font-bold text-amber-400 uppercase tracking-wider",children:[e.jsx(K,{size:13}),"Upstream (",p.length,")"]}),e.jsx("div",{className:"space-y-2",children:p.map((t,n)=>{const r="object"==typeof t.source?t.source.id:t.source,i=a.nodes.find(e=>e.id===r);if(!i)return null;const s=Lt(i.group);return e.jsxs("button",{onClick:()=>o(i.id),className:"w-full group flex items-center gap-3 p-3 rounded-lg bg-white/[0.02] hover:bg-white/[0.06] border border-white/[0.04] hover:border-white/[0.1] transition-all text-left",children:[e.jsx("div",{className:`w-1.5 h-8 rounded-full ${s.bg}/50`}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-[10px] text-gray-400 font-mono uppercase",children:t.relationship}),e.jsx("div",{className:"text-[15px] text-gray-100 group-hover:text-white truncate",children:i.label})]}),e.jsx(ie,{size:14,className:"text-gray-500 group-hover:text-white opacity-0 group-hover:opacity-100 transition-all"})]},n)})})]}),0===h&&e.jsx("div",{className:"text-center py-10 text-gray-400 text-[15px]",children:"No connections found for this node."})]}),"resources"===c&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("a",{href:`https://pubmed.ncbi.nlm.nih.gov/?term=${encodeURIComponent(r.label)}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-4 p-4 rounded-lg bg-clinical-cyan/5 border border-clinical-cyan/20 hover:bg-clinical-cyan/10 transition-all group",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-clinical-cyan/20 flex items-center justify-center flex-shrink-0",children:e.jsx(X,{size:18,className:"text-clinical-cyan"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-[15px] font-medium text-white group-hover:text-clinical-cyan transition-colors",children:"PubMed"}),e.jsx("div",{className:"text-[12px] text-gray-400",children:"Search peer-reviewed literature"})]}),e.jsx(ye,{size:14,className:"text-gray-500 group-hover:text-clinical-cyan flex-shrink-0"})]}),e.jsxs("a",{href:`https://www.uptodate.com/contents/search?search=${encodeURIComponent(r.label)}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-4 p-4 rounded-lg bg-white/[0.02] border border-white/[0.06] hover:bg-white/[0.05] transition-all group",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-white/5 flex items-center justify-center flex-shrink-0",children:e.jsx(Ce,{size:18,className:"text-gray-300"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-[15px] font-medium text-white",children:"UpToDate"}),e.jsx("div",{className:"text-[12px] text-gray-400",children:"Evidence-based clinical resource"})]}),e.jsx(ye,{size:14,className:"text-gray-500 flex-shrink-0"})]}),e.jsxs("a",{href:`https://radiopaedia.org/search?utf8=%E2%9C%93&q=${encodeURIComponent(r.label)}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-4 p-4 rounded-lg bg-white/[0.02] border border-white/[0.06] hover:bg-white/[0.05] transition-all group",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-white/5 flex items-center justify-center flex-shrink-0",children:e.jsx(He,{size:18,className:"text-gray-300"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-[15px] font-medium text-white",children:"Radiopaedia"}),e.jsx("div",{className:"text-[12px] text-gray-400",children:"Medical imaging reference"})]}),e.jsx(ye,{size:14,className:"text-gray-500 flex-shrink-0"})]}),e.jsxs("a",{href:`https://www.google.com/search?q=${encodeURIComponent(r.label+" pathophysiology site:ncbi.nlm.nih.gov OR site:who.int")}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-4 p-4 rounded-lg bg-white/[0.02] border border-white/[0.06] hover:bg-white/[0.05] transition-all group",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-white/5 flex items-center justify-center flex-shrink-0",children:e.jsx(rt,{size:18,className:"text-gray-300"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-[15px] font-medium text-white",children:"Scholar Search"}),e.jsx("div",{className:"text-[12px] text-gray-400",children:"NIH & WHO sources only"})]}),e.jsx(ye,{size:14,className:"text-gray-500 flex-shrink-0"})]})]})]})]})}):null});
/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */
let zt,Ft;function Gt(e,t,n,r){var a,i;if(!(null==e?void 0:e.baseUrl)){const e={geminiUrl:zt,vertexUrl:Ft};return t?null!==(a=e.vertexUrl)&&void 0!==a?a:n:null!==(i=e.geminiUrl)&&void 0!==i?i:r}return e.baseUrl}
/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */Ut.displayName="NodeInspector";class qt{}function Ht(e,t){return e.replace(/\{([^}]+)\}/g,(e,n)=>{if(Object.prototype.hasOwnProperty.call(t,n)){const e=t[n];return null!=e?String(e):""}throw new Error(`Key '${n}' not found in valueMap.`)})}function $t(e,t,n){for(let i=0;i<t.length-1;i++){const r=t[i];if(r.endsWith("[]")){const a=r.slice(0,-2);if(!(a in e)){if(!Array.isArray(n))throw new Error(`Value must be a list given an array path ${r}`);e[a]=Array.from({length:n.length},()=>({}))}if(Array.isArray(e[a])){const r=e[a];if(Array.isArray(n))for(let e=0;e<r.length;e++){$t(r[e],t.slice(i+1),n[e])}else for(const e of r)$t(e,t.slice(i+1),n)}return}if(r.endsWith("[0]")){const a=r.slice(0,-3);a in e||(e[a]=[{}]);return void $t(e[a][0],t.slice(i+1),n)}e[r]&&"object"==typeof e[r]||(e[r]={}),e=e[r]}const r=t[t.length-1],a=e[r];if(void 0!==a){if(!n||"object"==typeof n&&0===Object.keys(n).length)return;if(n===a)return;if("object"!=typeof a||"object"!=typeof n||null===a||null===n)throw new Error(`Cannot set value for an existing key. Key: ${r}`);Object.assign(a,n)}else if("_self"!==r||"object"!=typeof n||null===n||Array.isArray(n))e[r]=n;else{const t=n;Object.assign(e,t)}}function Bt(e,t,n=void 0){try{if(1===t.length&&"_self"===t[0])return e;for(let r=0;r<t.length;r++){if("object"!=typeof e||null===e)return n;const a=t[r];if(a.endsWith("[]")){const i=a.slice(0,-2);if(i in e){const a=e[i];return Array.isArray(a)?a.map(e=>Bt(e,t.slice(r+1),n)):n}return n}e=e[a]}return e}catch(r){if(r instanceof TypeError)return n;throw r}}function Vt(e,t,n,r,a){if(r>=t.length)return;if("object"!=typeof e||null===e)return;const i=t[r];if(i.endsWith("[]")){const o=i.slice(0,-2),s=e;if(o in s&&Array.isArray(s[o]))for(const e of s[o])Vt(e,t,n,r+1,a)}else if("*"===i){if("object"==typeof e&&null!==e&&!Array.isArray(e)){const t=e,i=Object.keys(t).filter(e=>!e.startsWith("_")&&!a.has(e)),o={};for(const e of i)o[e]=t[e];for(const[e,a]of Object.entries(o)){const i=[];for(const t of n.slice(r))"*"===t?i.push(e):i.push(t);$t(t,i,a)}for(const e of i)delete t[e]}}else{i in e&&Vt(e[i],t,n,r+1,a)}}
/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Yt(e){if("string"!=typeof e)throw new Error("fromImageBytes must be a string");return e}
/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Wt(e){const t={},n=Bt(e,["name"]);null!=n&&$t(t,["name"],n);const r=Bt(e,["metadata"]);null!=r&&$t(t,["metadata"],r);const a=Bt(e,["done"]);null!=a&&$t(t,["done"],a);const i=Bt(e,["error"]);null!=i&&$t(t,["error"],i);const o=Bt(e,["response","generateVideoResponse"]);return null!=o&&$t(t,["response"],function(e){const t={},n=Bt(e,["generatedSamples"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=Bt(e,["video"]);null!=n&&$t(t,["video"],function(e){const t={},n=Bt(e,["uri"]);null!=n&&$t(t,["uri"],n);const r=Bt(e,["encodedVideo"]);null!=r&&$t(t,["videoBytes"],Yt(r));const a=Bt(e,["encoding"]);null!=a&&$t(t,["mimeType"],a);return t}(n));return t}(e))),$t(t,["generatedVideos"],e)}const r=Bt(e,["raiMediaFilteredCount"]);null!=r&&$t(t,["raiMediaFilteredCount"],r);const a=Bt(e,["raiMediaFilteredReasons"]);null!=a&&$t(t,["raiMediaFilteredReasons"],a);return t}(o)),t}function Kt(e){const t={},n=Bt(e,["name"]);null!=n&&$t(t,["name"],n);const r=Bt(e,["metadata"]);null!=r&&$t(t,["metadata"],r);const a=Bt(e,["done"]);null!=a&&$t(t,["done"],a);const i=Bt(e,["error"]);null!=i&&$t(t,["error"],i);const o=Bt(e,["response"]);return null!=o&&$t(t,["response"],function(e){const t={},n=Bt(e,["videos"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=Bt(e,["_self"]);null!=n&&$t(t,["video"],function(e){const t={},n=Bt(e,["gcsUri"]);null!=n&&$t(t,["uri"],n);const r=Bt(e,["bytesBase64Encoded"]);null!=r&&$t(t,["videoBytes"],Yt(r));const a=Bt(e,["mimeType"]);null!=a&&$t(t,["mimeType"],a);return t}
/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */(n));return t}(e))),$t(t,["generatedVideos"],e)}const r=Bt(e,["raiMediaFilteredCount"]);null!=r&&$t(t,["raiMediaFilteredCount"],r);const a=Bt(e,["raiMediaFilteredReasons"]);null!=a&&$t(t,["raiMediaFilteredReasons"],a);return t}(o)),t}function Jt(e){const t={},n=Bt(e,["name"]);null!=n&&$t(t,["name"],n);const r=Bt(e,["metadata"]);null!=r&&$t(t,["metadata"],r);const a=Bt(e,["done"]);null!=a&&$t(t,["done"],a);const i=Bt(e,["error"]);null!=i&&$t(t,["error"],i);const o=Bt(e,["response"]);return null!=o&&$t(t,["response"],function(e){const t={},n=Bt(e,["sdkHttpResponse"]);null!=n&&$t(t,["sdkHttpResponse"],n);const r=Bt(e,["parent"]);null!=r&&$t(t,["parent"],r);const a=Bt(e,["documentName"]);null!=a&&$t(t,["documentName"],a);return t}(o)),t}function Qt(e){const t={},n=Bt(e,["name"]);null!=n&&$t(t,["name"],n);const r=Bt(e,["metadata"]);null!=r&&$t(t,["metadata"],r);const a=Bt(e,["done"]);null!=a&&$t(t,["done"],a);const i=Bt(e,["error"]);null!=i&&$t(t,["error"],i);const o=Bt(e,["response"]);return null!=o&&$t(t,["response"],function(e){const t={},n=Bt(e,["sdkHttpResponse"]);null!=n&&$t(t,["sdkHttpResponse"],n);const r=Bt(e,["parent"]);null!=r&&$t(t,["parent"],r);const a=Bt(e,["documentName"]);null!=a&&$t(t,["documentName"],a);return t}(o)),t}var Xt,Zt,en,tn,nn,rn,an,on,sn,ln,cn,un,dn,pn,hn,mn,fn,gn,yn,xn,bn,vn,wn,Nn,En,Sn,Cn,kn,Tn,In,An,jn,_n,On,Pn,Rn,Mn,Dn,Ln,Un,zn,Fn,Gn,qn,Hn,$n,Bn,Vn,Yn,Wn,Kn,Jn,Qn,Xn,Zn,er,tr,nr,rr,ar,ir,or,sr,lr,cr,ur,dr,pr,hr,mr,fr,gr,yr,xr,br,vr,wr,Nr,Er,Sr,Cr,kr,Tr,Ir,Ar,jr,_r,Or,Pr,Rr,Mr,Dr,Lr,Ur,zr,Fr,Gr,qr,Hr,$r,Br,Vr,Yr,Wr,Kr,Jr,Qr,Xr,Zr,ea,ta,na;(Zt=Xt||(Xt={})).OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",Zt.OUTCOME_OK="OUTCOME_OK",Zt.OUTCOME_FAILED="OUTCOME_FAILED",Zt.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED",(tn=en||(en={})).LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",tn.PYTHON="PYTHON",(rn=nn||(nn={})).SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",rn.SILENT="SILENT",rn.WHEN_IDLE="WHEN_IDLE",rn.INTERRUPT="INTERRUPT",(on=an||(an={})).TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",on.STRING="STRING",on.NUMBER="NUMBER",on.INTEGER="INTEGER",on.BOOLEAN="BOOLEAN",on.ARRAY="ARRAY",on.OBJECT="OBJECT",on.NULL="NULL",(ln=sn||(sn={})).MODE_UNSPECIFIED="MODE_UNSPECIFIED",ln.MODE_DYNAMIC="MODE_DYNAMIC",(un=cn||(cn={})).API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",un.SIMPLE_SEARCH="SIMPLE_SEARCH",un.ELASTIC_SEARCH="ELASTIC_SEARCH",(pn=dn||(dn={})).AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",pn.NO_AUTH="NO_AUTH",pn.API_KEY_AUTH="API_KEY_AUTH",pn.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",pn.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",pn.OAUTH="OAUTH",pn.OIDC_AUTH="OIDC_AUTH",(mn=hn||(hn={})).HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",mn.HTTP_IN_QUERY="HTTP_IN_QUERY",mn.HTTP_IN_HEADER="HTTP_IN_HEADER",mn.HTTP_IN_PATH="HTTP_IN_PATH",mn.HTTP_IN_BODY="HTTP_IN_BODY",mn.HTTP_IN_COOKIE="HTTP_IN_COOKIE",(gn=fn||(fn={})).PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",gn.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",gn.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",gn.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",gn.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",gn.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",gn.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH",(xn=yn||(yn={})).THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",xn.LOW="LOW",xn.HIGH="HIGH",(vn=bn||(bn={})).HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",vn.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",vn.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",vn.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",vn.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",vn.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",vn.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",vn.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",vn.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",vn.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",vn.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK",(Nn=wn||(wn={})).HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",Nn.SEVERITY="SEVERITY",Nn.PROBABILITY="PROBABILITY",(Sn=En||(En={})).HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",Sn.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",Sn.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",Sn.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",Sn.BLOCK_NONE="BLOCK_NONE",Sn.OFF="OFF",(kn=Cn||(Cn={})).FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",kn.STOP="STOP",kn.MAX_TOKENS="MAX_TOKENS",kn.SAFETY="SAFETY",kn.RECITATION="RECITATION",kn.LANGUAGE="LANGUAGE",kn.OTHER="OTHER",kn.BLOCKLIST="BLOCKLIST",kn.PROHIBITED_CONTENT="PROHIBITED_CONTENT",kn.SPII="SPII",kn.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",kn.IMAGE_SAFETY="IMAGE_SAFETY",kn.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",kn.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",kn.NO_IMAGE="NO_IMAGE",(In=Tn||(Tn={})).HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",In.NEGLIGIBLE="NEGLIGIBLE",In.LOW="LOW",In.MEDIUM="MEDIUM",In.HIGH="HIGH",(jn=An||(An={})).HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",jn.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",jn.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",jn.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",jn.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH",(On=_n||(_n={})).URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",On.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",On.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",On.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",On.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE",(Rn=Pn||(Pn={})).BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",Rn.SAFETY="SAFETY",Rn.OTHER="OTHER",Rn.BLOCKLIST="BLOCKLIST",Rn.PROHIBITED_CONTENT="PROHIBITED_CONTENT",Rn.IMAGE_SAFETY="IMAGE_SAFETY",Rn.MODEL_ARMOR="MODEL_ARMOR",Rn.JAILBREAK="JAILBREAK",(Dn=Mn||(Mn={})).TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",Dn.ON_DEMAND="ON_DEMAND",Dn.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT",(Un=Ln||(Ln={})).MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",Un.TEXT="TEXT",Un.IMAGE="IMAGE",Un.AUDIO="AUDIO",(Fn=zn||(zn={})).MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",Fn.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",Fn.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",Fn.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH",(qn=Gn||(Gn={})).TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",qn.TUNING_MODE_FULL="TUNING_MODE_FULL",qn.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER",($n=Hn||(Hn={})).ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",$n.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",$n.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",$n.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",$n.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",$n.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",$n.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO",(Vn=Bn||(Bn={})).JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",Vn.JOB_STATE_QUEUED="JOB_STATE_QUEUED",Vn.JOB_STATE_PENDING="JOB_STATE_PENDING",Vn.JOB_STATE_RUNNING="JOB_STATE_RUNNING",Vn.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",Vn.JOB_STATE_FAILED="JOB_STATE_FAILED",Vn.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",Vn.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",Vn.JOB_STATE_PAUSED="JOB_STATE_PAUSED",Vn.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",Vn.JOB_STATE_UPDATING="JOB_STATE_UPDATING",Vn.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED",(Wn=Yn||(Yn={})).TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",Wn.TUNING_TASK_I2V="TUNING_TASK_I2V",Wn.TUNING_TASK_T2V="TUNING_TASK_T2V",Wn.TUNING_TASK_R2V="TUNING_TASK_R2V",(Jn=Kn||(Kn={})).MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",Jn.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",Jn.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",Jn.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH",(Xn=Qn||(Qn={})).FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",Xn.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",Xn.BALANCED="BALANCED",Xn.PRIORITIZE_COST="PRIORITIZE_COST",(er=Zn||(Zn={})).UNSPECIFIED="UNSPECIFIED",er.BLOCKING="BLOCKING",er.NON_BLOCKING="NON_BLOCKING",(nr=tr||(tr={})).MODE_UNSPECIFIED="MODE_UNSPECIFIED",nr.MODE_DYNAMIC="MODE_DYNAMIC",(ar=rr||(rr={})).ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",ar.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER",(or=ir||(ir={})).MODE_UNSPECIFIED="MODE_UNSPECIFIED",or.AUTO="AUTO",or.ANY="ANY",or.NONE="NONE",or.VALIDATED="VALIDATED",(lr=sr||(sr={})).BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",lr.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",lr.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",lr.BLOCK_NONE="BLOCK_NONE",(ur=cr||(cr={})).DONT_ALLOW="DONT_ALLOW",ur.ALLOW_ADULT="ALLOW_ADULT",ur.ALLOW_ALL="ALLOW_ALL",(pr=dr||(dr={})).auto="auto",pr.en="en",pr.ja="ja",pr.ko="ko",pr.hi="hi",pr.zh="zh",pr.pt="pt",pr.es="es",(mr=hr||(hr={})).MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",mr.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",mr.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",mr.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",mr.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC",(gr=fr||(fr={})).CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",gr.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",gr.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",gr.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH",(xr=yr||(yr={})).SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",xr.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",xr.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",xr.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT",(vr=br||(br={})).EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",vr.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",vr.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",vr.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",vr.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",vr.EDIT_MODE_STYLE="EDIT_MODE_STYLE",vr.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",vr.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE",(Nr=wr||(wr={})).FOREGROUND="FOREGROUND",Nr.BACKGROUND="BACKGROUND",Nr.PROMPT="PROMPT",Nr.SEMANTIC="SEMANTIC",Nr.INTERACTIVE="INTERACTIVE",(Sr=Er||(Er={})).ASSET="ASSET",Sr.STYLE="STYLE",(kr=Cr||(Cr={})).INSERT="INSERT",kr.REMOVE="REMOVE",kr.REMOVE_STATIC="REMOVE_STATIC",kr.OUTPAINT="OUTPAINT",(Ir=Tr||(Tr={})).OPTIMIZED="OPTIMIZED",Ir.LOSSLESS="LOSSLESS",(jr=Ar||(Ar={})).SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",jr.PREFERENCE_TUNING="PREFERENCE_TUNING",(Or=_r||(_r={})).STATE_UNSPECIFIED="STATE_UNSPECIFIED",Or.STATE_PENDING="STATE_PENDING",Or.STATE_ACTIVE="STATE_ACTIVE",Or.STATE_FAILED="STATE_FAILED",(Rr=Pr||(Pr={})).STATE_UNSPECIFIED="STATE_UNSPECIFIED",Rr.PROCESSING="PROCESSING",Rr.ACTIVE="ACTIVE",Rr.FAILED="FAILED",(Dr=Mr||(Mr={})).SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",Dr.UPLOADED="UPLOADED",Dr.GENERATED="GENERATED",(Ur=Lr||(Lr={})).TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",Ur.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",Ur.RESPONSE_REJECTED="RESPONSE_REJECTED",Ur.NEED_MORE_INPUT="NEED_MORE_INPUT",(Fr=zr||(zr={})).MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",Fr.TEXT="TEXT",Fr.IMAGE="IMAGE",Fr.VIDEO="VIDEO",Fr.AUDIO="AUDIO",Fr.DOCUMENT="DOCUMENT",(qr=Gr||(Gr={})).START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",qr.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",qr.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW",($r=Hr||(Hr={})).END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",$r.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",$r.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW",(Vr=Br||(Br={})).ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",Vr.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",Vr.NO_INTERRUPTION="NO_INTERRUPTION",(Wr=Yr||(Yr={})).TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",Wr.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",Wr.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT",(Jr=Kr||(Kr={})).SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",Jr.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",Jr.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",Jr.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",Jr.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",Jr.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",Jr.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",Jr.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",Jr.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",Jr.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",Jr.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",Jr.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",Jr.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR",(Xr=Qr||(Qr={})).MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",Xr.QUALITY="QUALITY",Xr.DIVERSITY="DIVERSITY",Xr.VOCALIZATION="VOCALIZATION",(ea=Zr||(Zr={})).PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",ea.PLAY="PLAY",ea.PAUSE="PAUSE",ea.STOP="STOP",ea.RESET_CONTEXT="RESET_CONTEXT";class ra{constructor(e){const t={};for(const n of e.headers.entries())t[n[0]]=n[1];this.headers=t,this.responseInternal=e}json(){return this.responseInternal.json()}}class aa{get text(){var e,t,n,r,a,i,o,s;if(0===(null===(r=null===(n=null===(t=null===(e=this.candidates)||void 0===e?void 0:e[0])||void 0===t?void 0:t.content)||void 0===n?void 0:n.parts)||void 0===r?void 0:r.length))return;this.candidates&&this.candidates.length;let l="",c=!1;const u=[];for(const d of null!==(s=null===(o=null===(i=null===(a=this.candidates)||void 0===a?void 0:a[0])||void 0===i?void 0:i.content)||void 0===o?void 0:o.parts)&&void 0!==s?s:[]){for(const[e,t]of Object.entries(d))"text"===e||"thought"===e||"thoughtSignature"===e||null===t&&void 0===t||u.push(e);if("string"==typeof d.text){if("boolean"==typeof d.thought&&d.thought)continue;c=!0,l+=d.text}}return u.length,c?l:void 0}get data(){var e,t,n,r,a,i,o,s;if(0===(null===(r=null===(n=null===(t=null===(e=this.candidates)||void 0===e?void 0:e[0])||void 0===t?void 0:t.content)||void 0===n?void 0:n.parts)||void 0===r?void 0:r.length))return;this.candidates&&this.candidates.length;let l="";const c=[];for(const u of null!==(s=null===(o=null===(i=null===(a=this.candidates)||void 0===a?void 0:a[0])||void 0===i?void 0:i.content)||void 0===o?void 0:o.parts)&&void 0!==s?s:[]){for(const[e,t]of Object.entries(u))"inlineData"===e||null===t&&void 0===t||c.push(e);u.inlineData&&"string"==typeof u.inlineData.data&&(l+=atob(u.inlineData.data))}return c.length,l.length>0?btoa(l):void 0}get functionCalls(){var e,t,n,r,a,i,o,s;if(0===(null===(r=null===(n=null===(t=null===(e=this.candidates)||void 0===e?void 0:e[0])||void 0===t?void 0:t.content)||void 0===n?void 0:n.parts)||void 0===r?void 0:r.length))return;this.candidates&&this.candidates.length;const l=null===(s=null===(o=null===(i=null===(a=this.candidates)||void 0===a?void 0:a[0])||void 0===i?void 0:i.content)||void 0===o?void 0:o.parts)||void 0===s?void 0:s.filter(e=>e.functionCall).map(e=>e.functionCall).filter(e=>void 0!==e);return 0!==(null==l?void 0:l.length)?l:void 0}get executableCode(){var e,t,n,r,a,i,o,s,l;if(0===(null===(r=null===(n=null===(t=null===(e=this.candidates)||void 0===e?void 0:e[0])||void 0===t?void 0:t.content)||void 0===n?void 0:n.parts)||void 0===r?void 0:r.length))return;this.candidates&&this.candidates.length;const c=null===(s=null===(o=null===(i=null===(a=this.candidates)||void 0===a?void 0:a[0])||void 0===i?void 0:i.content)||void 0===o?void 0:o.parts)||void 0===s?void 0:s.filter(e=>e.executableCode).map(e=>e.executableCode).filter(e=>void 0!==e);return 0!==(null==c?void 0:c.length)?null===(l=null==c?void 0:c[0])||void 0===l?void 0:l.code:void 0}get codeExecutionResult(){var e,t,n,r,a,i,o,s,l;if(0===(null===(r=null===(n=null===(t=null===(e=this.candidates)||void 0===e?void 0:e[0])||void 0===t?void 0:t.content)||void 0===n?void 0:n.parts)||void 0===r?void 0:r.length))return;this.candidates&&this.candidates.length;const c=null===(s=null===(o=null===(i=null===(a=this.candidates)||void 0===a?void 0:a[0])||void 0===i?void 0:i.content)||void 0===o?void 0:o.parts)||void 0===s?void 0:s.filter(e=>e.codeExecutionResult).map(e=>e.codeExecutionResult).filter(e=>void 0!==e);return 0!==(null==c?void 0:c.length)?null===(l=null==c?void 0:c[0])||void 0===l?void 0:l.output:void 0}}class ia{}class oa{}class sa{}class la{}class ca{}class ua{}class da{}class pa{}class ha{}class ma{}class fa{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const n=new fa;let r;const a=e;return r=t?Kt(a):Wt(a),Object.assign(n,r),n}}class ga{}class ya{}class xa{}class ba{}class va{}class wa{}class Na{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const n=new Na,r=Jt(e);return Object.assign(n,r),n}}class Ea{}class Sa{}class Ca{}class ka{}class Ta{get text(){var e,t,n;let r="",a=!1;const i=[];for(const o of null!==(n=null===(t=null===(e=this.serverContent)||void 0===e?void 0:e.modelTurn)||void 0===t?void 0:t.parts)&&void 0!==n?n:[]){for(const[e,t]of Object.entries(o))"text"!==e&&"thought"!==e&&null!==t&&i.push(e);if("string"==typeof o.text){if("boolean"==typeof o.thought&&o.thought)continue;a=!0,r+=o.text}}return i.length,a?r:void 0}get data(){var e,t,n;let r="";const a=[];for(const i of null!==(n=null===(t=null===(e=this.serverContent)||void 0===e?void 0:e.modelTurn)||void 0===t?void 0:t.parts)&&void 0!==n?n:[]){for(const[e,t]of Object.entries(i))"inlineData"!==e&&null!==t&&a.push(e);i.inlineData&&"string"==typeof i.inlineData.data&&(r+=atob(i.inlineData.data))}return a.length,r.length>0?btoa(r):void 0}}class Ia{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}class Aa{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const n=new Aa,r=Qt(e);return Object.assign(n,r),n}}
/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ja(e,t){if(!t||"string"!=typeof t)throw new Error("model is required and must be a string");if(t.includes("..")||t.includes("?")||t.includes("&"))throw new Error("invalid model parameter");if(e.isVertexAI()){if(t.startsWith("publishers/")||t.startsWith("projects/")||t.startsWith("models/"))return t;if(t.indexOf("/")>=0){const e=t.split("/",2);return`publishers/${e[0]}/models/${e[1]}`}return`publishers/google/models/${t}`}return t.startsWith("models/")||t.startsWith("tunedModels/")?t:`models/${t}`}function _a(e,t){const n=ja(e,t);return n?n.startsWith("publishers/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/${n}`:n.startsWith("models/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/publishers/google/${n}`:n:""}function Oa(e){return Array.isArray(e)?e.map(e=>Pa(e)):[Pa(e)]}function Pa(e){if("object"==typeof e&&null!==e)return e;throw new Error("Could not parse input as Blob. Unsupported blob type: "+typeof e)}function Ra(e){const t=Pa(e);if(t.mimeType&&t.mimeType.startsWith("image/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function Ma(e){const t=Pa(e);if(t.mimeType&&t.mimeType.startsWith("audio/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function Da(e){if(null==e)throw new Error("PartUnion is required");if("object"==typeof e)return e;if("string"==typeof e)return{text:e};throw new Error("Unsupported part type: "+typeof e)}function La(e){if(null==e||Array.isArray(e)&&0===e.length)throw new Error("PartListUnion is required");return Array.isArray(e)?e.map(e=>Da(e)):[Da(e)]}function Ua(e){return null!=e&&"object"==typeof e&&"parts"in e&&Array.isArray(e.parts)}function za(e){return null!=e&&"object"==typeof e&&"functionCall"in e}function Fa(e){return null!=e&&"object"==typeof e&&"functionResponse"in e}function Ga(e){if(null==e)throw new Error("ContentUnion is required");return Ua(e)?e:{role:"user",parts:La(e)}}function qa(e,t){if(!t)return[];if(e.isVertexAI()&&Array.isArray(t))return t.flatMap(e=>{const t=Ga(e);return t.parts&&t.parts.length>0&&void 0!==t.parts[0].text?[t.parts[0].text]:[]});if(e.isVertexAI()){const e=Ga(t);return e.parts&&e.parts.length>0&&void 0!==e.parts[0].text?[e.parts[0].text]:[]}return Array.isArray(t)?t.map(e=>Ga(e)):[Ga(t)]}function Ha(e){if(null==e||Array.isArray(e)&&0===e.length)throw new Error("contents are required");if(!Array.isArray(e)){if(za(e)||Fa(e))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[Ga(e)]}const t=[],n=[],r=Ua(e[0]);for(const a of e){const e=Ua(a);if(e!=r)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(e)t.push(a);else{if(za(a)||Fa(a))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");n.push(a)}}return r||t.push({role:"user",parts:La(n)}),t}function $a(e){const t={},n=["items"],r=["anyOf"],a=["properties"];if(e.type&&e.anyOf)throw new Error("type and anyOf cannot be both populated.");const i=e.anyOf;null!=i&&2==i.length&&("null"===i[0].type?(t.nullable=!0,e=i[1]):"null"===i[1].type&&(t.nullable=!0,e=i[0])),e.type instanceof Array&&function(e,t){e.includes("null")&&(t.nullable=!0);const n=e.filter(e=>"null"!==e);if(1===n.length)t.type=Object.values(an).includes(n[0].toUpperCase())?n[0].toUpperCase():an.TYPE_UNSPECIFIED;else{t.anyOf=[];for(const e of n)t.anyOf.push({type:Object.values(an).includes(e.toUpperCase())?e.toUpperCase():an.TYPE_UNSPECIFIED})}}(e.type,t);for(const[o,s]of Object.entries(e))if(null!=s)if("type"==o){if("null"===s)throw new Error("type: null can not be the only possible type for the field.");if(s instanceof Array)continue;t.type=Object.values(an).includes(s.toUpperCase())?s.toUpperCase():an.TYPE_UNSPECIFIED}else if(n.includes(o))t[o]=$a(s);else if(r.includes(o)){const e=[];for(const n of s)"null"!=n.type?e.push($a(n)):t.nullable=!0;t[o]=e}else if(a.includes(o)){const e={};for(const[t,n]of Object.entries(s))e[t]=$a(n);t[o]=e}else{if("additionalProperties"===o)continue;t[o]=s}return t}function Ba(e){return $a(e)}function Va(e){if("object"==typeof e)return e;if("string"==typeof e)return{voiceConfig:{prebuiltVoiceConfig:{voiceName:e}}};throw new Error("Unsupported speechConfig type: "+typeof e)}function Ya(e){if("multiSpeakerVoiceConfig"in e)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return e}function Wa(e){if(e.functionDeclarations)for(const t of e.functionDeclarations)t.parameters&&(Object.keys(t.parameters).includes("$schema")?t.parametersJsonSchema||(t.parametersJsonSchema=t.parameters,delete t.parameters):t.parameters=$a(t.parameters)),t.response&&(Object.keys(t.response).includes("$schema")?t.responseJsonSchema||(t.responseJsonSchema=t.response,delete t.response):t.response=$a(t.response));return e}function Ka(e){if(null==e)throw new Error("tools is required");if(!Array.isArray(e))throw new Error("tools is required and must be an array of Tools");const t=[];for(const n of e)t.push(n);return t}function Ja(e,t){if("string"!=typeof t)throw new Error("name must be a string");return function(e,t,n,r=1){const a=!t.startsWith(`${n}/`)&&t.split("/").length===r;return e.isVertexAI()?t.startsWith("projects/")?t:t.startsWith("locations/")?`projects/${e.getProject()}/${t}`:t.startsWith(`${n}/`)?`projects/${e.getProject()}/locations/${e.getLocation()}/${t}`:a?`projects/${e.getProject()}/locations/${e.getLocation()}/${n}/${t}`:t:a?`${n}/${t}`:t}(e,t,"cachedContents")}function Qa(e){switch(e){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return e}}function Xa(e){return Yt(e)}function Za(e){var t;let n;var r;if(null!=(r=e)&&"object"==typeof r&&"name"in r&&(n=e.name),!(function(e){return null!=e&&"object"==typeof e&&"uri"in e}(e)&&(n=e.uri,void 0===n)||function(e){return null!=e&&"object"==typeof e&&"video"in e}(e)&&(n=null===(t=e.video)||void 0===t?void 0:t.uri,void 0===n))){if("string"==typeof e&&(n=e),void 0===n)throw new Error("Could not extract file name from the provided input.");if(n.startsWith("https://")){const e=n.split("files/")[1].match(/[a-z0-9]+/);if(null===e)throw new Error(`Could not extract file name from URI ${n}`);n=e[0]}else n.startsWith("files/")&&(n=n.split("files/")[1]);return n}}function ei(e,t){let n;return n=e.isVertexAI()?t?"publishers/google/models":"models":t?"models":"tunedModels",n}function ti(e){for(const t of["models","tunedModels","publisherModels"])if(ni(e,t))return e[t];return[]}function ni(e,t){return null!==e&&"object"==typeof e&&t in e}function ri(e,t={}){const n=e,r={name:n.name,description:n.description,parametersJsonSchema:n.inputSchema};n.outputSchema&&(r.responseJsonSchema=n.outputSchema),t.behavior&&(r.behavior=t.behavior);return{functionDeclarations:[r]}}function ai(e,t){let n;if("string"==typeof t)if(e.isVertexAI())if(t.startsWith("gs://"))n={format:"jsonl",gcsUri:[t]};else{if(!t.startsWith("bq://"))throw new Error(`Unsupported string source for Vertex AI: ${t}`);n={format:"bigquery",bigqueryUri:t}}else{if(!t.startsWith("files/"))throw new Error(`Unsupported string source for Gemini API: ${t}`);n={fileName:t}}else if(Array.isArray(t)){if(e.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");n={inlinedRequests:t}}else n=t;const r=[n.gcsUri,n.bigqueryUri].filter(Boolean).length,a=[n.inlinedRequests,n.fileName].filter(Boolean).length;if(e.isVertexAI()){if(a>0||1!==r)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(r>0||1!==a)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return n}function ii(e){if("object"!=typeof e||null===e)return{};const t=e,n=t.inlinedResponses;if("object"!=typeof n||null===n)return e;const r=n.inlinedResponses;if(!Array.isArray(r)||0===r.length)return e;let a=!1;for(const i of r){if("object"!=typeof i||null===i)continue;const e=i.response;if("object"!=typeof e||null===e)continue;if(void 0!==e.embedding){a=!0;break}}return a&&(t.inlinedEmbedContentResponses=t.inlinedResponses,delete t.inlinedResponses),e}function oi(e,t){const n=t;if(!e.isVertexAI()){if(/batches\/[^/]+$/.test(n))return n.split("/").pop();throw new Error(`Invalid batch job name: ${n}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(n))return n.split("/").pop();if(/^\d+$/.test(n))return n;throw new Error(`Invalid batch job name: ${n}.`)}function si(e){return"BATCH_STATE_UNSPECIFIED"===e?"JOB_STATE_UNSPECIFIED":"BATCH_STATE_PENDING"===e?"JOB_STATE_PENDING":"BATCH_STATE_RUNNING"===e?"JOB_STATE_RUNNING":"BATCH_STATE_SUCCEEDED"===e?"JOB_STATE_SUCCEEDED":"BATCH_STATE_FAILED"===e?"JOB_STATE_FAILED":"BATCH_STATE_CANCELLED"===e?"JOB_STATE_CANCELLED":"BATCH_STATE_EXPIRED"===e?"JOB_STATE_EXPIRED":e}
/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function li(e){const t={},n=Bt(e,["responsesFile"]);null!=n&&$t(t,["fileName"],n);const r=Bt(e,["inlinedResponses","inlinedResponses"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=Bt(e,["response"]);null!=n&&$t(t,["response"],function(e){const t={},n=Bt(e,["sdkHttpResponse"]);null!=n&&$t(t,["sdkHttpResponse"],n);const r=Bt(e,["candidates"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=Bt(e,["content"]);null!=n&&$t(t,["content"],n);const r=Bt(e,["citationMetadata"]);null!=r&&$t(t,["citationMetadata"],function(e){const t={},n=Bt(e,["citationSources"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),$t(t,["citations"],e)}return t}(r));const a=Bt(e,["tokenCount"]);null!=a&&$t(t,["tokenCount"],a);const i=Bt(e,["finishReason"]);null!=i&&$t(t,["finishReason"],i);const o=Bt(e,["avgLogprobs"]);null!=o&&$t(t,["avgLogprobs"],o);const s=Bt(e,["groundingMetadata"]);null!=s&&$t(t,["groundingMetadata"],s);const l=Bt(e,["index"]);null!=l&&$t(t,["index"],l);const c=Bt(e,["logprobsResult"]);null!=c&&$t(t,["logprobsResult"],c);const u=Bt(e,["safetyRatings"]);if(null!=u){let e=u;Array.isArray(e)&&(e=e.map(e=>e)),$t(t,["safetyRatings"],e)}const d=Bt(e,["urlContextMetadata"]);null!=d&&$t(t,["urlContextMetadata"],d);return t}(e))),$t(t,["candidates"],e)}const a=Bt(e,["modelVersion"]);null!=a&&$t(t,["modelVersion"],a);const i=Bt(e,["promptFeedback"]);null!=i&&$t(t,["promptFeedback"],i);const o=Bt(e,["responseId"]);null!=o&&$t(t,["responseId"],o);const s=Bt(e,["usageMetadata"]);null!=s&&$t(t,["usageMetadata"],s);return t}(n));const r=Bt(e,["error"]);null!=r&&$t(t,["error"],r);return t}(e))),$t(t,["inlinedResponses"],e)}const a=Bt(e,["inlinedEmbedContentResponses","inlinedResponses"]);if(null!=a){let e=a;Array.isArray(e)&&(e=e.map(e=>e)),$t(t,["inlinedEmbedContentResponses"],e)}return t}function ci(e){const t={},n=Bt(e,["name"]);null!=n&&$t(t,["name"],n);const r=Bt(e,["metadata","displayName"]);null!=r&&$t(t,["displayName"],r);const a=Bt(e,["metadata","state"]);null!=a&&$t(t,["state"],si(a));const i=Bt(e,["metadata","createTime"]);null!=i&&$t(t,["createTime"],i);const o=Bt(e,["metadata","endTime"]);null!=o&&$t(t,["endTime"],o);const s=Bt(e,["metadata","updateTime"]);null!=s&&$t(t,["updateTime"],s);const l=Bt(e,["metadata","model"]);null!=l&&$t(t,["model"],l);const c=Bt(e,["metadata","output"]);return null!=c&&$t(t,["dest"],li(ii(c))),t}function ui(e){const t={},n=Bt(e,["name"]);null!=n&&$t(t,["name"],n);const r=Bt(e,["displayName"]);null!=r&&$t(t,["displayName"],r);const a=Bt(e,["state"]);null!=a&&$t(t,["state"],si(a));const i=Bt(e,["error"]);null!=i&&$t(t,["error"],i);const o=Bt(e,["createTime"]);null!=o&&$t(t,["createTime"],o);const s=Bt(e,["startTime"]);null!=s&&$t(t,["startTime"],s);const l=Bt(e,["endTime"]);null!=l&&$t(t,["endTime"],l);const c=Bt(e,["updateTime"]);null!=c&&$t(t,["updateTime"],c);const u=Bt(e,["model"]);null!=u&&$t(t,["model"],u);const d=Bt(e,["inputConfig"]);null!=d&&$t(t,["src"],function(e){const t={},n=Bt(e,["instancesFormat"]);null!=n&&$t(t,["format"],n);const r=Bt(e,["gcsSource","uris"]);null!=r&&$t(t,["gcsUri"],r);const a=Bt(e,["bigquerySource","inputUri"]);null!=a&&$t(t,["bigqueryUri"],a);return t}(d));const p=Bt(e,["outputConfig"]);null!=p&&$t(t,["dest"],function(e){const t={},n=Bt(e,["predictionsFormat"]);null!=n&&$t(t,["format"],n);const r=Bt(e,["gcsDestination","outputUriPrefix"]);null!=r&&$t(t,["gcsUri"],r);const a=Bt(e,["bigqueryDestination","outputUri"]);return null!=a&&$t(t,["bigqueryUri"],a),t}(ii(p)));const h=Bt(e,["completionStats"]);return null!=h&&$t(t,["completionStats"],h),t}function di(e,t){const n={};if(void 0!==Bt(t,["format"]))throw new Error("format parameter is not supported in Gemini API.");if(void 0!==Bt(t,["gcsUri"]))throw new Error("gcsUri parameter is not supported in Gemini API.");if(void 0!==Bt(t,["bigqueryUri"]))throw new Error("bigqueryUri parameter is not supported in Gemini API.");const r=Bt(t,["fileName"]);null!=r&&$t(n,["fileName"],r);const a=Bt(t,["inlinedRequests"]);if(null!=a){let t=a;Array.isArray(t)&&(t=t.map(t=>function(e,t){const n={},r=Bt(t,["model"]);null!=r&&$t(n,["request","model"],ja(e,r));const a=Bt(t,["contents"]);if(null!=a){let e=Ha(a);Array.isArray(e)&&(e=e.map(e=>pi(e))),$t(n,["request","contents"],e)}const i=Bt(t,["metadata"]);null!=i&&$t(n,["metadata"],i);const o=Bt(t,["config"]);null!=o&&$t(n,["request","generationConfig"],function(e,t,n){const r={},a=Bt(t,["systemInstruction"]);void 0!==n&&null!=a&&$t(n,["systemInstruction"],pi(Ga(a)));const i=Bt(t,["temperature"]);null!=i&&$t(r,["temperature"],i);const o=Bt(t,["topP"]);null!=o&&$t(r,["topP"],o);const s=Bt(t,["topK"]);null!=s&&$t(r,["topK"],s);const l=Bt(t,["candidateCount"]);null!=l&&$t(r,["candidateCount"],l);const c=Bt(t,["maxOutputTokens"]);null!=c&&$t(r,["maxOutputTokens"],c);const u=Bt(t,["stopSequences"]);null!=u&&$t(r,["stopSequences"],u);const d=Bt(t,["responseLogprobs"]);null!=d&&$t(r,["responseLogprobs"],d);const p=Bt(t,["logprobs"]);null!=p&&$t(r,["logprobs"],p);const h=Bt(t,["presencePenalty"]);null!=h&&$t(r,["presencePenalty"],h);const m=Bt(t,["frequencyPenalty"]);null!=m&&$t(r,["frequencyPenalty"],m);const f=Bt(t,["seed"]);null!=f&&$t(r,["seed"],f);const g=Bt(t,["responseMimeType"]);null!=g&&$t(r,["responseMimeType"],g);const y=Bt(t,["responseSchema"]);null!=y&&$t(r,["responseSchema"],Ba(y));const x=Bt(t,["responseJsonSchema"]);null!=x&&$t(r,["responseJsonSchema"],x);if(void 0!==Bt(t,["routingConfig"]))throw new Error("routingConfig parameter is not supported in Gemini API.");if(void 0!==Bt(t,["modelSelectionConfig"]))throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const b=Bt(t,["safetySettings"]);if(void 0!==n&&null!=b){let e=b;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=Bt(e,["category"]);null!=n&&$t(t,["category"],n);if(void 0!==Bt(e,["method"]))throw new Error("method parameter is not supported in Gemini API.");const r=Bt(e,["threshold"]);null!=r&&$t(t,["threshold"],r);return t}(e))),$t(n,["safetySettings"],e)}const v=Bt(t,["tools"]);if(void 0!==n&&null!=v){let e=Ka(v);Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=Bt(e,["functionDeclarations"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),$t(t,["functionDeclarations"],e)}if(void 0!==Bt(e,["retrieval"]))throw new Error("retrieval parameter is not supported in Gemini API.");const r=Bt(e,["googleSearchRetrieval"]);null!=r&&$t(t,["googleSearchRetrieval"],r);const a=Bt(e,["computerUse"]);null!=a&&$t(t,["computerUse"],a);const i=Bt(e,["fileSearch"]);null!=i&&$t(t,["fileSearch"],i);const o=Bt(e,["codeExecution"]);null!=o&&$t(t,["codeExecution"],o);if(void 0!==Bt(e,["enterpriseWebSearch"]))throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const s=Bt(e,["googleMaps"]);null!=s&&$t(t,["googleMaps"],function(e){const t={};if(void 0!==Bt(e,["authConfig"]))throw new Error("authConfig parameter is not supported in Gemini API.");const n=Bt(e,["enableWidget"]);null!=n&&$t(t,["enableWidget"],n);return t}(s));const l=Bt(e,["googleSearch"]);null!=l&&$t(t,["googleSearch"],function(e){const t={};if(void 0!==Bt(e,["excludeDomains"]))throw new Error("excludeDomains parameter is not supported in Gemini API.");if(void 0!==Bt(e,["blockingConfidence"]))throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=Bt(e,["timeRangeFilter"]);null!=n&&$t(t,["timeRangeFilter"],n);return t}(l));const c=Bt(e,["urlContext"]);null!=c&&$t(t,["urlContext"],c);return t}
/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */(Wa(e)))),$t(n,["tools"],e)}const w=Bt(t,["toolConfig"]);void 0!==n&&null!=w&&$t(n,["toolConfig"],function(e){const t={},n=Bt(e,["functionCallingConfig"]);null!=n&&$t(t,["functionCallingConfig"],function(e){const t={},n=Bt(e,["mode"]);null!=n&&$t(t,["mode"],n);const r=Bt(e,["allowedFunctionNames"]);null!=r&&$t(t,["allowedFunctionNames"],r);if(void 0!==Bt(e,["streamFunctionCallArguments"]))throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return t}(n));const r=Bt(e,["retrievalConfig"]);null!=r&&$t(t,["retrievalConfig"],r);return t}(w));if(void 0!==Bt(t,["labels"]))throw new Error("labels parameter is not supported in Gemini API.");const N=Bt(t,["cachedContent"]);void 0!==n&&null!=N&&$t(n,["cachedContent"],Ja(e,N));const E=Bt(t,["responseModalities"]);null!=E&&$t(r,["responseModalities"],E);const S=Bt(t,["mediaResolution"]);null!=S&&$t(r,["mediaResolution"],S);const C=Bt(t,["speechConfig"]);null!=C&&$t(r,["speechConfig"],Va(C));if(void 0!==Bt(t,["audioTimestamp"]))throw new Error("audioTimestamp parameter is not supported in Gemini API.");const k=Bt(t,["thinkingConfig"]);null!=k&&$t(r,["thinkingConfig"],k);const T=Bt(t,["imageConfig"]);null!=T&&$t(r,["imageConfig"],function(e){const t={},n=Bt(e,["aspectRatio"]);null!=n&&$t(t,["aspectRatio"],n);const r=Bt(e,["imageSize"]);null!=r&&$t(t,["imageSize"],r);if(void 0!==Bt(e,["outputMimeType"]))throw new Error("outputMimeType parameter is not supported in Gemini API.");if(void 0!==Bt(e,["outputCompressionQuality"]))throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return t}(T));return r}(e,o,Bt(n,["request"],{})));return n}(e,t))),$t(n,["requests","requests"],t)}return n}function pi(e){const t={},n=Bt(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=Bt(e,["mediaResolution"]);null!=n&&$t(t,["mediaResolution"],n);const r=Bt(e,["codeExecutionResult"]);null!=r&&$t(t,["codeExecutionResult"],r);const a=Bt(e,["executableCode"]);null!=a&&$t(t,["executableCode"],a);const i=Bt(e,["fileData"]);null!=i&&$t(t,["fileData"],function(e){const t={};if(void 0!==Bt(e,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const n=Bt(e,["fileUri"]);null!=n&&$t(t,["fileUri"],n);const r=Bt(e,["mimeType"]);null!=r&&$t(t,["mimeType"],r);return t}(i));const o=Bt(e,["functionCall"]);null!=o&&$t(t,["functionCall"],function(e){const t={},n=Bt(e,["id"]);null!=n&&$t(t,["id"],n);const r=Bt(e,["args"]);null!=r&&$t(t,["args"],r);const a=Bt(e,["name"]);null!=a&&$t(t,["name"],a);if(void 0!==Bt(e,["partialArgs"]))throw new Error("partialArgs parameter is not supported in Gemini API.");if(void 0!==Bt(e,["willContinue"]))throw new Error("willContinue parameter is not supported in Gemini API.");return t}(o));const s=Bt(e,["functionResponse"]);null!=s&&$t(t,["functionResponse"],s);const l=Bt(e,["inlineData"]);null!=l&&$t(t,["inlineData"],function(e){const t={},n=Bt(e,["data"]);if(null!=n&&$t(t,["data"],n),void 0!==Bt(e,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const r=Bt(e,["mimeType"]);return null!=r&&$t(t,["mimeType"],r),t}(l));const c=Bt(e,["text"]);null!=c&&$t(t,["text"],c);const u=Bt(e,["thought"]);null!=u&&$t(t,["thought"],u);const d=Bt(e,["thoughtSignature"]);null!=d&&$t(t,["thoughtSignature"],d);const p=Bt(e,["videoMetadata"]);null!=p&&$t(t,["videoMetadata"],p);return t}(e))),$t(t,["parts"],e)}const r=Bt(e,["role"]);return null!=r&&$t(t,["role"],r),t}function hi(e,t){const n=Bt(e,["displayName"]);void 0!==t&&null!=n&&$t(t,["displayName"],n);const r=Bt(e,["dest"]);return void 0!==t&&null!=r&&$t(t,["outputConfig"],function(e){const t={},n=Bt(e,["format"]);null!=n&&$t(t,["predictionsFormat"],n);const r=Bt(e,["gcsUri"]);null!=r&&$t(t,["gcsDestination","outputUriPrefix"],r);const a=Bt(e,["bigqueryUri"]);if(null!=a&&$t(t,["bigqueryDestination","outputUri"],a),void 0!==Bt(e,["fileName"]))throw new Error("fileName parameter is not supported in Vertex AI.");if(void 0!==Bt(e,["inlinedResponses"]))throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(void 0!==Bt(e,["inlinedEmbedContentResponses"]))throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return t}(function(e){if("string"!=typeof e)return e;const t=e;if(t.startsWith("gs://"))return{format:"jsonl",gcsUri:t};if(t.startsWith("bq://"))return{format:"bigquery",bigqueryUri:t};throw new Error(`Unsupported destination: ${t}`)}(r))),{}}function mi(e,t){const n={},r=Bt(t,["model"]);null!=r&&$t(n,["_url","model"],ja(e,r));const a=Bt(t,["src"]);null!=a&&$t(n,["batch","inputConfig"],di(e,ai(e,a)));const i=Bt(t,["config"]);return null!=i&&function(e,t){const n=Bt(e,["displayName"]);if(void 0!==t&&null!=n&&$t(t,["batch","displayName"],n),void 0!==Bt(e,["dest"]))throw new Error("dest parameter is not supported in Gemini API.")}(i,n),n}function fi(e,t){const n={},r=Bt(t,["model"]);null!=r&&$t(n,["model"],ja(e,r));const a=Bt(t,["src"]);null!=a&&$t(n,["inputConfig"],function(e){const t={},n=Bt(e,["format"]);null!=n&&$t(t,["instancesFormat"],n);const r=Bt(e,["gcsUri"]);null!=r&&$t(t,["gcsSource","uris"],r);const a=Bt(e,["bigqueryUri"]);if(null!=a&&$t(t,["bigquerySource","inputUri"],a),void 0!==Bt(e,["fileName"]))throw new Error("fileName parameter is not supported in Vertex AI.");if(void 0!==Bt(e,["inlinedRequests"]))throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return t}(ai(e,a)));const i=Bt(t,["config"]);return null!=i&&hi(i,n),n}function gi(e,t){const n={},r=Bt(t,["model"]);null!=r&&$t(n,["_url","model"],ja(e,r));const a=Bt(t,["src"]);null!=a&&$t(n,["batch","inputConfig"],function(e,t){const n={},r=Bt(t,["fileName"]);null!=r&&$t(n,["file_name"],r);const a=Bt(t,["inlinedRequests"]);null!=a&&$t(n,["requests"],function(e,t){const n={},r=Bt(t,["contents"]);if(null!=r){let t=qa(e,r);Array.isArray(t)&&(t=t.map(e=>e)),$t(n,["requests[]","request","content"],t)}const a=Bt(t,["config"]);null!=a&&($t(n,["_self"],function(e,t){const n={},r=Bt(e,["taskType"]);void 0!==t&&null!=r&&$t(t,["requests[]","taskType"],r);const a=Bt(e,["title"]);void 0!==t&&null!=a&&$t(t,["requests[]","title"],a);const i=Bt(e,["outputDimensionality"]);void 0!==t&&null!=i&&$t(t,["requests[]","outputDimensionality"],i);if(void 0!==Bt(e,["mimeType"]))throw new Error("mimeType parameter is not supported in Gemini API.");if(void 0!==Bt(e,["autoTruncate"]))throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}(a,n)),function(e,t){for(const[n,r]of Object.entries(t)){const t=n.split("."),a=r.split("."),i=new Set;let o=-1;for(let e=0;e<t.length;e++)if("*"===t[e]){o=e;break}if(-1!==o&&a.length>o)for(let e=o;e<a.length;e++){const t=a[e];"*"===t||t.endsWith("[]")||t.endsWith("[0]")||i.add(t)}Vt(e,t,a,0,i)}}(n,{"requests[].*":"requests[].request.*"}));return n}(e,a));return n}(e,a));const i=Bt(t,["config"]);return null!=i&&function(e,t){const n=Bt(e,["displayName"]);void 0!==t&&null!=n&&$t(t,["batch","displayName"],n)}(i,n),n}function yi(e){const t={},n=Bt(e,["config"]);return null!=n&&function(e,t){const n=Bt(e,["pageSize"]);void 0!==t&&null!=n&&$t(t,["_query","pageSize"],n);const r=Bt(e,["pageToken"]);if(void 0!==t&&null!=r&&$t(t,["_query","pageToken"],r),void 0!==Bt(e,["filter"]))throw new Error("filter parameter is not supported in Gemini API.")}(n,t),t}function xi(e){const t={},n=Bt(e,["config"]);return null!=n&&function(e,t){const n=Bt(e,["pageSize"]);void 0!==t&&null!=n&&$t(t,["_query","pageSize"],n);const r=Bt(e,["pageToken"]);void 0!==t&&null!=r&&$t(t,["_query","pageToken"],r);const a=Bt(e,["filter"]);void 0!==t&&null!=a&&$t(t,["_query","filter"],a)}(n,t),t}(na=ta||(ta={})).PAGED_ITEM_BATCH_JOBS="batchJobs",na.PAGED_ITEM_MODELS="models",na.PAGED_ITEM_TUNING_JOBS="tuningJobs",na.PAGED_ITEM_FILES="files",na.PAGED_ITEM_CACHED_CONTENTS="cachedContents",na.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",na.PAGED_ITEM_DOCUMENTS="documents";class bi{constructor(e,t,n,r){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(e,n,r)}init(e,t,n){var r,a;this.nameInternal=e,this.pageInternal=t[this.nameInternal]||[],this.sdkHttpResponseInternal=null==t?void 0:t.sdkHttpResponse,this.idxInternal=0;let i={config:{}};i=n&&0!==Object.keys(n).length?"object"==typeof n?Object.assign({},n):n:{config:{}},i.config&&(i.config.pageToken=t.nextPageToken),this.paramsInternal=i,this.pageInternalSize=null!==(a=null===(r=i.config)||void 0===r?void 0:r.pageSize)&&void 0!==a?a:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength){if(!this.hasNextPage())return{value:void 0,done:!0};await this.nextPage()}const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return void 0!==(null===(e=this.params.config)||void 0===e?void 0:e.pageToken)}}
/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class vi extends qt{constructor(e){super(),this.apiClient=e,this.create=async e=>(this.apiClient.isVertexAI()&&(e.config=this.formatDestination(e.src,e.config)),this.createInternal(e)),this.createEmbeddings=async e=>{if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(e)},this.list=async(e={})=>new bi(ta.PAGED_ITEM_BATCH_JOBS,e=>this.listInternal(e),await this.listInternal(e),e)}createInlinedGenerateContentRequest(e){const t=mi(this.apiClient,e),n=Ht("{model}:batchGenerateContent",t._url),r=t.batch.inputConfig.requests,a=r.requests,i=[];for(const o of a){const e=Object.assign({},o);if(e.systemInstruction){const t=e.systemInstruction;delete e.systemInstruction;const n=e.request;n.systemInstruction=t,e.request=n}i.push(e)}return r.requests=i,delete t.config,delete t._url,delete t._query,{path:n,body:t}}getGcsUri(e){return"string"==typeof e?e.startsWith("gs://")?e:void 0:!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0?e.gcsUri[0]:void 0}getBigqueryUri(e){return"string"==typeof e?e.startsWith("bq://")?e:void 0:Array.isArray(e)?void 0:e.bigqueryUri}formatDestination(e,t){const n=t?Object.assign({},t):{},r=Date.now().toString();if(n.displayName||(n.displayName=`genaiBatchJob_${r}`),void 0===n.dest){const t=this.getGcsUri(e),a=this.getBigqueryUri(e);if(t)t.endsWith(".jsonl")?n.dest=`${t.slice(0,-6)}/dest`:n.dest=`${t}_dest_${r}`;else{if(!a)throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.");n.dest=`${a}_dest_${r}`}}return n}async createInternal(e){var t,n,r,a;let i,o="",s={};if(this.apiClient.isVertexAI()){const r=fi(this.apiClient,e);return o=Ht("batchPredictionJobs",r._url),s=r._query,delete r._url,delete r._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),i.then(e=>ui(e))}{const t=mi(this.apiClient,e);return o=Ht("{model}:batchGenerateContent",t._url),s=t._query,delete t._url,delete t._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(r=e.config)||void 0===r?void 0:r.httpOptions,abortSignal:null===(a=e.config)||void 0===a?void 0:a.abortSignal}).then(e=>e.json()),i.then(e=>ci(e))}}async createEmbeddingsInternal(e){var t,n;let r,a="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=gi(this.apiClient,e);return a=Ht("{model}:asyncBatchEmbedContent",o._url),i=o._query,delete o._url,delete o._query,r=this.apiClient.request({path:a,queryParams:i,body:JSON.stringify(o),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),r.then(e=>ci(e))}}async get(e){var t,n,r,a;let i,o="",s={};if(this.apiClient.isVertexAI()){const r=function(e,t){const n={},r=Bt(t,["name"]);return null!=r&&$t(n,["_url","name"],oi(e,r)),n}(this.apiClient,e);return o=Ht("batchPredictionJobs/{name}",r._url),s=r._query,delete r._url,delete r._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(r),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),i.then(e=>ui(e))}{const t=function(e,t){const n={},r=Bt(t,["name"]);return null!=r&&$t(n,["_url","name"],oi(e,r)),n}(this.apiClient,e);return o=Ht("batches/{name}",t._url),s=t._query,delete t._url,delete t._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(r=e.config)||void 0===r?void 0:r.httpOptions,abortSignal:null===(a=e.config)||void 0===a?void 0:a.abortSignal}).then(e=>e.json()),i.then(e=>ci(e))}}async cancel(e){var t,n,r,a;let i="",o={};if(this.apiClient.isVertexAI()){const r=function(e,t){const n={},r=Bt(t,["name"]);return null!=r&&$t(n,["_url","name"],oi(e,r)),n}(this.apiClient,e);i=Ht("batchPredictionJobs/{name}:cancel",r._url),o=r._query,delete r._url,delete r._query,await this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal})}else{const t=function(e,t){const n={},r=Bt(t,["name"]);return null!=r&&$t(n,["_url","name"],oi(e,r)),n}(this.apiClient,e);i=Ht("batches/{name}:cancel",t._url),o=t._query,delete t._url,delete t._query,await this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(r=e.config)||void 0===r?void 0:r.httpOptions,abortSignal:null===(a=e.config)||void 0===a?void 0:a.abortSignal})}}async listInternal(e){var t,n,r,a;let i,o="",s={};if(this.apiClient.isVertexAI()){const r=xi(e);return o=Ht("batchPredictionJobs",r._url),s=r._query,delete r._url,delete r._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(r),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),i.then(e=>{const t=function(e){const t={},n=Bt(e,["sdkHttpResponse"]);null!=n&&$t(t,["sdkHttpResponse"],n);const r=Bt(e,["nextPageToken"]);null!=r&&$t(t,["nextPageToken"],r);const a=Bt(e,["batchPredictionJobs"]);if(null!=a){let e=a;Array.isArray(e)&&(e=e.map(e=>ui(e))),$t(t,["batchJobs"],e)}return t}(e),n=new ka;return Object.assign(n,t),n})}{const t=yi(e);return o=Ht("batches",t._url),s=t._query,delete t._url,delete t._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(r=e.config)||void 0===r?void 0:r.httpOptions,abortSignal:null===(a=e.config)||void 0===a?void 0:a.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),i.then(e=>{const t=function(e){const t={},n=Bt(e,["sdkHttpResponse"]);null!=n&&$t(t,["sdkHttpResponse"],n);const r=Bt(e,["nextPageToken"]);null!=r&&$t(t,["nextPageToken"],r);const a=Bt(e,["operations"]);if(null!=a){let e=a;Array.isArray(e)&&(e=e.map(e=>ci(e))),$t(t,["batchJobs"],e)}return t}(e),n=new ka;return Object.assign(n,t),n})}}async delete(e){var t,n,r,a;let i,o="",s={};if(this.apiClient.isVertexAI()){const r=function(e,t){const n={},r=Bt(t,["name"]);return null!=r&&$t(n,["_url","name"],oi(e,r)),n}(this.apiClient,e);return o=Ht("batchPredictionJobs/{name}",r._url),s=r._query,delete r._url,delete r._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(r),httpMethod:"DELETE",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),i.then(e=>function(e){const t={},n=Bt(e,["sdkHttpResponse"]);null!=n&&$t(t,["sdkHttpResponse"],n);const r=Bt(e,["name"]);null!=r&&$t(t,["name"],r);const a=Bt(e,["done"]);null!=a&&$t(t,["done"],a);const i=Bt(e,["error"]);return null!=i&&$t(t,["error"],i),t}(e))}{const t=function(e,t){const n={},r=Bt(t,["name"]);return null!=r&&$t(n,["_url","name"],oi(e,r)),n}(this.apiClient,e);return o=Ht("batches/{name}",t._url),s=t._query,delete t._url,delete t._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(t),httpMethod:"DELETE",httpOptions:null===(r=e.config)||void 0===r?void 0:r.httpOptions,abortSignal:null===(a=e.config)||void 0===a?void 0:a.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),i.then(e=>function(e){const t={},n=Bt(e,["sdkHttpResponse"]);null!=n&&$t(t,["sdkHttpResponse"],n);const r=Bt(e,["name"]);null!=r&&$t(t,["name"],r);const a=Bt(e,["done"]);null!=a&&$t(t,["done"],a);const i=Bt(e,["error"]);return null!=i&&$t(t,["error"],i),t}(e))}}}
/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function wi(e){const t={},n=Bt(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=Bt(e,["mediaResolution"]);null!=n&&$t(t,["mediaResolution"],n);const r=Bt(e,["codeExecutionResult"]);null!=r&&$t(t,["codeExecutionResult"],r);const a=Bt(e,["executableCode"]);null!=a&&$t(t,["executableCode"],a);const i=Bt(e,["fileData"]);null!=i&&$t(t,["fileData"],function(e){const t={};if(void 0!==Bt(e,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const n=Bt(e,["fileUri"]);null!=n&&$t(t,["fileUri"],n);const r=Bt(e,["mimeType"]);null!=r&&$t(t,["mimeType"],r);return t}(i));const o=Bt(e,["functionCall"]);null!=o&&$t(t,["functionCall"],function(e){const t={},n=Bt(e,["id"]);null!=n&&$t(t,["id"],n);const r=Bt(e,["args"]);null!=r&&$t(t,["args"],r);const a=Bt(e,["name"]);null!=a&&$t(t,["name"],a);if(void 0!==Bt(e,["partialArgs"]))throw new Error("partialArgs parameter is not supported in Gemini API.");if(void 0!==Bt(e,["willContinue"]))throw new Error("willContinue parameter is not supported in Gemini API.");return t}(o));const s=Bt(e,["functionResponse"]);null!=s&&$t(t,["functionResponse"],s);const l=Bt(e,["inlineData"]);null!=l&&$t(t,["inlineData"],function(e){const t={},n=Bt(e,["data"]);if(null!=n&&$t(t,["data"],n),void 0!==Bt(e,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const r=Bt(e,["mimeType"]);return null!=r&&$t(t,["mimeType"],r),t}(l));const c=Bt(e,["text"]);null!=c&&$t(t,["text"],c);const u=Bt(e,["thought"]);null!=u&&$t(t,["thought"],u);const d=Bt(e,["thoughtSignature"]);null!=d&&$t(t,["thoughtSignature"],d);const p=Bt(e,["videoMetadata"]);null!=p&&$t(t,["videoMetadata"],p);return t}(e))),$t(t,["parts"],e)}const r=Bt(e,["role"]);return null!=r&&$t(t,["role"],r),t}function Ni(e,t){const n=Bt(e,["ttl"]);void 0!==t&&null!=n&&$t(t,["ttl"],n);const r=Bt(e,["expireTime"]);void 0!==t&&null!=r&&$t(t,["expireTime"],r);const a=Bt(e,["displayName"]);void 0!==t&&null!=a&&$t(t,["displayName"],a);const i=Bt(e,["contents"]);if(void 0!==t&&null!=i){let e=Ha(i);Array.isArray(e)&&(e=e.map(e=>wi(e))),$t(t,["contents"],e)}const o=Bt(e,["systemInstruction"]);void 0!==t&&null!=o&&$t(t,["systemInstruction"],wi(Ga(o)));const s=Bt(e,["tools"]);if(void 0!==t&&null!=s){let e=s;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=Bt(e,["functionDeclarations"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),$t(t,["functionDeclarations"],e)}if(void 0!==Bt(e,["retrieval"]))throw new Error("retrieval parameter is not supported in Gemini API.");const r=Bt(e,["googleSearchRetrieval"]);null!=r&&$t(t,["googleSearchRetrieval"],r);const a=Bt(e,["computerUse"]);null!=a&&$t(t,["computerUse"],a);const i=Bt(e,["fileSearch"]);null!=i&&$t(t,["fileSearch"],i);const o=Bt(e,["codeExecution"]);null!=o&&$t(t,["codeExecution"],o);if(void 0!==Bt(e,["enterpriseWebSearch"]))throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const s=Bt(e,["googleMaps"]);null!=s&&$t(t,["googleMaps"],function(e){const t={};if(void 0!==Bt(e,["authConfig"]))throw new Error("authConfig parameter is not supported in Gemini API.");const n=Bt(e,["enableWidget"]);null!=n&&$t(t,["enableWidget"],n);return t}(s));const l=Bt(e,["googleSearch"]);null!=l&&$t(t,["googleSearch"],function(e){const t={};if(void 0!==Bt(e,["excludeDomains"]))throw new Error("excludeDomains parameter is not supported in Gemini API.");if(void 0!==Bt(e,["blockingConfidence"]))throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=Bt(e,["timeRangeFilter"]);null!=n&&$t(t,["timeRangeFilter"],n);return t}(l));const c=Bt(e,["urlContext"]);null!=c&&$t(t,["urlContext"],c);return t}(e))),$t(t,["tools"],e)}const l=Bt(e,["toolConfig"]);if(void 0!==t&&null!=l&&$t(t,["toolConfig"],function(e){const t={},n=Bt(e,["functionCallingConfig"]);null!=n&&$t(t,["functionCallingConfig"],function(e){const t={},n=Bt(e,["mode"]);null!=n&&$t(t,["mode"],n);const r=Bt(e,["allowedFunctionNames"]);null!=r&&$t(t,["allowedFunctionNames"],r);if(void 0!==Bt(e,["streamFunctionCallArguments"]))throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return t}(n));const r=Bt(e,["retrievalConfig"]);null!=r&&$t(t,["retrievalConfig"],r);return t}(l)),void 0!==Bt(e,["kmsKeyName"]))throw new Error("kmsKeyName parameter is not supported in Gemini API.");return{}}function Ei(e,t){const n=Bt(e,["ttl"]);void 0!==t&&null!=n&&$t(t,["ttl"],n);const r=Bt(e,["expireTime"]);void 0!==t&&null!=r&&$t(t,["expireTime"],r);const a=Bt(e,["displayName"]);void 0!==t&&null!=a&&$t(t,["displayName"],a);const i=Bt(e,["contents"]);if(void 0!==t&&null!=i){let e=Ha(i);Array.isArray(e)&&(e=e.map(e=>e)),$t(t,["contents"],e)}const o=Bt(e,["systemInstruction"]);void 0!==t&&null!=o&&$t(t,["systemInstruction"],Ga(o));const s=Bt(e,["tools"]);if(void 0!==t&&null!=s){let e=s;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=Bt(e,["functionDeclarations"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={};if(void 0!==Bt(e,["behavior"]))throw new Error("behavior parameter is not supported in Vertex AI.");const n=Bt(e,["description"]);null!=n&&$t(t,["description"],n);const r=Bt(e,["name"]);null!=r&&$t(t,["name"],r);const a=Bt(e,["parameters"]);null!=a&&$t(t,["parameters"],a);const i=Bt(e,["parametersJsonSchema"]);null!=i&&$t(t,["parametersJsonSchema"],i);const o=Bt(e,["response"]);null!=o&&$t(t,["response"],o);const s=Bt(e,["responseJsonSchema"]);null!=s&&$t(t,["responseJsonSchema"],s);return t}(e))),$t(t,["functionDeclarations"],e)}const r=Bt(e,["retrieval"]);null!=r&&$t(t,["retrieval"],r);const a=Bt(e,["googleSearchRetrieval"]);null!=a&&$t(t,["googleSearchRetrieval"],a);const i=Bt(e,["computerUse"]);null!=i&&$t(t,["computerUse"],i);if(void 0!==Bt(e,["fileSearch"]))throw new Error("fileSearch parameter is not supported in Vertex AI.");const o=Bt(e,["codeExecution"]);null!=o&&$t(t,["codeExecution"],o);const s=Bt(e,["enterpriseWebSearch"]);null!=s&&$t(t,["enterpriseWebSearch"],s);const l=Bt(e,["googleMaps"]);null!=l&&$t(t,["googleMaps"],l);const c=Bt(e,["googleSearch"]);null!=c&&$t(t,["googleSearch"],c);const u=Bt(e,["urlContext"]);null!=u&&$t(t,["urlContext"],u);return t}(e))),$t(t,["tools"],e)}const l=Bt(e,["toolConfig"]);void 0!==t&&null!=l&&$t(t,["toolConfig"],l);const c=Bt(e,["kmsKeyName"]);return void 0!==t&&null!=c&&$t(t,["encryption_spec","kmsKeyName"],c),{}}function Si(e){const t={},n=Bt(e,["config"]);return null!=n&&function(e,t){const n=Bt(e,["pageSize"]);void 0!==t&&null!=n&&$t(t,["_query","pageSize"],n);const r=Bt(e,["pageToken"]);void 0!==t&&null!=r&&$t(t,["_query","pageToken"],r)}(n,t),t}function Ci(e){const t={},n=Bt(e,["config"]);return null!=n&&function(e,t){const n=Bt(e,["pageSize"]);void 0!==t&&null!=n&&$t(t,["_query","pageSize"],n);const r=Bt(e,["pageToken"]);void 0!==t&&null!=r&&$t(t,["_query","pageToken"],r)}(n,t),t}function ki(e,t){const n={},r=Bt(t,["name"]);null!=r&&$t(n,["_url","name"],Ja(e,r));const a=Bt(t,["config"]);return null!=a&&function(e,t){const n=Bt(e,["ttl"]);void 0!==t&&null!=n&&$t(t,["ttl"],n);const r=Bt(e,["expireTime"]);void 0!==t&&null!=r&&$t(t,["expireTime"],r)}(a,n),n}function Ti(e,t){const n={},r=Bt(t,["name"]);null!=r&&$t(n,["_url","name"],Ja(e,r));const a=Bt(t,["config"]);return null!=a&&function(e,t){const n=Bt(e,["ttl"]);void 0!==t&&null!=n&&$t(t,["ttl"],n);const r=Bt(e,["expireTime"]);void 0!==t&&null!=r&&$t(t,["expireTime"],r)}(a,n),n}
/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Ii extends qt{constructor(e){super(),this.apiClient=e,this.list=async(e={})=>new bi(ta.PAGED_ITEM_CACHED_CONTENTS,e=>this.listInternal(e),await this.listInternal(e),e)}async create(e){var t,n,r,a;let i,o="",s={};if(this.apiClient.isVertexAI()){const r=function(e,t){const n={},r=Bt(t,["model"]);null!=r&&$t(n,["model"],_a(e,r));const a=Bt(t,["config"]);return null!=a&&Ei(a,n),n}(this.apiClient,e);return o=Ht("cachedContents",r._url),s=r._query,delete r._url,delete r._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),i.then(e=>e)}{const t=function(e,t){const n={},r=Bt(t,["model"]);null!=r&&$t(n,["model"],_a(e,r));const a=Bt(t,["config"]);return null!=a&&Ni(a,n),n}(this.apiClient,e);return o=Ht("cachedContents",t._url),s=t._query,delete t._url,delete t._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(r=e.config)||void 0===r?void 0:r.httpOptions,abortSignal:null===(a=e.config)||void 0===a?void 0:a.abortSignal}).then(e=>e.json()),i.then(e=>e)}}async get(e){var t,n,r,a;let i,o="",s={};if(this.apiClient.isVertexAI()){const r=function(e,t){const n={},r=Bt(t,["name"]);return null!=r&&$t(n,["_url","name"],Ja(e,r)),n}(this.apiClient,e);return o=Ht("{name}",r._url),s=r._query,delete r._url,delete r._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(r),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),i.then(e=>e)}{const t=function(e,t){const n={},r=Bt(t,["name"]);return null!=r&&$t(n,["_url","name"],Ja(e,r)),n}(this.apiClient,e);return o=Ht("{name}",t._url),s=t._query,delete t._url,delete t._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(r=e.config)||void 0===r?void 0:r.httpOptions,abortSignal:null===(a=e.config)||void 0===a?void 0:a.abortSignal}).then(e=>e.json()),i.then(e=>e)}}async delete(e){var t,n,r,a;let i,o="",s={};if(this.apiClient.isVertexAI()){const r=function(e,t){const n={},r=Bt(t,["name"]);return null!=r&&$t(n,["_url","name"],Ja(e,r)),n}(this.apiClient,e);return o=Ht("{name}",r._url),s=r._query,delete r._url,delete r._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(r),httpMethod:"DELETE",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),i.then(e=>{const t=function(e){const t={},n=Bt(e,["sdkHttpResponse"]);return null!=n&&$t(t,["sdkHttpResponse"],n),t}(e),n=new ya;return Object.assign(n,t),n})}{const t=function(e,t){const n={},r=Bt(t,["name"]);return null!=r&&$t(n,["_url","name"],Ja(e,r)),n}(this.apiClient,e);return o=Ht("{name}",t._url),s=t._query,delete t._url,delete t._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(t),httpMethod:"DELETE",httpOptions:null===(r=e.config)||void 0===r?void 0:r.httpOptions,abortSignal:null===(a=e.config)||void 0===a?void 0:a.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),i.then(e=>{const t=function(e){const t={},n=Bt(e,["sdkHttpResponse"]);return null!=n&&$t(t,["sdkHttpResponse"],n),t}(e),n=new ya;return Object.assign(n,t),n})}}async update(e){var t,n,r,a;let i,o="",s={};if(this.apiClient.isVertexAI()){const r=Ti(this.apiClient,e);return o=Ht("{name}",r._url),s=r._query,delete r._url,delete r._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(r),httpMethod:"PATCH",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),i.then(e=>e)}{const t=ki(this.apiClient,e);return o=Ht("{name}",t._url),s=t._query,delete t._url,delete t._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(t),httpMethod:"PATCH",httpOptions:null===(r=e.config)||void 0===r?void 0:r.httpOptions,abortSignal:null===(a=e.config)||void 0===a?void 0:a.abortSignal}).then(e=>e.json()),i.then(e=>e)}}async listInternal(e){var t,n,r,a;let i,o="",s={};if(this.apiClient.isVertexAI()){const r=Ci(e);return o=Ht("cachedContents",r._url),s=r._query,delete r._url,delete r._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(r),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),i.then(e=>{const t=function(e){const t={},n=Bt(e,["sdkHttpResponse"]);null!=n&&$t(t,["sdkHttpResponse"],n);const r=Bt(e,["nextPageToken"]);null!=r&&$t(t,["nextPageToken"],r);const a=Bt(e,["cachedContents"]);if(null!=a){let e=a;Array.isArray(e)&&(e=e.map(e=>e)),$t(t,["cachedContents"],e)}return t}(e),n=new xa;return Object.assign(n,t),n})}{const t=Si(e);return o=Ht("cachedContents",t._url),s=t._query,delete t._url,delete t._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(r=e.config)||void 0===r?void 0:r.httpOptions,abortSignal:null===(a=e.config)||void 0===a?void 0:a.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),i.then(e=>{const t=function(e){const t={},n=Bt(e,["sdkHttpResponse"]);null!=n&&$t(t,["sdkHttpResponse"],n);const r=Bt(e,["nextPageToken"]);null!=r&&$t(t,["nextPageToken"],r);const a=Bt(e,["cachedContents"]);if(null!=a){let e=a;Array.isArray(e)&&(e=e.map(e=>e)),$t(t,["cachedContents"],e)}return t}(e),n=new xa;return Object.assign(n,t),n})}}}function Ai(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function ji(e){return this instanceof ji?(this.v=e,this):new ji(e)}function _i(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,a=n.apply(e,t||[]),i=[];return r=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),o("next"),o("throw"),o("return",function(e){return function(t){return Promise.resolve(t).then(e,c)}}),r[Symbol.asyncIterator]=function(){return this},r;function o(e,t){a[e]&&(r[e]=function(t){return new Promise(function(n,r){i.push([e,t,n,r])>1||s(e,t)})},t&&(r[e]=t(r[e])))}function s(e,t){try{(n=a[e](t)).value instanceof ji?Promise.resolve(n.value.v).then(l,c):u(i[0][2],n)}catch(r){u(i[0][3],r)}var n}function l(e){s("next",e)}function c(e){s("throw",e)}function u(e,t){e(t),i.shift(),i.length&&s(i[0][0],i[0][1])}}function Oi(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=Ai(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise(function(r,a){(function(e,t,n,r){Promise.resolve(r).then(function(t){e({value:t,done:n})},t)})(r,a,(t=e[n](t)).done,t.value)})}}}
/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */
function Pi(e){var t;if(null==e.candidates||0===e.candidates.length)return!1;const n=null===(t=e.candidates[0])||void 0===t?void 0:t.content;return void 0!==n&&Ri(n)}function Ri(e){if(void 0===e.parts||0===e.parts.length)return!1;for(const t of e.parts)if(void 0===t||0===Object.keys(t).length)return!1;return!0}function Mi(e){if(void 0===e||0===e.length)return[];const t=[],n=e.length;let r=0;for(;r<n;)if("user"===e[r].role)t.push(e[r]),r++;else{const a=[];let i=!0;for(;r<n&&"model"===e[r].role;)a.push(e[r]),i&&!Ri(e[r])&&(i=!1),r++;i?t.push(...a):t.pop()}return t}"function"==typeof SuppressedError&&SuppressedError;class Di{constructor(e,t){this.modelsModule=e,this.apiClient=t}create(e){return new Li(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class Li{constructor(e,t,n,r={},a=[]){this.apiClient=e,this.modelsModule=t,this.model=n,this.config=r,this.history=a,this.sendPromise=Promise.resolve(),function(e){if(0!==e.length)for(const t of e)if("user"!==t.role&&"model"!==t.role)throw new Error(`Role must be user or model, but got ${t.role}.`)}(a)}async sendMessage(e){var t;await this.sendPromise;const n=Ga(e.message),r=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(n),config:null!==(t=e.config)&&void 0!==t?t:this.config});return this.sendPromise=(async()=>{var e,t,a;const i=await r,o=null===(t=null===(e=i.candidates)||void 0===e?void 0:e[0])||void 0===t?void 0:t.content,s=i.automaticFunctionCallingHistory,l=this.getHistory(!0).length;let c=[];null!=s&&(c=null!==(a=s.slice(l))&&void 0!==a?a:[]);const u=o?[o]:[];this.recordHistory(n,u,c)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),r}async sendMessageStream(e){var t;await this.sendPromise;const n=Ga(e.message),r=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(n),config:null!==(t=e.config)&&void 0!==t?t:this.config});this.sendPromise=r.then(()=>{}).catch(()=>{});const a=await r;return this.processStreamResponse(a,n)}getHistory(e=!1){const t=e?Mi(this.history):this.history;return structuredClone(t)}processStreamResponse(e,t){var n,r;return _i(this,arguments,function*(){var a,i,o,s;const l=[];try{for(var c,u=!0,d=Oi(e);!(a=(c=yield ji(d.next())).done);u=!0){s=c.value,u=!1;const e=s;if(Pi(e)){const t=null===(r=null===(n=e.candidates)||void 0===n?void 0:n[0])||void 0===r?void 0:r.content;void 0!==t&&l.push(t)}yield yield ji(e)}}catch(p){i={error:p}}finally{try{u||a||!(o=d.return)||(yield ji(o.call(d)))}finally{if(i)throw i.error}}this.recordHistory(t,l)})}recordHistory(e,t,n){let r=[];t.length>0&&t.every(e=>void 0!==e.role)?r=t:r.push({role:"model",parts:[]}),n&&n.length>0?this.history.push(...Mi(n)):this.history.push(e),this.history.push(...r)}}
/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Ui extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,Ui.prototype)}}
/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function zi(e){const t={},n=Bt(e,["config"]);return null!=n&&function(e,t){const n=Bt(e,["pageSize"]);void 0!==t&&null!=n&&$t(t,["_query","pageSize"],n);const r=Bt(e,["pageToken"]);void 0!==t&&null!=r&&$t(t,["_query","pageToken"],r)}(n,t),t}
/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */
class Fi extends qt{constructor(e){super(),this.apiClient=e,this.list=async(e={})=>new bi(ta.PAGED_ITEM_FILES,e=>this.listInternal(e),await this.listInternal(e),e)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(e=>e)}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var t,n;let r,a="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=zi(e);return a=Ht("files",o._url),i=o._query,delete o._url,delete o._query,r=this.apiClient.request({path:a,queryParams:i,body:JSON.stringify(o),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),r.then(e=>{const t=function(e){const t={},n=Bt(e,["sdkHttpResponse"]);null!=n&&$t(t,["sdkHttpResponse"],n);const r=Bt(e,["nextPageToken"]);null!=r&&$t(t,["nextPageToken"],r);const a=Bt(e,["files"]);if(null!=a){let e=a;Array.isArray(e)&&(e=e.map(e=>e)),$t(t,["files"],e)}return t}(e),n=new Ea;return Object.assign(n,t),n})}}async createInternal(e){var t,n;let r,a="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=function(e){const t={},n=Bt(e,["file"]);return null!=n&&$t(t,["file"],n),t}(e);return a=Ht("upload/v1beta/files",o._url),i=o._query,delete o._url,delete o._query,r=this.apiClient.request({path:a,queryParams:i,body:JSON.stringify(o),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),r.then(e=>{const t=function(e){const t={},n=Bt(e,["sdkHttpResponse"]);return null!=n&&$t(t,["sdkHttpResponse"],n),t}(e),n=new Sa;return Object.assign(n,t),n})}}async get(e){var t,n;let r,a="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=function(e){const t={},n=Bt(e,["name"]);return null!=n&&$t(t,["_url","file"],Za(n)),t}(e);return a=Ht("files/{file}",o._url),i=o._query,delete o._url,delete o._query,r=this.apiClient.request({path:a,queryParams:i,body:JSON.stringify(o),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),r.then(e=>e)}}async delete(e){var t,n;let r,a="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=function(e){const t={},n=Bt(e,["name"]);return null!=n&&$t(t,["_url","file"],Za(n)),t}(e);return a=Ht("files/{file}",o._url),i=o._query,delete o._url,delete o._query,r=this.apiClient.request({path:a,queryParams:i,body:JSON.stringify(o),httpMethod:"DELETE",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),r.then(e=>{const t=function(e){const t={},n=Bt(e,["sdkHttpResponse"]);return null!=n&&$t(t,["sdkHttpResponse"],n),t}(e),n=new Ca;return Object.assign(n,t),n})}}}
/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Gi(e){const t={},n=Bt(e,["data"]);if(null!=n&&$t(t,["data"],n),void 0!==Bt(e,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const r=Bt(e,["mimeType"]);return null!=r&&$t(t,["mimeType"],r),t}function qi(e){const t={},n=Bt(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=Bt(e,["mediaResolution"]);null!=n&&$t(t,["mediaResolution"],n);const r=Bt(e,["codeExecutionResult"]);null!=r&&$t(t,["codeExecutionResult"],r);const a=Bt(e,["executableCode"]);null!=a&&$t(t,["executableCode"],a);const i=Bt(e,["fileData"]);null!=i&&$t(t,["fileData"],function(e){const t={};if(void 0!==Bt(e,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const n=Bt(e,["fileUri"]);null!=n&&$t(t,["fileUri"],n);const r=Bt(e,["mimeType"]);null!=r&&$t(t,["mimeType"],r);return t}(i));const o=Bt(e,["functionCall"]);null!=o&&$t(t,["functionCall"],function(e){const t={},n=Bt(e,["id"]);null!=n&&$t(t,["id"],n);const r=Bt(e,["args"]);null!=r&&$t(t,["args"],r);const a=Bt(e,["name"]);null!=a&&$t(t,["name"],a);if(void 0!==Bt(e,["partialArgs"]))throw new Error("partialArgs parameter is not supported in Gemini API.");if(void 0!==Bt(e,["willContinue"]))throw new Error("willContinue parameter is not supported in Gemini API.");return t}(o));const s=Bt(e,["functionResponse"]);null!=s&&$t(t,["functionResponse"],s);const l=Bt(e,["inlineData"]);null!=l&&$t(t,["inlineData"],Gi(l));const c=Bt(e,["text"]);null!=c&&$t(t,["text"],c);const u=Bt(e,["thought"]);null!=u&&$t(t,["thought"],u);const d=Bt(e,["thoughtSignature"]);null!=d&&$t(t,["thoughtSignature"],d);const p=Bt(e,["videoMetadata"]);null!=p&&$t(t,["videoMetadata"],p);return t}(e))),$t(t,["parts"],e)}const r=Bt(e,["role"]);return null!=r&&$t(t,["role"],r),t}function Hi(e,t){const n=Bt(e,["generationConfig"]);void 0!==t&&null!=n&&$t(t,["setup","generationConfig"],n);const r=Bt(e,["responseModalities"]);void 0!==t&&null!=r&&$t(t,["setup","generationConfig","responseModalities"],r);const a=Bt(e,["temperature"]);void 0!==t&&null!=a&&$t(t,["setup","generationConfig","temperature"],a);const i=Bt(e,["topP"]);void 0!==t&&null!=i&&$t(t,["setup","generationConfig","topP"],i);const o=Bt(e,["topK"]);void 0!==t&&null!=o&&$t(t,["setup","generationConfig","topK"],o);const s=Bt(e,["maxOutputTokens"]);void 0!==t&&null!=s&&$t(t,["setup","generationConfig","maxOutputTokens"],s);const l=Bt(e,["mediaResolution"]);void 0!==t&&null!=l&&$t(t,["setup","generationConfig","mediaResolution"],l);const c=Bt(e,["seed"]);void 0!==t&&null!=c&&$t(t,["setup","generationConfig","seed"],c);const u=Bt(e,["speechConfig"]);void 0!==t&&null!=u&&$t(t,["setup","generationConfig","speechConfig"],Ya(u));const d=Bt(e,["thinkingConfig"]);void 0!==t&&null!=d&&$t(t,["setup","generationConfig","thinkingConfig"],d);const p=Bt(e,["enableAffectiveDialog"]);void 0!==t&&null!=p&&$t(t,["setup","generationConfig","enableAffectiveDialog"],p);const h=Bt(e,["systemInstruction"]);void 0!==t&&null!=h&&$t(t,["setup","systemInstruction"],qi(Ga(h)));const m=Bt(e,["tools"]);if(void 0!==t&&null!=m){let e=Ka(m);Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=Bt(e,["functionDeclarations"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),$t(t,["functionDeclarations"],e)}if(void 0!==Bt(e,["retrieval"]))throw new Error("retrieval parameter is not supported in Gemini API.");const r=Bt(e,["googleSearchRetrieval"]);null!=r&&$t(t,["googleSearchRetrieval"],r);const a=Bt(e,["computerUse"]);null!=a&&$t(t,["computerUse"],a);const i=Bt(e,["fileSearch"]);null!=i&&$t(t,["fileSearch"],i);const o=Bt(e,["codeExecution"]);null!=o&&$t(t,["codeExecution"],o);if(void 0!==Bt(e,["enterpriseWebSearch"]))throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const s=Bt(e,["googleMaps"]);null!=s&&$t(t,["googleMaps"],function(e){const t={};if(void 0!==Bt(e,["authConfig"]))throw new Error("authConfig parameter is not supported in Gemini API.");const n=Bt(e,["enableWidget"]);return null!=n&&$t(t,["enableWidget"],n),t}(s));const l=Bt(e,["googleSearch"]);null!=l&&$t(t,["googleSearch"],function(e){const t={};if(void 0!==Bt(e,["excludeDomains"]))throw new Error("excludeDomains parameter is not supported in Gemini API.");if(void 0!==Bt(e,["blockingConfidence"]))throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=Bt(e,["timeRangeFilter"]);return null!=n&&$t(t,["timeRangeFilter"],n),t}(l));const c=Bt(e,["urlContext"]);null!=c&&$t(t,["urlContext"],c);return t}(Wa(e)))),$t(t,["setup","tools"],e)}const f=Bt(e,["sessionResumption"]);void 0!==t&&null!=f&&$t(t,["setup","sessionResumption"],function(e){const t={},n=Bt(e,["handle"]);null!=n&&$t(t,["handle"],n);if(void 0!==Bt(e,["transparent"]))throw new Error("transparent parameter is not supported in Gemini API.");return t}(f));const g=Bt(e,["inputAudioTranscription"]);void 0!==t&&null!=g&&$t(t,["setup","inputAudioTranscription"],g);const y=Bt(e,["outputAudioTranscription"]);void 0!==t&&null!=y&&$t(t,["setup","outputAudioTranscription"],y);const x=Bt(e,["realtimeInputConfig"]);void 0!==t&&null!=x&&$t(t,["setup","realtimeInputConfig"],x);const b=Bt(e,["contextWindowCompression"]);void 0!==t&&null!=b&&$t(t,["setup","contextWindowCompression"],b);const v=Bt(e,["proactivity"]);return void 0!==t&&null!=v&&$t(t,["setup","proactivity"],v),{}}function $i(e,t){const n=Bt(e,["generationConfig"]);void 0!==t&&null!=n&&$t(t,["setup","generationConfig"],function(e){const t={},n=Bt(e,["modelSelectionConfig"]);null!=n&&$t(t,["modelConfig"],n);const r=Bt(e,["responseJsonSchema"]);null!=r&&$t(t,["responseJsonSchema"],r);const a=Bt(e,["audioTimestamp"]);null!=a&&$t(t,["audioTimestamp"],a);const i=Bt(e,["candidateCount"]);null!=i&&$t(t,["candidateCount"],i);const o=Bt(e,["enableAffectiveDialog"]);null!=o&&$t(t,["enableAffectiveDialog"],o);const s=Bt(e,["frequencyPenalty"]);null!=s&&$t(t,["frequencyPenalty"],s);const l=Bt(e,["logprobs"]);null!=l&&$t(t,["logprobs"],l);const c=Bt(e,["maxOutputTokens"]);null!=c&&$t(t,["maxOutputTokens"],c);const u=Bt(e,["mediaResolution"]);null!=u&&$t(t,["mediaResolution"],u);const d=Bt(e,["presencePenalty"]);null!=d&&$t(t,["presencePenalty"],d);const p=Bt(e,["responseLogprobs"]);null!=p&&$t(t,["responseLogprobs"],p);const h=Bt(e,["responseMimeType"]);null!=h&&$t(t,["responseMimeType"],h);const m=Bt(e,["responseModalities"]);null!=m&&$t(t,["responseModalities"],m);const f=Bt(e,["responseSchema"]);null!=f&&$t(t,["responseSchema"],f);const g=Bt(e,["routingConfig"]);null!=g&&$t(t,["routingConfig"],g);const y=Bt(e,["seed"]);null!=y&&$t(t,["seed"],y);const x=Bt(e,["speechConfig"]);null!=x&&$t(t,["speechConfig"],Wi(x));const b=Bt(e,["stopSequences"]);null!=b&&$t(t,["stopSequences"],b);const v=Bt(e,["temperature"]);null!=v&&$t(t,["temperature"],v);const w=Bt(e,["thinkingConfig"]);null!=w&&$t(t,["thinkingConfig"],w);const N=Bt(e,["topK"]);null!=N&&$t(t,["topK"],N);const E=Bt(e,["topP"]);if(null!=E&&$t(t,["topP"],E),void 0!==Bt(e,["enableEnhancedCivicAnswers"]))throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return t}(n));const r=Bt(e,["responseModalities"]);void 0!==t&&null!=r&&$t(t,["setup","generationConfig","responseModalities"],r);const a=Bt(e,["temperature"]);void 0!==t&&null!=a&&$t(t,["setup","generationConfig","temperature"],a);const i=Bt(e,["topP"]);void 0!==t&&null!=i&&$t(t,["setup","generationConfig","topP"],i);const o=Bt(e,["topK"]);void 0!==t&&null!=o&&$t(t,["setup","generationConfig","topK"],o);const s=Bt(e,["maxOutputTokens"]);void 0!==t&&null!=s&&$t(t,["setup","generationConfig","maxOutputTokens"],s);const l=Bt(e,["mediaResolution"]);void 0!==t&&null!=l&&$t(t,["setup","generationConfig","mediaResolution"],l);const c=Bt(e,["seed"]);void 0!==t&&null!=c&&$t(t,["setup","generationConfig","seed"],c);const u=Bt(e,["speechConfig"]);void 0!==t&&null!=u&&$t(t,["setup","generationConfig","speechConfig"],Wi(Ya(u)));const d=Bt(e,["thinkingConfig"]);void 0!==t&&null!=d&&$t(t,["setup","generationConfig","thinkingConfig"],d);const p=Bt(e,["enableAffectiveDialog"]);void 0!==t&&null!=p&&$t(t,["setup","generationConfig","enableAffectiveDialog"],p);const h=Bt(e,["systemInstruction"]);void 0!==t&&null!=h&&$t(t,["setup","systemInstruction"],Ga(h));const m=Bt(e,["tools"]);if(void 0!==t&&null!=m){let e=Ka(m);Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=Bt(e,["functionDeclarations"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={};if(void 0!==Bt(e,["behavior"]))throw new Error("behavior parameter is not supported in Vertex AI.");const n=Bt(e,["description"]);null!=n&&$t(t,["description"],n);const r=Bt(e,["name"]);null!=r&&$t(t,["name"],r);const a=Bt(e,["parameters"]);null!=a&&$t(t,["parameters"],a);const i=Bt(e,["parametersJsonSchema"]);null!=i&&$t(t,["parametersJsonSchema"],i);const o=Bt(e,["response"]);null!=o&&$t(t,["response"],o);const s=Bt(e,["responseJsonSchema"]);return null!=s&&$t(t,["responseJsonSchema"],s),t}(e))),$t(t,["functionDeclarations"],e)}const r=Bt(e,["retrieval"]);null!=r&&$t(t,["retrieval"],r);const a=Bt(e,["googleSearchRetrieval"]);null!=a&&$t(t,["googleSearchRetrieval"],a);const i=Bt(e,["computerUse"]);null!=i&&$t(t,["computerUse"],i);if(void 0!==Bt(e,["fileSearch"]))throw new Error("fileSearch parameter is not supported in Vertex AI.");const o=Bt(e,["codeExecution"]);null!=o&&$t(t,["codeExecution"],o);const s=Bt(e,["enterpriseWebSearch"]);null!=s&&$t(t,["enterpriseWebSearch"],s);const l=Bt(e,["googleMaps"]);null!=l&&$t(t,["googleMaps"],l);const c=Bt(e,["googleSearch"]);null!=c&&$t(t,["googleSearch"],c);const u=Bt(e,["urlContext"]);null!=u&&$t(t,["urlContext"],u);return t}(Wa(e)))),$t(t,["setup","tools"],e)}const f=Bt(e,["sessionResumption"]);void 0!==t&&null!=f&&$t(t,["setup","sessionResumption"],f);const g=Bt(e,["inputAudioTranscription"]);void 0!==t&&null!=g&&$t(t,["setup","inputAudioTranscription"],g);const y=Bt(e,["outputAudioTranscription"]);void 0!==t&&null!=y&&$t(t,["setup","outputAudioTranscription"],y);const x=Bt(e,["realtimeInputConfig"]);void 0!==t&&null!=x&&$t(t,["setup","realtimeInputConfig"],x);const b=Bt(e,["contextWindowCompression"]);void 0!==t&&null!=b&&$t(t,["setup","contextWindowCompression"],b);const v=Bt(e,["proactivity"]);return void 0!==t&&null!=v&&$t(t,["setup","proactivity"],v),{}}function Bi(e){const t={},n=Bt(e,["media"]);if(null!=n){let e=Oa(n);Array.isArray(e)&&(e=e.map(e=>Gi(e))),$t(t,["mediaChunks"],e)}const r=Bt(e,["audio"]);null!=r&&$t(t,["audio"],Gi(Ma(r)));const a=Bt(e,["audioStreamEnd"]);null!=a&&$t(t,["audioStreamEnd"],a);const i=Bt(e,["video"]);null!=i&&$t(t,["video"],Gi(Ra(i)));const o=Bt(e,["text"]);null!=o&&$t(t,["text"],o);const s=Bt(e,["activityStart"]);null!=s&&$t(t,["activityStart"],s);const l=Bt(e,["activityEnd"]);return null!=l&&$t(t,["activityEnd"],l),t}function Vi(e){const t={},n=Bt(e,["media"]);if(null!=n){let e=Oa(n);Array.isArray(e)&&(e=e.map(e=>e)),$t(t,["mediaChunks"],e)}const r=Bt(e,["audio"]);null!=r&&$t(t,["audio"],Ma(r));const a=Bt(e,["audioStreamEnd"]);null!=a&&$t(t,["audioStreamEnd"],a);const i=Bt(e,["video"]);null!=i&&$t(t,["video"],Ra(i));const o=Bt(e,["text"]);null!=o&&$t(t,["text"],o);const s=Bt(e,["activityStart"]);null!=s&&$t(t,["activityStart"],s);const l=Bt(e,["activityEnd"]);return null!=l&&$t(t,["activityEnd"],l),t}function Yi(e){const t={},n=Bt(e,["setupComplete"]);null!=n&&$t(t,["setupComplete"],n);const r=Bt(e,["serverContent"]);null!=r&&$t(t,["serverContent"],r);const a=Bt(e,["toolCall"]);null!=a&&$t(t,["toolCall"],a);const i=Bt(e,["toolCallCancellation"]);null!=i&&$t(t,["toolCallCancellation"],i);const o=Bt(e,["usageMetadata"]);null!=o&&$t(t,["usageMetadata"],function(e){const t={},n=Bt(e,["promptTokenCount"]);null!=n&&$t(t,["promptTokenCount"],n);const r=Bt(e,["cachedContentTokenCount"]);null!=r&&$t(t,["cachedContentTokenCount"],r);const a=Bt(e,["candidatesTokenCount"]);null!=a&&$t(t,["responseTokenCount"],a);const i=Bt(e,["toolUsePromptTokenCount"]);null!=i&&$t(t,["toolUsePromptTokenCount"],i);const o=Bt(e,["thoughtsTokenCount"]);null!=o&&$t(t,["thoughtsTokenCount"],o);const s=Bt(e,["totalTokenCount"]);null!=s&&$t(t,["totalTokenCount"],s);const l=Bt(e,["promptTokensDetails"]);if(null!=l){let e=l;Array.isArray(e)&&(e=e.map(e=>e)),$t(t,["promptTokensDetails"],e)}const c=Bt(e,["cacheTokensDetails"]);if(null!=c){let e=c;Array.isArray(e)&&(e=e.map(e=>e)),$t(t,["cacheTokensDetails"],e)}const u=Bt(e,["candidatesTokensDetails"]);if(null!=u){let e=u;Array.isArray(e)&&(e=e.map(e=>e)),$t(t,["responseTokensDetails"],e)}const d=Bt(e,["toolUsePromptTokensDetails"]);if(null!=d){let e=d;Array.isArray(e)&&(e=e.map(e=>e)),$t(t,["toolUsePromptTokensDetails"],e)}const p=Bt(e,["trafficType"]);null!=p&&$t(t,["trafficType"],p);return t}
/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */(o));const s=Bt(e,["goAway"]);null!=s&&$t(t,["goAway"],s);const l=Bt(e,["sessionResumptionUpdate"]);return null!=l&&$t(t,["sessionResumptionUpdate"],l),t}function Wi(e){const t={},n=Bt(e,["languageCode"]);null!=n&&$t(t,["languageCode"],n);const r=Bt(e,["voiceConfig"]);if(null!=r&&$t(t,["voiceConfig"],r),void 0!==Bt(e,["multiSpeakerVoiceConfig"]))throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");return t}function Ki(e){const t={},n=Bt(e,["content"]);null!=n&&$t(t,["content"],n);const r=Bt(e,["citationMetadata"]);null!=r&&$t(t,["citationMetadata"],function(e){const t={},n=Bt(e,["citationSources"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),$t(t,["citations"],e)}return t}(r));const a=Bt(e,["tokenCount"]);null!=a&&$t(t,["tokenCount"],a);const i=Bt(e,["finishReason"]);null!=i&&$t(t,["finishReason"],i);const o=Bt(e,["avgLogprobs"]);null!=o&&$t(t,["avgLogprobs"],o);const s=Bt(e,["groundingMetadata"]);null!=s&&$t(t,["groundingMetadata"],s);const l=Bt(e,["index"]);null!=l&&$t(t,["index"],l);const c=Bt(e,["logprobsResult"]);null!=c&&$t(t,["logprobsResult"],c);const u=Bt(e,["safetyRatings"]);if(null!=u){let e=u;Array.isArray(e)&&(e=e.map(e=>e)),$t(t,["safetyRatings"],e)}const d=Bt(e,["urlContextMetadata"]);return null!=d&&$t(t,["urlContextMetadata"],d),t}function Ji(e){const t={},n=Bt(e,["values"]);null!=n&&$t(t,["values"],n);const r=Bt(e,["statistics"]);return null!=r&&$t(t,["statistics"],function(e){const t={},n=Bt(e,["truncated"]);null!=n&&$t(t,["truncated"],n);const r=Bt(e,["token_count"]);null!=r&&$t(t,["tokenCount"],r);return t}(r)),t}function Qi(e){const t={},n=Bt(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=Bt(e,["mediaResolution"]);null!=n&&$t(t,["mediaResolution"],n);const r=Bt(e,["codeExecutionResult"]);null!=r&&$t(t,["codeExecutionResult"],r);const a=Bt(e,["executableCode"]);null!=a&&$t(t,["executableCode"],a);const i=Bt(e,["fileData"]);null!=i&&$t(t,["fileData"],function(e){const t={};if(void 0!==Bt(e,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const n=Bt(e,["fileUri"]);null!=n&&$t(t,["fileUri"],n);const r=Bt(e,["mimeType"]);null!=r&&$t(t,["mimeType"],r);return t}(i));const o=Bt(e,["functionCall"]);null!=o&&$t(t,["functionCall"],function(e){const t={},n=Bt(e,["id"]);null!=n&&$t(t,["id"],n);const r=Bt(e,["args"]);null!=r&&$t(t,["args"],r);const a=Bt(e,["name"]);null!=a&&$t(t,["name"],a);if(void 0!==Bt(e,["partialArgs"]))throw new Error("partialArgs parameter is not supported in Gemini API.");if(void 0!==Bt(e,["willContinue"]))throw new Error("willContinue parameter is not supported in Gemini API.");return t}(o));const s=Bt(e,["functionResponse"]);null!=s&&$t(t,["functionResponse"],s);const l=Bt(e,["inlineData"]);null!=l&&$t(t,["inlineData"],function(e){const t={},n=Bt(e,["data"]);if(null!=n&&$t(t,["data"],n),void 0!==Bt(e,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const r=Bt(e,["mimeType"]);return null!=r&&$t(t,["mimeType"],r),t}(l));const c=Bt(e,["text"]);null!=c&&$t(t,["text"],c);const u=Bt(e,["thought"]);null!=u&&$t(t,["thought"],u);const d=Bt(e,["thoughtSignature"]);null!=d&&$t(t,["thoughtSignature"],d);const p=Bt(e,["videoMetadata"]);null!=p&&$t(t,["videoMetadata"],p);return t}(e))),$t(t,["parts"],e)}const r=Bt(e,["role"]);return null!=r&&$t(t,["role"],r),t}function Xi(e,t){const n=Bt(e,["systemInstruction"]);void 0!==t&&null!=n&&$t(t,["systemInstruction"],Ga(n));const r=Bt(e,["tools"]);if(void 0!==t&&null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>Po(e))),$t(t,["tools"],e)}const a=Bt(e,["generationConfig"]);return void 0!==t&&null!=a&&$t(t,["generationConfig"],function(e){const t={},n=Bt(e,["modelSelectionConfig"]);null!=n&&$t(t,["modelConfig"],n);const r=Bt(e,["responseJsonSchema"]);null!=r&&$t(t,["responseJsonSchema"],r);const a=Bt(e,["audioTimestamp"]);null!=a&&$t(t,["audioTimestamp"],a);const i=Bt(e,["candidateCount"]);null!=i&&$t(t,["candidateCount"],i);const o=Bt(e,["enableAffectiveDialog"]);null!=o&&$t(t,["enableAffectiveDialog"],o);const s=Bt(e,["frequencyPenalty"]);null!=s&&$t(t,["frequencyPenalty"],s);const l=Bt(e,["logprobs"]);null!=l&&$t(t,["logprobs"],l);const c=Bt(e,["maxOutputTokens"]);null!=c&&$t(t,["maxOutputTokens"],c);const u=Bt(e,["mediaResolution"]);null!=u&&$t(t,["mediaResolution"],u);const d=Bt(e,["presencePenalty"]);null!=d&&$t(t,["presencePenalty"],d);const p=Bt(e,["responseLogprobs"]);null!=p&&$t(t,["responseLogprobs"],p);const h=Bt(e,["responseMimeType"]);null!=h&&$t(t,["responseMimeType"],h);const m=Bt(e,["responseModalities"]);null!=m&&$t(t,["responseModalities"],m);const f=Bt(e,["responseSchema"]);null!=f&&$t(t,["responseSchema"],f);const g=Bt(e,["routingConfig"]);null!=g&&$t(t,["routingConfig"],g);const y=Bt(e,["seed"]);null!=y&&$t(t,["seed"],y);const x=Bt(e,["speechConfig"]);null!=x&&$t(t,["speechConfig"],Oo(x));const b=Bt(e,["stopSequences"]);null!=b&&$t(t,["stopSequences"],b);const v=Bt(e,["temperature"]);null!=v&&$t(t,["temperature"],v);const w=Bt(e,["thinkingConfig"]);null!=w&&$t(t,["thinkingConfig"],w);const N=Bt(e,["topK"]);null!=N&&$t(t,["topK"],N);const E=Bt(e,["topP"]);null!=E&&$t(t,["topP"],E);if(void 0!==Bt(e,["enableEnhancedCivicAnswers"]))throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return t}(a)),{}}function Zi(e,t){const n={},r=Bt(t,["model"]);null!=r&&$t(n,["_url","model"],ja(e,r));const a=Bt(t,["contents"]);if(null!=a){let e=Ha(a);Array.isArray(e)&&(e=e.map(e=>Qi(e))),$t(n,["contents"],e)}const i=Bt(t,["config"]);return null!=i&&function(e){if(void 0!==Bt(e,["systemInstruction"]))throw new Error("systemInstruction parameter is not supported in Gemini API.");if(void 0!==Bt(e,["tools"]))throw new Error("tools parameter is not supported in Gemini API.");if(void 0!==Bt(e,["generationConfig"]))throw new Error("generationConfig parameter is not supported in Gemini API.")}(i),n}function eo(e,t){const n={},r=Bt(t,["model"]);null!=r&&$t(n,["_url","model"],ja(e,r));const a=Bt(t,["prompt"]);null!=a&&$t(n,["instances[0]","prompt"],a);const i=Bt(t,["referenceImages"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=Bt(e,["referenceImage"]);null!=n&&$t(t,["referenceImage"],No(n));const r=Bt(e,["referenceId"]);null!=r&&$t(t,["referenceId"],r);const a=Bt(e,["referenceType"]);null!=a&&$t(t,["referenceType"],a);const i=Bt(e,["maskImageConfig"]);null!=i&&$t(t,["maskImageConfig"],function(e){const t={},n=Bt(e,["maskMode"]);null!=n&&$t(t,["maskMode"],n);const r=Bt(e,["segmentationClasses"]);null!=r&&$t(t,["maskClasses"],r);const a=Bt(e,["maskDilation"]);null!=a&&$t(t,["dilation"],a);return t}(i));const o=Bt(e,["controlImageConfig"]);null!=o&&$t(t,["controlImageConfig"],function(e){const t={},n=Bt(e,["controlType"]);null!=n&&$t(t,["controlType"],n);const r=Bt(e,["enableControlImageComputation"]);return null!=r&&$t(t,["computeControl"],r),t}(o));const s=Bt(e,["styleImageConfig"]);null!=s&&$t(t,["styleImageConfig"],s);const l=Bt(e,["subjectImageConfig"]);null!=l&&$t(t,["subjectImageConfig"],l);return t}(e))),$t(n,["instances[0]","referenceImages"],e)}const o=Bt(t,["config"]);return null!=o&&function(e,t){const n=Bt(e,["outputGcsUri"]);void 0!==t&&null!=n&&$t(t,["parameters","storageUri"],n);const r=Bt(e,["negativePrompt"]);void 0!==t&&null!=r&&$t(t,["parameters","negativePrompt"],r);const a=Bt(e,["numberOfImages"]);void 0!==t&&null!=a&&$t(t,["parameters","sampleCount"],a);const i=Bt(e,["aspectRatio"]);void 0!==t&&null!=i&&$t(t,["parameters","aspectRatio"],i);const o=Bt(e,["guidanceScale"]);void 0!==t&&null!=o&&$t(t,["parameters","guidanceScale"],o);const s=Bt(e,["seed"]);void 0!==t&&null!=s&&$t(t,["parameters","seed"],s);const l=Bt(e,["safetyFilterLevel"]);void 0!==t&&null!=l&&$t(t,["parameters","safetySetting"],l);const c=Bt(e,["personGeneration"]);void 0!==t&&null!=c&&$t(t,["parameters","personGeneration"],c);const u=Bt(e,["includeSafetyAttributes"]);void 0!==t&&null!=u&&$t(t,["parameters","includeSafetyAttributes"],u);const d=Bt(e,["includeRaiReason"]);void 0!==t&&null!=d&&$t(t,["parameters","includeRaiReason"],d);const p=Bt(e,["language"]);void 0!==t&&null!=p&&$t(t,["parameters","language"],p);const h=Bt(e,["outputMimeType"]);void 0!==t&&null!=h&&$t(t,["parameters","outputOptions","mimeType"],h);const m=Bt(e,["outputCompressionQuality"]);void 0!==t&&null!=m&&$t(t,["parameters","outputOptions","compressionQuality"],m);const f=Bt(e,["addWatermark"]);void 0!==t&&null!=f&&$t(t,["parameters","addWatermark"],f);const g=Bt(e,["labels"]);void 0!==t&&null!=g&&$t(t,["labels"],g);const y=Bt(e,["editMode"]);void 0!==t&&null!=y&&$t(t,["parameters","editMode"],y);const x=Bt(e,["baseSteps"]);void 0!==t&&null!=x&&$t(t,["parameters","editConfig","baseSteps"],x)}(o,n),n}function to(e,t){const n={},r=Bt(t,["model"]);null!=r&&$t(n,["_url","model"],ja(e,r));const a=Bt(t,["contents"]);if(null!=a){let t=qa(e,a);Array.isArray(t)&&(t=t.map(e=>e)),$t(n,["requests[]","content"],t)}const i=Bt(t,["config"]);null!=i&&function(e,t){const n=Bt(e,["taskType"]);void 0!==t&&null!=n&&$t(t,["requests[]","taskType"],n);const r=Bt(e,["title"]);void 0!==t&&null!=r&&$t(t,["requests[]","title"],r);const a=Bt(e,["outputDimensionality"]);if(void 0!==t&&null!=a&&$t(t,["requests[]","outputDimensionality"],a),void 0!==Bt(e,["mimeType"]))throw new Error("mimeType parameter is not supported in Gemini API.");if(void 0!==Bt(e,["autoTruncate"]))throw new Error("autoTruncate parameter is not supported in Gemini API.")}(i,n);const o=Bt(t,["model"]);return void 0!==o&&$t(n,["requests[]","model"],ja(e,o)),n}function no(e,t){const n={},r=Bt(t,["model"]);null!=r&&$t(n,["_url","model"],ja(e,r));const a=Bt(t,["contents"]);if(null!=a){let t=qa(e,a);Array.isArray(t)&&(t=t.map(e=>e)),$t(n,["instances[]","content"],t)}const i=Bt(t,["config"]);return null!=i&&function(e,t){const n=Bt(e,["taskType"]);void 0!==t&&null!=n&&$t(t,["instances[]","task_type"],n);const r=Bt(e,["title"]);void 0!==t&&null!=r&&$t(t,["instances[]","title"],r);const a=Bt(e,["outputDimensionality"]);void 0!==t&&null!=a&&$t(t,["parameters","outputDimensionality"],a);const i=Bt(e,["mimeType"]);void 0!==t&&null!=i&&$t(t,["instances[]","mimeType"],i);const o=Bt(e,["autoTruncate"]);void 0!==t&&null!=o&&$t(t,["parameters","autoTruncate"],o)}(i,n),n}function ro(e,t,n){const r={},a=Bt(t,["systemInstruction"]);void 0!==n&&null!=a&&$t(n,["systemInstruction"],Qi(Ga(a)));const i=Bt(t,["temperature"]);null!=i&&$t(r,["temperature"],i);const o=Bt(t,["topP"]);null!=o&&$t(r,["topP"],o);const s=Bt(t,["topK"]);null!=s&&$t(r,["topK"],s);const l=Bt(t,["candidateCount"]);null!=l&&$t(r,["candidateCount"],l);const c=Bt(t,["maxOutputTokens"]);null!=c&&$t(r,["maxOutputTokens"],c);const u=Bt(t,["stopSequences"]);null!=u&&$t(r,["stopSequences"],u);const d=Bt(t,["responseLogprobs"]);null!=d&&$t(r,["responseLogprobs"],d);const p=Bt(t,["logprobs"]);null!=p&&$t(r,["logprobs"],p);const h=Bt(t,["presencePenalty"]);null!=h&&$t(r,["presencePenalty"],h);const m=Bt(t,["frequencyPenalty"]);null!=m&&$t(r,["frequencyPenalty"],m);const f=Bt(t,["seed"]);null!=f&&$t(r,["seed"],f);const g=Bt(t,["responseMimeType"]);null!=g&&$t(r,["responseMimeType"],g);const y=Bt(t,["responseSchema"]);null!=y&&$t(r,["responseSchema"],Ba(y));const x=Bt(t,["responseJsonSchema"]);if(null!=x&&$t(r,["responseJsonSchema"],x),void 0!==Bt(t,["routingConfig"]))throw new Error("routingConfig parameter is not supported in Gemini API.");if(void 0!==Bt(t,["modelSelectionConfig"]))throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const b=Bt(t,["safetySettings"]);if(void 0!==n&&null!=b){let e=b;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=Bt(e,["category"]);null!=n&&$t(t,["category"],n);if(void 0!==Bt(e,["method"]))throw new Error("method parameter is not supported in Gemini API.");const r=Bt(e,["threshold"]);null!=r&&$t(t,["threshold"],r);return t}(e))),$t(n,["safetySettings"],e)}const v=Bt(t,["tools"]);if(void 0!==n&&null!=v){let e=Ka(v);Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=Bt(e,["functionDeclarations"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),$t(t,["functionDeclarations"],e)}if(void 0!==Bt(e,["retrieval"]))throw new Error("retrieval parameter is not supported in Gemini API.");const r=Bt(e,["googleSearchRetrieval"]);null!=r&&$t(t,["googleSearchRetrieval"],r);const a=Bt(e,["computerUse"]);null!=a&&$t(t,["computerUse"],a);const i=Bt(e,["fileSearch"]);null!=i&&$t(t,["fileSearch"],i);const o=Bt(e,["codeExecution"]);null!=o&&$t(t,["codeExecution"],o);if(void 0!==Bt(e,["enterpriseWebSearch"]))throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const s=Bt(e,["googleMaps"]);null!=s&&$t(t,["googleMaps"],function(e){const t={};if(void 0!==Bt(e,["authConfig"]))throw new Error("authConfig parameter is not supported in Gemini API.");const n=Bt(e,["enableWidget"]);null!=n&&$t(t,["enableWidget"],n);return t}(s));const l=Bt(e,["googleSearch"]);null!=l&&$t(t,["googleSearch"],function(e){const t={};if(void 0!==Bt(e,["excludeDomains"]))throw new Error("excludeDomains parameter is not supported in Gemini API.");if(void 0!==Bt(e,["blockingConfidence"]))throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=Bt(e,["timeRangeFilter"]);null!=n&&$t(t,["timeRangeFilter"],n);return t}(l));const c=Bt(e,["urlContext"]);null!=c&&$t(t,["urlContext"],c);return t}(Wa(e)))),$t(n,["tools"],e)}const w=Bt(t,["toolConfig"]);if(void 0!==n&&null!=w&&$t(n,["toolConfig"],function(e){const t={},n=Bt(e,["functionCallingConfig"]);null!=n&&$t(t,["functionCallingConfig"],function(e){const t={},n=Bt(e,["mode"]);null!=n&&$t(t,["mode"],n);const r=Bt(e,["allowedFunctionNames"]);if(null!=r&&$t(t,["allowedFunctionNames"],r),void 0!==Bt(e,["streamFunctionCallArguments"]))throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return t}(n));const r=Bt(e,["retrievalConfig"]);null!=r&&$t(t,["retrievalConfig"],r);return t}(w)),void 0!==Bt(t,["labels"]))throw new Error("labels parameter is not supported in Gemini API.");const N=Bt(t,["cachedContent"]);void 0!==n&&null!=N&&$t(n,["cachedContent"],Ja(e,N));const E=Bt(t,["responseModalities"]);null!=E&&$t(r,["responseModalities"],E);const S=Bt(t,["mediaResolution"]);null!=S&&$t(r,["mediaResolution"],S);const C=Bt(t,["speechConfig"]);if(null!=C&&$t(r,["speechConfig"],Va(C)),void 0!==Bt(t,["audioTimestamp"]))throw new Error("audioTimestamp parameter is not supported in Gemini API.");const k=Bt(t,["thinkingConfig"]);null!=k&&$t(r,["thinkingConfig"],k);const T=Bt(t,["imageConfig"]);return null!=T&&$t(r,["imageConfig"],function(e){const t={},n=Bt(e,["aspectRatio"]);null!=n&&$t(t,["aspectRatio"],n);const r=Bt(e,["imageSize"]);null!=r&&$t(t,["imageSize"],r);if(void 0!==Bt(e,["outputMimeType"]))throw new Error("outputMimeType parameter is not supported in Gemini API.");if(void 0!==Bt(e,["outputCompressionQuality"]))throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return t}(T)),r}function ao(e,t,n){const r={},a=Bt(t,["systemInstruction"]);void 0!==n&&null!=a&&$t(n,["systemInstruction"],Ga(a));const i=Bt(t,["temperature"]);null!=i&&$t(r,["temperature"],i);const o=Bt(t,["topP"]);null!=o&&$t(r,["topP"],o);const s=Bt(t,["topK"]);null!=s&&$t(r,["topK"],s);const l=Bt(t,["candidateCount"]);null!=l&&$t(r,["candidateCount"],l);const c=Bt(t,["maxOutputTokens"]);null!=c&&$t(r,["maxOutputTokens"],c);const u=Bt(t,["stopSequences"]);null!=u&&$t(r,["stopSequences"],u);const d=Bt(t,["responseLogprobs"]);null!=d&&$t(r,["responseLogprobs"],d);const p=Bt(t,["logprobs"]);null!=p&&$t(r,["logprobs"],p);const h=Bt(t,["presencePenalty"]);null!=h&&$t(r,["presencePenalty"],h);const m=Bt(t,["frequencyPenalty"]);null!=m&&$t(r,["frequencyPenalty"],m);const f=Bt(t,["seed"]);null!=f&&$t(r,["seed"],f);const g=Bt(t,["responseMimeType"]);null!=g&&$t(r,["responseMimeType"],g);const y=Bt(t,["responseSchema"]);null!=y&&$t(r,["responseSchema"],Ba(y));const x=Bt(t,["responseJsonSchema"]);null!=x&&$t(r,["responseJsonSchema"],x);const b=Bt(t,["routingConfig"]);null!=b&&$t(r,["routingConfig"],b);const v=Bt(t,["modelSelectionConfig"]);null!=v&&$t(r,["modelConfig"],v);const w=Bt(t,["safetySettings"]);if(void 0!==n&&null!=w){let e=w;Array.isArray(e)&&(e=e.map(e=>e)),$t(n,["safetySettings"],e)}const N=Bt(t,["tools"]);if(void 0!==n&&null!=N){let e=Ka(N);Array.isArray(e)&&(e=e.map(e=>Po(Wa(e)))),$t(n,["tools"],e)}const E=Bt(t,["toolConfig"]);void 0!==n&&null!=E&&$t(n,["toolConfig"],E);const S=Bt(t,["labels"]);void 0!==n&&null!=S&&$t(n,["labels"],S);const C=Bt(t,["cachedContent"]);void 0!==n&&null!=C&&$t(n,["cachedContent"],Ja(e,C));const k=Bt(t,["responseModalities"]);null!=k&&$t(r,["responseModalities"],k);const T=Bt(t,["mediaResolution"]);null!=T&&$t(r,["mediaResolution"],T);const I=Bt(t,["speechConfig"]);null!=I&&$t(r,["speechConfig"],Oo(Va(I)));const A=Bt(t,["audioTimestamp"]);null!=A&&$t(r,["audioTimestamp"],A);const j=Bt(t,["thinkingConfig"]);null!=j&&$t(r,["thinkingConfig"],j);const _=Bt(t,["imageConfig"]);return null!=_&&$t(r,["imageConfig"],function(e){const t={},n=Bt(e,["aspectRatio"]);null!=n&&$t(t,["aspectRatio"],n);const r=Bt(e,["imageSize"]);null!=r&&$t(t,["imageSize"],r);const a=Bt(e,["outputMimeType"]);null!=a&&$t(t,["imageOutputOptions","mimeType"],a);const i=Bt(e,["outputCompressionQuality"]);null!=i&&$t(t,["imageOutputOptions","compressionQuality"],i);return t}(_)),r}function io(e,t){const n={},r=Bt(t,["model"]);null!=r&&$t(n,["_url","model"],ja(e,r));const a=Bt(t,["contents"]);if(null!=a){let e=Ha(a);Array.isArray(e)&&(e=e.map(e=>Qi(e))),$t(n,["contents"],e)}const i=Bt(t,["config"]);return null!=i&&$t(n,["generationConfig"],ro(e,i,n)),n}function oo(e,t){const n={},r=Bt(t,["model"]);null!=r&&$t(n,["_url","model"],ja(e,r));const a=Bt(t,["contents"]);if(null!=a){let e=Ha(a);Array.isArray(e)&&(e=e.map(e=>e)),$t(n,["contents"],e)}const i=Bt(t,["config"]);return null!=i&&$t(n,["generationConfig"],ao(e,i,n)),n}function so(e){const t={},n=Bt(e,["sdkHttpResponse"]);null!=n&&$t(t,["sdkHttpResponse"],n);const r=Bt(e,["candidates"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>Ki(e))),$t(t,["candidates"],e)}const a=Bt(e,["modelVersion"]);null!=a&&$t(t,["modelVersion"],a);const i=Bt(e,["promptFeedback"]);null!=i&&$t(t,["promptFeedback"],i);const o=Bt(e,["responseId"]);null!=o&&$t(t,["responseId"],o);const s=Bt(e,["usageMetadata"]);return null!=s&&$t(t,["usageMetadata"],s),t}function lo(e){const t={},n=Bt(e,["sdkHttpResponse"]);null!=n&&$t(t,["sdkHttpResponse"],n);const r=Bt(e,["candidates"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>e)),$t(t,["candidates"],e)}const a=Bt(e,["createTime"]);null!=a&&$t(t,["createTime"],a);const i=Bt(e,["modelVersion"]);null!=i&&$t(t,["modelVersion"],i);const o=Bt(e,["promptFeedback"]);null!=o&&$t(t,["promptFeedback"],o);const s=Bt(e,["responseId"]);null!=s&&$t(t,["responseId"],s);const l=Bt(e,["usageMetadata"]);return null!=l&&$t(t,["usageMetadata"],l),t}function co(e,t){const n={},r=Bt(t,["model"]);null!=r&&$t(n,["_url","model"],ja(e,r));const a=Bt(t,["prompt"]);null!=a&&$t(n,["instances[0]","prompt"],a);const i=Bt(t,["config"]);return null!=i&&function(e,t){if(void 0!==Bt(e,["outputGcsUri"]))throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(void 0!==Bt(e,["negativePrompt"]))throw new Error("negativePrompt parameter is not supported in Gemini API.");const n=Bt(e,["numberOfImages"]);void 0!==t&&null!=n&&$t(t,["parameters","sampleCount"],n);const r=Bt(e,["aspectRatio"]);void 0!==t&&null!=r&&$t(t,["parameters","aspectRatio"],r);const a=Bt(e,["guidanceScale"]);if(void 0!==t&&null!=a&&$t(t,["parameters","guidanceScale"],a),void 0!==Bt(e,["seed"]))throw new Error("seed parameter is not supported in Gemini API.");const i=Bt(e,["safetyFilterLevel"]);void 0!==t&&null!=i&&$t(t,["parameters","safetySetting"],i);const o=Bt(e,["personGeneration"]);void 0!==t&&null!=o&&$t(t,["parameters","personGeneration"],o);const s=Bt(e,["includeSafetyAttributes"]);void 0!==t&&null!=s&&$t(t,["parameters","includeSafetyAttributes"],s);const l=Bt(e,["includeRaiReason"]);void 0!==t&&null!=l&&$t(t,["parameters","includeRaiReason"],l);const c=Bt(e,["language"]);void 0!==t&&null!=c&&$t(t,["parameters","language"],c);const u=Bt(e,["outputMimeType"]);void 0!==t&&null!=u&&$t(t,["parameters","outputOptions","mimeType"],u);const d=Bt(e,["outputCompressionQuality"]);if(void 0!==t&&null!=d&&$t(t,["parameters","outputOptions","compressionQuality"],d),void 0!==Bt(e,["addWatermark"]))throw new Error("addWatermark parameter is not supported in Gemini API.");if(void 0!==Bt(e,["labels"]))throw new Error("labels parameter is not supported in Gemini API.");const p=Bt(e,["imageSize"]);if(void 0!==t&&null!=p&&$t(t,["parameters","sampleImageSize"],p),void 0!==Bt(e,["enhancePrompt"]))throw new Error("enhancePrompt parameter is not supported in Gemini API.")}(i,n),n}function uo(e,t){const n={},r=Bt(t,["model"]);null!=r&&$t(n,["_url","model"],ja(e,r));const a=Bt(t,["prompt"]);null!=a&&$t(n,["instances[0]","prompt"],a);const i=Bt(t,["config"]);return null!=i&&function(e,t){const n=Bt(e,["outputGcsUri"]);void 0!==t&&null!=n&&$t(t,["parameters","storageUri"],n);const r=Bt(e,["negativePrompt"]);void 0!==t&&null!=r&&$t(t,["parameters","negativePrompt"],r);const a=Bt(e,["numberOfImages"]);void 0!==t&&null!=a&&$t(t,["parameters","sampleCount"],a);const i=Bt(e,["aspectRatio"]);void 0!==t&&null!=i&&$t(t,["parameters","aspectRatio"],i);const o=Bt(e,["guidanceScale"]);void 0!==t&&null!=o&&$t(t,["parameters","guidanceScale"],o);const s=Bt(e,["seed"]);void 0!==t&&null!=s&&$t(t,["parameters","seed"],s);const l=Bt(e,["safetyFilterLevel"]);void 0!==t&&null!=l&&$t(t,["parameters","safetySetting"],l);const c=Bt(e,["personGeneration"]);void 0!==t&&null!=c&&$t(t,["parameters","personGeneration"],c);const u=Bt(e,["includeSafetyAttributes"]);void 0!==t&&null!=u&&$t(t,["parameters","includeSafetyAttributes"],u);const d=Bt(e,["includeRaiReason"]);void 0!==t&&null!=d&&$t(t,["parameters","includeRaiReason"],d);const p=Bt(e,["language"]);void 0!==t&&null!=p&&$t(t,["parameters","language"],p);const h=Bt(e,["outputMimeType"]);void 0!==t&&null!=h&&$t(t,["parameters","outputOptions","mimeType"],h);const m=Bt(e,["outputCompressionQuality"]);void 0!==t&&null!=m&&$t(t,["parameters","outputOptions","compressionQuality"],m);const f=Bt(e,["addWatermark"]);void 0!==t&&null!=f&&$t(t,["parameters","addWatermark"],f);const g=Bt(e,["labels"]);void 0!==t&&null!=g&&$t(t,["labels"],g);const y=Bt(e,["imageSize"]);void 0!==t&&null!=y&&$t(t,["parameters","sampleImageSize"],y);const x=Bt(e,["enhancePrompt"]);void 0!==t&&null!=x&&$t(t,["parameters","enhancePrompt"],x)}(i,n),n}function po(e){const t={},n=Bt(e,["sdkHttpResponse"]);null!=n&&$t(t,["sdkHttpResponse"],n);const r=Bt(e,["predictions"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=Bt(e,["_self"]);null!=n&&$t(t,["image"],function(e){const t={},n=Bt(e,["bytesBase64Encoded"]);null!=n&&$t(t,["imageBytes"],Xa(n));const r=Bt(e,["mimeType"]);null!=r&&$t(t,["mimeType"],r);return t}(n));const r=Bt(e,["raiFilteredReason"]);null!=r&&$t(t,["raiFilteredReason"],r);const a=Bt(e,["_self"]);null!=a&&$t(t,["safetyAttributes"],Io(a));return t}(e))),$t(t,["generatedImages"],e)}const a=Bt(e,["positivePromptSafetyAttributes"]);return null!=a&&$t(t,["positivePromptSafetyAttributes"],Io(a)),t}function ho(e,t){const n=Bt(e,["numberOfVideos"]);if(void 0!==t&&null!=n&&$t(t,["parameters","sampleCount"],n),void 0!==Bt(e,["outputGcsUri"]))throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(void 0!==Bt(e,["fps"]))throw new Error("fps parameter is not supported in Gemini API.");const r=Bt(e,["durationSeconds"]);if(void 0!==t&&null!=r&&$t(t,["parameters","durationSeconds"],r),void 0!==Bt(e,["seed"]))throw new Error("seed parameter is not supported in Gemini API.");const a=Bt(e,["aspectRatio"]);void 0!==t&&null!=a&&$t(t,["parameters","aspectRatio"],a);const i=Bt(e,["resolution"]);void 0!==t&&null!=i&&$t(t,["parameters","resolution"],i);const o=Bt(e,["personGeneration"]);if(void 0!==t&&null!=o&&$t(t,["parameters","personGeneration"],o),void 0!==Bt(e,["pubsubTopic"]))throw new Error("pubsubTopic parameter is not supported in Gemini API.");const s=Bt(e,["negativePrompt"]);void 0!==t&&null!=s&&$t(t,["parameters","negativePrompt"],s);const l=Bt(e,["enhancePrompt"]);if(void 0!==t&&null!=l&&$t(t,["parameters","enhancePrompt"],l),void 0!==Bt(e,["generateAudio"]))throw new Error("generateAudio parameter is not supported in Gemini API.");const c=Bt(e,["lastFrame"]);void 0!==t&&null!=c&&$t(t,["instances[0]","lastFrame"],wo(c));const u=Bt(e,["referenceImages"]);if(void 0!==t&&null!=u){let e=u;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=Bt(e,["image"]);null!=n&&$t(t,["image"],wo(n));const r=Bt(e,["referenceType"]);null!=r&&$t(t,["referenceType"],r);return t}(e))),$t(t,["instances[0]","referenceImages"],e)}if(void 0!==Bt(e,["mask"]))throw new Error("mask parameter is not supported in Gemini API.");if(void 0!==Bt(e,["compressionQuality"]))throw new Error("compressionQuality parameter is not supported in Gemini API.");return{}}function mo(e,t){const n=Bt(e,["numberOfVideos"]);void 0!==t&&null!=n&&$t(t,["parameters","sampleCount"],n);const r=Bt(e,["outputGcsUri"]);void 0!==t&&null!=r&&$t(t,["parameters","storageUri"],r);const a=Bt(e,["fps"]);void 0!==t&&null!=a&&$t(t,["parameters","fps"],a);const i=Bt(e,["durationSeconds"]);void 0!==t&&null!=i&&$t(t,["parameters","durationSeconds"],i);const o=Bt(e,["seed"]);void 0!==t&&null!=o&&$t(t,["parameters","seed"],o);const s=Bt(e,["aspectRatio"]);void 0!==t&&null!=s&&$t(t,["parameters","aspectRatio"],s);const l=Bt(e,["resolution"]);void 0!==t&&null!=l&&$t(t,["parameters","resolution"],l);const c=Bt(e,["personGeneration"]);void 0!==t&&null!=c&&$t(t,["parameters","personGeneration"],c);const u=Bt(e,["pubsubTopic"]);void 0!==t&&null!=u&&$t(t,["parameters","pubsubTopic"],u);const d=Bt(e,["negativePrompt"]);void 0!==t&&null!=d&&$t(t,["parameters","negativePrompt"],d);const p=Bt(e,["enhancePrompt"]);void 0!==t&&null!=p&&$t(t,["parameters","enhancePrompt"],p);const h=Bt(e,["generateAudio"]);void 0!==t&&null!=h&&$t(t,["parameters","generateAudio"],h);const m=Bt(e,["lastFrame"]);void 0!==t&&null!=m&&$t(t,["instances[0]","lastFrame"],No(m));const f=Bt(e,["referenceImages"]);if(void 0!==t&&null!=f){let e=f;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=Bt(e,["image"]);null!=n&&$t(t,["image"],No(n));const r=Bt(e,["referenceType"]);null!=r&&$t(t,["referenceType"],r);return t}(e))),$t(t,["instances[0]","referenceImages"],e)}const g=Bt(e,["mask"]);void 0!==t&&null!=g&&$t(t,["instances[0]","mask"],function(e){const t={},n=Bt(e,["image"]);null!=n&&$t(t,["_self"],No(n));const r=Bt(e,["maskMode"]);null!=r&&$t(t,["maskMode"],r);return t}(g));const y=Bt(e,["compressionQuality"]);return void 0!==t&&null!=y&&$t(t,["parameters","compressionQuality"],y),{}}function fo(e){const t={},n=Bt(e,["name"]);null!=n&&$t(t,["name"],n);const r=Bt(e,["metadata"]);null!=r&&$t(t,["metadata"],r);const a=Bt(e,["done"]);null!=a&&$t(t,["done"],a);const i=Bt(e,["error"]);null!=i&&$t(t,["error"],i);const o=Bt(e,["response","generateVideoResponse"]);return null!=o&&$t(t,["response"],function(e){const t={},n=Bt(e,["generatedSamples"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=Bt(e,["video"]);null!=n&&$t(t,["video"],function(e){const t={},n=Bt(e,["uri"]);null!=n&&$t(t,["uri"],n);const r=Bt(e,["encodedVideo"]);null!=r&&$t(t,["videoBytes"],Xa(r));const a=Bt(e,["encoding"]);null!=a&&$t(t,["mimeType"],a);return t}(n));return t}(e))),$t(t,["generatedVideos"],e)}const r=Bt(e,["raiMediaFilteredCount"]);null!=r&&$t(t,["raiMediaFilteredCount"],r);const a=Bt(e,["raiMediaFilteredReasons"]);null!=a&&$t(t,["raiMediaFilteredReasons"],a);return t}(o)),t}function go(e){const t={},n=Bt(e,["name"]);null!=n&&$t(t,["name"],n);const r=Bt(e,["metadata"]);null!=r&&$t(t,["metadata"],r);const a=Bt(e,["done"]);null!=a&&$t(t,["done"],a);const i=Bt(e,["error"]);null!=i&&$t(t,["error"],i);const o=Bt(e,["response"]);return null!=o&&$t(t,["response"],function(e){const t={},n=Bt(e,["videos"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=Bt(e,["_self"]);null!=n&&$t(t,["video"],function(e){const t={},n=Bt(e,["gcsUri"]);null!=n&&$t(t,["uri"],n);const r=Bt(e,["bytesBase64Encoded"]);null!=r&&$t(t,["videoBytes"],Xa(r));const a=Bt(e,["mimeType"]);null!=a&&$t(t,["mimeType"],a);return t}(n));return t}(e))),$t(t,["generatedVideos"],e)}const r=Bt(e,["raiMediaFilteredCount"]);null!=r&&$t(t,["raiMediaFilteredCount"],r);const a=Bt(e,["raiMediaFilteredReasons"]);null!=a&&$t(t,["raiMediaFilteredReasons"],a);return t}(o)),t}function yo(e,t){const n={},r=Bt(t,["model"]);null!=r&&$t(n,["_url","model"],ja(e,r));const a=Bt(t,["prompt"]);null!=a&&$t(n,["instances[0]","prompt"],a);const i=Bt(t,["image"]);null!=i&&$t(n,["instances[0]","image"],wo(i));const o=Bt(t,["video"]);null!=o&&$t(n,["instances[0]","video"],Lo(o));const s=Bt(t,["source"]);null!=s&&function(e,t){const n={},r=Bt(e,["prompt"]);void 0!==t&&null!=r&&$t(t,["instances[0]","prompt"],r);const a=Bt(e,["image"]);void 0!==t&&null!=a&&$t(t,["instances[0]","image"],wo(a));const i=Bt(e,["video"]);void 0!==t&&null!=i&&$t(t,["instances[0]","video"],Lo(i))}(s,n);const l=Bt(t,["config"]);return null!=l&&ho(l,n),n}function xo(e,t){const n={},r=Bt(t,["model"]);null!=r&&$t(n,["_url","model"],ja(e,r));const a=Bt(t,["prompt"]);null!=a&&$t(n,["instances[0]","prompt"],a);const i=Bt(t,["image"]);null!=i&&$t(n,["instances[0]","image"],No(i));const o=Bt(t,["video"]);null!=o&&$t(n,["instances[0]","video"],Uo(o));const s=Bt(t,["source"]);null!=s&&function(e,t){const n={},r=Bt(e,["prompt"]);void 0!==t&&null!=r&&$t(t,["instances[0]","prompt"],r);const a=Bt(e,["image"]);void 0!==t&&null!=a&&$t(t,["instances[0]","image"],No(a));const i=Bt(e,["video"]);void 0!==t&&null!=i&&$t(t,["instances[0]","video"],Uo(i))}(s,n);const l=Bt(t,["config"]);return null!=l&&mo(l,n),n}function bo(e){const t={},n=Bt(e,["_self"]);null!=n&&$t(t,["image"],vo(n));const r=Bt(e,["raiFilteredReason"]);null!=r&&$t(t,["raiFilteredReason"],r);const a=Bt(e,["_self"]);null!=a&&$t(t,["safetyAttributes"],Ao(a));const i=Bt(e,["prompt"]);return null!=i&&$t(t,["enhancedPrompt"],i),t}function vo(e){const t={},n=Bt(e,["gcsUri"]);null!=n&&$t(t,["gcsUri"],n);const r=Bt(e,["bytesBase64Encoded"]);null!=r&&$t(t,["imageBytes"],Xa(r));const a=Bt(e,["mimeType"]);return null!=a&&$t(t,["mimeType"],a),t}function wo(e){const t={};if(void 0!==Bt(e,["gcsUri"]))throw new Error("gcsUri parameter is not supported in Gemini API.");const n=Bt(e,["imageBytes"]);null!=n&&$t(t,["bytesBase64Encoded"],Xa(n));const r=Bt(e,["mimeType"]);return null!=r&&$t(t,["mimeType"],r),t}function No(e){const t={},n=Bt(e,["gcsUri"]);null!=n&&$t(t,["gcsUri"],n);const r=Bt(e,["imageBytes"]);null!=r&&$t(t,["bytesBase64Encoded"],Xa(r));const a=Bt(e,["mimeType"]);return null!=a&&$t(t,["mimeType"],a),t}function Eo(e,t){const n={},r=Bt(t,["config"]);return null!=r&&function(e,t,n){const r=Bt(t,["pageSize"]);void 0!==n&&null!=r&&$t(n,["_query","pageSize"],r);const a=Bt(t,["pageToken"]);void 0!==n&&null!=a&&$t(n,["_query","pageToken"],a);const i=Bt(t,["filter"]);void 0!==n&&null!=i&&$t(n,["_query","filter"],i);const o=Bt(t,["queryBase"]);void 0!==n&&null!=o&&$t(n,["_url","models_url"],ei(e,o))}(e,r,n),n}function So(e,t){const n={},r=Bt(t,["config"]);return null!=r&&function(e,t,n){const r=Bt(t,["pageSize"]);void 0!==n&&null!=r&&$t(n,["_query","pageSize"],r);const a=Bt(t,["pageToken"]);void 0!==n&&null!=a&&$t(n,["_query","pageToken"],a);const i=Bt(t,["filter"]);void 0!==n&&null!=i&&$t(n,["_query","filter"],i);const o=Bt(t,["queryBase"]);void 0!==n&&null!=o&&$t(n,["_url","models_url"],ei(e,o))}(e,r,n),n}function Co(e){const t={},n=Bt(e,["name"]);null!=n&&$t(t,["name"],n);const r=Bt(e,["displayName"]);null!=r&&$t(t,["displayName"],r);const a=Bt(e,["description"]);null!=a&&$t(t,["description"],a);const i=Bt(e,["version"]);null!=i&&$t(t,["version"],i);const o=Bt(e,["_self"]);null!=o&&$t(t,["tunedModelInfo"],function(e){const t={},n=Bt(e,["baseModel"]);null!=n&&$t(t,["baseModel"],n);const r=Bt(e,["createTime"]);null!=r&&$t(t,["createTime"],r);const a=Bt(e,["updateTime"]);null!=a&&$t(t,["updateTime"],a);return t}(o));const s=Bt(e,["inputTokenLimit"]);null!=s&&$t(t,["inputTokenLimit"],s);const l=Bt(e,["outputTokenLimit"]);null!=l&&$t(t,["outputTokenLimit"],l);const c=Bt(e,["supportedGenerationMethods"]);null!=c&&$t(t,["supportedActions"],c);const u=Bt(e,["temperature"]);null!=u&&$t(t,["temperature"],u);const d=Bt(e,["maxTemperature"]);null!=d&&$t(t,["maxTemperature"],d);const p=Bt(e,["topP"]);null!=p&&$t(t,["topP"],p);const h=Bt(e,["topK"]);null!=h&&$t(t,["topK"],h);const m=Bt(e,["thinking"]);return null!=m&&$t(t,["thinking"],m),t}function ko(e){const t={},n=Bt(e,["name"]);null!=n&&$t(t,["name"],n);const r=Bt(e,["displayName"]);null!=r&&$t(t,["displayName"],r);const a=Bt(e,["description"]);null!=a&&$t(t,["description"],a);const i=Bt(e,["versionId"]);null!=i&&$t(t,["version"],i);const o=Bt(e,["deployedModels"]);if(null!=o){let e=o;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=Bt(e,["endpoint"]);null!=n&&$t(t,["name"],n);const r=Bt(e,["deployedModelId"]);return null!=r&&$t(t,["deployedModelId"],r),t}(e))),$t(t,["endpoints"],e)}const s=Bt(e,["labels"]);null!=s&&$t(t,["labels"],s);const l=Bt(e,["_self"]);null!=l&&$t(t,["tunedModelInfo"],function(e){const t={},n=Bt(e,["labels","google-vertex-llm-tuning-base-model-id"]);null!=n&&$t(t,["baseModel"],n);const r=Bt(e,["createTime"]);null!=r&&$t(t,["createTime"],r);const a=Bt(e,["updateTime"]);null!=a&&$t(t,["updateTime"],a);return t}(l));const c=Bt(e,["defaultCheckpointId"]);null!=c&&$t(t,["defaultCheckpointId"],c);const u=Bt(e,["checkpoints"]);if(null!=u){let e=u;Array.isArray(e)&&(e=e.map(e=>e)),$t(t,["checkpoints"],e)}return t}function To(e,t){const n={},r=Bt(t,["model"]);null!=r&&$t(n,["_url","model"],ja(e,r));const a=Bt(t,["source"]);null!=a&&function(e,t){const n={},r=Bt(e,["prompt"]);void 0!==t&&null!=r&&$t(t,["instances[0]","prompt"],r);const a=Bt(e,["personImage"]);void 0!==t&&null!=a&&$t(t,["instances[0]","personImage","image"],No(a));const i=Bt(e,["productImages"]);if(void 0!==t&&null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=Bt(e,["productImage"]);return null!=n&&$t(t,["image"],No(n)),t}(e))),$t(t,["instances[0]","productImages"],e)}}(a,n);const i=Bt(t,["config"]);return null!=i&&function(e,t){const n=Bt(e,["numberOfImages"]);void 0!==t&&null!=n&&$t(t,["parameters","sampleCount"],n);const r=Bt(e,["baseSteps"]);void 0!==t&&null!=r&&$t(t,["parameters","baseSteps"],r);const a=Bt(e,["outputGcsUri"]);void 0!==t&&null!=a&&$t(t,["parameters","storageUri"],a);const i=Bt(e,["seed"]);void 0!==t&&null!=i&&$t(t,["parameters","seed"],i);const o=Bt(e,["safetyFilterLevel"]);void 0!==t&&null!=o&&$t(t,["parameters","safetySetting"],o);const s=Bt(e,["personGeneration"]);void 0!==t&&null!=s&&$t(t,["parameters","personGeneration"],s);const l=Bt(e,["addWatermark"]);void 0!==t&&null!=l&&$t(t,["parameters","addWatermark"],l);const c=Bt(e,["outputMimeType"]);void 0!==t&&null!=c&&$t(t,["parameters","outputOptions","mimeType"],c);const u=Bt(e,["outputCompressionQuality"]);void 0!==t&&null!=u&&$t(t,["parameters","outputOptions","compressionQuality"],u);const d=Bt(e,["enhancePrompt"]);void 0!==t&&null!=d&&$t(t,["parameters","enhancePrompt"],d);const p=Bt(e,["labels"]);void 0!==t&&null!=p&&$t(t,["labels"],p)}(i,n),n}function Io(e){const t={},n=Bt(e,["safetyAttributes","categories"]);null!=n&&$t(t,["categories"],n);const r=Bt(e,["safetyAttributes","scores"]);null!=r&&$t(t,["scores"],r);const a=Bt(e,["contentType"]);return null!=a&&$t(t,["contentType"],a),t}function Ao(e){const t={},n=Bt(e,["safetyAttributes","categories"]);null!=n&&$t(t,["categories"],n);const r=Bt(e,["safetyAttributes","scores"]);null!=r&&$t(t,["scores"],r);const a=Bt(e,["contentType"]);return null!=a&&$t(t,["contentType"],a),t}function jo(e,t){const n={},r=Bt(t,["model"]);null!=r&&$t(n,["_url","model"],ja(e,r));const a=Bt(t,["source"]);null!=a&&function(e,t){const n={},r=Bt(e,["prompt"]);void 0!==t&&null!=r&&$t(t,["instances[0]","prompt"],r);const a=Bt(e,["image"]);void 0!==t&&null!=a&&$t(t,["instances[0]","image"],No(a));const i=Bt(e,["scribbleImage"]);void 0!==t&&null!=i&&$t(t,["instances[0]","scribble"],function(e){const t={},n=Bt(e,["image"]);return null!=n&&$t(t,["image"],No(n)),t}(i))}(a,n);const i=Bt(t,["config"]);return null!=i&&function(e,t){const n=Bt(e,["mode"]);void 0!==t&&null!=n&&$t(t,["parameters","mode"],n);const r=Bt(e,["maxPredictions"]);void 0!==t&&null!=r&&$t(t,["parameters","maxPredictions"],r);const a=Bt(e,["confidenceThreshold"]);void 0!==t&&null!=a&&$t(t,["parameters","confidenceThreshold"],a);const i=Bt(e,["maskDilation"]);void 0!==t&&null!=i&&$t(t,["parameters","maskDilation"],i);const o=Bt(e,["binaryColorThreshold"]);void 0!==t&&null!=o&&$t(t,["parameters","binaryColorThreshold"],o);const s=Bt(e,["labels"]);void 0!==t&&null!=s&&$t(t,["labels"],s)}(i,n),n}function _o(e){const t={},n=Bt(e,["predictions"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=Bt(e,["_self"]);null!=n&&$t(t,["mask"],vo(n));const r=Bt(e,["labels"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>e)),$t(t,["labels"],e)}return t}(e))),$t(t,["generatedMasks"],e)}return t}function Oo(e){const t={},n=Bt(e,["languageCode"]);null!=n&&$t(t,["languageCode"],n);const r=Bt(e,["voiceConfig"]);if(null!=r&&$t(t,["voiceConfig"],r),void 0!==Bt(e,["multiSpeakerVoiceConfig"]))throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");return t}function Po(e){const t={},n=Bt(e,["functionDeclarations"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={};if(void 0!==Bt(e,["behavior"]))throw new Error("behavior parameter is not supported in Vertex AI.");const n=Bt(e,["description"]);null!=n&&$t(t,["description"],n);const r=Bt(e,["name"]);null!=r&&$t(t,["name"],r);const a=Bt(e,["parameters"]);null!=a&&$t(t,["parameters"],a);const i=Bt(e,["parametersJsonSchema"]);null!=i&&$t(t,["parametersJsonSchema"],i);const o=Bt(e,["response"]);null!=o&&$t(t,["response"],o);const s=Bt(e,["responseJsonSchema"]);return null!=s&&$t(t,["responseJsonSchema"],s),t}(e))),$t(t,["functionDeclarations"],e)}const r=Bt(e,["retrieval"]);null!=r&&$t(t,["retrieval"],r);const a=Bt(e,["googleSearchRetrieval"]);null!=a&&$t(t,["googleSearchRetrieval"],a);const i=Bt(e,["computerUse"]);if(null!=i&&$t(t,["computerUse"],i),void 0!==Bt(e,["fileSearch"]))throw new Error("fileSearch parameter is not supported in Vertex AI.");const o=Bt(e,["codeExecution"]);null!=o&&$t(t,["codeExecution"],o);const s=Bt(e,["enterpriseWebSearch"]);null!=s&&$t(t,["enterpriseWebSearch"],s);const l=Bt(e,["googleMaps"]);null!=l&&$t(t,["googleMaps"],l);const c=Bt(e,["googleSearch"]);null!=c&&$t(t,["googleSearch"],c);const u=Bt(e,["urlContext"]);return null!=u&&$t(t,["urlContext"],u),t}function Ro(e,t){const n={},r=Bt(t,["model"]);null!=r&&$t(n,["_url","name"],ja(e,r));const a=Bt(t,["config"]);return null!=a&&function(e,t){const n=Bt(e,["displayName"]);void 0!==t&&null!=n&&$t(t,["displayName"],n);const r=Bt(e,["description"]);void 0!==t&&null!=r&&$t(t,["description"],r);const a=Bt(e,["defaultCheckpointId"]);void 0!==t&&null!=a&&$t(t,["defaultCheckpointId"],a)}(a,n),n}function Mo(e,t){const n={},r=Bt(t,["model"]);null!=r&&$t(n,["_url","model"],ja(e,r));const a=Bt(t,["config"]);return null!=a&&function(e,t){const n=Bt(e,["displayName"]);void 0!==t&&null!=n&&$t(t,["displayName"],n);const r=Bt(e,["description"]);void 0!==t&&null!=r&&$t(t,["description"],r);const a=Bt(e,["defaultCheckpointId"]);void 0!==t&&null!=a&&$t(t,["defaultCheckpointId"],a)}(a,n),n}function Do(e,t){const n={},r=Bt(t,["model"]);null!=r&&$t(n,["_url","model"],ja(e,r));const a=Bt(t,["image"]);null!=a&&$t(n,["instances[0]","image"],No(a));const i=Bt(t,["upscaleFactor"]);null!=i&&$t(n,["parameters","upscaleConfig","upscaleFactor"],i);const o=Bt(t,["config"]);return null!=o&&function(e,t){const n=Bt(e,["outputGcsUri"]);void 0!==t&&null!=n&&$t(t,["parameters","storageUri"],n);const r=Bt(e,["safetyFilterLevel"]);void 0!==t&&null!=r&&$t(t,["parameters","safetySetting"],r);const a=Bt(e,["personGeneration"]);void 0!==t&&null!=a&&$t(t,["parameters","personGeneration"],a);const i=Bt(e,["includeRaiReason"]);void 0!==t&&null!=i&&$t(t,["parameters","includeRaiReason"],i);const o=Bt(e,["outputMimeType"]);void 0!==t&&null!=o&&$t(t,["parameters","outputOptions","mimeType"],o);const s=Bt(e,["outputCompressionQuality"]);void 0!==t&&null!=s&&$t(t,["parameters","outputOptions","compressionQuality"],s);const l=Bt(e,["enhanceInputImage"]);void 0!==t&&null!=l&&$t(t,["parameters","upscaleConfig","enhanceInputImage"],l);const c=Bt(e,["imagePreservationFactor"]);void 0!==t&&null!=c&&$t(t,["parameters","upscaleConfig","imagePreservationFactor"],c);const u=Bt(e,["labels"]);void 0!==t&&null!=u&&$t(t,["labels"],u);const d=Bt(e,["numberOfImages"]);void 0!==t&&null!=d&&$t(t,["parameters","sampleCount"],d);const p=Bt(e,["mode"]);void 0!==t&&null!=p&&$t(t,["parameters","mode"],p)}(o,n),n}function Lo(e){const t={},n=Bt(e,["uri"]);null!=n&&$t(t,["uri"],n);const r=Bt(e,["videoBytes"]);null!=r&&$t(t,["encodedVideo"],Xa(r));const a=Bt(e,["mimeType"]);return null!=a&&$t(t,["encoding"],a),t}function Uo(e){const t={},n=Bt(e,["uri"]);null!=n&&$t(t,["gcsUri"],n);const r=Bt(e,["videoBytes"]);null!=r&&$t(t,["bytesBase64Encoded"],Xa(r));const a=Bt(e,["mimeType"]);return null!=a&&$t(t,["mimeType"],a),t}
/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const zo="x-goog-api-client",Fo=/^\s*data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class Go{constructor(e){var t,n;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const r={};this.clientOptions.vertexai?(r.apiVersion=null!==(t=this.clientOptions.apiVersion)&&void 0!==t?t:"v1beta1",r.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(r.apiVersion=null!==(n=this.clientOptions.apiVersion)&&void 0!==n?n:"v1beta",r.baseUrl="https://generativelanguage.googleapis.com/"),r.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=r,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(r,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&"global"!==this.clientOptions.location?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){this.clientOptions.project&&this.clientOptions.location?this.clientOptions.apiKey=void 0:(this.clientOptions.project=void 0,this.clientOptions.location=void 0)}isVertexAI(){var e;return null!==(e=this.clientOptions.vertexai)&&void 0!==e&&e}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&void 0!==this.clientOptions.httpOptions.apiVersion)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&void 0!==this.clientOptions.httpOptions.baseUrl)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&void 0!==this.clientOptions.httpOptions.headers)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||void 0===e.baseUrl||void 0===e.apiVersion)throw new Error("HTTP options are not correctly set.");const t=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&""!==e.apiVersion&&t.push(e.apiVersion),t.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),t=new URL(e);return t.protocol="http:"==t.protocol?"ws":"wss",t.toString()}setBaseUrl(e){if(!this.clientOptions.httpOptions)throw new Error("HTTP options are not correctly set.");this.clientOptions.httpOptions.baseUrl=e}constructUrl(e,t,n){const r=[this.getRequestUrlInternal(t)];n&&r.push(this.getBaseResourcePath()),""!==e&&r.push(e);return new URL(`${r.join("/")}`)}shouldPrependVertexProjectPath(e){return!this.clientOptions.apiKey&&(!!this.clientOptions.vertexai&&(!e.path.startsWith("projects/")&&("GET"!==e.httpMethod||!e.path.startsWith("publishers/google/models"))))}async request(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const n=this.shouldPrependVertexProjectPath(e),r=this.constructUrl(e.path,t,n);if(e.queryParams)for(const[i,o]of Object.entries(e.queryParams))r.searchParams.append(i,String(o));let a={};if("GET"===e.httpMethod){if(e.body&&"{}"!==e.body)throw new Error("Request body should be empty for GET request, but got non empty request body")}else a.body=e.body;return a=await this.includeExtraHttpOptionsToRequestInit(a,t,r.toString(),e.abortSignal),this.unaryApiCall(r,a,e.httpMethod)}patchHttpOptions(e,t){const n=JSON.parse(JSON.stringify(e));for(const[r,a]of Object.entries(t))"object"==typeof a?n[r]=Object.assign(Object.assign({},n[r]),a):void 0!==a&&(n[r]=a);return n}async requestStream(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const n=this.shouldPrependVertexProjectPath(e),r=this.constructUrl(e.path,t,n);r.searchParams.has("alt")&&"sse"===r.searchParams.get("alt")||r.searchParams.set("alt","sse");let a={};return a.body=e.body,a=await this.includeExtraHttpOptionsToRequestInit(a,t,r.toString(),e.abortSignal),this.streamApiCall(r,a,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,t,n,r){if(t&&t.timeout||r){const n=new AbortController,a=n.signal;if(t.timeout&&(null==t?void 0:t.timeout)>0){const e=setTimeout(()=>n.abort(),t.timeout);e&&"function"==typeof e.unref&&e.unref()}r&&r.addEventListener("abort",()=>{n.abort()}),e.signal=a}return t&&null!==t.extraBody&&function(e,t){if(!t||0===Object.keys(t).length)return;if(e.body instanceof Blob)return;let n={};if("string"==typeof e.body&&e.body.length>0)try{const t=JSON.parse(e.body);if("object"!=typeof t||null===t||Array.isArray(t))return;n=t}catch(i){return}function r(e,t){const n=Object.assign({},e);for(const a in t)if(Object.prototype.hasOwnProperty.call(t,a)){const e=t[a],i=n[a];e&&"object"==typeof e&&!Array.isArray(e)&&i&&"object"==typeof i&&!Array.isArray(i)?n[a]=r(i,e):n[a]=e}return n}const a=r(n,t);e.body=JSON.stringify(a)}
/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */(e,t.extraBody),e.headers=await this.getHeadersInternal(t,n),e}async unaryApiCall(e,t,n){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:n})).then(async e=>(await qo(e),new ra(e))).catch(e=>{throw e instanceof Error?e:new Error(JSON.stringify(e))})}async streamApiCall(e,t,n){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:n})).then(async e=>(await qo(e),this.processStreamResponse(e))).catch(e=>{throw e instanceof Error?e:new Error(JSON.stringify(e))})}processStreamResponse(e){var t;return _i(this,arguments,function*(){const n=null===(t=null==e?void 0:e.body)||void 0===t?void 0:t.getReader(),r=new TextDecoder("utf-8");if(!n)throw new Error("Response body is empty");try{let t="";for(;;){const{done:i,value:o}=yield ji(n.read());if(i){if(t.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const s=r.decode(o,{stream:!0});try{const e=JSON.parse(s);if("error"in e){const t=JSON.parse(JSON.stringify(e.error)),n=t.status,r=t.code,a=`got status: ${n}. ${JSON.stringify(e)}`;if(r>=400&&r<600){throw new Ui({message:a,status:r})}}}catch(a){if("ApiError"===a.name)throw a}t+=s;let l=t.match(Fo);for(;l;){const n=l[1];try{const r=new Response(n,{headers:null==e?void 0:e.headers,status:null==e?void 0:e.status,statusText:null==e?void 0:e.statusText});yield yield ji(new ra(r)),t=t.slice(l[0].length),l=t.match(Fo)}catch(a){throw new Error(`exception parsing stream chunk ${n}. ${a}`)}}}}finally{n.releaseLock()}})}async apiCall(e,t){return fetch(e,t).catch(e=>{throw new Error(`exception ${e} sending request`)})}getDefaultHeaders(){const e={},t="google-genai-sdk/1.30.0 "+this.clientOptions.userAgentExtra;return e["User-Agent"]=t,e[zo]=t,e["Content-Type"]="application/json",e}async getHeadersInternal(e,t){const n=new Headers;if(e&&e.headers){for(const[t,r]of Object.entries(e.headers))n.append(t,r);e.timeout&&e.timeout>0&&n.append("X-Server-Timeout",String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(n,t),n}getFileName(e){var t;let n="";return"string"==typeof e&&(n=e.replace(/[/\\]+$/,""),n=null!==(t=n.split(/[/\\]/).pop())&&void 0!==t?t:""),n}async uploadFile(e,t){var n;const r={};null!=t&&(r.mimeType=t.mimeType,r.name=t.name,r.displayName=t.displayName),r.name&&!r.name.startsWith("files/")&&(r.name=`files/${r.name}`);const a=this.clientOptions.uploader,i=await a.stat(e);r.sizeBytes=String(i.size);const o=null!==(n=null==t?void 0:t.mimeType)&&void 0!==n?n:i.type;if(void 0===o||""===o)throw new Error("Can not determine mimeType. Please provide mimeType in the config.");r.mimeType=o;const s={file:r},l=this.getFileName(e),c=Ht("upload/v1beta/files",s._url),u=await this.fetchUploadUrl(c,r.sizeBytes,r.mimeType,l,s,null==t?void 0:t.httpOptions);return a.upload(e,u,this)}async uploadFileToFileSearchStore(e,t,n){var r;const a=this.clientOptions.uploader,i=await a.stat(t),o=String(i.size),s=null!==(r=null==n?void 0:n.mimeType)&&void 0!==r?r:i.type;if(void 0===s||""===s)throw new Error("Can not determine mimeType. Please provide mimeType in the config.");const l=`upload/v1beta/${e}:uploadToFileSearchStore`,c=this.getFileName(t),u={};(null==n?void 0:n.customMetadata)&&(u.customMetadata=n.customMetadata),(null==n?void 0:n.chunkingConfig)&&(u.chunkingConfig=n.chunkingConfig);const d=await this.fetchUploadUrl(l,o,s,c,u,null==n?void 0:n.httpOptions);return a.uploadToFileSearchStore(t,d,this)}async downloadFile(e){const t=this.clientOptions.downloader;await t.download(e,this)}async fetchUploadUrl(e,t,n,r,a,i){var o;let s={};s=i||{apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${t}`,"X-Goog-Upload-Header-Content-Type":`${n}`},r?{"X-Goog-Upload-File-Name":r}:{})};const l=await this.request({path:e,body:JSON.stringify(a),httpMethod:"POST",httpOptions:s});if(!l||!(null==l?void 0:l.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const c=null===(o=null==l?void 0:l.headers)||void 0===o?void 0:o["x-goog-upload-url"];if(void 0===c)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return c}}async function qo(e){var t;if(void 0===e)throw new Error("response is undefined");if(!e.ok){const n=e.status;let r;r=(null===(t=e.headers.get("content-type"))||void 0===t?void 0:t.includes("application/json"))?await e.json():{error:{message:await e.text(),code:e.status,status:e.statusText}};const a=JSON.stringify(r);if(n>=400&&n<600){throw new Ui({message:a,status:n})}throw new Error(a)}}function Ho(e){for(const t of e){if(Bo(t))return!0;if("object"==typeof t&&"inputSchema"in t)return!0}return false}function $o(e){var t;const n=null!==(t=e[zo])&&void 0!==t?t:"";e[zo]=(n+" mcp_used/unknown").trimStart()}function Bo(e){return null!==e&&"object"==typeof e&&e instanceof Yo}function Vo(e,t=100){return _i(this,arguments,function*(){let n,r=0;for(;r<t;){const t=yield ji(e.listTools({cursor:n}));for(const e of t.tools)yield yield ji(e),r++;if(!t.nextCursor)break;n=t.nextCursor}})}class Yo{constructor(e=[],t){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=t}static create(e,t){return new Yo(e,t)}async initialize(){var e,t,n,r;if(this.mcpTools.length>0)return;const a={},i=[];for(const u of this.mcpClients)try{for(var o,s=!0,l=(t=void 0,Oi(Vo(u)));!(e=(o=await l.next()).done);s=!0){r=o.value,s=!1;const e=r;i.push(e);const t=e.name;if(a[t])throw new Error(`Duplicate function name ${t} found in MCP tools. Please ensure function names are unique.`);a[t]=u}}catch(c){t={error:c}}finally{try{s||e||!(n=l.return)||await n.call(l)}finally{if(t)throw t.error}}this.mcpTools=i,this.functionNameToMcpClient=a}async tool(){return await this.initialize(),function(e,t={}){const n=[],r=new Set;for(const a of e){const e=a.name;if(r.has(e))throw new Error(`Duplicate function name ${e} found in MCP tools. Please ensure function names are unique.`);r.add(e);const i=ri(a,t);i.functionDeclarations&&n.push(...i.functionDeclarations)}return{functionDeclarations:n}}(this.mcpTools,this.config)}async callTool(e){await this.initialize();const t=[];for(const n of e)if(n.name in this.functionNameToMcpClient){const e=this.functionNameToMcpClient[n.name];let r;this.config.timeout&&(r={timeout:this.config.timeout});const a=await e.callTool({name:n.name,arguments:n.args},void 0,r);t.push({functionResponse:{name:n.name,response:a.isError?{error:a}:a}})}return t}}
/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Wo{constructor(e,t,n){this.apiClient=e,this.auth=t,this.webSocketFactory=n}async connect(e){var t,n;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");const r=this.apiClient.getWebsocketBaseUrl(),a=this.apiClient.getApiVersion(),i=function(e){const t=new Headers;for(const[n,r]of Object.entries(e))t.append(n,r);return t}
/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */(this.apiClient.getDefaultHeaders()),o=`${r}/ws/google.ai.generativelanguage.${a}.GenerativeService.BidiGenerateMusic?key=${this.apiClient.getApiKey()}`;let s=()=>{};const l=new Promise(e=>{s=e}),c=e.callbacks,u=(this.apiClient,{onopen:function(){s({})},onmessage:e=>{!async function(e,t,n){const r=new Ia;let a;a=n.data instanceof Blob?JSON.parse(await n.data.text()):JSON.parse(n.data),Object.assign(r,a),t(r)}(0,c.onmessage,e)},onerror:null!==(t=null==c?void 0:c.onerror)&&void 0!==t?t:function(e){},onclose:null!==(n=null==c?void 0:c.onclose)&&void 0!==n?n:function(e){}}),d=this.webSocketFactory.create(o,function(e){const t={};return e.forEach((e,n)=>{t[n]=e}),t}(i),u);d.connect(),await l;const p={setup:{model:ja(this.apiClient,e.model)}};return d.send(JSON.stringify(p)),new Ko(d,this.apiClient)}}class Ko{constructor(e,t){this.conn=e,this.apiClient=t}async setWeightedPrompts(e){if(!e.weightedPrompts||0===Object.keys(e.weightedPrompts).length)throw new Error("Weighted prompts must be set and contain at least one entry.");const t=function(e){const t={},n=Bt(e,["weightedPrompts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),$t(t,["weightedPrompts"],e)}return t}(e);this.conn.send(JSON.stringify({clientContent:t}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const t=function(e){const t={},n=Bt(e,["musicGenerationConfig"]);return null!=n&&$t(t,["musicGenerationConfig"],n),t}(e);this.conn.send(JSON.stringify(t))}sendPlaybackControl(e){const t={playbackControl:e};this.conn.send(JSON.stringify(t))}play(){this.sendPlaybackControl(Zr.PLAY)}pause(){this.sendPlaybackControl(Zr.PAUSE)}stop(){this.sendPlaybackControl(Zr.STOP)}resetContext(){this.sendPlaybackControl(Zr.RESET_CONTEXT)}close(){this.conn.close()}}class Jo{constructor(e,t,n){this.apiClient=e,this.auth=t,this.webSocketFactory=n,this.music=new Wo(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var t,n,r,a,i,o;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const s=this.apiClient.getWebsocketBaseUrl(),l=this.apiClient.getApiVersion();let c;const u=this.apiClient.getHeaders();e.config&&e.config.tools&&Ho(e.config.tools)&&$o(u);const d=function(e){const t=new Headers;for(const[n,r]of Object.entries(e))t.append(n,r);return t}
/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */(u);if(this.apiClient.isVertexAI())c=`${s}/ws/google.cloud.aiplatform.${l}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(d,c);else{const e=this.apiClient.getApiKey();let t="BidiGenerateContent",n="key";(null==e?void 0:e.startsWith("auth_tokens/"))&&(t="BidiGenerateContentConstrained",n="access_token"),c=`${s}/ws/google.ai.generativelanguage.${l}.GenerativeService.${t}?${n}=${e}`}let p=()=>{};const h=new Promise(e=>{p=e}),m=e.callbacks,f=this.apiClient,g={onopen:function(){var e;null===(e=null==m?void 0:m.onopen)||void 0===e||e.call(m),p({})},onmessage:e=>{!async function(e,t,n){const r=new Ta;let a;a=n.data instanceof Blob?await n.data.text():n.data instanceof ArrayBuffer?(new TextDecoder).decode(n.data):n.data;const i=JSON.parse(a);if(e.isVertexAI()){const e=Yi(i);Object.assign(r,e)}else{const e=i;Object.assign(r,e)}t(r)}(f,m.onmessage,e)},onerror:null!==(t=null==m?void 0:m.onerror)&&void 0!==t?t:function(e){},onclose:null!==(n=null==m?void 0:m.onclose)&&void 0!==n?n:function(e){}},y=this.webSocketFactory.create(c,function(e){const t={};return e.forEach((e,n)=>{t[n]=e}),t}(d),g);y.connect(),await h;let x=ja(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&x.startsWith("publishers/")){x=`projects/${this.apiClient.getProject()}/locations/${this.apiClient.getLocation()}/`+x}let b={};this.apiClient.isVertexAI()&&void 0===(null===(r=e.config)||void 0===r?void 0:r.responseModalities)&&(void 0===e.config?e.config={responseModalities:[Ln.AUDIO]}:e.config.responseModalities=[Ln.AUDIO]),null===(a=e.config)||void 0===a||a.generationConfig;const v=null!==(o=null===(i=e.config)||void 0===i?void 0:i.tools)&&void 0!==o?o:[],w=[];for(const E of v)if(this.isCallableTool(E)){const e=E;w.push(await e.tool())}else w.push(E);w.length>0&&(e.config.tools=w);const N={model:x,config:e.config,callbacks:e.callbacks};return b=this.apiClient.isVertexAI()?function(e,t){const n={},r=Bt(t,["model"]);null!=r&&$t(n,["setup","model"],ja(e,r));const a=Bt(t,["config"]);return null!=a&&$t(n,["config"],$i(a,n)),n}(this.apiClient,N):function(e,t){const n={},r=Bt(t,["model"]);null!=r&&$t(n,["setup","model"],ja(e,r));const a=Bt(t,["config"]);return null!=a&&$t(n,["config"],Hi(a,n)),n}(this.apiClient,N),delete b.config,y.send(JSON.stringify(b)),new Xo(y,this.apiClient)}isCallableTool(e){return"callTool"in e&&"function"==typeof e.callTool}}const Qo={turnComplete:!0};class Xo{constructor(e,t){this.conn=e,this.apiClient=t}tLiveClientContent(e,t){if(null!==t.turns&&void 0!==t.turns){let r=[];try{r=Ha(t.turns),e.isVertexAI()||(r=r.map(e=>Qi(e)))}catch(n){throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:r,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(e,t){let n=[];if(null==t.functionResponses)throw new Error("functionResponses is required.");if(n=Array.isArray(t.functionResponses)?t.functionResponses:[t.functionResponses],0===n.length)throw new Error("functionResponses is required.");for(const r of n){if("object"!=typeof r||null===r||!("name"in r)||!("response"in r))throw new Error(`Could not parse function response, type '${typeof r}'.`);if(!e.isVertexAI()&&!("id"in r))throw new Error("FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.")}return{toolResponse:{functionResponses:n}}}sendClientContent(e){e=Object.assign(Object.assign({},Qo),e);const t=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendRealtimeInput(e){let t={};t=this.apiClient.isVertexAI()?{realtimeInput:Vi(e)}:{realtimeInput:Bi(e)},this.conn.send(JSON.stringify(t))}sendToolResponse(e){if(null==e.functionResponses)throw new Error("Tool response parameters are required.");const t=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function Zo(e){var t,n,r;if(null===(t=null==e?void 0:e.automaticFunctionCalling)||void 0===t?void 0:t.disable)return!0;let a=!1;for(const o of null!==(n=null==e?void 0:e.tools)&&void 0!==n?n:[])if(es(o)){a=!0;break}if(!a)return!0;const i=null===(r=null==e?void 0:e.automaticFunctionCalling)||void 0===r?void 0:r.maximumRemoteCalls;return!!(i&&(i<0||!Number.isInteger(i))||0==i)}function es(e){return"callTool"in e&&"function"==typeof e.callTool}function ts(e){var t;const n=[];return(null===(t=null==e?void 0:e.config)||void 0===t?void 0:t.tools)?(e.config.tools.forEach((e,t)=>{if(es(e))return;const r=e;r.functionDeclarations&&r.functionDeclarations.length>0&&n.push(t)}),n):n}function ns(e){var t;return!(null===(t=null==e?void 0:e.automaticFunctionCalling)||void 0===t?void 0:t.ignoreCallHistory)}
/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class rs extends qt{constructor(e){super(),this.apiClient=e,this.generateContent=async e=>{var t,n,r,a,i;const o=await this.processParamsMaybeAddMcpUsage(e);if(this.maybeMoveToResponseJsonSchem(e),!function(e){var t,n,r;return null!==(r=null===(n=null===(t=e.config)||void 0===t?void 0:t.tools)||void 0===n?void 0:n.some(e=>es(e)))&&void 0!==r&&r}(e)||Zo(e.config))return await this.generateContentInternal(o);const s=ts(e);if(s.length>0){const e=s.map(e=>`tools[${e}]`).join(", ");throw new Error(`Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations is not yet supported. Incompatible tools found at ${e}.`)}let l,c;const u=Ha(o.contents),d=null!==(r=null===(n=null===(t=o.config)||void 0===t?void 0:t.automaticFunctionCalling)||void 0===n?void 0:n.maximumRemoteCalls)&&void 0!==r?r:10;let p=0;for(;p<d&&(l=await this.generateContentInternal(o),l.functionCalls&&0!==l.functionCalls.length);){const t=l.candidates[0].content,n=[];for(const r of null!==(i=null===(a=e.config)||void 0===a?void 0:a.tools)&&void 0!==i?i:[])if(es(r)){const e=r,t=await e.callTool(l.functionCalls);n.push(...t)}p++,c={role:"user",parts:n},o.contents=Ha(o.contents),o.contents.push(t),o.contents.push(c),ns(o.config)&&(u.push(t),u.push(c))}return ns(o.config)&&(l.automaticFunctionCallingHistory=u),l},this.generateContentStream=async e=>{var t,n,r,a,i;if(this.maybeMoveToResponseJsonSchem(e),Zo(e.config)){const t=await this.processParamsMaybeAddMcpUsage(e);return await this.generateContentStreamInternal(t)}const o=ts(e);if(o.length>0){const e=o.map(e=>`tools[${e}]`).join(", ");throw new Error(`Incompatible tools found at ${e}. Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations" is not yet supported.`)}const s=null===(r=null===(n=null===(t=null==e?void 0:e.config)||void 0===t?void 0:t.toolConfig)||void 0===n?void 0:n.functionCallingConfig)||void 0===r?void 0:r.streamFunctionCallArguments,l=null===(i=null===(a=null==e?void 0:e.config)||void 0===a?void 0:a.automaticFunctionCalling)||void 0===i?void 0:i.disable;if(s&&!l)throw new Error("Running in streaming mode with 'streamFunctionCallArguments' enabled, this feature is not compatible with automatic function calling (AFC). Please set 'config.automaticFunctionCalling.disable' to true to disable AFC or leave 'config.toolConfig.functionCallingConfig.streamFunctionCallArguments' to be undefined or set to false to disable streaming function call arguments feature.");return await this.processAfcStream(e)},this.generateImages=async e=>await this.generateImagesInternal(e).then(e=>{var t;let n;const r=[];if(null==e?void 0:e.generatedImages)for(const i of e.generatedImages)i&&(null==i?void 0:i.safetyAttributes)&&"Positive Prompt"===(null===(t=null==i?void 0:i.safetyAttributes)||void 0===t?void 0:t.contentType)?n=null==i?void 0:i.safetyAttributes:r.push(i);let a;return a=n?{generatedImages:r,positivePromptSafetyAttributes:n,sdkHttpResponse:e.sdkHttpResponse}:{generatedImages:r,sdkHttpResponse:e.sdkHttpResponse},a}),this.list=async e=>{var t;const n={config:Object.assign(Object.assign({},{queryBase:!0}),null==e?void 0:e.config)};if(this.apiClient.isVertexAI()&&!n.config.queryBase){if(null===(t=n.config)||void 0===t?void 0:t.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");n.config.filter="labels.tune-type:*"}return new bi(ta.PAGED_ITEM_MODELS,e=>this.listInternal(e),await this.listInternal(n),n)},this.editImage=async e=>{const t={model:e.model,prompt:e.prompt,referenceImages:[],config:e.config};return e.referenceImages&&e.referenceImages&&(t.referenceImages=e.referenceImages.map(e=>e.toReferenceImageAPI())),await this.editImageInternal(t)},this.upscaleImage=async e=>{let t={numberOfImages:1,mode:"upscale"};e.config&&(t=Object.assign(Object.assign({},t),e.config));const n={model:e.model,image:e.image,upscaleFactor:e.upscaleFactor,config:t};return await this.upscaleImageInternal(n)},this.generateVideos=async e=>{var t,n,r,a,i,o;if((e.prompt||e.image||e.video)&&e.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||((null===(t=e.video)||void 0===t?void 0:t.uri)&&(null===(n=e.video)||void 0===n?void 0:n.videoBytes)?e.video={uri:e.video.uri,mimeType:e.video.mimeType}:(null===(a=null===(r=e.source)||void 0===r?void 0:r.video)||void 0===a?void 0:a.uri)&&(null===(o=null===(i=e.source)||void 0===i?void 0:i.video)||void 0===o?void 0:o.videoBytes)&&(e.source.video={uri:e.source.video.uri,mimeType:e.source.video.mimeType})),await this.generateVideosInternal(e)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var t,n,r;const a=null===(t=e.config)||void 0===t?void 0:t.tools;if(!a)return e;const i=await Promise.all(a.map(async e=>{if(es(e)){const t=e;return await t.tool()}return e})),o={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:i})};if(o.config.tools=i,e.config&&e.config.tools&&Ho(e.config.tools)){const t=null!==(r=null===(n=e.config.httpOptions)||void 0===n?void 0:n.headers)&&void 0!==r?r:{};let a=Object.assign({},t);0===Object.keys(a).length&&(a=this.apiClient.getDefaultHeaders()),$o(a),o.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:a})}return o}async initAfcToolsMap(e){var t,n,r;const a=new Map;for(const i of null!==(n=null===(t=e.config)||void 0===t?void 0:t.tools)&&void 0!==n?n:[])if(es(i)){const e=i,t=await e.tool();for(const n of null!==(r=t.functionDeclarations)&&void 0!==r?r:[]){if(!n.name)throw new Error("Function declaration name is required.");if(a.has(n.name))throw new Error(`Duplicate tool declaration name: ${n.name}`);a.set(n.name,e)}}return a}async processAfcStream(e){var t,n,r;const a=null!==(r=null===(n=null===(t=e.config)||void 0===t?void 0:t.automaticFunctionCalling)||void 0===n?void 0:n.maximumRemoteCalls)&&void 0!==r?r:10;let i=!1,o=0;return function(e,t,n){var r,s;return _i(this,arguments,function*(){for(var l,c,u,d;o<a;){i&&(o++,i=!1);const g=yield ji(e.processParamsMaybeAddMcpUsage(n)),y=yield ji(e.generateContentStreamInternal(g)),x=[],b=[];try{for(var p,h=!0,m=(c=void 0,Oi(y));!(l=(p=yield ji(m.next())).done);h=!0){d=p.value,h=!1;const e=d;if(yield yield ji(e),e.candidates&&(null===(r=e.candidates[0])||void 0===r?void 0:r.content)){b.push(e.candidates[0].content);for(const n of null!==(s=e.candidates[0].content.parts)&&void 0!==s?s:[])if(o<a&&n.functionCall){if(!n.functionCall.name)throw new Error("Function call name was not returned by the model.");if(!t.has(n.functionCall.name))throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${t.keys()}, mising tool: ${n.functionCall.name}`);{const e=yield ji(t.get(n.functionCall.name).callTool([n.functionCall]));x.push(...e)}}}}}catch(f){c={error:f}}finally{try{h||l||!(u=m.return)||(yield ji(u.call(m)))}finally{if(c)throw c.error}}if(!(x.length>0))break;{i=!0;const e=new aa;e.candidates=[{content:{role:"user",parts:x}}],yield yield ji(e);const t=[];t.push(...b),t.push({role:"user",parts:x});const r=Ha(n.contents).concat(t);n.contents=r}}})}(this,await this.initAfcToolsMap(e),e)}async generateContentInternal(e){var t,n,r,a;let i,o="",s={};if(this.apiClient.isVertexAI()){const r=oo(this.apiClient,e);return o=Ht("{model}:generateContent",r._url),s=r._query,delete r._url,delete r._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),i.then(e=>{const t=lo(e),n=new aa;return Object.assign(n,t),n})}{const t=io(this.apiClient,e);return o=Ht("{model}:generateContent",t._url),s=t._query,delete t._url,delete t._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(r=e.config)||void 0===r?void 0:r.httpOptions,abortSignal:null===(a=e.config)||void 0===a?void 0:a.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),i.then(e=>{const t=so(e),n=new aa;return Object.assign(n,t),n})}}async generateContentStreamInternal(e){var t,n,r,a;let i,o="",s={};if(this.apiClient.isVertexAI()){const r=oo(this.apiClient,e);o=Ht("{model}:streamGenerateContent?alt=sse",r._url),s=r._query,delete r._url,delete r._query;return i=this.apiClient.requestStream({path:o,queryParams:s,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}),i.then(function(e){return _i(this,arguments,function*(){var t,n,r,a;try{for(var i,o=!0,s=Oi(e);!(t=(i=yield ji(s.next())).done);o=!0){a=i.value,o=!1;const e=a,t=lo(yield ji(e.json()));t.sdkHttpResponse={headers:e.headers};const n=new aa;Object.assign(n,t),yield yield ji(n)}}catch(l){n={error:l}}finally{try{o||t||!(r=s.return)||(yield ji(r.call(s)))}finally{if(n)throw n.error}}})})}{const t=io(this.apiClient,e);o=Ht("{model}:streamGenerateContent?alt=sse",t._url),s=t._query,delete t._url,delete t._query;return i=this.apiClient.requestStream({path:o,queryParams:s,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(r=e.config)||void 0===r?void 0:r.httpOptions,abortSignal:null===(a=e.config)||void 0===a?void 0:a.abortSignal}),i.then(function(e){return _i(this,arguments,function*(){var t,n,r,a;try{for(var i,o=!0,s=Oi(e);!(t=(i=yield ji(s.next())).done);o=!0){a=i.value,o=!1;const e=a,t=so(yield ji(e.json()));t.sdkHttpResponse={headers:e.headers};const n=new aa;Object.assign(n,t),yield yield ji(n)}}catch(l){n={error:l}}finally{try{o||t||!(r=s.return)||(yield ji(r.call(s)))}finally{if(n)throw n.error}}})})}}async embedContent(e){var t,n,r,a;let i,o="",s={};if(this.apiClient.isVertexAI()){const r=no(this.apiClient,e);return o=Ht("{model}:predict",r._url),s=r._query,delete r._url,delete r._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),i.then(e=>{const t=function(e){const t={},n=Bt(e,["sdkHttpResponse"]);null!=n&&$t(t,["sdkHttpResponse"],n);const r=Bt(e,["predictions[]","embeddings"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>Ji(e))),$t(t,["embeddings"],e)}const a=Bt(e,["metadata"]);return null!=a&&$t(t,["metadata"],a),t}(e),n=new ia;return Object.assign(n,t),n})}{const t=to(this.apiClient,e);return o=Ht("{model}:batchEmbedContents",t._url),s=t._query,delete t._url,delete t._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(r=e.config)||void 0===r?void 0:r.httpOptions,abortSignal:null===(a=e.config)||void 0===a?void 0:a.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),i.then(e=>{const t=function(e){const t={},n=Bt(e,["sdkHttpResponse"]);null!=n&&$t(t,["sdkHttpResponse"],n);const r=Bt(e,["embeddings"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>e)),$t(t,["embeddings"],e)}const a=Bt(e,["metadata"]);return null!=a&&$t(t,["metadata"],a),t}(e),n=new ia;return Object.assign(n,t),n})}}async generateImagesInternal(e){var t,n,r,a;let i,o="",s={};if(this.apiClient.isVertexAI()){const r=uo(this.apiClient,e);return o=Ht("{model}:predict",r._url),s=r._query,delete r._url,delete r._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),i.then(e=>{const t=function(e){const t={},n=Bt(e,["sdkHttpResponse"]);null!=n&&$t(t,["sdkHttpResponse"],n);const r=Bt(e,["predictions"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>bo(e))),$t(t,["generatedImages"],e)}const a=Bt(e,["positivePromptSafetyAttributes"]);return null!=a&&$t(t,["positivePromptSafetyAttributes"],Ao(a)),t}(e),n=new oa;return Object.assign(n,t),n})}{const t=co(this.apiClient,e);return o=Ht("{model}:predict",t._url),s=t._query,delete t._url,delete t._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(r=e.config)||void 0===r?void 0:r.httpOptions,abortSignal:null===(a=e.config)||void 0===a?void 0:a.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),i.then(e=>{const t=po(e),n=new oa;return Object.assign(n,t),n})}}async editImageInternal(e){var t,n;let r,a="",i={};if(this.apiClient.isVertexAI()){const o=eo(this.apiClient,e);return a=Ht("{model}:predict",o._url),i=o._query,delete o._url,delete o._query,r=this.apiClient.request({path:a,queryParams:i,body:JSON.stringify(o),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),r.then(e=>{const t=function(e){const t={},n=Bt(e,["sdkHttpResponse"]);null!=n&&$t(t,["sdkHttpResponse"],n);const r=Bt(e,["predictions"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>bo(e))),$t(t,["generatedImages"],e)}return t}(e),n=new sa;return Object.assign(n,t),n})}throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var t,n;let r,a="",i={};if(this.apiClient.isVertexAI()){const o=Do(this.apiClient,e);return a=Ht("{model}:predict",o._url),i=o._query,delete o._url,delete o._query,r=this.apiClient.request({path:a,queryParams:i,body:JSON.stringify(o),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),r.then(e=>{const t=function(e){const t={},n=Bt(e,["sdkHttpResponse"]);null!=n&&$t(t,["sdkHttpResponse"],n);const r=Bt(e,["predictions"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>bo(e))),$t(t,["generatedImages"],e)}return t}(e),n=new la;return Object.assign(n,t),n})}throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var t,n;let r,a="",i={};if(this.apiClient.isVertexAI()){const o=To(this.apiClient,e);return a=Ht("{model}:predict",o._url),i=o._query,delete o._url,delete o._query,r=this.apiClient.request({path:a,queryParams:i,body:JSON.stringify(o),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),r.then(e=>{const t=function(e){const t={},n=Bt(e,["predictions"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>bo(e))),$t(t,["generatedImages"],e)}return t}(e),n=new ca;return Object.assign(n,t),n})}throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var t,n;let r,a="",i={};if(this.apiClient.isVertexAI()){const o=jo(this.apiClient,e);return a=Ht("{model}:predict",o._url),i=o._query,delete o._url,delete o._query,r=this.apiClient.request({path:a,queryParams:i,body:JSON.stringify(o),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),r.then(e=>{const t=_o(e),n=new ua;return Object.assign(n,t),n})}throw new Error("This method is only supported by the Vertex AI.")}async get(e){var t,n,r,a;let i,o="",s={};if(this.apiClient.isVertexAI()){const r=function(e,t){const n={},r=Bt(t,["model"]);return null!=r&&$t(n,["_url","name"],ja(e,r)),n}(this.apiClient,e);return o=Ht("{name}",r._url),s=r._query,delete r._url,delete r._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(r),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),i.then(e=>ko(e))}{const t=function(e,t){const n={},r=Bt(t,["model"]);return null!=r&&$t(n,["_url","name"],ja(e,r)),n}(this.apiClient,e);return o=Ht("{name}",t._url),s=t._query,delete t._url,delete t._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(r=e.config)||void 0===r?void 0:r.httpOptions,abortSignal:null===(a=e.config)||void 0===a?void 0:a.abortSignal}).then(e=>e.json()),i.then(e=>Co(e))}}async listInternal(e){var t,n,r,a;let i,o="",s={};if(this.apiClient.isVertexAI()){const r=So(this.apiClient,e);return o=Ht("{models_url}",r._url),s=r._query,delete r._url,delete r._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(r),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),i.then(e=>{const t=function(e){const t={},n=Bt(e,["sdkHttpResponse"]);null!=n&&$t(t,["sdkHttpResponse"],n);const r=Bt(e,["nextPageToken"]);null!=r&&$t(t,["nextPageToken"],r);const a=Bt(e,["_self"]);if(null!=a){let e=ti(a);Array.isArray(e)&&(e=e.map(e=>ko(e))),$t(t,["models"],e)}return t}(e),n=new da;return Object.assign(n,t),n})}{const t=Eo(this.apiClient,e);return o=Ht("{models_url}",t._url),s=t._query,delete t._url,delete t._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(r=e.config)||void 0===r?void 0:r.httpOptions,abortSignal:null===(a=e.config)||void 0===a?void 0:a.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),i.then(e=>{const t=function(e){const t={},n=Bt(e,["sdkHttpResponse"]);null!=n&&$t(t,["sdkHttpResponse"],n);const r=Bt(e,["nextPageToken"]);null!=r&&$t(t,["nextPageToken"],r);const a=Bt(e,["_self"]);if(null!=a){let e=ti(a);Array.isArray(e)&&(e=e.map(e=>Co(e))),$t(t,["models"],e)}return t}(e),n=new da;return Object.assign(n,t),n})}}async update(e){var t,n,r,a;let i,o="",s={};if(this.apiClient.isVertexAI()){const r=Mo(this.apiClient,e);return o=Ht("{model}",r._url),s=r._query,delete r._url,delete r._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(r),httpMethod:"PATCH",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),i.then(e=>ko(e))}{const t=Ro(this.apiClient,e);return o=Ht("{name}",t._url),s=t._query,delete t._url,delete t._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(t),httpMethod:"PATCH",httpOptions:null===(r=e.config)||void 0===r?void 0:r.httpOptions,abortSignal:null===(a=e.config)||void 0===a?void 0:a.abortSignal}).then(e=>e.json()),i.then(e=>Co(e))}}async delete(e){var t,n,r,a;let i,o="",s={};if(this.apiClient.isVertexAI()){const r=function(e,t){const n={},r=Bt(t,["model"]);return null!=r&&$t(n,["_url","name"],ja(e,r)),n}(this.apiClient,e);return o=Ht("{name}",r._url),s=r._query,delete r._url,delete r._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(r),httpMethod:"DELETE",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),i.then(e=>{const t=function(e){const t={},n=Bt(e,["sdkHttpResponse"]);return null!=n&&$t(t,["sdkHttpResponse"],n),t}(e),n=new pa;return Object.assign(n,t),n})}{const t=function(e,t){const n={},r=Bt(t,["model"]);return null!=r&&$t(n,["_url","name"],ja(e,r)),n}(this.apiClient,e);return o=Ht("{name}",t._url),s=t._query,delete t._url,delete t._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(t),httpMethod:"DELETE",httpOptions:null===(r=e.config)||void 0===r?void 0:r.httpOptions,abortSignal:null===(a=e.config)||void 0===a?void 0:a.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),i.then(e=>{const t=function(e){const t={},n=Bt(e,["sdkHttpResponse"]);return null!=n&&$t(t,["sdkHttpResponse"],n),t}(e),n=new pa;return Object.assign(n,t),n})}}async countTokens(e){var t,n,r,a;let i,o="",s={};if(this.apiClient.isVertexAI()){const r=function(e,t){const n={},r=Bt(t,["model"]);null!=r&&$t(n,["_url","model"],ja(e,r));const a=Bt(t,["contents"]);if(null!=a){let e=Ha(a);Array.isArray(e)&&(e=e.map(e=>e)),$t(n,["contents"],e)}const i=Bt(t,["config"]);return null!=i&&Xi(i,n),n}(this.apiClient,e);return o=Ht("{model}:countTokens",r._url),s=r._query,delete r._url,delete r._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),i.then(e=>{const t=function(e){const t={},n=Bt(e,["sdkHttpResponse"]);null!=n&&$t(t,["sdkHttpResponse"],n);const r=Bt(e,["totalTokens"]);return null!=r&&$t(t,["totalTokens"],r),t}(e),n=new ha;return Object.assign(n,t),n})}{const t=Zi(this.apiClient,e);return o=Ht("{model}:countTokens",t._url),s=t._query,delete t._url,delete t._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(r=e.config)||void 0===r?void 0:r.httpOptions,abortSignal:null===(a=e.config)||void 0===a?void 0:a.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),i.then(e=>{const t=function(e){const t={},n=Bt(e,["sdkHttpResponse"]);null!=n&&$t(t,["sdkHttpResponse"],n);const r=Bt(e,["totalTokens"]);null!=r&&$t(t,["totalTokens"],r);const a=Bt(e,["cachedContentTokenCount"]);return null!=a&&$t(t,["cachedContentTokenCount"],a),t}(e),n=new ha;return Object.assign(n,t),n})}}async computeTokens(e){var t,n;let r,a="",i={};if(this.apiClient.isVertexAI()){const o=function(e,t){const n={},r=Bt(t,["model"]);null!=r&&$t(n,["_url","model"],ja(e,r));const a=Bt(t,["contents"]);if(null!=a){let e=Ha(a);Array.isArray(e)&&(e=e.map(e=>e)),$t(n,["contents"],e)}return n}(this.apiClient,e);return a=Ht("{model}:computeTokens",o._url),i=o._query,delete o._url,delete o._query,r=this.apiClient.request({path:a,queryParams:i,body:JSON.stringify(o),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),r.then(e=>{const t=function(e){const t={},n=Bt(e,["sdkHttpResponse"]);null!=n&&$t(t,["sdkHttpResponse"],n);const r=Bt(e,["tokensInfo"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>e)),$t(t,["tokensInfo"],e)}return t}(e),n=new ma;return Object.assign(n,t),n})}throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var t,n,r,a;let i,o="",s={};if(this.apiClient.isVertexAI()){const r=xo(this.apiClient,e);return o=Ht("{model}:predictLongRunning",r._url),s=r._query,delete r._url,delete r._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),i.then(e=>{const t=go(e),n=new fa;return Object.assign(n,t),n})}{const t=yo(this.apiClient,e);return o=Ht("{model}:predictLongRunning",t._url),s=t._query,delete t._url,delete t._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(r=e.config)||void 0===r?void 0:r.httpOptions,abortSignal:null===(a=e.config)||void 0===a?void 0:a.abortSignal}).then(e=>e.json()),i.then(e=>{const t=fo(e),n=new fa;return Object.assign(n,t),n})}}}
/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class as extends qt{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const t=e.operation,n=e.config;if(void 0===t.name||""===t.name)throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const e=t.name.split("/operations/")[0];let r;n&&"httpOptions"in n&&(r=n.httpOptions);const a=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:e,config:{httpOptions:r}});return t._fromAPIResponse({apiResponse:a,_isVertexAI:!0})}{const e=await this.getVideosOperationInternal({operationName:t.name,config:n});return t._fromAPIResponse({apiResponse:e,_isVertexAI:!1})}}async get(e){const t=e.operation,n=e.config;if(void 0===t.name||""===t.name)throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const e=t.name.split("/operations/")[0];let r;n&&"httpOptions"in n&&(r=n.httpOptions);const a=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:e,config:{httpOptions:r}});return t._fromAPIResponse({apiResponse:a,_isVertexAI:!0})}{const e=await this.getVideosOperationInternal({operationName:t.name,config:n});return t._fromAPIResponse({apiResponse:e,_isVertexAI:!1})}}async getVideosOperationInternal(e){var t,n,r,a;let i,o="",s={};if(this.apiClient.isVertexAI()){const r=function(e){const t={},n=Bt(e,["operationName"]);return null!=n&&$t(t,["_url","operationName"],n),t}(e);return o=Ht("{operationName}",r._url),s=r._query,delete r._url,delete r._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(r),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),i}{const t=function(e){const t={},n=Bt(e,["operationName"]);return null!=n&&$t(t,["_url","operationName"],n),t}(e);return o=Ht("{operationName}",t._url),s=t._query,delete t._url,delete t._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(r=e.config)||void 0===r?void 0:r.httpOptions,abortSignal:null===(a=e.config)||void 0===a?void 0:a.abortSignal}).then(e=>e.json()),i}}async fetchPredictVideosOperationInternal(e){var t,n;let r,a="",i={};if(this.apiClient.isVertexAI()){const o=function(e){const t={},n=Bt(e,["operationName"]);null!=n&&$t(t,["operationName"],n);const r=Bt(e,["resourceName"]);return null!=r&&$t(t,["_url","resourceName"],r),t}(e);return a=Ht("{resourceName}:fetchPredictOperation",o._url),i=o._query,delete o._url,delete o._query,r=this.apiClient.request({path:a,queryParams:i,body:JSON.stringify(o),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),r}throw new Error("This method is only supported by the Vertex AI.")}}
/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function is(e){const t={},n=Bt(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=Bt(e,["mediaResolution"]);null!=n&&$t(t,["mediaResolution"],n);const r=Bt(e,["codeExecutionResult"]);null!=r&&$t(t,["codeExecutionResult"],r);const a=Bt(e,["executableCode"]);null!=a&&$t(t,["executableCode"],a);const i=Bt(e,["fileData"]);null!=i&&$t(t,["fileData"],function(e){const t={};if(void 0!==Bt(e,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const n=Bt(e,["fileUri"]);null!=n&&$t(t,["fileUri"],n);const r=Bt(e,["mimeType"]);null!=r&&$t(t,["mimeType"],r);return t}(i));const o=Bt(e,["functionCall"]);null!=o&&$t(t,["functionCall"],function(e){const t={},n=Bt(e,["id"]);null!=n&&$t(t,["id"],n);const r=Bt(e,["args"]);null!=r&&$t(t,["args"],r);const a=Bt(e,["name"]);null!=a&&$t(t,["name"],a);if(void 0!==Bt(e,["partialArgs"]))throw new Error("partialArgs parameter is not supported in Gemini API.");if(void 0!==Bt(e,["willContinue"]))throw new Error("willContinue parameter is not supported in Gemini API.");return t}(o));const s=Bt(e,["functionResponse"]);null!=s&&$t(t,["functionResponse"],s);const l=Bt(e,["inlineData"]);null!=l&&$t(t,["inlineData"],function(e){const t={},n=Bt(e,["data"]);if(null!=n&&$t(t,["data"],n),void 0!==Bt(e,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const r=Bt(e,["mimeType"]);return null!=r&&$t(t,["mimeType"],r),t}(l));const c=Bt(e,["text"]);null!=c&&$t(t,["text"],c);const u=Bt(e,["thought"]);null!=u&&$t(t,["thought"],u);const d=Bt(e,["thoughtSignature"]);null!=d&&$t(t,["thoughtSignature"],d);const p=Bt(e,["videoMetadata"]);null!=p&&$t(t,["videoMetadata"],p);return t}(e))),$t(t,["parts"],e)}const r=Bt(e,["role"]);return null!=r&&$t(t,["role"],r),t}function os(e,t,n){const r=Bt(t,["expireTime"]);void 0!==n&&null!=r&&$t(n,["expireTime"],r);const a=Bt(t,["newSessionExpireTime"]);void 0!==n&&null!=a&&$t(n,["newSessionExpireTime"],a);const i=Bt(t,["uses"]);void 0!==n&&null!=i&&$t(n,["uses"],i);const o=Bt(t,["liveConnectConstraints"]);void 0!==n&&null!=o&&$t(n,["bidiGenerateContentSetup"],function(e,t){const n={},r=Bt(t,["model"]);null!=r&&$t(n,["setup","model"],ja(e,r));const a=Bt(t,["config"]);null!=a&&$t(n,["config"],function(e,t){const n={},r=Bt(e,["generationConfig"]);void 0!==t&&null!=r&&$t(t,["setup","generationConfig"],r);const a=Bt(e,["responseModalities"]);void 0!==t&&null!=a&&$t(t,["setup","generationConfig","responseModalities"],a);const i=Bt(e,["temperature"]);void 0!==t&&null!=i&&$t(t,["setup","generationConfig","temperature"],i);const o=Bt(e,["topP"]);void 0!==t&&null!=o&&$t(t,["setup","generationConfig","topP"],o);const s=Bt(e,["topK"]);void 0!==t&&null!=s&&$t(t,["setup","generationConfig","topK"],s);const l=Bt(e,["maxOutputTokens"]);void 0!==t&&null!=l&&$t(t,["setup","generationConfig","maxOutputTokens"],l);const c=Bt(e,["mediaResolution"]);void 0!==t&&null!=c&&$t(t,["setup","generationConfig","mediaResolution"],c);const u=Bt(e,["seed"]);void 0!==t&&null!=u&&$t(t,["setup","generationConfig","seed"],u);const d=Bt(e,["speechConfig"]);void 0!==t&&null!=d&&$t(t,["setup","generationConfig","speechConfig"],Ya(d));const p=Bt(e,["thinkingConfig"]);void 0!==t&&null!=p&&$t(t,["setup","generationConfig","thinkingConfig"],p);const h=Bt(e,["enableAffectiveDialog"]);void 0!==t&&null!=h&&$t(t,["setup","generationConfig","enableAffectiveDialog"],h);const m=Bt(e,["systemInstruction"]);void 0!==t&&null!=m&&$t(t,["setup","systemInstruction"],is(Ga(m)));const f=Bt(e,["tools"]);if(void 0!==t&&null!=f){let e=Ka(f);Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=Bt(e,["functionDeclarations"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),$t(t,["functionDeclarations"],e)}if(void 0!==Bt(e,["retrieval"]))throw new Error("retrieval parameter is not supported in Gemini API.");const r=Bt(e,["googleSearchRetrieval"]);null!=r&&$t(t,["googleSearchRetrieval"],r);const a=Bt(e,["computerUse"]);null!=a&&$t(t,["computerUse"],a);const i=Bt(e,["fileSearch"]);null!=i&&$t(t,["fileSearch"],i);const o=Bt(e,["codeExecution"]);null!=o&&$t(t,["codeExecution"],o);if(void 0!==Bt(e,["enterpriseWebSearch"]))throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const s=Bt(e,["googleMaps"]);null!=s&&$t(t,["googleMaps"],function(e){const t={};if(void 0!==Bt(e,["authConfig"]))throw new Error("authConfig parameter is not supported in Gemini API.");const n=Bt(e,["enableWidget"]);null!=n&&$t(t,["enableWidget"],n);return t}(s));const l=Bt(e,["googleSearch"]);null!=l&&$t(t,["googleSearch"],function(e){const t={};if(void 0!==Bt(e,["excludeDomains"]))throw new Error("excludeDomains parameter is not supported in Gemini API.");if(void 0!==Bt(e,["blockingConfidence"]))throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=Bt(e,["timeRangeFilter"]);null!=n&&$t(t,["timeRangeFilter"],n);return t}(l));const c=Bt(e,["urlContext"]);null!=c&&$t(t,["urlContext"],c);return t}
/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */(Wa(e)))),$t(t,["setup","tools"],e)}const g=Bt(e,["sessionResumption"]);void 0!==t&&null!=g&&$t(t,["setup","sessionResumption"],function(e){const t={},n=Bt(e,["handle"]);null!=n&&$t(t,["handle"],n);if(void 0!==Bt(e,["transparent"]))throw new Error("transparent parameter is not supported in Gemini API.");return t}(g));const y=Bt(e,["inputAudioTranscription"]);void 0!==t&&null!=y&&$t(t,["setup","inputAudioTranscription"],y);const x=Bt(e,["outputAudioTranscription"]);void 0!==t&&null!=x&&$t(t,["setup","outputAudioTranscription"],x);const b=Bt(e,["realtimeInputConfig"]);void 0!==t&&null!=b&&$t(t,["setup","realtimeInputConfig"],b);const v=Bt(e,["contextWindowCompression"]);void 0!==t&&null!=v&&$t(t,["setup","contextWindowCompression"],v);const w=Bt(e,["proactivity"]);void 0!==t&&null!=w&&$t(t,["setup","proactivity"],w);return n}(a,n));return n}(e,o));const s=Bt(t,["lockAdditionalFields"]);return void 0!==n&&null!=s&&$t(n,["fieldMask"],s),{}}function ss(e,t){let n=null;const r=e.bidiGenerateContentSetup;if("object"==typeof r&&null!==r&&"setup"in r){const t=r.setup;"object"==typeof t&&null!==t?(e.bidiGenerateContentSetup=t,n=t):delete e.bidiGenerateContentSetup}else void 0!==r&&delete e.bidiGenerateContentSetup;const a=e.fieldMask;if(n){const r=function(e){const t=[];for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)){const r=e[n];if("object"==typeof r&&null!=r&&Object.keys(r).length>0){const e=Object.keys(r).map(e=>`${n}.${e}`);t.push(...e)}else t.push(n)}return t.join(",")}(n);if(Array.isArray(null==t?void 0:t.lockAdditionalFields)&&0===(null==t?void 0:t.lockAdditionalFields.length))r?e.fieldMask=r:delete e.fieldMask;else if((null==t?void 0:t.lockAdditionalFields)&&t.lockAdditionalFields.length>0&&null!==a&&Array.isArray(a)&&a.length>0){const t=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let n=[];a.length>0&&(n=a.map(e=>t.includes(e)?`generationConfig.${e}`:e));const i=[];r&&i.push(r),n.length>0&&i.push(...n),i.length>0?e.fieldMask=i.join(","):delete e.fieldMask}else delete e.fieldMask}else null!==a&&Array.isArray(a)&&a.length>0?e.fieldMask=a.join(","):delete e.fieldMask;return e}class ls extends qt{constructor(e){super(),this.apiClient=e}async create(e){var t,n;let r,a="",i={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const o=function(e,t){const n={},r=Bt(t,["config"]);return null!=r&&$t(n,["config"],os(e,r,n)),n}(this.apiClient,e);a=Ht("auth_tokens",o._url),i=o._query,delete o.config,delete o._url,delete o._query;const s=ss(o,e.config);return r=this.apiClient.request({path:a,queryParams:i,body:JSON.stringify(s),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),r.then(e=>e)}}}
/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function cs(e){const t={},n=Bt(e,["config"]);return null!=n&&function(e,t){const n=Bt(e,["displayName"]);void 0!==t&&null!=n&&$t(t,["displayName"],n)}(n,t),t}function us(e){const t={},n=Bt(e,["name"]);null!=n&&$t(t,["_url","name"],n);const r=Bt(e,["config"]);return null!=r&&function(e,t){const n=Bt(e,["force"]);void 0!==t&&null!=n&&$t(t,["_query","force"],n)}(r,t),t}function ds(e){const t={},n=Bt(e,["name"]);null!=n&&$t(t,["name"],n);const r=Bt(e,["metadata"]);null!=r&&$t(t,["metadata"],r);const a=Bt(e,["done"]);null!=a&&$t(t,["done"],a);const i=Bt(e,["error"]);null!=i&&$t(t,["error"],i);const o=Bt(e,["response"]);return null!=o&&$t(t,["response"],function(e){const t={},n=Bt(e,["sdkHttpResponse"]);null!=n&&$t(t,["sdkHttpResponse"],n);const r=Bt(e,["parent"]);null!=r&&$t(t,["parent"],r);const a=Bt(e,["documentName"]);null!=a&&$t(t,["documentName"],a);return t}(o)),t}function ps(e){const t={},n=Bt(e,["fileSearchStoreName"]);null!=n&&$t(t,["_url","file_search_store_name"],n);const r=Bt(e,["fileName"]);null!=r&&$t(t,["fileName"],r);const a=Bt(e,["config"]);return null!=a&&function(e,t){const n=Bt(e,["customMetadata"]);if(void 0!==t&&null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),$t(t,["customMetadata"],e)}const r=Bt(e,["chunkingConfig"]);void 0!==t&&null!=r&&$t(t,["chunkingConfig"],r)}(a,t),t}function hs(e){const t={},n=Bt(e,["config"]);return null!=n&&function(e,t){const n=Bt(e,["pageSize"]);void 0!==t&&null!=n&&$t(t,["_query","pageSize"],n);const r=Bt(e,["pageToken"]);void 0!==t&&null!=r&&$t(t,["_query","pageToken"],r)}(n,t),t}function ms(e){const t={},n=Bt(e,["fileSearchStoreName"]);null!=n&&$t(t,["_url","file_search_store_name"],n);const r=Bt(e,["config"]);return null!=r&&function(e,t){const n=Bt(e,["mimeType"]);void 0!==t&&null!=n&&$t(t,["mimeType"],n);const r=Bt(e,["displayName"]);void 0!==t&&null!=r&&$t(t,["displayName"],r);const a=Bt(e,["customMetadata"]);if(void 0!==t&&null!=a){let e=a;Array.isArray(e)&&(e=e.map(e=>e)),$t(t,["customMetadata"],e)}const i=Bt(e,["chunkingConfig"]);void 0!==t&&null!=i&&$t(t,["chunkingConfig"],i)}(r,t),t}function fs(e){const t={},n=Bt(e,["name"]);null!=n&&$t(t,["_url","name"],n);const r=Bt(e,["config"]);return null!=r&&
/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */
function(e,t){const n=Bt(e,["force"]);void 0!==t&&null!=n&&$t(t,["_query","force"],n)}(r,t),t}function gs(e){const t={},n=Bt(e,["parent"]);null!=n&&$t(t,["_url","parent"],n);const r=Bt(e,["config"]);return null!=r&&function(e,t){const n=Bt(e,["pageSize"]);void 0!==t&&null!=n&&$t(t,["_query","pageSize"],n);const r=Bt(e,["pageToken"]);void 0!==t&&null!=r&&$t(t,["_query","pageToken"],r)}(r,t),t}
/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */
class ys extends qt{constructor(e){super(),this.apiClient=e,this.list=async e=>new bi(ta.PAGED_ITEM_DOCUMENTS,t=>this.listInternal({parent:e.parent,config:t.config}),await this.listInternal(e),e)}async get(e){var t,n;let r,a="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=function(e){const t={},n=Bt(e,["name"]);return null!=n&&$t(t,["_url","name"],n),t}(e);return a=Ht("{name}",o._url),i=o._query,delete o._url,delete o._query,r=this.apiClient.request({path:a,queryParams:i,body:JSON.stringify(o),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),r.then(e=>e)}}async delete(e){var t,n;let r="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const i=fs(e);r=Ht("{name}",i._url),a=i._query,delete i._url,delete i._query,await this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(i),httpMethod:"DELETE",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal})}}async listInternal(e){var t,n;let r,a="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=gs(e);return a=Ht("{parent}/documents",o._url),i=o._query,delete o._url,delete o._query,r=this.apiClient.request({path:a,queryParams:i,body:JSON.stringify(o),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),r.then(e=>{const t=function(e){const t={},n=Bt(e,["sdkHttpResponse"]);null!=n&&$t(t,["sdkHttpResponse"],n);const r=Bt(e,["nextPageToken"]);null!=r&&$t(t,["nextPageToken"],r);const a=Bt(e,["documents"]);if(null!=a){let e=a;Array.isArray(e)&&(e=e.map(e=>e)),$t(t,["documents"],e)}return t}(e),n=new ba;return Object.assign(n,t),n})}}}
/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class xs extends qt{constructor(e,t=new ys(e)){super(),this.apiClient=e,this.documents=t,this.list=async(e={})=>new bi(ta.PAGED_ITEM_FILE_SEARCH_STORES,e=>this.listInternal(e),await this.listInternal(e),e)}async uploadToFileSearchStore(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files to a file search store.");return this.apiClient.uploadFileToFileSearchStore(e.fileSearchStoreName,e.file,e.config)}async create(e){var t,n;let r,a="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=cs(e);return a=Ht("fileSearchStores",o._url),i=o._query,delete o._url,delete o._query,r=this.apiClient.request({path:a,queryParams:i,body:JSON.stringify(o),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),r.then(e=>e)}}async get(e){var t,n;let r,a="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=function(e){const t={},n=Bt(e,["name"]);return null!=n&&$t(t,["_url","name"],n),t}(e);return a=Ht("{name}",o._url),i=o._query,delete o._url,delete o._query,r=this.apiClient.request({path:a,queryParams:i,body:JSON.stringify(o),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),r.then(e=>e)}}async delete(e){var t,n;let r="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const i=us(e);r=Ht("{name}",i._url),a=i._query,delete i._url,delete i._query,await this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(i),httpMethod:"DELETE",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal})}}async listInternal(e){var t,n;let r,a="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=hs(e);return a=Ht("fileSearchStores",o._url),i=o._query,delete o._url,delete o._query,r=this.apiClient.request({path:a,queryParams:i,body:JSON.stringify(o),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),r.then(e=>{const t=function(e){const t={},n=Bt(e,["sdkHttpResponse"]);null!=n&&$t(t,["sdkHttpResponse"],n);const r=Bt(e,["nextPageToken"]);null!=r&&$t(t,["nextPageToken"],r);const a=Bt(e,["fileSearchStores"]);if(null!=a){let e=a;Array.isArray(e)&&(e=e.map(e=>e)),$t(t,["fileSearchStores"],e)}return t}(e),n=new va;return Object.assign(n,t),n})}}async uploadToFileSearchStoreInternal(e){var t,n;let r,a="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=ms(e);return a=Ht("upload/v1beta/{file_search_store_name}:uploadToFileSearchStore",o._url),i=o._query,delete o._url,delete o._query,r=this.apiClient.request({path:a,queryParams:i,body:JSON.stringify(o),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),r.then(e=>{const t=function(e){const t={},n=Bt(e,["sdkHttpResponse"]);return null!=n&&$t(t,["sdkHttpResponse"],n),t}(e),n=new wa;return Object.assign(n,t),n})}}async importFile(e){var t,n;let r,a="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=ps(e);return a=Ht("{file_search_store_name}:importFile",o._url),i=o._query,delete o._url,delete o._query,r=this.apiClient.request({path:a,queryParams:i,body:JSON.stringify(o),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),r.then(e=>{const t=ds(e),n=new Na;return Object.assign(n,t),n})}}}
/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function bs(e,t){const n={},r=Bt(e,["baseModel"]);null!=r&&$t(n,["baseModel"],r);const a=Bt(e,["preTunedModel"]);null!=a&&$t(n,["preTunedModel"],a);const i=Bt(e,["trainingDataset"]);null!=i&&function(e){const t={};if(void 0!==Bt(e,["gcsUri"]))throw new Error("gcsUri parameter is not supported in Gemini API.");if(void 0!==Bt(e,["vertexDatasetResource"]))throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const n=Bt(e,["examples"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),$t(t,["examples","examples"],e)}}(i);const o=Bt(e,["config"]);return null!=o&&function(e,t){const n={};if(void 0!==Bt(e,["validationDataset"]))throw new Error("validationDataset parameter is not supported in Gemini API.");const r=Bt(e,["tunedModelDisplayName"]);if(void 0!==t&&null!=r&&$t(t,["displayName"],r),void 0!==Bt(e,["description"]))throw new Error("description parameter is not supported in Gemini API.");const a=Bt(e,["epochCount"]);void 0!==t&&null!=a&&$t(t,["tuningTask","hyperparameters","epochCount"],a);const i=Bt(e,["learningRateMultiplier"]);if(null!=i&&$t(n,["tuningTask","hyperparameters","learningRateMultiplier"],i),void 0!==Bt(e,["exportLastCheckpointOnly"]))throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(void 0!==Bt(e,["preTunedModelCheckpointId"]))throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(void 0!==Bt(e,["adapterSize"]))throw new Error("adapterSize parameter is not supported in Gemini API.");const o=Bt(e,["batchSize"]);void 0!==t&&null!=o&&$t(t,["tuningTask","hyperparameters","batchSize"],o);const s=Bt(e,["learningRate"]);if(void 0!==t&&null!=s&&$t(t,["tuningTask","hyperparameters","learningRate"],s),void 0!==Bt(e,["labels"]))throw new Error("labels parameter is not supported in Gemini API.");if(void 0!==Bt(e,["beta"]))throw new Error("beta parameter is not supported in Gemini API.")}(o,n),n}function vs(e,t){const n={},r=Bt(e,["baseModel"]);null!=r&&$t(n,["baseModel"],r);const a=Bt(e,["preTunedModel"]);null!=a&&$t(n,["preTunedModel"],a);const i=Bt(e,["trainingDataset"]);null!=i&&function(e,t,n){const r={};let a=Bt(n,["config","method"]);void 0===a&&(a="SUPERVISED_FINE_TUNING");if("SUPERVISED_FINE_TUNING"===a){const n=Bt(e,["gcsUri"]);void 0!==t&&null!=n&&$t(t,["supervisedTuningSpec","trainingDatasetUri"],n)}else if("PREFERENCE_TUNING"===a){const n=Bt(e,["gcsUri"]);void 0!==t&&null!=n&&$t(t,["preferenceOptimizationSpec","trainingDatasetUri"],n)}let i=Bt(n,["config","method"]);void 0===i&&(i="SUPERVISED_FINE_TUNING");if("SUPERVISED_FINE_TUNING"===i){const n=Bt(e,["vertexDatasetResource"]);void 0!==t&&null!=n&&$t(t,["supervisedTuningSpec","trainingDatasetUri"],n)}else if("PREFERENCE_TUNING"===i){const n=Bt(e,["vertexDatasetResource"]);void 0!==t&&null!=n&&$t(t,["preferenceOptimizationSpec","trainingDatasetUri"],n)}if(void 0!==Bt(e,["examples"]))throw new Error("examples parameter is not supported in Vertex AI.")}(i,n,t);const o=Bt(e,["config"]);return null!=o&&function(e,t,n){let r=Bt(n,["config","method"]);if(void 0===r&&(r="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===r){const n=Bt(e,["validationDataset"]);void 0!==t&&null!=n&&$t(t,["supervisedTuningSpec"],Cs(n))}else if("PREFERENCE_TUNING"===r){const n=Bt(e,["validationDataset"]);void 0!==t&&null!=n&&$t(t,["preferenceOptimizationSpec"],Cs(n))}const a=Bt(e,["tunedModelDisplayName"]);void 0!==t&&null!=a&&$t(t,["tunedModelDisplayName"],a);const i=Bt(e,["description"]);void 0!==t&&null!=i&&$t(t,["description"],i);let o=Bt(n,["config","method"]);if(void 0===o&&(o="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===o){const n=Bt(e,["epochCount"]);void 0!==t&&null!=n&&$t(t,["supervisedTuningSpec","hyperParameters","epochCount"],n)}else if("PREFERENCE_TUNING"===o){const n=Bt(e,["epochCount"]);void 0!==t&&null!=n&&$t(t,["preferenceOptimizationSpec","hyperParameters","epochCount"],n)}let s=Bt(n,["config","method"]);if(void 0===s&&(s="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===s){const n=Bt(e,["learningRateMultiplier"]);void 0!==t&&null!=n&&$t(t,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],n)}else if("PREFERENCE_TUNING"===s){const n=Bt(e,["learningRateMultiplier"]);void 0!==t&&null!=n&&$t(t,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],n)}let l=Bt(n,["config","method"]);if(void 0===l&&(l="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===l){const n=Bt(e,["exportLastCheckpointOnly"]);void 0!==t&&null!=n&&$t(t,["supervisedTuningSpec","exportLastCheckpointOnly"],n)}else if("PREFERENCE_TUNING"===l){const n=Bt(e,["exportLastCheckpointOnly"]);void 0!==t&&null!=n&&$t(t,["preferenceOptimizationSpec","exportLastCheckpointOnly"],n)}let c=Bt(n,["config","method"]);if(void 0===c&&(c="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===c){const n=Bt(e,["adapterSize"]);void 0!==t&&null!=n&&$t(t,["supervisedTuningSpec","hyperParameters","adapterSize"],n)}else if("PREFERENCE_TUNING"===c){const n=Bt(e,["adapterSize"]);void 0!==t&&null!=n&&$t(t,["preferenceOptimizationSpec","hyperParameters","adapterSize"],n)}if(void 0!==Bt(e,["batchSize"]))throw new Error("batchSize parameter is not supported in Vertex AI.");if(void 0!==Bt(e,["learningRate"]))throw new Error("learningRate parameter is not supported in Vertex AI.");const u=Bt(e,["labels"]);void 0!==t&&null!=u&&$t(t,["labels"],u);const d=Bt(e,["beta"]);void 0!==t&&null!=d&&$t(t,["preferenceOptimizationSpec","hyperParameters","beta"],d)}(o,n,t),n}function ws(e,t){const n={},r=Bt(e,["config"]);return null!=r&&function(e,t){const n=Bt(e,["pageSize"]);void 0!==t&&null!=n&&$t(t,["_query","pageSize"],n);const r=Bt(e,["pageToken"]);void 0!==t&&null!=r&&$t(t,["_query","pageToken"],r);const a=Bt(e,["filter"]);void 0!==t&&null!=a&&$t(t,["_query","filter"],a)}(r,n),n}function Ns(e,t){const n={},r=Bt(e,["config"]);return null!=r&&function(e,t){const n=Bt(e,["pageSize"]);void 0!==t&&null!=n&&$t(t,["_query","pageSize"],n);const r=Bt(e,["pageToken"]);void 0!==t&&null!=r&&$t(t,["_query","pageToken"],r);const a=Bt(e,["filter"]);void 0!==t&&null!=a&&$t(t,["_query","filter"],a)}(r,n),n}function Es(e,t){const n={},r=Bt(e,["sdkHttpResponse"]);null!=r&&$t(n,["sdkHttpResponse"],r);const a=Bt(e,["name"]);null!=a&&$t(n,["name"],a);const i=Bt(e,["state"]);null!=i&&$t(n,["state"],Qa(i));const o=Bt(e,["createTime"]);null!=o&&$t(n,["createTime"],o);const s=Bt(e,["tuningTask","startTime"]);null!=s&&$t(n,["startTime"],s);const l=Bt(e,["tuningTask","completeTime"]);null!=l&&$t(n,["endTime"],l);const c=Bt(e,["updateTime"]);null!=c&&$t(n,["updateTime"],c);const u=Bt(e,["description"]);null!=u&&$t(n,["description"],u);const d=Bt(e,["baseModel"]);null!=d&&$t(n,["baseModel"],d);const p=Bt(e,["_self"]);return null!=p&&$t(n,["tunedModel"],function(e){const t={},n=Bt(e,["name"]);null!=n&&$t(t,["model"],n);const r=Bt(e,["name"]);return null!=r&&$t(t,["endpoint"],r),t}(p)),n}function Ss(e,t){const n={},r=Bt(e,["sdkHttpResponse"]);null!=r&&$t(n,["sdkHttpResponse"],r);const a=Bt(e,["name"]);null!=a&&$t(n,["name"],a);const i=Bt(e,["state"]);null!=i&&$t(n,["state"],Qa(i));const o=Bt(e,["createTime"]);null!=o&&$t(n,["createTime"],o);const s=Bt(e,["startTime"]);null!=s&&$t(n,["startTime"],s);const l=Bt(e,["endTime"]);null!=l&&$t(n,["endTime"],l);const c=Bt(e,["updateTime"]);null!=c&&$t(n,["updateTime"],c);const u=Bt(e,["error"]);null!=u&&$t(n,["error"],u);const d=Bt(e,["description"]);null!=d&&$t(n,["description"],d);const p=Bt(e,["baseModel"]);null!=p&&$t(n,["baseModel"],p);const h=Bt(e,["tunedModel"]);null!=h&&$t(n,["tunedModel"],h);const m=Bt(e,["preTunedModel"]);null!=m&&$t(n,["preTunedModel"],m);const f=Bt(e,["supervisedTuningSpec"]);null!=f&&$t(n,["supervisedTuningSpec"],f);const g=Bt(e,["preferenceOptimizationSpec"]);null!=g&&$t(n,["preferenceOptimizationSpec"],g);const y=Bt(e,["tuningDataStats"]);null!=y&&$t(n,["tuningDataStats"],y);const x=Bt(e,["encryptionSpec"]);null!=x&&$t(n,["encryptionSpec"],x);const b=Bt(e,["partnerModelTuningSpec"]);null!=b&&$t(n,["partnerModelTuningSpec"],b);const v=Bt(e,["customBaseModel"]);null!=v&&$t(n,["customBaseModel"],v);const w=Bt(e,["experiment"]);null!=w&&$t(n,["experiment"],w);const N=Bt(e,["labels"]);null!=N&&$t(n,["labels"],N);const E=Bt(e,["outputUri"]);null!=E&&$t(n,["outputUri"],E);const S=Bt(e,["pipelineJob"]);null!=S&&$t(n,["pipelineJob"],S);const C=Bt(e,["serviceAccount"]);null!=C&&$t(n,["serviceAccount"],C);const k=Bt(e,["tunedModelDisplayName"]);null!=k&&$t(n,["tunedModelDisplayName"],k);const T=Bt(e,["veoTuningSpec"]);return null!=T&&$t(n,["veoTuningSpec"],T),n}function Cs(e,t){const n={},r=Bt(e,["gcsUri"]);null!=r&&$t(n,["validationDatasetUri"],r);const a=Bt(e,["vertexDatasetResource"]);return null!=a&&$t(n,["validationDatasetUri"],a),n}
/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ks extends qt{constructor(e){super(),this.apiClient=e,this.get=async e=>await this.getInternal(e),this.list=async(e={})=>new bi(ta.PAGED_ITEM_TUNING_JOBS,e=>this.listInternal(e),await this.listInternal(e),e),this.tune=async e=>{var t;if(this.apiClient.isVertexAI()){if(e.baseModel.startsWith("projects/")){const n={tunedModelName:e.baseModel};(null===(t=e.config)||void 0===t?void 0:t.preTunedModelCheckpointId)&&(n.checkpointId=e.config.preTunedModelCheckpointId);const r=Object.assign(Object.assign({},e),{preTunedModel:n});return r.baseModel=void 0,await this.tuneInternal(r)}{const t=Object.assign({},e);return await this.tuneInternal(t)}}{const t=Object.assign({},e),n=await this.tuneMldevInternal(t);let r="";void 0!==n.metadata&&void 0!==n.metadata.tunedModel?r=n.metadata.tunedModel:void 0!==n.name&&n.name.includes("/operations/")&&(r=n.name.split("/operations/")[0]);return{name:r,state:Bn.JOB_STATE_QUEUED}}}}async getInternal(e){var t,n,r,a;let i,o="",s={};if(this.apiClient.isVertexAI()){const r=function(e){const t={},n=Bt(e,["name"]);return null!=n&&$t(t,["_url","name"],n),t}(e);return o=Ht("{name}",r._url),s=r._query,delete r._url,delete r._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(r),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),i.then(e=>Ss(e))}{const t=function(e){const t={},n=Bt(e,["name"]);return null!=n&&$t(t,["_url","name"],n),t}(e);return o=Ht("{name}",t._url),s=t._query,delete t._url,delete t._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(r=e.config)||void 0===r?void 0:r.httpOptions,abortSignal:null===(a=e.config)||void 0===a?void 0:a.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),i.then(e=>Es(e))}}async listInternal(e){var t,n,r,a;let i,o="",s={};if(this.apiClient.isVertexAI()){const r=Ns(e);return o=Ht("tuningJobs",r._url),s=r._query,delete r._url,delete r._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(r),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),i.then(e=>{const t=function(e){const t={},n=Bt(e,["sdkHttpResponse"]);null!=n&&$t(t,["sdkHttpResponse"],n);const r=Bt(e,["nextPageToken"]);null!=r&&$t(t,["nextPageToken"],r);const a=Bt(e,["tuningJobs"]);if(null!=a){let e=a;Array.isArray(e)&&(e=e.map(e=>Ss(e))),$t(t,["tuningJobs"],e)}return t}(e),n=new ga;return Object.assign(n,t),n})}{const t=ws(e);return o=Ht("tunedModels",t._url),s=t._query,delete t._url,delete t._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(r=e.config)||void 0===r?void 0:r.httpOptions,abortSignal:null===(a=e.config)||void 0===a?void 0:a.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),i.then(e=>{const t=function(e){const t={},n=Bt(e,["sdkHttpResponse"]);null!=n&&$t(t,["sdkHttpResponse"],n);const r=Bt(e,["nextPageToken"]);null!=r&&$t(t,["nextPageToken"],r);const a=Bt(e,["tunedModels"]);if(null!=a){let e=a;Array.isArray(e)&&(e=e.map(e=>Es(e))),$t(t,["tuningJobs"],e)}return t}(e),n=new ga;return Object.assign(n,t),n})}}async cancel(e){var t,n,r,a;let i="",o={};if(this.apiClient.isVertexAI()){const r=function(e){const t={},n=Bt(e,["name"]);return null!=n&&$t(t,["_url","name"],n),t}(e);i=Ht("{name}:cancel",r._url),o=r._query,delete r._url,delete r._query,await this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal})}else{const t=function(e){const t={},n=Bt(e,["name"]);return null!=n&&$t(t,["_url","name"],n),t}(e);i=Ht("{name}:cancel",t._url),o=t._query,delete t._url,delete t._query,await this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(r=e.config)||void 0===r?void 0:r.httpOptions,abortSignal:null===(a=e.config)||void 0===a?void 0:a.abortSignal})}}async tuneInternal(e){var t,n;let r,a="",i={};if(this.apiClient.isVertexAI()){const o=vs(e,e);return a=Ht("tuningJobs",o._url),i=o._query,delete o._url,delete o._query,r=this.apiClient.request({path:a,queryParams:i,body:JSON.stringify(o),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),r.then(e=>Ss(e))}throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var t,n;let r,a="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=bs(e);return a=Ht("tunedModels",o._url),i=o._query,delete o._url,delete o._query,r=this.apiClient.request({path:a,queryParams:i,body:JSON.stringify(o),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),r.then(e=>function(e){const t={},n=Bt(e,["sdkHttpResponse"]);null!=n&&$t(t,["sdkHttpResponse"],n);const r=Bt(e,["name"]);null!=r&&$t(t,["name"],r);const a=Bt(e,["metadata"]);null!=a&&$t(t,["metadata"],a);const i=Bt(e,["done"]);null!=i&&$t(t,["done"],i);const o=Bt(e,["error"]);return null!=o&&$t(t,["error"],o),t}(e))}}}
/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Ts{async download(e,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const Is="x-goog-upload-status";async function As(e,t,n){var r,a;let i=0,o=0,s=new ra(new Response),l="upload";for(i=e.size;o<i;){const c=Math.min(8388608,i-o),u=e.slice(o,o+c);o+c>=i&&(l+=", finalize");let d=0,p=1e3;for(;d<3&&(s=await n.request({path:"",body:u,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:t,headers:{"X-Goog-Upload-Command":l,"X-Goog-Upload-Offset":String(o),"Content-Length":String(c)}}}),!(null===(r=null==s?void 0:s.headers)||void 0===r?void 0:r[Is]));)d++,await js(p),p*=2;if(o+=c,"active"!==(null===(a=null==s?void 0:s.headers)||void 0===a?void 0:a[Is]))break;if(i<=o)throw new Error("All content has been uploaded, but the upload status is not finalized.")}return s}function js(e){return new Promise(t=>setTimeout(t,e))}class _s{async upload(e,t,n){if("string"==typeof e)throw new Error("File path is not supported in browser uploader.");return await async function(e,t,n){var r;const a=await As(e,t,n),i=await(null==a?void 0:a.json());if("final"!==(null===(r=null==a?void 0:a.headers)||void 0===r?void 0:r[Is]))throw new Error("Failed to upload file: Upload status is not finalized.");return i.file}(e,t,n)}async uploadToFileSearchStore(e,t,n){if("string"==typeof e)throw new Error("File path is not supported in browser uploader.");return await async function(e,t,n){var r;const a=await As(e,t,n),i=await(null==a?void 0:a.json());if("final"!==(null===(r=null==a?void 0:a.headers)||void 0===r?void 0:r[Is]))throw new Error("Failed to upload file: Upload status is not finalized.");const o=Qt(i),s=new Aa;return Object.assign(s,o),s}(e,t,n)}async stat(e){if("string"==typeof e)throw new Error("File path is not supported in browser uploader.");return await async function(e){return{size:e.size,type:e.type}}(e)}}
/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Os{create(e,t,n){return new Ps(e,t,n)}}class Ps{constructor(e,t,n){this.url=e,this.headers=t,this.callbacks=n}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(void 0===this.ws)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(void 0===this.ws)throw new Error("WebSocket is not connected");this.ws.close()}}
/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Rs="x-goog-api-key";class Ms{constructor(e){this.apiKey=e}async addAuthHeaders(e,t){if(null===e.get(Rs)){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(Rs,this.apiKey)}}}
/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Ds{constructor(e){var t;if(null==e.apiKey)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=null!==(t=e.vertexai)&&void 0!==t&&t,this.apiKey=e.apiKey;const n=Gt(e.httpOptions,e.vertexai,void 0,void 0);n&&(e.httpOptions?e.httpOptions.baseUrl=n:e.httpOptions={baseUrl:n}),this.apiVersion=e.apiVersion;const r=new Ms(this.apiKey);this.apiClient=new Go({auth:r,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:"gl-node/web",uploader:new _s,downloader:new Ts}),this.models=new rs(this.apiClient),this.live=new Jo(this.apiClient,r,new Os),this.batches=new vi(this.apiClient),this.chats=new Di(this.models,this.apiClient),this.caches=new Ii(this.apiClient),this.files=new Fi(this.apiClient),this.operations=new as(this.apiClient),this.authTokens=new ls(this.apiClient),this.tunings=new ks(this.apiClient),this.fileSearchStores=new xs(this.apiClient)}}const Ls=(e,t)=>t.some(t=>e instanceof t);let Us,zs;const Fs=new WeakMap,Gs=new WeakMap,qs=new WeakMap;let Hs={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return Fs.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Ys(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function $s(e){Hs=e(Hs)}function Bs(e){return(zs||(zs=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(Ws(this),t),Ys(this.request)}:function(...t){return Ys(e.apply(Ws(this),t))}}function Vs(e){return"function"==typeof e?Bs(e):(e instanceof IDBTransaction&&function(e){if(Fs.has(e))return;const t=new Promise((t,n)=>{const r=()=>{e.removeEventListener("complete",a),e.removeEventListener("error",i),e.removeEventListener("abort",i)},a=()=>{t(),r()},i=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",a),e.addEventListener("error",i),e.addEventListener("abort",i)});Fs.set(e,t)}(e),Ls(e,Us||(Us=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,Hs):e)}function Ys(e){if(e instanceof IDBRequest)return function(e){const t=new Promise((t,n)=>{const r=()=>{e.removeEventListener("success",a),e.removeEventListener("error",i)},a=()=>{t(Ys(e.result)),r()},i=()=>{n(e.error),r()};e.addEventListener("success",a),e.addEventListener("error",i)});return qs.set(t,e),t}(e);if(Gs.has(e))return Gs.get(e);const t=Vs(e);return t!==e&&(Gs.set(e,t),qs.set(t,e)),t}const Ws=e=>qs.get(e);const Ks=["get","getKey","getAll","getAllKeys","count"],Js=["put","add","delete","clear"],Qs=new Map;function Xs(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(Qs.get(t))return Qs.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,a=Js.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!a&&!Ks.includes(n))return;const i=async function(e,...t){const i=this.transaction(e,a?"readwrite":"readonly");let o=i.store;return r&&(o=o.index(t.shift())),(await Promise.all([o[n](...t),a&&i.done]))[0]};return Qs.set(t,i),i}$s(e=>({...e,get:(t,n,r)=>Xs(t,n)||e.get(t,n,r),has:(t,n)=>!!Xs(t,n)||e.has(t,n)}));const Zs=["continue","continuePrimaryKey","advance"],el={},tl=new WeakMap,nl=new WeakMap,rl={get(e,t){if(!Zs.includes(t))return e[t];let n=el[t];return n||(n=el[t]=function(...e){tl.set(this,nl.get(this)[t](...e))}),n}};async function*al(...e){let t=this;if(t instanceof IDBCursor||(t=await t.openCursor(...e)),!t)return;const n=new Proxy(t,rl);for(nl.set(n,t),qs.set(n,Ws(t));t;)yield n,t=await(tl.get(n)||t.continue()),tl.delete(n)}function il(e,t){return t===Symbol.asyncIterator&&Ls(e,[IDBIndex,IDBObjectStore,IDBCursor])||"iterate"===t&&Ls(e,[IDBIndex,IDBObjectStore])}$s(e=>({...e,get:(t,n,r)=>il(t,n)?al:e.get(t,n,r),has:(t,n)=>il(t,n)||e.has(t,n)}));let ol=null;async function sl(){return ol||(ol=await function(e,t,{blocked:n,upgrade:r,blocking:a,terminated:i}={}){const o=indexedDB.open(e,t),s=Ys(o);return r&&o.addEventListener("upgradeneeded",e=>{r(Ys(o.result),e.oldVersion,e.newVersion,Ys(o.transaction),e)}),n&&o.addEventListener("blocked",e=>n(e.oldVersion,e.newVersion,e)),s.then(e=>{i&&e.addEventListener("close",()=>i()),a&&e.addEventListener("versionchange",e=>a(e.oldVersion,e.newVersion,e))}).catch(()=>{}),s}("synapse_med_v1",1,{upgrade(e){if(!e.objectStoreNames.contains("notes")){const t=e.createObjectStore("notes",{keyPath:"id"});t.createIndex("by_updated","updated_at"),t.createIndex("by_title","title")}if(!e.objectStoreNames.contains("files")){const t=e.createObjectStore("files",{keyPath:"id"});t.createIndex("by_note","related_note_id"),t.createIndex("by_type","mime_type")}if(e.objectStoreNames.contains("profile")||e.createObjectStore("profile",{keyPath:"id"}),!e.objectStoreNames.contains("chats")){e.createObjectStore("chats",{keyPath:"note_id"}).createIndex("by_note","note_id")}}}),ol)}const ll="local-user",cl={get:async()=>(await sl()).get("profile",ll),async save(e){const t=await sl(),n=(new Date).toISOString(),r=await this.get(),a={id:ll,name:e.name||r?.name||"",discipline:e.discipline??r?.discipline,level:e.level??r?.level,teaching_style:e.teaching_style??r?.teaching_style,custom_teaching_style:e.custom_teaching_style??r?.custom_teaching_style,exam_goal:e.exam_goal??r?.exam_goal,custom_exam_goal:e.custom_exam_goal??r?.custom_exam_goal,profile_picture_id:e.profile_picture_id??r?.profile_picture_id,birthday:e.birthday??r?.birthday,theme:e.theme??r?.theme,specialties:e.specialties??r?.specialties,learning_goals:e.learning_goals??r?.learning_goals,api_key:e.api_key??r?.api_key,created_at:r?.created_at||n,updated_at:n};return await t.put("profile",a),a},async getApiKey(){const e=await this.get();return e?.api_key},async updateApiKey(e){await this.save({api_key:e})},async hasApiKey(){const e=await this.getApiKey();return!!e&&e.startsWith("AIza")},async exists(){return void 0!==await this.get()},async delete(){const e=await sl();await e.delete("profile",ll)},async clear(){const e=await sl();await e.clear("profile")}};class ul extends Error{constructor(e,t){super(e),this.code=t,this.name="ChatApiKeyError"}}const dl={type:"object",properties:{verdict:{type:"string",enum:["CORRECT","INCORRECT"],description:"Whether the student's answer was correct or incorrect"},analysis:{type:"string",description:"2-3 substantial paragraphs analyzing the answer. If correct: validate reasoning, explain WHY it's best, extend understanding. If incorrect: honor their reasoning, explain why correct answer is superior, build conceptual bridge."},optionAnalysis:{type:"object",properties:{A:{type:"string",description:"One sophisticated sentence explaining option A - why it's correct or why it's a distractor"},B:{type:"string",description:"One sophisticated sentence explaining option B - why it's correct or why it's a distractor"},C:{type:"string",description:"One sophisticated sentence explaining option C - why it's correct or why it's a distractor"},D:{type:"string",description:"One sophisticated sentence explaining option D - why it's correct or why it's a distractor"}},required:["A","B","C","D"],description:"Analysis of each answer option"},corePrinciple:{type:"string",description:"One powerful sentence that crystallizes the conceptual distinction being tested. Make it memorable."},examStrategy:{type:"string",description:"One tactical insight about recognizing this pattern on exam day, or a clinical pearl that cements understanding."},correctAnswer:{type:"string",enum:["A","B","C","D"],description:"The single-letter correct answer (A/B/C/D)"},correctAnswerExplanation:{type:"string",description:"A one-line explanation of why this is the correct answer, concise and directly addressing the key mechanism or concept."}},required:["verdict","analysis","optionAnalysis","corePrinciple","examStrategy","correctAnswer","correctAnswerExplanation"]},pl={"USMLE Step 1":{style:"Two-step vignette: clinical presentation  pathophysiology mechanism",focus:["Mechanism of disease","Biochemistry pathways","Pharmacology MOA","Histology correlates"],tips:"Focus on the 'WHY' - connect symptoms to underlying biochemistry/pathology"},"USMLE Step 2 CK":{style:"Clinical vignette with next-best-step management",focus:["Diagnosis","Management algorithms","Treatment priorities","Patient safety"],tips:"Think: What would harm the patient if missed? What's the most likely diagnosis?"},"NCLEX-RN":{style:"Priority/delegation/safety focused with SATA format",focus:["Patient safety","Nursing priorities","Delegation rules","Assessment first"],tips:"ABC's, Maslow's hierarchy, nursing process. Safety always comes first."},"University Semester Exam":{style:"Mix of conceptual understanding and factual recall",focus:["Core concepts","Classifications","Definitions","Clinical correlations"],tips:"Know your professor's style - lecture notes often reveal emphasis areas"},MCAT:{style:"Passage-based critical reasoning with science application",focus:["Scientific reasoning","Data interpretation","Concept application","Critical analysis"],tips:"Don't overthink - the answer is in the passage or directly testable"},default:{style:"Balanced clinical and conceptual assessment",focus:["Core knowledge","Clinical application","Critical thinking"],tips:"Focus on understanding over memorization"}};const hl=new class{constructor(){this.topicsCache=new Map}async getClient(){const e=await cl.getApiKey();if(!e)throw new ul("No API Key found. Please add your Google Gemini API key in Settings.","MISSING");if(!e.startsWith("AIza"))throw new ul("Invalid API Key format. Google Gemini API keys start with 'AIza'.","INVALID");return new Ds({apiKey:e})}handleApiError(e){const t=e?.message?.toLowerCase()||"",n=e?.status||e?.httpStatus;if(t.includes("api key not valid")||t.includes("invalid api key")||400===n)throw new ul("Your API key is invalid. Please check it in Settings.","INVALID");if(t.includes("quota")||t.includes("rate limit")||429===n)throw new ul("API quota exceeded. Please wait a moment or check your Google Cloud console.","QUOTA_EXCEEDED");if(t.includes("expired")||t.includes("revoked"))throw new ul("Your API key has expired or been revoked. Please generate a new one.","EXPIRED");throw e}extractTopicsFromContent(e){const t=`${e.length}-${e.slice(0,100)}`;if(this.topicsCache.has(t))return this.topicsCache.get(t);const n=[],r=/^#{1,3}\s+(.+)$/gm;let a,i=0;for(;null!==(a=r.exec(e));){let e=a[1].replace(/\[([^\]]+)\]\([^)]+\)/g,"$1").replace(/\[([^\]]+)\]/g,"$1").replace(/[*_`]/g,"").replace(/\(node:[^)]+\)/g,"").trim();e.length>3&&e.length<80&&!e.toLowerCase().includes("table of contents")&&n.push({id:"topic-"+i++,name:e,questionCount:Math.floor(3*Math.random())+2})}return n.length>0&&n.unshift({id:"full-guide",name:" Full Guide (All Topics)",questionCount:5}),this.topicsCache.set(t,n),n}getEffectiveExamGoal(e){return"Custom"===e.examGoal&&e.customExamGoal?e.customExamGoal:e.examGoal||"Clinical assessment"}getEffectiveTeachingStyle(e){return"Custom"===e.teachingStyle&&e.customTeachingStyle?e.customTeachingStyle:e.teachingStyle||"Detailed"}detectDifficultyTier(e){const t=e.level?.includes("Pre-clinical")||!1,n=e.level?.includes("Clinical")||!1;return{isPreClinical:t,isClinicalStudent:n,isAdvanced:"Intern/Resident"===e.level||"Professional"===e.level,needsPreBrief:t||n}}getDifficultySettings(e,t){return e?"\n DIFFICULTY: SCAFFOLDED LEARNING\n- **Patient:** Cooperative, articulate, volunteers relevant info when appropriate.\n- **Guidance:** If student seems stuck (>2 exchanges without progress), offer a gentle clinical nudge.\n- **Forgiveness:** Warn before consequences. Allow course correction.\n- **Vitals:** Provided upfront at presentation.\n":t?"\n DIFFICULTY: HIGH-FIDELITY REALISTIC\n- **Patient:** May be stoic, vague, poor historian, or confused. Answers ONLY what is asked.\n- **Information Fog:** Chief complaint ONLY at start. Vitals, history, exam - must be requested.\n- **Consequences:** Delays  vitals worsen. Wrong action  immediate deterioration.\n- **No Safety Net:** Patient won't remind you to check things.\n":"\n DIFFICULTY: CLINICAL TRAINING\n- **Patient:** Cooperative but doesn't elaborate. Direct answers only.\n- **Information:** Vitals provided. History/exam must be requested.\n- **Consequences:** Significant delays trigger warning, then deterioration.\n"}getPreBriefPhase(e,t,n){return e?`\n\n PHASE 0: PRE-BRIEF (MANDATORY FOR THIS LEARNER)\n\n**PURPOSE:** Set mental model, reduce anxiety, clarify role expectations.\n\n**EXECUTE THIS FIRST:**\n1. **Welcome:** Greet ${t.name||"the learner"} warmly.\n2. **Orientation:** "Today's simulation focuses on: ${n}"\n3. **Role Clarity:** "As a ${t.level||"student"} ${t.discipline||"healthcare professional"}, your focus areas are:"\n   - Generate 3-4 SPECIFIC learning objectives relevant to their discipline/level\n   - Examples for Physio: "Identify DVT red flags", "Determine mobility safety", "Communicate findings"\n   - Examples for Nursing: "Prioritize assessments", "Recognize deterioration signs", "Escalate appropriately"\n   - Examples for MD: "Develop differential", "Order targeted workup", "Formulate treatment plan"\n4. **Consent:** Ask: "Ready to step into the room?" or similar.\n5. **STOP AND WAIT** for user confirmation before proceeding to Phase 1.\n\n**TRANSITION TRIGGER:** When user says "yes", "ready", "let's go", "ok", or similar  Proceed to Phase 1.\n`:`\n\n PHASE 0: PRE-BRIEF (SKIPPED - ADVANCED LEARNER)\n\n**This learner is ${t.level}** - simulate real-world conditions.\nSkip orientation. Begin scenario immediately at Phase 1.\n`}getDynamicWinCondition(e){return`\n\n DYNAMIC WIN CONDITION + SCOPE CEILING (AI-DETERMINED)\n\n**THIS LEARNER:** ${e.discipline||"Healthcare Professional"} | ${e.level||"Student"}\n\n**YOUR TASK:** Dynamically determine this learner's:\n1. **SCOPE CEILING** - What is the MAXIMUM they can do within their profession's scope of practice?\n2. **WIN CONDITION** - What action marks "job well done" for their role?\n3. **BEYOND SCOPE** - What should they NOT be asked to do?\n\n**FRAMEWORK FOR ANY DISCIPLINE:**\n- What does a competent ${e.discipline||"professional"} at ${e.level||"this level"} DO vs. REFER?\n- Where does their authority END and another profession's BEGIN?\n- If they identify something beyond their scope, ESCALATION = SUCCESS\n\n**FEW-SHOT EXAMPLES (Learn the PATTERN, apply to ANY discipline):**\n\n **Example 1: Physiotherapy Student + DVT Case**\n- Scope Ceiling: Assess mobility, recognize red flags, hold unsafe treatment\n- Win Condition: "I recognize DVT signs, I'm stopping mobilization and escalating to the physician"\n- Beyond Scope: Ordering D-dimer, prescribing anticoagulants, diagnosing PE\n- Case Ends When: Escalation decision made \n\n **Example 2: Nursing Student + Chest Pain**\n- Scope Ceiling: Vital assessment, ECG initiation, notify physician, administer PRN meds per protocol\n- Win Condition: "Patient has ST changes, I've given aspirin per protocol and paged cardiology STAT"\n- Beyond Scope: Interpreting ECG definitively, ordering cath lab, choosing thrombolytics\n- Case Ends When: Correct prioritization + escalation \n\n **Example 3: Pharmacy Student + Drug Interaction**\n- Scope Ceiling: Identify interaction, calculate correct dose, recommend alternative, alert prescriber\n- Win Condition: "This combination risks QT prolongation, I'm calling the prescriber to recommend [alternative]"\n- Beyond Scope: Changing prescription independently, diagnosing patient condition\n- Case Ends When: Prescriber alerted with recommendation \n\n **Example 4: MD Intern + Same DVT Case**\n- Scope Ceiling: Full workup, diagnosis, initial treatment, disposition decision\n- Win Condition: "D-dimer elevated, CTPA confirms PE, starting heparin, admitting to medicine"\n- Beyond Scope: Very little - may need attending approval for high-risk decisions\n- Case Ends When: Diagnosis + treatment + disposition complete \n\n**NOW APPLY THIS LOGIC TO: ${e.discipline||"this learner"} at ${e.level||"their level"}**\n\n**LEVEL MODIFIER:**\n- Pre-clinical/Student  Lower ceiling, more scaffolding, escalation often = win\n- Clinical Student  Moderate ceiling, can do more independently, still needs supervision sign-off\n- Intern/Resident  High ceiling, can diagnose/treat, needs attending for major decisions\n- Professional/Attending  Full ceiling, case ends at disposition\n\n**GOLDEN RULE:** Once learner correctly acts at their ceiling  CASE IS WON. Do NOT push them beyond their scope.\n`}getImmersionRules(){return"\n\n IMMERSION RULES (NON-NEGOTIABLE)\n\n1. **VISUAL SCENE:** Start with what the learner SEES entering the room.\n   - Patient position, expression, visible signs, environment\n   - Example: *You enter Bay 4. An elderly woman clutches her leg, face pale.*\n\n2. **PATIENT VOICE:** When asked subjective questions, SPEAK AS THE PATIENT.\n   - Use quotes. Include emotion.\n   - Example: \"It's like... something's squeezing inside, doc. Won't let up.\"\n\n3. **NON-VERBAL CUES:** Use italics for actions/observations.\n   - *Patient winces on palpation*\n   - *Avoids eye contact when asked about smoking*\n   - *Monitor alarm sounds*\n\n4. **DYNAMIC VITALS:** Track and update based on actions.\n   Format when vitals change:\n   ```\n    VITALS UPDATE:\n   HR: 88  112 bpm ( Tachycardia)\n   BP: 130/85  118/70 mmHg\n   SpO2: 97%  93%\n   *Patient appears more distressed*\n   ```\n"}getSafetySystem(){return"\n\n SAFETY SYSTEM\n\nIf learner attempts DANGEROUS action (could harm patient):\n\n **SAFETY PAUSE** - *Simulation frozen*\n**Action:** [What they tried]\n**Risk:** [Why dangerous - 1-2 sentences]\n**Instead:** [Correct approach]\n*Choose: (1) Revise decision, or (2) Continue for learning*\n"}getCaseProgression(e,t,n){return`\n\n CASE PROGRESSION\n\n${e?'**PHASE 0 - PRE-BRIEF:**  START HERE. Orient learner. Wait for "ready" confirmation.':""}\n**PHASE 1 - PRESENTATION:** Scene + Chief complaint ${t?"+ Vitals + History hints":n?"ONLY (everything else must be requested)":"+ Vitals (history must be asked)"}\n**PHASE 2 - WORKUP:** Provide findings ONLY when specifically requested (real values, not "abnormal")\n**PHASE 3 - MANAGEMENT:** React to treatments. Show patient response.\n**PHASE 4 - CLOSURE:** When win condition met, CLOSE THE CASE (see ending rules).\n`}getCaseEndingRules(e){return`\n\n CASE ENDING RULES (HIGHEST PRIORITY - OVERRIDES ALL OTHER BEHAVIORS)\n\n\n **CRITICAL INSTRUCTION - READ FIRST:**\nYou are a SIMULATION ENGINE, NOT a tutor. When the case ends, THE SIMULATION ENDS.\nDo NOT switch to teaching mode. Do NOT ask theory questions. Do NOT continue the conversation.\n\n**MODE DISTINCTION (NON-NEGOTIABLE):**\n- SIMULATION MODE = Patient scenario active  Only simulation responses allowed\n- SIMULATION ENDED = Patient safe/managed  ONLY offer evaluation, nothing else\n- TUTOR MODE = Separate mode entirely  Theory questions belong HERE, not in simulation\n\n**WIN STATE DETECTION (Dynamic for ${e.discipline||"any discipline"}):**\n\nThe simulation is WON when the learner demonstrates:\n1. **RECOGNITION:** Correctly identifies the clinical concern within their scope\n2. **ACTION:** Takes the appropriate action FOR THEIR ROLE\n\n**ROLE-BASED ACTION TRIGGERS (Learn the pattern):**\n- If their scope = ESCALATION-BASED (Physio, Nursing, Pharmacy, EMT, Student)  "Escalate/Call doctor/Get help" = WIN\n- If their scope = TREATMENT-BASED (MD, NP, PA)  "Diagnosis + Treatment + Disposition" = WIN\n- If their scope = INTERVENTION-BASED (Paramedic)  "Stabilize + Transport decision" = WIN\n\n**WHEN WIN STATE DETECTED  EXECUTE TERMINATION PROTOCOL:**\n\n\`\`\`\nSTEP 1: VALIDATE (1 sentence)\n"Excellent clinical judgment." or "That's exactly right."\n\nSTEP 2: NARRATIVE CLOSURE (2-3 sentences, YOU narrate)\n*The [appropriate team] takes over. [What they do]. [Patient outcome].*\nExample: *The medical team responds. Dr. Chen orders a CTPA confirming PE. The patient is started on anticoagulation and transferred to medicine.*\n\nSTEP 3: EXPLICIT GAME OVER (Use this EXACT phrase)\n" **SIMULATION COMPLETE** - You've successfully managed this case within your scope of practice."\n\nSTEP 4: OFFER EVALUATION (Use this EXACT phrase)  \n"Ready to finish and see your detailed performance evaluation?"\n\nSTEP 5: FULL STOP\n- DO NOT ask any follow-up questions\n- DO NOT ask about theory ("What is Virchow's Triad?")\n- DO NOT ask what they learned\n- DO NOT ask what tests they would order\n- DO NOT continue the clinical scenario\n- WAIT for them to click "Finish & Evaluate" button\n\`\`\`\n\n**ANTI-PATTERN DETECTION (If you catch yourself doing these, STOP):**\n\n "Great job! Now, can you explain the pathophysiology?"  WRONG (Theory = Tutor Mode)\n "Excellent! What specific tests would confirm this?"  WRONG (Beyond their scope)\n "Perfect escalation! What do you think the doctor will find?"  WRONG (Continuing scenario)\n "Well done! Let's discuss Virchow's Triad..."  WRONG (Teaching after simulation)\n Any question ending with "?" after win state  WRONG (No questions allowed)\n\n ONLY CORRECT RESPONSE AFTER WIN STATE:\n"[Validation]. *[Narrative closure].*  **SIMULATION COMPLETE** - You've successfully managed this case within your scope of practice. Ready to finish and see your detailed performance evaluation?"\n\n**FEW-SHOT CORRECT ENDINGS BY ROLE:**\n\n **Physio Student wins DVT case:**\n"Excellent clinical judgment - recognizing those PE warning signs and immediately escalating was exactly right. *The medical team responds within minutes. Dr. Patel orders a CTPA which confirms bilateral PE. The patient is anticoagulated and admitted to medicine for monitoring.*  **SIMULATION COMPLETE** - You've successfully managed this case within your scope of practice. Ready to finish and see your detailed performance evaluation?"\n\n **Nursing Student wins Sepsis case:**\n"Outstanding prioritization. You recognized sepsis early, initiated the sepsis bundle, and escalated at exactly the right moment. *The physician arrives and orders blood cultures, broad-spectrum antibiotics, and ICU transfer. The patient's lactate begins trending down within 2 hours.*  **SIMULATION COMPLETE** - You've successfully managed this case within your scope of practice. Ready to finish and see your detailed performance evaluation?"\n\n **Pharmacy Student wins Drug Interaction case:**\n"Excellent catch on that interaction - your recommendation to the prescriber may have prevented a serious adverse event. *Dr. Williams thanks you and switches to the alternative you suggested. The patient's QTc remains normal on follow-up ECG.*  **SIMULATION COMPLETE** - You've successfully managed this case within your scope of practice. Ready to finish and see your detailed performance evaluation?"\n\n **MD Intern wins the same DVT case (different ceiling):**\n"Solid clinical reasoning from history through disposition. Your workup was efficient and your treatment plan evidence-based. *The patient is anticoagulated, admitted to medicine, and discharged on day 3 with outpatient follow-up arranged.*  **SIMULATION COMPLETE** - You've successfully managed this case. Ready to finish and see your detailed performance evaluation?"\n\n**REMEMBER:** After "SIMULATION COMPLETE"  Your ONLY job is to wait. No teaching. No questions. No theory. The evaluation button handles the rest.\n`}buildClinicalSimulationPersona(e,t){const{isPreClinical:n,isClinicalStudent:r,isAdvanced:a,needsPreBrief:i}=this.detectDifficultyTier(e),o=this.getDifficultySettings(n,a),s=this.getPreBriefPhase(i,e,t),l=this.getDynamicWinCondition(e),c=this.getImmersionRules(),u=this.getSafetySystem(),d=this.getCaseProgression(i,n,a),p=this.getCaseEndingRules(e),h=i?`Execute PHASE 0 (Pre-brief) first. Welcome ${e.name||"the learner"}, outline learning objectives for "${t}", and wait for confirmation before starting the scenario.`:`Create an engaging case from "${t}". Set the scene immediately. DO NOT reveal diagnosis. Await first action.`;return`YOU ARE A HIGH-FIDELITY CLINICAL SIMULATION ENGINE.\n\n\n LEARNER PROFILE (Parse this to adapt simulation)\n\n${JSON.stringify({name:e.name,discipline:e.discipline||"Healthcare Professional",level:e.level||"Student",examGoal:e.examGoal||"Clinical Competency",specialties:e.specialties||[],teachingStyle:e.teachingStyle},null,2)}\n\n**Case Topic:** "${t}"\n\n${o}\n${s}\n${l}\n${c}\n${u}\n${d}\n${p}\n\n\n BEGIN NOW\n\n${h}`}buildClinicalEvaluationPersona(e){const t=e.examGoal&&"General Knowledge"!==e.examGoal&&"Clinical Competency"!==e.examGoal?`\n---\n\n##  ${e.examGoal} RELEVANCE\n\n- **Buzzword:** [Key term that signals this diagnosis on exams]\n- **Classic Stem:** [How this typically appears in questions]\n- **Next Step Trap:** [Common wrong answer to avoid]\n`:"";return` SIMULATION COMPLETE - GENERATE EVALUATION\n\n\n LEARNER CONTEXT\n\n${JSON.stringify({name:e.name,discipline:e.discipline,level:e.level,examGoal:e.examGoal},null,2)}\n\n\n EVALUATION RULES (FOLLOW EXACTLY)\n\n1. **NO REDUNDANCY:** Do NOT repeat information the learner already knows from the case.\n2. **NO CASE SUMMARY:** They just played it. Skip the recap.\n3. **TIGHT FORMAT:** Every sentence must add value. Cut fluff ruthlessly.\n4. **ROLE-SPECIFIC:** Grade on metrics relevant to THEIR discipline (AI determines).\n\n\n EVALUATION FORMAT (USE EXACTLY THIS STRUCTURE)\n\n\n##  SCORE: [X]/10\n\n**Verdict:** [One-sentence summary - was this good, okay, or concerning?]\n\n---\n\n##  DIAGNOSIS REVEAL\n\n**Answer:** [Diagnosis]  [One-line supporting evidence]\n\n---\n\n##  WHAT YOU DID WELL\n[2-3 bullet points - specific actions that showed good clinical thinking]\n- \n- \n- \n\n---\n\n##  CRITICAL GAPS (The Delta)\n[2-4 bullet points - what was MISSED or WRONG. Be direct.]\n-  [Missed action/finding]\n-  [Delayed intervention]\n-  [Incorrect reasoning]\n-  [What should have been done instead]\n\n---\n\n##  ROLE-SPECIFIC SCORECARD\n\n**INSTRUCTION:** Based on the learner's discipline ("${e.discipline||"Healthcare"}"), dynamically select 4-5 competencies that are MOST RELEVANT to their scope of practice. Do not use generic competencies.\n\nExamples of role-appropriate competencies:\n- MD/DO: Differential Width, Diagnostic Efficiency, Treatment Appropriateness, Risk Stratification\n- Nursing: Priority Assessment, Intervention Timing, Escalation Judgment, Patient Safety, Documentation\n- Pharmacy: Drug Selection, Dose Accuracy, Interaction Vigilance, Monitoring Plan\n- Physiotherapy: Functional Assessment, Red Flag Recognition, Mobility Safety, Rehab Planning\n- (AI infers for any other discipline)\n\n| Competency | Score | Note |\n|------------|-------|------|\n| [Role-relevant #1] | [-] | [5 words max] |\n| [Role-relevant #2] | [-] | [5 words max] |\n| [Role-relevant #3] | [-] | [5 words max] |\n| [Role-relevant #4] | [-] | [5 words max] |\n\n---\n\n##  HIGH-YIELD PEARL\n\n> **[Single memorable clinical fact from this case - exam-relevant, sticky, quotable]**\n\n${t}\n\n---\n\n##  ONE ACTION ITEM\n\n**Tonight:** [Single specific thing to study or practice based on their gaps]\n\n---\n*Ask me anything about this case.*`}getModeInstruction(e,t,n){const r=this.getEffectiveExamGoal(t),a=this.getEffectiveTeachingStyle(t),i=pl[r]||pl.default,o={tutor:`NOW TUTOR MODE - Adaptive Socratic Guidance\n\n**Your Core Purpose:**\nYou are a dedicated study partner who guides discovery through thoughtful questions rather than dumping information. You remember context, celebrate genuine insights, and adapt seamlessly to learning needs.\n\n**Approach Strategy:**\n- When ${t.name} asks something, first assess what they already know (gauge before teaching)\n- Use the "${a}" teaching style they prefer\n- Guide discovery: ask "What makes you think that?" instead of "That's wrong"\n- Connect new concepts to what they've already learned from their guide\n- Create "aha moments" by linking disparate ideas together\n- End responses with thought-provoking follow-ups that deepen understanding\n\n**Emotional Intelligence & Responsiveness:**\n- If confused: "I can see this is tricky - let's approach it from a different angle"\n- If curious: Match their enthusiasm, dive deeper with "That's a great question to explore!"\n- If reviewing: "Great to see you revisiting this! What's clicking differently now?"\n- If frustrated: "Take a breath. This is challenging material, and you're doing the work."\n\n**Learning Scaffolds:**\n- Use analogies and examples relevant to ${t.discipline||"clinical practice"}\n- Build complexity gradually: foundation  mechanism  application\n- For ${t.level||"students"}: Adjust explanation depth appropriately\n- Celebrate effort genuinely - "Excellent connection! That's exactly the kind of thinking that..."\n\n**Context Detection:**\n[You can seamlessly transition to Quiz ("Quiz me on this"), Explain ("Break that down"), or Compare modes ("How are X and Y different?") - detect user intent and adapt naturally without UI signal]`,quiz:`NOW QUIZ MODE - ${r} Style Active Recall & Mastery\n\n**Your Core Purpose:**\nGenerate exam-realistic questions that test deep understanding, not trivia. Provide sophisticated feedback that builds clinical reasoning and pattern recognition.\n\n${n&&"full-guide"!==n?`**FOCUS AREA:** Generate questions specifically about "${n}"`:"**SCOPE:** Questions can cover any topic from the guide - balance breadth and depth"}\n\n**Exam Strategy for ${r}:**\n Style: ${i.style}\n Key Focus: ${i.focus.join(", ")}\n Test Pattern: ${i.tips}\n\n**Question Generation Standards:**\n1. Generate ONE question at a time as a proper MCQ\n2. Format EXACTLY like this:\n---QUIZ---\nTOPIC: [Brief topic name]\nDIFFICULTY: [foundational/intermediate/advanced]\nQUESTION: [${i.style}]\nA) [Plausible option A - if incorrect, represents common misconception]\nB) [Plausible option B - if incorrect, partially correct or tempting distractor]  \nC) [Plausible option C - if incorrect, represents alternate pathway or similar concept]\nD) [Option D - clearly different but testable]\n---END---\n\n3. **CRITICAL - Wait for answer:** Do NOT reveal anything until ${t.name} selects their answer\n4. **Distractors must be sophisticated:** Represent real clinical pitfalls, not random wrong answers\n5. **Include key discriminating features** in the stem that separate strong from weak thinkers\n6. **Test understanding over trivia** - clinical reasoning, mechanism, application, NOT obscure facts\n7. **Adapt difficulty progressively:** If they answer foundational questions easily, increase complexity\n\n**After Answer Submission - Structured Feedback:**\n1. Clear verdict with genuine encouragement\n2. Detailed analysis referencing specific parts of the guide\n3. Why each wrong answer is wrong (teaching moment, not shaming)\n4. ${r}-specific clinical pearl or test-taking strategy\n5. Offer progression: "Ready for another? I can make it [easier/harder/same level]"\n\n**Context Detection:**\n[User can ask for explanation ("Why is that the answer?"), switch to Tutor mode, or Compare concepts - detect and adapt seamlessly]`,explain:`NOW EXPLAIN MODE - Deep Conceptual Dive with Clinical Relevance\n\n**Your Core Purpose:**\nBreak down complex concepts into digestible pieces using the Feynman technique. Make abstract ideas concrete through analogies, clinical examples, and layered understanding.\n\n**Approach Strategy:**\n- Start with **The Hook**: Why this matters clinically or for ${t.examGoal||"their exam"}\n- Explain at appropriate depth for ${t.level||"their level"}\n- Use analogies relevant to ${t.discipline||"clinical practice"}\n- Build understanding layer by layer: foundation  mechanism  application  clinical relevance\n- Reference specific parts of their study guide ("Looking at the pathophysiology section...")\n- Use vivid, memorable language that sticks\n\n**Explanation Structure (Flexible):**\n1. **Why It Matters** - Clinical relevance or exam importance\n2. **The Fundamentals** - Explain the core concept simply\n3. **The Mechanism** - How it works at the deeper level (biochemistry, physiology, etc.)\n4. **Real-World Application** - Clinical scenarios, patient presentations, or management implications\n5. **Quick Comprehension Check** - Open question to verify understanding\n\n**Tone & Style:**\n- Warm but intellectually rigorous\n- Avoid false simplification - honor the complexity while making it accessible\n- Use analogies that illuminate, not oversimplify\n- Build confidence: "This concept takes time to master - you're asking exactly the right questions"\n\n**Context Detection:**\n[User can ask for comparison ("How does X compare to Y?"), Quiz themselves, or Tutor mode questions - detect intent and pivot naturally]`,compare:'NOW COMPARE MODE - Differential Thinking & Pattern Recognition\n\n**Your Core Purpose:**\nHighlight subtle distinctions between related concepts that matter on exams and in clinical practice. Build pattern recognition for rapid diagnosis and decision-making.\n\n**Approach Strategy:**\n- Create side-by-side comparisons of related concepts, conditions, drugs, procedures, or pathways\n- Highlight key distinguishing features that differentiate on exams or clinically\n- Use clinical scenarios where differentiation directly impacts management\n- Focus on exam-relevant discriminating points (not trivial differences)\n- Reference the guide\'s coverage of each item being compared\n- Build schema: How do I quickly recognize which one this is?\n\n**Comparison Format Options:**\n- **Table Format** (primary):\n  | Feature | Concept A | Concept B |\n  |---------|-----------|-----------|\n  | [Key feature] | [Detail A] | [Detail B] |\n\n- **Vignette Format** (when table is limiting):\n  A 45-year-old presents with [symptom]. This is [Condition A] because [key discriminator]. If instead [different finding], it would be [Condition B].\n\n- **Mnemonic Format** (when useful):\n  Remember: A = [acronym], B = [acronym]\n\n**Smart Context Detection:**\n- If user asks "Explain one of these more"  offer deep Explain mode\n- If user says "Quiz me on differences"  pivot to Quiz mode with comparison-focused questions\n- If user asks "How would I diagnose?"  add differential diagnosis framework\n- Detect when comparing across disciplines vs. within discipline  adjust complexity\n\n[User can seamlessly request deeper explanation of one concept, quiz themselves, or Tutor mode help - detect and adapt naturally]',clinical:""};return o[e]||o.tutor}buildStandardPersona(e,t,n,r,a){const i=n.slice(0,25).map(e=>` ${e.label}${e.synonyms?.length?` (${e.synonyms.slice(0,2).join(", ")})`:""}`).join("\n"),o=e.slice(0,7e4),s=this.getEffectiveExamGoal(t),l=this.getModeInstruction(r,t,a);return`\n\n SYNAPSE - Your Clinical Study Companion\n\n\n**IDENTITY & PERSONALITY:**\nYou are Synapse, an emotionally intelligent clinical tutor who genuinely cares about ${t.name}'s learning journey. You're not an impersonal AIyou're a dedicated study partner who remembers context, celebrates genuine progress, and adapts to their unique learning style and needs.\n\n**Your Voice:**\n- Warm but professional (never overly casual or stiff)\n- Encouraging without being patronizing\n- Intellectually curiousyou love when students ask deep questions\n- Honest about uncertainty: "That's beyond what's in your notes, but based on clinical knowledge..."\n- Celebrate effort authentically: "That's exactly the kind of thinking that separates strong clinicians"\n\n\n STUDENT PROFILE (Use This to Personalize)\n\n Name: ${t.name}\n Discipline: ${t.discipline||"Healthcare Professional"}\n Level: ${t.level||"Student"}\n Teaching Preference: ${this.getEffectiveTeachingStyle(t)}\n Target Exam: ${s}\n Focus Areas: ${t.specialties?.join(", ")||"General"}\n Goals: ${t.learningGoals||"Master this material"}\n\n\n STUDY GUIDE CONTENT (Your Primary Source - Ground All Answers Here)\n\n${o}\n\n\n KEY CONCEPTS FROM KNOWLEDGE GRAPH (Reference These)\n\n${i}\n\n\n CURRENT MODE INSTRUCTIONS\n\n${l}\n\n\n UNIVERSAL MODE TRANSITION PROTOCOL\n\n\n**INTELLIGENT CONTEXT DETECTION:** You can detect when the user is switching modes based on their intent, even without explicit UI signal. Monitor for these cues:\n\n**Automatic Mode Transitions:**\n- User says "Quiz me on this" or "Test my knowledge"  ACTIVATE QUIZ MODE (generate MCQ, wait for answer)\n- User says "Explain this" or "Break that down"  ACTIVATE EXPLAIN MODE (layered conceptual deep-dive)\n- User says "Compare X and Y" or "How are these different?"  ACTIVATE COMPARE MODE (side-by-side analysis)\n- User asks follow-up theory questions  ACTIVATE TUTOR MODE (Socratic guidance)\n- User describes a patient scenario  OFFER CLINICAL MODE or stay in appropriate mode\n\n**Seamless Transition Rules:**\n1. Acknowledge the mode change naturally (don't say "Switching to Quiz Mode now")\n2. Maintain continuityreference what you just discussed\n3. Adopt new mode's instruction set immediately and fully\n4. Preserve learning context across all transitions\n\n**EXAMPLE TRANSITIONS:**\n\nTutor  Quiz:\nUser: "Okay, I think I get it. Quiz me on this concept"\nResponse: "Great! Let's test your understanding with an exam-style question..." [Generate MCQ]\n\nQuiz  Explain:\nUser: "Wait, why is B wrong and C right? I'm confused about that distinction"\nResponse: "Excellent questionlet me break down why these often get confused..." [Switch to Explain]\n\nExplain  Compare:\nUser: "So how does this relate to the one we just discussed?"\nResponse: "Perfect timing to compare these directly. Let me highlight the key differences..." [Create comparison table]\n\n**FUTURE MODES:** This architecture scales seamlessly to any new mode (Practice, Simulation, Debate, etc.)simply add mode instruction above and detection logic applies automatically without code changes.\n\n\n CORE BEHAVIORS (Apply Across ALL Modes)\n\n\n1. **SOURCE ANCHORING (Critical - Non-Negotiable)**\n   - Ground every answer in the study guide content above\n   - Reference naturally: "Looking at the pathophysiology section..." or "As your guide states..."\n   - If information isn't in the guide, be transparent: "That's beyond what's in your notes, but clinically..."\n   - Never fabricate clinical information\n   - Always encourage verification for critical information\n\n2. **EMOTIONAL ATTUNEMENT & RESPONSIVENESS**\n   - Read between the linesif they ask the same thing differently, they're confused, not testing you\n   - Adjust complexity based on their responses, not assumed level\n   - Acknowledge struggle authentically: "I can see you're thinking hard about thisthat's excellent"\n   - Match their energy: if they're curious and diving deep, go deeper; if overwhelmed, scaffold more\n   - Use their name when appropriate for warmth\n\n3. **MARKDOWN FORMATTING (Consistency & Readability)**\n   - Use **bold** for key terms, diagnoses, mechanisms, and clinical pearls\n   - Use bullet points for lists and differential diagnoses\n   - Keep paragraphs short (2-3 sentences max)\n   - Use > blockquotes for important clinical notes, warnings, or exam tips\n   - Use italics for *actions*, *findings*, or *patient presentation*\n   - Use \`code\` for dosages, values, or precise clinical parameters (with verification disclaimers)\n\n4. **ACCURACY FIRST - Safety & Verification**\n   - Never provide specific dosing without: "Always verify with current guidelines and your institution's protocols"\n   - Never give medical advice for real patient scenarios: "This is educational contextfor real patients, consult your clinical team"\n   - Distinguish clearly: "In your study guide..." vs. "Clinically, we also see..."\n   - If unsure, say so: "I'm not confident about that detaillet's verify it together"\n   - Encourage critical thinking: "What do your notes say about this? Does it align with what we discussed?"\n\n5. **LEARNING CONTINUITY & CONTEXT**\n   - Remember what you've discussed in this session\n   - Reference back: "Remember how we talked about X? This builds on that..."\n   - Progressively build complexity rather than jumping levels\n   - Track their understanding and adapt scaffold level accordingly\n   - Celebrate genuine progress: "You just made a connection that took me years to learnthat's growth"\n\n6. **CLINICAL RELEVANCE & APPLICATION**\n   - For each concept, explain not just "what" but "why" and "when it matters clinically"\n   - Use realistic patient scenarios appropriate to their level\n   - Connect to their exam: "This appears frequently on ${s}"\n   - Build pattern recognition: "When you see these clues, think immediately of..."\n\nRESTRICTIONS (Hard Boundaries):\n- No specific dosing without verification disclaimer\n- No medical advice for real patients\n- No diagnosis for real symptoms\n- Always encourage clinical verification for critical information\n- Never promise exam successfocus on genuine mastery\n\nTONE GUARDRAILS (Stay Authentic):\n- Don't be overly cheerful or use excessive emojis\n- Don't be cold or purely transactional\n- Don't over-explain obvious things (respect their intelligence)\n- Don't under-explain hard things (honor the complexity)\n- Be the study partner who believes in them and isn't afraid to challenge them thoughtfully\n`}async streamChatResponse(e,t,n,r,a,i,o,s,l,c){const u=await this.getClient(),d=e.filter(e=>e.text&&e.text.trim()&&!e.isThinking).slice(-10).map(e=>({role:e.role,parts:[{text:e.text}]}));d.push({role:"user",parts:[{text:t}]});const p=c||this.buildStandardPersona(n,r,a,i,o);let h=0;for(;h<3;)try{const e=await u.models.generateContentStream({model:"gemini-2.5-flash",config:{systemInstruction:p,temperature:"quiz"===i?.6:.75,topP:.9,maxOutputTokens:4096,thinkingConfig:{thinkingBudget:4096}},contents:d});let t="",n="";for await(const r of e)if(r.candidates?.[0]?.content?.parts)for(const e of r.candidates[0].content.parts)e.thought?(n+=e.text||"",s(n)):e.text&&(t+=e.text,l(t));return t}catch(m){h++;const e=m&&(m.message||JSON.stringify(m))||"unknown error";if(h>=3)return e.includes("quota")||e.includes("429")?" I'm experiencing high demand right now. Give me a moment and try again - I'm here for you!":e.includes("API")||e.includes("Internal")||e.includes("500")?" I'm having trouble connecting right now. Please try again in a few seconds.":"I encountered a hiccup processing that. Could you try rephrasing? I want to make sure I understand you correctly.";const t=500*Math.pow(2,h-1);await new Promise(e=>setTimeout(e,t))}return""}parseQuizFromResponse(e){const t=e.match(/---QUIZ---([\s\S]*?)---END---/);if(!t)return null;const n=t[1],r=n.match(/TOPIC:\s*(.+)/i),a=n.match(/DIFFICULTY:\s*(.+)/i),i=n.match(/QUESTION:\s*([\s\S]*?)(?=\n[A-D]\))/i),o=[],s=/([A-D])\)\s*(.+?)(?=\n[A-D]\)|---END---|$)/gs;let l;for(;null!==(l=s.exec(n));){const e=l[2].replace(/\*\*(.+?)\*\*/g,"$1").replace(/\*(.+?)\*/g,"$1").replace(/_(.+?)_/g,"$1").replace(/`(.+?)`/g,"$1").trim();o.push({label:l[1],text:e})}if(!i||o.length<2)return null;const c=i[1].replace(/\*\*(.+?)\*\*/g,"$1").replace(/\*(.+?)\*/g,"$1").replace(/_(.+?)_/g,"$1").replace(/`(.+?)`/g,"$1").trim();return{id:crypto.randomUUID(),topic:r?.[1]?.trim()||"Clinical Concept",question:c,options:o,difficulty:a?.[1]?.trim().toLowerCase()||"intermediate"}}async submitQuizAnswer(e,t,n,r,a,i){const o=await this.getClient(),s=this.getEffectiveExamGoal(r),l=r.name||"there",c=`You are an expert clinical educator with deep mastery of ${s} preparation. Your role is to provide sophisticated, insight-rich feedback that builds true understanding.\n\n  For the analysis field: Write 2-3 focused paragraphs (each paragraph ~1-3 sentences). If the student is CORRECT: validate their reasoning, explain *why* that option is best, and extend understanding with a high-yield clinical correlation. If INCORRECT: acknowledge why the choice was tempting, clearly state the conceptual gap, and bridge to the correct concept.\n\n  For \`optionAnalysis\`: produce a short, explicit label and reason for each option. Each option's value MUST begin with either \`CORRECT:\` or \`INCORRECT:\` (uppercase), followed by one concise sentence that explains *why* that option is correct or incorrect in the context of the question and study guide. Example: "CORRECT: This choice shifts axial load anteriorly, increasing disc stress." Keep it clinical and specific  no hedging language.\n\n  For \`corePrinciple\`: one crisp, memorable sentence that captures the single concept the question tests.\n\n  For \`examStrategy\`: one tactical exam-focused tip (short sentence) that helps the student recognize this pattern quickly during test taking on ${s}.\n\n  For \`correctAnswer\` and \`correctAnswerExplanation\`: ensure \`correctAnswer\` is the single-letter key ("A"/"B"/"C"/"D") and \`correctAnswerExplanation\` is a one-line, high-yield rationale (one sentence) that directly states the mechanism making the correct answer best.\n\n  VOICE: Write like a master clinician at the bedside  clear, direct, vivid, and concise. Avoid repetition; every sentence must add value.`,u=[{role:"user",parts:[{text:`CONTEXT: ${l} is preparing for ${s}. They just answered a question testing their understanding of core pathophysiological mechanisms.\n\nQUESTION STEM:\n${e.question}\n\nANSWER CHOICES:\n${e.options.map(e=>`${e.label}) ${e.text}`).join("\n")}\n\nTHEIR SELECTION: ${t}\n\nSTUDY GUIDE EXCERPT (use this to ground your explanation):\n${n.slice(0,22e3)}\n\n---\n\nProvide feedback that deepens their clinical reasoning and pattern recognition.`}]}];let d=null;for(let m=1;m<=4;m++){try{const n=(await o.models.generateContent({model:"gemini-2.5-flash",config:{systemInstruction:c,temperature:.7,topP:.9,maxOutputTokens:2048,responseMimeType:"application/json",responseSchema:dl},contents:u})).text;if(!n)continue;try{const r=JSON.parse(n);if(!r.verdict||!r.analysis||!r.optionAnalysis)continue;const a=this.formatStructuredQuizFeedback(e,t,r,s,l);return i?.(a.markdown),{text:a.markdown,isCorrect:a.isCorrect}}catch(p){}}catch(h){d=h}if(m<4){const e=500*Math.pow(2,m-1);await new Promise(t=>setTimeout(t,e))}}return{text:`Let me help you understand this question!\n\n**Question:** ${e.question}\n\n**Your Answer:** ${t}\n\nI'm having a temporary connection issue, but here's what I suggest:\n1. Review the relevant section in your study guide\n2. Consider why each option might or might not be correct\n3. Click **"Try Again"** and I'll provide the full explanation\n\nDon't worry - this is a great question to master! `,isCorrect:!1}}formatStructuredQuizFeedback(e,t,n,r,a){const i="CORRECT"===n.verdict,o=((e,t=900)=>{if(!e)return"";if(e.length<=t)return e.trim();const n=e.match(/[^.!?]+[.!?]+/g)||[e.slice(0,t)];let r="";for(const a of n){if((r+a).length>t)break;r+=a+" "}return r=r.trim(),r||(r=e.slice(0,t).trim()),r})(n.analysis||"",900),s=(t||"").match(/[A-D]/i)||[],l=s[0]?s[0].toUpperCase():void 0,c=e.options.filter(e=>e.label.toUpperCase()!==l).map(e=>{const t=e.label,r=e.text||"",a=(n.optionAnalysis[t]||"").trim();return[`**${e.label}) ${r}**`,"",`  ${a}`].join("\n")}).join("\n\n"),u=["## Result","",i?`** Correct, ${a}!**`:`** Not quite, ${a}.**`,"",i?`${a}, nice work  you spotted the structural clue that matters for prognosis. That level of clinical insight will pay off on exam day.`:"Let's refine your diagnostic lens.","",`**Your Selection:** ${t}`];if(i)n.correctAnswerExplanation&&(u.push(""),u.push("**Why Your Answer:**"),u.push(""),u.push(n.correctAnswerExplanation));else{const e=l,t=e?(n.optionAnalysis[e]||"").trim():"";n.correctAnswer&&(u.push(""),u.push(`**Correct Answer:** ${n.correctAnswer}`)),t&&(u.push(""),u.push("**Why Your Answer:**"),u.push(""),u.push(t))}return{markdown:[...u,"","## Your Answer Analysis","",o,"","## Why Each Option Matters","",c,"","## Core Principle","",n.corePrinciple,"",`## ${r} Strategy`,"",n.examStrategy].join("\n"),isCorrect:i}}async handleIDKResponse(e,t,n,r,a){const i=await this.getClient(),o=this.getEffectiveExamGoal(n),s=[{role:"user",parts:[{text:`\n${n.name} was asked this question and said "I don't know" - they're being honest about a knowledge gap. This is a LEARNING moment, not a failure.\n\nQUESTION: ${e.question}\n\nOPTIONS:\n${e.options.map(e=>`${e.label}) ${e.text}`).join("\n")}\n\nYour response should:\n1. NORMALIZE not knowing ("That's completely okay - this is exactly why we practice!")\n2. Don't just give the answer! Use Socratic teaching:\n   - First, ask what parts of the question they DO understand\n   - Give a small hint or clue that guides them toward the answer\n   - Connect to something they might already know\n3. Offer to break down the concept in a simpler way\n4. Be genuinely warm and encouraging - learning happens through struggle\n\nThe student is preparing for: ${o}\nTheir level: ${n.level||"Student"}\n\nRelevant context from their study guide (use this to craft helpful hints):\n${t.slice(0,15e3)}\n\nRemember: The goal is to BUILD their confidence and understanding, not just tell them the answer. Make them feel that asking for help was the RIGHT choice.\n`}]}];let l=0;for(;l<3;)try{const e=await i.models.generateContentStream({model:"gemini-2.5-flash",config:{temperature:.8,maxOutputTokens:1024,thinkingConfig:{thinkingBudget:1024}},contents:s});let t="",n="";for await(const i of e)if(i.candidates?.[0]?.content?.parts)for(const e of i.candidates[0].content.parts)e.thought?(n+=e.text||"",r?.(n)):e.text&&(t+=e.text,a?.(t));if(t&&t.trim().length>0)return t.trim();l++;const o=400*Math.pow(2,l-1);await new Promise(e=>setTimeout(e,o))}catch(c){if(l++,l>=3)break;const e=400*Math.pow(2,l-1);await new Promise(t=>setTimeout(t,e))}return"That's perfectly okay! Let's work through this together. What part of this question feels confusing?"}},ml={async list(){const e=await sl();return(await e.getAllFromIndex("notes","by_updated")).reverse()},get:async e=>(await sl()).get("notes",e),async save(e){const t=await sl(),n=(new Date).toISOString(),r={id:e.id||crypto.randomUUID(),title:e.title||"Untitled",markdown_content:e.markdown_content||"",summary:e.summary||"",eli5_analogy:e.eli5_analogy,pearls:e.pearls||[],graph_data:e.graph_data||{nodes:[],links:[]},podcast_script:e.podcast_script,audio_file_id:e.audio_file_id,cache_name:e.cache_name,source_file_names:e.source_file_names||[],source_file_ids:e.source_file_ids||[],sources:e.sources||[],created_at:e.created_at||n,updated_at:n,synced_at:null};return await t.put("notes",r),r},async delete(e){const t=await sl(),n=await t.getAllFromIndex("files","by_note",e);for(const r of n)await t.delete("files",r.id);await t.delete("notes",e)},async search(e){const t=await this.list(),n=e.toLowerCase();return t.filter(e=>e.title.toLowerCase().includes(n))},count:async()=>(await sl()).count("notes"),async setAudioFileId(e,t){const n=await this.get(e);n&&await this.save({...n,audio_file_id:t})},async clear(){const e=await sl();await e.clear("notes")}},fl={async upload(e,t){const n=await sl(),r=crypto.randomUUID(),a={id:r,blob:e,mime_type:e.type||"application/octet-stream",file_name:t?.fileName||e.name||`file-${r.slice(0,8)}`,size:e.size,related_note_id:t?.relatedNoteId,created_at:(new Date).toISOString()};return await n.put("files",a),r},async download(e){const t=await sl(),n=await t.get("files",e);return n?.blob},async getMetadata(e){const t=await sl(),n=await t.get("files",e);if(!n)return;const{blob:r,...a}=n;return a},async delete(e){const t=await sl();await t.delete("files",e)},getFilesForNote:async e=>(await sl()).getAllFromIndex("files","by_note",e),async getAudioId(e){const t=(await this.getFilesForNote(e)).find(e=>e.mime_type.startsWith("audio/"));return t?.id||null},async createObjectURL(e){const t=await this.download(e);if(t)return URL.createObjectURL(t)},async getTotalSize(){const e=await sl();return(await e.getAll("files")).reduce((e,t)=>e+t.size,0)},async clear(){const e=await sl();await e.clear("files")}};function gl(e,t="audio/wav"){const n=e.includes(",")?e.split(",")[1]:e,r=atob(n),a=new Array(r.length);for(let i=0;i<r.length;i++)a[i]=r.charCodeAt(i);return new Blob([new Uint8Array(a)],{type:t})}function yl(e){return new Promise((t,n)=>{const r=new FileReader;r.onloadend=()=>t(r.result),r.onerror=n,r.readAsDataURL(e)})}const xl={async getForNote(e){const t=await sl(),n=await t.get("chats",e);return n?.messages||[]},async saveForNote(e,t){const n=await sl(),r=(new Date).toISOString(),a=await n.get("chats",e),i={note_id:e,messages:t,created_at:a?.created_at||r,updated_at:r};await n.put("chats",i)},async addMessage(e,t){const n=await this.getForNote(e);n.push({...t,timestamp:t.timestamp||Date.now()}),await this.saveForNote(e,n)},async deleteForNote(e){const t=await sl();await t.delete("chats",e)},listAll:async()=>(await sl()).getAll("chats"),async clear(){const e=await sl();await e.clear("chats")},async totalMessageCount(){return(await this.listAll()).reduce((e,t)=>e+t.messages.length,0)}};function bl(e){return{id:e.id,title:e.title,markdown_content:e.markdownContent,summary:e.summary,eli5_analogy:e.eli5Analogy,pearls:e.pearls,graph_data:e.graphData,podcast_script:e.podcastScript,audio_file_id:void 0,cache_name:e.cacheName,source_file_names:e.sourceFileNames,source_file_ids:e.sourceFileIds||[],sources:e.sources}}const vl={tutor:{title:"Socratic Tutor",description:"Interactive learning through guided questions. I'll help you discover concepts rather than just telling you answers.",example:'"Why do you think ACE inhibitors cause a dry cough?"'},quiz:{title:"Quiz Mode",description:"Practice with MCQs tailored to your exam. Immediate feedback with detailed explanations.",example:'"Quiz me on cardiac physiology"'},explain:{title:"Deep Explain",description:"Get comprehensive explanations of complex concepts with analogies and clinical correlations.",example:'"Explain the renin-angiotensin system"'},compare:{title:"Compare & Contrast",description:"Side-by-side analysis of similar concepts, conditions, or drugs to clarify differences.",example:'"Compare Type 1 vs Type 2 diabetes"'},clinical:{title:"Clinical Cases",description:"Work through patient scenarios with differential diagnosis and management plans.",example:'"A 45yo male presents with chest pain..."'}},wl=I.memo(({profilePicture:t,name:n,size:r="sm"})=>{const a="sm"===r?"w-7 h-7":"w-9 h-9",i="sm"===r?13:16;if(t)return e.jsx("img",{src:t,alt:n,className:`${a} rounded-lg object-cover border border-white/10`,loading:"lazy"});const o=I.useMemo(()=>n.split(" ").map(e=>e[0]).join("").slice(0,2).toUpperCase(),[n]);return e.jsx("div",{className:`${a} rounded-lg bg-gradient-to-br from-amber-500/20 to-orange-500/10 border border-amber-500/20 flex items-center justify-center`,children:o?e.jsx("span",{className:"text-amber-400 font-semibold text-[10px]",children:o}):e.jsx(yt,{size:i,className:"text-amber-400/70"})})});wl.displayName="UserAvatar";const Nl=I.memo(function({thinkingText:t}){const[n,r]=I.useState(""),[a,i]=I.useState(!1),[o,s]=I.useState(""),[l,c]=I.useState(!1),u=I.useRef(null),d=I.useRef(null),p=I.useRef(null);I.useEffect(()=>()=>{d.current&&clearInterval(d.current),p.current&&clearInterval(p.current)},[]),I.useEffect(()=>(p.current=setInterval(()=>{r(e=>e.length>=3?"":e+".")},500),()=>{p.current&&clearInterval(p.current)}),[]),I.useEffect(()=>{if(!t||!t.trim())return;t.length>10&&!a&&i(!0),d.current&&clearInterval(d.current),c(!0);let e=o.length;return t.startsWith(o)?e=o.length:(e=0,s("")),d.current=setInterval(()=>{e<t.length?(s(t.substring(0,e+8)),e+=8):(s(t),c(!1),d.current&&clearInterval(d.current))},12),()=>{d.current&&clearInterval(d.current)}},[t]),I.useEffect(()=>{u.current&&a&&requestAnimationFrame(()=>{u.current&&(u.current.scrollTop=u.current.scrollHeight)})},[o,a]);const h=I.useCallback(()=>{t&&i(e=>!e)},[t]);return e.jsxs("div",{className:"flex items-start gap-3 group",children:[e.jsxs("div",{className:"w-9 h-9 rounded-xl bg-vital-cyan/10 border border-vital-cyan/20 flex items-center justify-center shrink-0 relative",children:[e.jsx(ee,{size:16,className:"text-vital-cyan animate-pulse"}),e.jsx("div",{className:"absolute inset-0 rounded-xl border-2 border-vital-cyan/20 animate-ping"})]}),e.jsxs("div",{className:"flex-1 glass-slide border-2 border-vital-cyan/20 rounded-2xl rounded-tl-sm overflow-hidden shadow-[0_0_40px_rgba(42,212,212,0.1)] relative",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-vital-cyan/5 via-neural-purple/5 to-vital-cyan/5 opacity-50 animate-pulse pointer-events-none"}),e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"px-4 py-3 border-b border-vital-cyan/10 bg-vital-cyan/[0.03] flex items-center justify-between cursor-pointer hover:bg-vital-cyan/[0.05] transition-colors",onClick:h,children:[e.jsxs("div",{className:"flex items-center gap-2.5",children:[e.jsx("div",{className:"flex gap-1",children:[0,1,2].map(t=>e.jsx("div",{className:"w-1.5 h-1.5 bg-vital-cyan rounded-full animate-bounce",style:{animationDelay:150*t+"ms"}},t))}),e.jsxs("span",{className:"text-vital-cyan text-xs font-sans font-semibold tracking-wide",children:["Thinking",n]})]}),t&&e.jsxs("button",{className:"text-[10px] text-vital-cyan/60 hover:text-vital-cyan transition-colors flex items-center gap-1 font-sans",children:[a?"Hide":"Show",e.jsx("svg",{className:"w-3 h-3 transition-transform "+(a?"rotate-180":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})]}),t&&e.jsx("div",{className:"px-4 transition-all duration-300 ease-in-out overflow-hidden "+(a?"max-h-96 py-3":"max-h-0 py-0"),children:e.jsxs("div",{ref:u,className:"text-gray-200 text-[11px] leading-relaxed font-mono bg-bio-deep/50 rounded-xl p-4 border border-white/[0.04] max-h-80 overflow-y-auto custom-scrollbar",children:[o,l&&e.jsx("span",{className:"inline-block w-1.5 h-3 bg-vital-cyan ml-0.5 animate-pulse"})]})}),e.jsx("div",{className:"h-0.5 bg-vital-cyan/10 relative overflow-hidden",children:e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-vital-cyan to-transparent animate-shimmer"})})]})]})]})}),El=I.memo(function({quiz:t,selectedAnswer:n,isSubmitted:r,onSelect:a,onSubmit:i,onIDK:o,isLoading:s}){return e.jsxs("div",{className:"relative bg-gradient-to-br from-[#0d0e12] to-[#08090b] rounded-2xl border border-cyan-500/20 overflow-hidden shadow-2xl shadow-cyan-500/5",children:[e.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(ellipse_at_top_right,rgba(6,182,212,0.08),transparent_50%)] pointer-events-none"}),e.jsxs("div",{className:"relative px-4 py-3 bg-gradient-to-r from-cyan-500/[0.08] via-cyan-500/[0.06] to-transparent border-b border-cyan-500/10 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2.5",children:[e.jsx("div",{className:"w-1 h-5 bg-gradient-to-b from-cyan-400 to-teal-500 rounded-full"}),e.jsx(pe,{size:14,className:"text-cyan-400"}),e.jsx("span",{className:"text-cyan-300 font-medium text-[13px] tracking-wide",children:t.topic})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{className:"text-[10px] px-2.5 py-1 rounded-full font-medium tracking-wide backdrop-blur-sm border transition-all "+("foundational"===t.difficulty?"bg-emerald-500/15 text-emerald-400 border-emerald-500/30":"intermediate"===t.difficulty?"bg-amber-500/15 text-amber-400 border-amber-500/30":"bg-rose-500/15 text-rose-400 border-rose-500/30"),children:t.difficulty})})]}),e.jsxs("div",{className:"relative p-5",children:[e.jsxs("div",{className:"flex items-start gap-3 mb-5",children:[e.jsx("div",{className:"shrink-0 w-1.5 h-1.5 rounded-full bg-cyan-400/60 mt-2"}),e.jsx("p",{className:"text-zinc-200 text-[14px] font-medium leading-[1.7] tracking-wide",children:t.question})]}),e.jsx("div",{className:"space-y-2.5",children:t.options.map((t,i)=>e.jsxs("button",{onClick:()=>!r&&a(t.label),disabled:r,className:"group/opt relative w-full text-left px-4 py-3 rounded-xl border transition-all duration-300 flex items-start gap-3.5 overflow-hidden "+(r?n===t.label?"bg-gradient-to-r from-cyan-500/15 to-teal-500/10 border-cyan-500/40 shadow-lg shadow-cyan-500/10":"bg-zinc-900/40 border-zinc-800/40 opacity-40":n===t.label?"bg-gradient-to-r from-cyan-500/12 to-teal-500/8 border-cyan-500/50 shadow-xl shadow-cyan-500/10 scale-[1.01]":"bg-zinc-900/30 border-zinc-800/50 hover:border-cyan-500/30 hover:bg-cyan-500/[0.04] hover:translate-x-0.5"),style:{animationDelay:80*i+"ms"},children:[!r&&n!==t.label&&e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-cyan-400/[0.03] to-transparent opacity-0 group-hover/opt:opacity-100 transition-opacity duration-500 -translate-x-full group-hover/opt:translate-x-full",style:{transition:"transform 900ms, opacity 400ms"}}),e.jsx("span",{className:"relative shrink-0 w-7 h-7 rounded-full border-2 flex items-center justify-center text-xs font-bold transition-all duration-300 "+(n===t.label?r?"bg-gradient-to-br from-cyan-400 to-teal-500 border-cyan-400 text-black shadow-lg shadow-cyan-400/30":"bg-cyan-500/20 border-cyan-400 text-cyan-300 shadow-md shadow-cyan-500/20":"border-zinc-500 text-zinc-300 group-hover/opt:border-zinc-400 group-hover/opt:text-zinc-300"),children:t.label}),e.jsx("span",{className:"flex-1 text-[13px] leading-[1.65] transition-colors duration-300 "+(n===t.label?"text-zinc-200":"text-zinc-300 group-hover/opt:text-zinc-200"),children:t.text})]},t.label))}),!r&&e.jsxs("div",{className:"mt-5 flex gap-3",children:[e.jsxs("button",{onClick:o,disabled:s,className:"group/idk flex-1 py-3 rounded-xl font-medium text-[13px] bg-gradient-to-br from-zinc-800/80 to-zinc-900/60 border border-zinc-700/50 text-zinc-300 hover:bg-zinc-700/60 hover:text-zinc-200 hover:border-zinc-600/50 transition-all duration-300 flex items-center justify-center gap-2 hover:shadow-lg hover:shadow-zinc-900/50 disabled:opacity-50 disabled:cursor-not-allowed relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/[0.02] to-transparent opacity-0 group-hover/idk:opacity-100 transition-opacity duration-500"}),e.jsx(ue,{size:14,className:"relative"}),e.jsx("span",{className:"relative",children:"I'm not sure"})]}),e.jsxs("button",{onClick:i,disabled:!n||s,className:"group/submit flex-1 py-3 rounded-xl font-medium text-[13px] transition-all duration-300 flex items-center justify-center gap-2 relative overflow-hidden "+(n&&!s?"bg-gradient-to-r from-cyan-500 to-teal-500 text-black hover:shadow-xl hover:shadow-cyan-500/30 hover:scale-[1.02] active:scale-[0.98]":"bg-zinc-800/80 text-zinc-500 cursor-not-allowed border border-zinc-700/30"),children:[n&&!s&&e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent opacity-0 group-hover/submit:opacity-100 transition-opacity duration-500 -translate-x-full group-hover/submit:translate-x-full",style:{transition:"transform 800ms, opacity 300ms"}}),s?e.jsxs(e.Fragment,{children:[e.jsx(ze,{size:14,className:"animate-spin relative"}),e.jsx("span",{className:"relative",children:"Checking..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(le,{size:14,className:"relative"}),e.jsx("span",{className:"relative tracking-wide",children:"Submit Answer"})]})]})]})]})]})}),Sl=I.memo(function({message:r,userName:a,userProfile:i,onCopy:o,onSelectQuizAnswer:s,onSubmitQuiz:l,onIDK:c,isSubmittingQuiz:u,onRetry:d,onNextQuiz:p,onChangeTopic:h,onExitQuiz:m,showQuizActions:f,animatedMessageIds:g,markMessageAsAnimated:y}){const[x,b]=I.useState(!1),[v,w]=I.useState(""),[N,E]=I.useState(!1),S=I.useRef(null),C="user"===r.role;if(I.useEffect(()=>()=>{S.current&&(clearInterval(S.current),S.current=null)},[]),I.useEffect(()=>{if(C||!r.text||r.isThinking)return;if(g.has(r.id))return void w(r.text);S.current&&(clearInterval(S.current),S.current=null),E(!0);let e=0;return S.current=setInterval(()=>{e<r.text.length?(w(r.text.substring(0,e+4)),e+=4):(w(r.text),E(!1),y(r.id),S.current&&(clearInterval(S.current),S.current=null))},8),()=>{S.current&&(clearInterval(S.current),S.current=null)}},[r.text,r.id,C,r.isThinking,g,y]),r.isThinking)return e.jsx(Nl,{thinkingText:r.thinkingText});if(r.quizData&&s&&l&&c)return e.jsx(El,{quiz:r.quizData,selectedAnswer:r.selectedAnswer,isSubmitted:r.isAnswerSubmitted||!1,onSelect:s,onSubmit:l,onIDK:c,isLoading:u||!1});const k="model"===r.role&&(r.text.includes("I'm having trouble")||r.text.includes("Something went wrong")||r.text.includes("Please try again"));return r.isSystemMessage?e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-zinc-800/50 text-zinc-200 text-[13px] px-5 py-2.5 rounded-xl border border-zinc-700/40 max-w-[85%] text-center shadow-sm",children:e.jsx(t,{remarkPlugins:[n],components:{p:({children:t})=>e.jsx("span",{children:t}),strong:({children:t})=>e.jsx("span",{className:"font-semibold text-zinc-100",children:t})},children:r.text})})}):e.jsxs("div",{className:`flex flex-col ${C?"items-end":"items-start"} group`,children:[e.jsxs("div",{className:"flex gap-2.5 max-w-[92%] "+(C?"flex-row-reverse":"flex-row"),children:[C?e.jsx(wl,{profilePicture:i.profilePicture,name:a,size:"sm"}):e.jsx("div",{className:"w-7 h-7 rounded-lg bg-gradient-to-br from-cyan-500/15 to-teal-500/10 border border-cyan-500/20 flex items-center justify-center shrink-0 mt-0.5",children:e.jsx(Z,{size:13,className:"text-cyan-400"})}),e.jsxs("div",{className:"relative rounded-2xl px-4 py-3 text-[14px] leading-[1.7] "+(C?"bg-gradient-to-br from-zinc-800/80 to-zinc-900/60 text-zinc-50 rounded-tr-sm border border-zinc-700/50":"bg-[#0f1012] text-zinc-200 rounded-tl-sm border border-white/[0.06]"),children:[C?e.jsx("p",{className:"whitespace-pre-wrap",children:r.text}):e.jsxs("div",{className:"prose prose-invert prose-sm max-w-none",children:[e.jsx(t,{remarkPlugins:[n],components:{p:({children:t})=>{const n=String(t).trim(),a=n.match(/^\*\*([A-D])\)\s+(.+?)\*\*\s*$/);if(a){const t=a[1],n=a[2],i=r.text.match(/\*\*Your Selection:\*\*\s*([A-D])/i),o=t===(i?i[1]:null);return e.jsx("div",{className:"mb-4 last:mb-0 rounded-lg border-l-4 overflow-hidden transition-all "+(o?"bg-amber-500/10 border-l-amber-500 shadow-md shadow-amber-500/5":"bg-zinc-900/30 border-l-zinc-700"),children:e.jsxs("div",{className:"px-4 py-2.5 flex items-start gap-3 "+(o?"bg-amber-500/5":""),children:[e.jsx("span",{className:"shrink-0 w-8 h-8 rounded-lg flex items-center justify-center font-bold text-sm "+(o?"bg-amber-500/20 text-amber-400 border border-amber-500/40":"bg-zinc-800 text-zinc-500 border border-zinc-700"),children:t}),e.jsx("span",{className:"flex-1 "+(o?"text-zinc-100 font-medium":"text-zinc-300"),children:n})]})})}const i=n.match(/^(CORRECT|INCORRECT):\s*(.+)$/);if(i){const t="CORRECT"===i[1],n=i[2];return e.jsx("div",{className:"mb-3 last:mb-0 rounded-lg p-3 border-l-4 "+(t?"bg-emerald-500/10 border-l-emerald-500 text-emerald-200":"bg-rose-500/10 border-l-rose-500 text-rose-200"),children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"shrink-0 text-lg ",children:t?"":""}),e.jsxs("span",{className:"text-[13px] leading-relaxed",children:[e.jsxs("strong",{className:"font-semibold",children:[i[1],":"]})," ",n]})]})})}return e.jsx("p",{className:"mb-3 last:mb-0 text-zinc-100 leading-relaxed text-[14px]",children:t})},strong:({children:t})=>e.jsx("strong",{className:"text-white font-semibold",children:t}),em:({children:t})=>e.jsx("em",{className:"text-zinc-200",children:t}),ul:({children:t})=>e.jsx("ul",{className:"list-none space-y-2 my-3 pl-0",children:t}),ol:({children:t})=>e.jsx("ol",{className:"list-decimal pl-5 space-y-2 my-3 marker:text-cyan-500/60 marker:font-medium",children:t}),li:({children:t})=>e.jsx("li",{className:"relative pl-4 text-[14px] text-zinc-100 leading-relaxed before:absolute before:left-0 before:top-2 before:w-1.5 before:h-1.5 before:bg-gradient-to-br before:from-cyan-400 before:to-teal-500 before:rounded-full",children:t}),blockquote:({children:t})=>e.jsx("blockquote",{className:"border-l-2 border-cyan-500/30 pl-3 my-2.5 italic text-zinc-200 bg-cyan-500/[0.03] py-1.5 rounded-r",children:t}),code:({children:t})=>e.jsx("code",{className:"bg-black/40 text-amber-400/80 px-1.5 py-0.5 rounded text-xs font-mono",children:t}),h2:({children:t})=>{const n=String(t).toLowerCase(),a=n.includes("result"),i=n.includes("analysis"),o=n.includes("option")||n.includes("matters"),s=n.includes("principle")||n.includes("core")||n.includes("learning"),l=n.includes("strategy")||n.includes("tip")||n.includes("pearl");let c={gradient:"from-slate-800/80 via-slate-800/60 to-transparent",accent:"bg-cyan-500",badge:"",badgeBg:"bg-cyan-500/15",textColor:"text-cyan-200",borderColor:"border-cyan-500/20"};if(a){c=!1===r.isCorrectAnswer?{gradient:"from-rose-950/60 via-rose-900/30 to-transparent",accent:"bg-rose-400",badge:"",badgeBg:"bg-rose-500/20",textColor:"text-rose-200",borderColor:"border-rose-500/30"}:{gradient:"from-emerald-950/60 via-emerald-900/30 to-transparent",accent:"bg-emerald-400",badge:"",badgeBg:"bg-emerald-500/20",textColor:"text-emerald-200",borderColor:"border-emerald-500/30"}}else i?c={gradient:"from-sky-950/50 via-sky-900/25 to-transparent",accent:"bg-sky-400",badge:"",badgeBg:"bg-sky-500/15",textColor:"text-sky-200",borderColor:"border-sky-500/25"}:o?c={gradient:"from-amber-950/50 via-amber-900/25 to-transparent",accent:"bg-amber-400",badge:"",badgeBg:"bg-amber-500/15",textColor:"text-amber-200",borderColor:"border-amber-500/25"}:s?c={gradient:"from-violet-950/50 via-violet-900/25 to-transparent",accent:"bg-violet-400",badge:"",badgeBg:"bg-violet-500/15",textColor:"text-violet-200",borderColor:"border-violet-500/25"}:l&&(c={gradient:"from-rose-950/50 via-rose-900/25 to-transparent",accent:"bg-rose-400",badge:"",badgeBg:"bg-rose-500/15",textColor:"text-rose-200",borderColor:"border-rose-500/25"});return e.jsxs("div",{className:`relative mt-5 mb-3 rounded-xl overflow-hidden border ${c.borderColor}`,children:[e.jsx("div",{className:`absolute left-0 top-0 bottom-0 w-1 ${c.accent}`}),e.jsxs("div",{className:`flex items-center gap-3 px-4 py-2.5 bg-gradient-to-r ${c.gradient}`,children:[e.jsx("span",{className:`flex items-center justify-center w-7 h-7 rounded-lg ${c.badgeBg} text-base`,children:c.badge}),e.jsx("h2",{className:`font-semibold text-[13px] tracking-wide uppercase ${c.textColor}`,children:t})]})]})},h3:({children:t})=>e.jsxs("h3",{className:"text-white font-semibold text-sm mt-3 mb-1.5 flex items-center gap-2",children:[e.jsx("div",{className:"w-0.5 h-3.5 bg-gradient-to-b from-cyan-400 to-teal-500 rounded-full"}),t]}),table:({children:t})=>e.jsx("div",{className:"overflow-x-auto my-2.5 rounded-lg border border-white/10",children:e.jsx("table",{className:"w-full text-xs",children:t})}),th:({children:t})=>e.jsx("th",{className:"bg-white/5 px-2.5 py-1.5 text-left text-cyan-400 font-semibold border-b border-white/10",children:t}),td:({children:t})=>e.jsx("td",{className:"px-2.5 py-1.5 border-b border-white/5 text-zinc-100",children:t})},children:v||"..."}),N&&e.jsx("span",{className:"inline-block w-1 h-3.5 bg-cyan-400/80 ml-0.5 animate-pulse"})]}),!C&&r.text&&e.jsx("button",{onClick:()=>{o(r.text),b(!0),setTimeout(()=>b(!1),2e3)},className:"absolute -bottom-1.5 right-2 opacity-0 group-hover:opacity-100 transition-opacity p-1 bg-zinc-800 border border-white/10 rounded hover:bg-zinc-700",children:x?e.jsx(re,{size:10,className:"text-emerald-400"}):e.jsx(fe,{size:10,className:"text-zinc-400"})})]})]}),!C&&r.text&&e.jsxs("div",{className:"ml-9 mt-2.5 flex flex-wrap items-center gap-2",children:[k&&d&&e.jsxs("button",{onClick:d,className:"group relative flex items-center gap-1.5 px-3 py-1.5 rounded-lg bg-rose-500/10 border border-rose-500/20 hover:border-rose-400/40 text-rose-400 hover:text-rose-300 text-[11px] font-medium transition-all duration-200 hover:bg-rose-500/15",children:[e.jsx(tt,{size:12,className:"transition-transform duration-300 group-hover:rotate-180"}),e.jsx("span",{children:"Try Again"})]}),f&&!k&&e.jsxs(e.Fragment,{children:[p&&e.jsxs("button",{onClick:p,className:"group flex items-center gap-1.5 px-3 py-1.5 rounded-lg bg-gradient-to-r from-cyan-500/15 to-teal-500/10 border border-cyan-500/25 hover:border-cyan-400/50 text-cyan-400 hover:text-cyan-300 text-[11px] font-medium transition-all duration-200 hover:shadow-lg hover:shadow-cyan-500/10",children:[e.jsx(vt,{size:12}),e.jsx("span",{children:"Next Question"})]}),h&&e.jsxs("button",{onClick:h,className:"group flex items-center gap-1.5 px-3 py-1.5 rounded-lg bg-amber-500/10 border border-amber-500/20 hover:border-amber-400/40 text-amber-400 hover:text-amber-300 text-[11px] font-medium transition-all duration-200",children:[e.jsx(ht,{size:12}),e.jsx("span",{children:"Switch Topic"})]}),m&&e.jsxs("button",{onClick:m,className:"group flex items-center gap-1.5 px-3 py-1.5 rounded-lg bg-zinc-800/60 border border-zinc-700/40 hover:border-zinc-600/50 text-zinc-300 hover:text-zinc-300 text-[11px] font-medium transition-all duration-200",children:[e.jsx(Ge,{size:12}),e.jsx("span",{children:"Explore More"})]})]})]})]})}),Cl=I.memo(function({mode:t,onModeChange:n}){const[r,a]=I.useState(null),i=[{id:"tutor",icon:Ge,label:"Tutor"},{id:"quiz",icon:pe,label:"Quiz"},{id:"explain",icon:Le,label:"Explain"},{id:"compare",icon:Te,label:"Compare"},{id:"clinical",icon:lt,label:"Clinical"}];return e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"flex gap-1.5 overflow-x-auto no-scrollbar",children:i.map(({id:r,icon:i,label:o})=>e.jsxs("button",{onClick:()=>n(r),onMouseEnter:()=>a(r),onMouseLeave:()=>a(null),className:"relative flex items-center gap-2 px-4 py-2 rounded-xl text-xs font-sans font-medium transition-all duration-300 whitespace-nowrap "+(t===r?"bg-vital-cyan/10 text-vital-cyan border border-vital-cyan/20 shadow-[0_0_20px_rgba(42,212,212,0.15)]":"text-gray-500 hover:text-serum-white hover:bg-white/[0.03] border border-transparent hover:border-white/[0.06]"),children:[e.jsx(i,{size:13}),o]},r))}),r&&e.jsx("div",{className:"absolute top-full left-0 right-0 mt-3 z-50 animate-in fade-in slide-in-from-top-1 duration-150",children:e.jsxs("div",{className:"glass-slide border border-white/[0.06] rounded-2xl p-4 shadow-2xl",children:[e.jsx("div",{className:"flex items-center gap-2 mb-2",children:e.jsx("span",{className:"text-vital-cyan font-sans font-semibold text-xs",children:vl[r].title})}),e.jsx("p",{className:"text-gray-300 text-[11px] font-sans leading-relaxed mb-2",children:vl[r].description}),e.jsxs("div",{className:"flex items-center gap-1.5 text-[10px]",children:[e.jsx("span",{className:"text-gray-300 font-sans",children:"Try:"}),e.jsx("span",{className:"text-gray-200 italic font-sans",children:vl[r].example})]})]})})]})}),kl=I.memo(function({topics:t,selected:n,onSelect:r}){const[a,i]=I.useState(!1),o=a?t:t.slice(0,4),s=t.length>4,l=A.useRef(null);return A.useEffect(()=>{a&&l.current?.focus()},[a]),e.jsx("div",{className:"flex flex-col items-start group animate-fadeIn",children:e.jsxs("div",{className:"flex gap-2.5 max-w-[92%]",children:[e.jsx("div",{className:"w-7 h-7 rounded-lg bg-gradient-to-br from-cyan-500/15 to-teal-500/10 border border-cyan-500/20 flex items-center justify-center shrink-0 mt-0.5",children:e.jsx(Z,{size:13,className:"text-cyan-400"})}),e.jsxs("div",{className:"relative rounded-2xl rounded-tl-sm bg-[#0f1012] border border-white/[0.05] overflow-hidden backdrop-blur-sm",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-cyan-500/[0.03] via-transparent to-teal-500/[0.02] pointer-events-none"}),e.jsxs("div",{className:"relative px-4 py-3 border-b border-cyan-500/10 bg-gradient-to-r from-cyan-500/[0.04] to-transparent",children:[e.jsxs("div",{className:"flex items-center gap-2.5",children:[e.jsx("div",{className:"w-1 h-4 bg-gradient-to-b from-cyan-400 to-teal-500 rounded-full"}),e.jsx("span",{className:"text-[11px] font-medium tracking-wide text-cyan-300",children:"Choose Your Focus Area"})]}),e.jsx("p",{className:"text-[11px] text-zinc-400 mt-1 ml-[18px] italic",children:"Select a topic to begin your personalized quiz journey"})]}),e.jsxs("div",{id:"topic-list",role:"list","aria-label":"Available topics",className:"relative p-4 space-y-2 max-h-[300px] overflow-y-auto custom-scrollbar",children:[o.map((t,a)=>e.jsxs("button",{ref:0===a?l:void 0,onClick:()=>r(t.id),onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),r(t.id))},"aria-pressed":n===t.id,role:"listitem",className:"group/topic w-full text-left px-3.5 py-3 rounded-xl text-xs transition-all duration-300 flex items-center gap-3 relative overflow-hidden "+(n===t.id?"bg-gradient-to-r from-cyan-500/15 to-teal-500/10 border border-cyan-500/40 shadow-lg shadow-cyan-500/10 scale-[1.02]":"bg-zinc-900/30 border border-zinc-800/50 hover:border-cyan-500/30 hover:bg-cyan-500/[0.05] hover:translate-x-1"),style:{animationDelay:50*a+"ms"},children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-cyan-400/5 to-transparent opacity-0 group-hover/topic:opacity-100 transition-opacity duration-500 -translate-x-full group-hover/topic:translate-x-full",style:{transition:"transform 800ms, opacity 300ms"}}),"full-guide"===t.id?e.jsx("div",{className:"shrink-0 w-6 h-6 rounded-lg bg-gradient-to-br from-cyan-500/20 to-teal-500/10 border border-cyan-500/30 flex items-center justify-center",children:e.jsx(X,{size:12,className:"text-cyan-400"})}):e.jsx("div",{className:"shrink-0 w-1.5 h-1.5 rounded-full transition-all duration-300 "+(n===t.id?"bg-cyan-400 shadow-lg shadow-cyan-400/50":"bg-zinc-600 group-hover/topic:bg-cyan-500/50")}),e.jsx("span",{className:"flex-1 leading-relaxed transition-colors duration-300 "+(n===t.id?"text-cyan-300 font-medium":"text-zinc-300 group-hover/topic:text-zinc-300"),children:t.name.replace(" ","")}),n===t.id&&e.jsx(le,{size:14,className:"text-cyan-400 shrink-0 animate-in zoom-in duration-200"})]},t.id)),s&&e.jsx("div",{className:"pt-2",children:e.jsx("button",{onClick:()=>i(!a),"aria-expanded":a,"aria-controls":"topic-list",className:"w-full text-center py-2.5 px-3 rounded-xl text-xs transition-all duration-300 flex items-center justify-center gap-2 bg-zinc-900/50 border border-zinc-800/50 hover:border-cyan-500/30 hover:bg-cyan-500/[0.05] text-zinc-300 hover:text-cyan-300",children:a?e.jsxs(e.Fragment,{children:[e.jsx(oe,{size:14}),e.jsx("span",{children:"Show less"})]}):e.jsxs(e.Fragment,{children:[e.jsx(ae,{size:14}),e.jsxs("span",{children:["Show ",t.length-4," more topics"]})]})})})]}),e.jsx("div",{className:"relative px-4 py-2.5 border-t border-white/[0.03] bg-black/20",children:e.jsx("p",{className:"text-[10px] text-zinc-400 text-center italic",children:"Click any topic to generate a challenging question"})})]})]})})}),Tl=I.memo(function({examGoal:t,onSelect:n}){const r=I.useCallback(()=>t?.includes("USMLE")?[{icon:ht,label:"Vignette",prompt:"Generate a USMLE-style clinical vignette with a realistic patient scenario from this topic.",color:"cyan"},{icon:ke,label:"Mechanism",prompt:"Explain the key pathophysiology mechanisms I should know for USMLE from this topic.",color:"amber"},{icon:Te,label:"Differentials",prompt:"What are the important differential diagnoses from this topic?",color:"emerald"}]:t?.includes("NCLEX")?[{icon:ht,label:"Priority",prompt:"Create an NCLEX-style priority question: What should the nurse do FIRST?",color:"cyan"},{icon:pe,label:"SATA",prompt:"Generate a 'Select all that apply' question from this content.",color:"amber"},{icon:lt,label:"Process",prompt:"Walk me through the nursing process for managing a patient based on this topic.",color:"emerald"}]:t?.includes("University")||t?.includes("Semester")?[{icon:X,label:"Essay Prep",prompt:"What are the key points I should include if asked to write an essay on this topic?",color:"cyan"},{icon:ue,label:"Exam Qs",prompt:"What questions might a professor ask about this topic? Help me prepare for MCQ and short answer.",color:"amber"},{icon:Te,label:"Connect",prompt:"How does this topic connect to other related concepts I should know?",color:"emerald"}]:[{icon:st,label:"Summarize",prompt:"Summarize the key takeaways from this topic concisely.",color:"cyan"},{icon:vt,label:"Clinical Pearl",prompt:"What's the most important clinical pearl from this topic?",color:"amber"},{icon:ue,label:"Explain",prompt:"Explain the most important concept from this topic in simple terms.",color:"emerald"}],[t]),a=I.useMemo(()=>({cyan:"hover:border-cyan-500/30 hover:text-cyan-400 hover:bg-cyan-500/5",amber:"hover:border-amber-500/30 hover:text-amber-400 hover:bg-amber-500/5",emerald:"hover:border-emerald-500/30 hover:text-emerald-400 hover:bg-emerald-500/5"}),[]);return e.jsx("div",{className:"flex gap-2 flex-wrap justify-center",children:r().map(({icon:t,label:r,prompt:i,color:o})=>e.jsxs("button",{onClick:()=>n(i),className:`flex items-center gap-2 px-3 py-2 rounded-xl bg-white/[0.02] border border-white/[0.06] text-[12px] text-zinc-400 transition-all group ${a[o]}`,children:[e.jsx(t,{size:12,className:"transition-colors"}),e.jsx("span",{className:"font-medium",children:r})]},r))})}),Il=({contextMarkdown:t,userProfile:n,graphNodes:r,noteTitle:a,noteId:i,initialSelection:o,onClose:s,onClearSelection:l})=>{const c=i||a?.toLowerCase().replace(/\s+/g,"-")||"default",[u,d]=I.useState([]),[p,h]=I.useState(""),[m,f]=I.useState(!1),[g,y]=I.useState(!1),[x,b]=I.useState(!1),[v,w]=I.useState(null),[N,E]=I.useState("tutor"),[S,C]=I.useState([]),[k,T]=I.useState("full-guide"),[A,j]=I.useState(!1),[_,O]=I.useState(!0),[P,R]=I.useState(0),[M,D]=I.useState(!1),[L,U]=I.useState(new Set),[z,F]=I.useState(null),G=I.useRef(null),q=I.useRef(null),H=I.useMemo(()=>u.filter(e=>!e.hideFromUI),[u]),$=I.useCallback(e=>{U(t=>t.has(e)?t:new Set([...t,e]))},[]),B=I.useCallback((e="smooth",t=50)=>{setTimeout(()=>{G.current&&G.current.scrollTo({top:G.current.scrollHeight,behavior:e})},t)},[]),V=I.useRef(!1);I.useEffect(()=>{(async()=>{try{const e=await xl.getForNote(c);if(e&&e.length>0){const t=e.filter(e=>!e.isThinking);d(t),E("tutor"),t.length>0&&U(new Set(t.map(e=>e.id)))}}catch(e){d([])}finally{V.current=!0}})()},[c]);const Y=I.useRef(null);I.useEffect(()=>{if(V.current&&0!==u.length)return Y.current&&clearTimeout(Y.current),Y.current=setTimeout(async()=>{const e=u.filter(e=>!e.isThinking);try{await xl.saveForNote(c,e)}catch(t){}},500),()=>{Y.current&&clearTimeout(Y.current)}},[u,N,c]),I.useEffect(()=>{if(t){const e=setTimeout(()=>{C(hl.extractTopicsFromContent(t))},0);return()=>clearTimeout(e)}},[t]);const W=I.useRef(0);I.useEffect(()=>{const e=Date.now();e-W.current<150||(W.current=e,B("smooth",100))},[u.length,m,B]),I.useEffect(()=>{u.some(e=>"model"===e.role&&e.text?.includes(" **SIMULATION COMPLETE**"))&&y(!1)},[u]),I.useEffect(()=>{setTimeout(()=>q.current?.focus(),100)},[]),I.useEffect(()=>{o&&(E("explain"),R(e=>e+1))},[o]);const K=I.useCallback(()=>{const e=hl.buildClinicalSimulationPersona(n,a),i={id:crypto.randomUUID(),role:"user",text:" Start Clinical Simulation",timestamp:Date.now()},o=crypto.randomUUID(),s={id:o,role:"model",text:"",timestamp:Date.now(),isThinking:!0,thinkingText:"Analyzing learner profile... Setting difficulty... Creating patient scenario..."};d(e=>[...e,i,s]),f(!0),y(!0),B("smooth",100),hl.streamChatResponse(u,e,t,n,r,"clinical",void 0,e=>d(t=>t.map(t=>t.id===o?{...t,thinkingText:e}:t)),e=>d(t=>t.map(t=>t.id===o?{...t,text:e}:t))).then(e=>{d(t=>t.map(t=>t.id===o?{...t,text:e,isThinking:!1}:t))}).catch(e=>{d(e=>e.map(e=>e.id===o?{...e,text:"I'm having trouble generating a clinical case. Please try again.",isThinking:!1}:e))}).finally(()=>{f(!1)})},[u,t,n,r,a,B]),J=I.useCallback(async()=>{if(m)return;const e=hl.buildClinicalEvaluationPersona(n),a={id:crypto.randomUUID(),role:"user",text:" Finish case and evaluate my performance.",timestamp:Date.now()},i=crypto.randomUUID(),o={id:i,role:"model",text:"",timestamp:Date.now(),isThinking:!0,thinkingText:"Analyzing decisions... Calculating score... Identifying gaps..."};d(e=>[...e,a,o]),f(!0),B("smooth",100);try{const a=await hl.streamChatResponse(u,e,t,n,r,"clinical",void 0,e=>d(t=>t.map(t=>t.id===i?{...t,thinkingText:e}:t)),e=>d(t=>t.map(t=>t.id===i?{...t,text:e}:t)),e);d(e=>e.map(e=>e.id===i?{...e,text:a,isThinking:!1}:e)),E("tutor")}catch(s){d(e=>e.map(e=>e.id===i?{...e,text:"I'm having trouble evaluating the case. Please try again.",isThinking:!1}:e))}finally{f(!1)}},[m,u,t,n,r,a,B]),Q=I.useCallback(e=>{if(g&&!x)return"clinical"===e?void E("clinical"):(w("A clinical simulation is currently running. Finish, Cancel, or Reset to change modes."),void setTimeout(()=>w(null),3e3));x&&b(!1);const t=e=>({tutor:"Tutor",quiz:"Quiz",explain:"Explain",compare:"Compare",clinical:"Clinical Simulation"}[e]||e),n=N,r=t(n),a=t(e);if("clinical"!==e&&n!==e){const e={id:crypto.randomUUID(),role:"user",text:` **Mode Changed:** ${r}  **${a}**`,timestamp:Date.now(),isSystemMessage:!0};d(t=>[...t,e])}E(e),"quiz"===e?(O(!0),B("smooth",150)):"clinical"===e&&K()},[N,K,B,g,x]),X=I.useCallback(async()=>{if(!p.trim()||m)return;let e=p;o&&(e=`Regarding this text: "${o}"\n\n${p}`);if(/try again|explain.*answer|why.*wrong|what.*correct/i.test(p.trim())&&z){const e={id:crypto.randomUUID(),role:"user",text:p,timestamp:Date.now()},r=crypto.randomUUID(),a={id:r,role:"model",text:"",timestamp:Date.now(),isThinking:!0,thinkingText:""};d(t=>[...t,e,a]),h(""),q.current&&(q.current.style.height="52px"),f(!0),B("smooth",100);try{const e=await hl.submitQuizAnswer(z.quizData,z.selectedAnswer,t,n,e=>d(t=>t.map(t=>t.id===r?{...t,thinkingText:e}:t)),e=>d(t=>t.map(t=>t.id===r?{...t,text:e}:t)));d(t=>t.map(t=>t.id===r?{...t,text:e.text,isThinking:!1,isCorrectAnswer:e.isCorrect}:t))}catch(y){d(e=>e.map(e=>e.id===r?{...e,text:"Something went wrong. Please try again.",isThinking:!1}:e))}finally{f(!1),o&&(D(!0),setTimeout(()=>{l?.(),D(!1)},220))}return}const a=/quiz|test me|question|mcq|assess/i.test(p.trim()),i=a?"quiz":N,s={id:crypto.randomUUID(),role:"user",text:e,timestamp:Date.now()},c=crypto.randomUUID(),g={id:c,role:"model",text:"",timestamp:Date.now(),isThinking:!0,thinkingText:""};d(e=>[...e,s,g]),h(""),q.current&&(q.current.style.height="52px"),f(!0),O(!1),B("smooth",100);try{const o=await hl.streamChatResponse(u,e,t,n,r,i,"full-guide"===k?void 0:k,e=>d(t=>t.map(t=>t.id===c?{...t,thinkingText:e}:t)),e=>d(t=>t.map(t=>t.id===c?{...t,text:e}:t))),s="quiz"===i||a?hl.parseQuizFromResponse(o):null;d(e=>e.map(e=>e.id===c?{...e,text:o,isThinking:!1,quizData:s||void 0}:e))}catch(y){d(e=>e.map(e=>e.id===c?{...e,text:"Something went wrong. Please try again.",isThinking:!1}:e))}finally{f(!1),o&&(D(!0),setTimeout(()=>{l?.(),D(!1)},220))}},[p,m,u,t,n,r,N,k,l,B,o,z]),ee=(e,t)=>{d(n=>n.map(n=>n.id===e?{...n,selectedAnswer:t}:n))},te=async e=>{const r=u.find(t=>t.id===e);if(!r?.quizData||!r.selectedAnswer)return;F({messageId:e,quizData:r.quizData,selectedAnswer:r.selectedAnswer}),j(!0),d(t=>t.map(t=>t.id===e?{...t,isAnswerSubmitted:!0}:t));const a=crypto.randomUUID(),i={id:a,role:"model",text:"",timestamp:Date.now(),isThinking:!0,thinkingText:""};d(e=>[...e,i]),B("smooth",100);try{const e=await hl.submitQuizAnswer(r.quizData,r.selectedAnswer,t,n,e=>d(t=>t.map(t=>t.id===a?{...t,thinkingText:e}:t)),e=>d(t=>t.map(t=>t.id===a?{...t,text:e}:t)));d(t=>t.map(t=>t.id===a?{...t,text:e.text,isThinking:!1,isCorrectAnswer:e.isCorrect}:t))}catch(o){d(e=>e.map(e=>e.id===a?{...e,text:"Something went wrong. Please try again.",isThinking:!1}:e))}finally{j(!1)}},ne=async e=>{const r=u.find(t=>t.id===e);if(!r?.quizData)return;j(!0),d(t=>t.map(t=>t.id===e?{...t,isAnswerSubmitted:!0,selectedAnswer:"IDK"}:t));const a=crypto.randomUUID(),i={id:a,role:"model",text:"",timestamp:Date.now(),isThinking:!0,thinkingText:""};d(e=>[...e,i]),B("smooth",100);try{const e=await hl.handleIDKResponse(r.quizData,t,n,e=>d(t=>t.map(t=>t.id===a?{...t,thinkingText:e}:t)),e=>d(t=>t.map(t=>t.id===a?{...t,text:e}:t)));d(t=>t.map(t=>t.id===a?{...t,text:e,isThinking:!1}:t))}catch(o){d(e=>e.map(e=>e.id===a?{...e,text:"Something went wrong. Please try again.",isThinking:!1}:e))}finally{j(!1)}},re=I.useCallback(()=>{y(!1),b(!0),E("tutor"),w(null);const e={id:crypto.randomUUID(),role:"user",text:"[SYSTEM: Clinical simulation was cancelled by the user. The simulation has ended. Do not continue or reference the clinical case unless the user explicitly asks about it. You are now in Tutor mode for subsequent interactions. Respond to new questions normally.]",timestamp:Date.now(),hideFromUI:!0},t={id:crypto.randomUUID(),role:"user",text:" Simulation cancelled  you're back in Tutor mode. You can start chatting or start a new simulation when you're ready.",timestamp:Date.now(),isSystemMessage:!0};d(n=>[...n,e,t])},[]),ae=()=>{if(z)d(e=>e.slice(0,-1)),te(z.messageId);else{const e=[...u].reverse().find(e=>"user"===e.role);if(e){[...u].findIndex(e=>"model"===e.role&&(e.text.includes("I'm having trouble")||e.text.includes("Something went wrong")||e.text.includes("Please try again"))),d(e=>e.slice(0,-1)),h(e.text),setTimeout(()=>{const e=document.querySelector("[data-send-button]");e&&e.click()},100)}}},ie=I.useCallback(()=>{const e="full-guide"===k?"the full guide content":S.find(e=>e.id===k)?.name||"general concepts",a="full-guide"===k?"Generate another challenging MCQ question from any topic in the guide. Make it different from previous questions.":`Generate another challenging MCQ question about ${e}. Make it different from previous questions.`;"quiz"!==N&&E("quiz");const i={id:crypto.randomUUID(),role:"user",text:a,timestamp:Date.now()},o=crypto.randomUUID(),s={id:o,role:"model",text:"",timestamp:Date.now(),isThinking:!0,thinkingText:""};d(e=>[...e,i,s]),f(!0),O(!1),B("smooth",100),hl.streamChatResponse(u,a,t,n,r,"quiz","full-guide"===k?void 0:k,e=>d(t=>t.map(t=>t.id===o?{...t,thinkingText:e}:t)),e=>{const t=hl.parseQuizFromResponse(e);d(t?e=>e.map(e=>e.id===o?{...e,text:"",isThinking:!1,quizData:t}:e):t=>t.map(t=>t.id===o?{...t,text:e}:t))}).then(e=>{const t=hl.parseQuizFromResponse(e);d(n=>n.map(n=>n.id===o?t?{...n,text:"",isThinking:!1,quizData:t}:{...n,text:e,isThinking:!1}:n))}).catch(e=>{d(e=>e.map(e=>e.id===o?{...e,text:"Let me try generating another question...",isThinking:!1}:e))}).finally(()=>f(!1))},[u,t,n,r,N,k,S,B]),oe=I.useCallback(()=>{E("quiz"),O(!0),B("smooth",150)},[B]),se=I.useCallback(()=>{E("tutor"),O(!1)},[]),le=I.useCallback((e,t)=>{if("model"!==e.role||e.isThinking||e.quizData)return!1;if(!e.text||e.text.length<50)return!1;if(e.text.includes("I'm having trouble")||e.text.includes("Please try again"))return!1;const n=u.slice(0,t);if(!n.some(e=>e.quizData&&e.isAnswerSubmitted))return!1;const r=[...n].reverse().findIndex(e=>e.quizData&&e.isAnswerSubmitted);if(-1===r)return!1;const a=n.length-1-r,i=u.slice(a+1).find(e=>"model"===e.role&&!e.quizData&&!e.isThinking);return i?.id===e.id},[u]),ce=I.useCallback(e=>{const a=S.find(t=>t.id===e)?.name||"this topic",i="full-guide"===e?"Generate a challenging MCQ quiz question from the full guide content.":`Generate a challenging MCQ quiz question about ${a}.`,o={id:crypto.randomUUID(),role:"user",text:i,timestamp:Date.now()},s=crypto.randomUUID(),l={id:s,role:"model",text:"",timestamp:Date.now(),isThinking:!0,thinkingText:""};d(e=>[...e,o,l]),f(!0),B("smooth",100),hl.streamChatResponse(u,i,t,n,r,"quiz","full-guide"===e?void 0:e,e=>d(t=>t.map(t=>t.id===s?{...t,thinkingText:e}:t)),e=>d(t=>t.map(t=>t.id===s?{...t,text:e}:t))).then(e=>{const t=hl.parseQuizFromResponse(e);d(n=>n.map(n=>n.id===s?{...n,text:e,isThinking:!1,quizData:t||void 0}:n))}).catch(e=>{d(e=>e.map(e=>e.id===s?{...e,text:"Something went wrong. Please try again.",isThinking:!1}:e))}).finally(()=>{f(!1)})},[u,t,n,r,S,B]),ue=e=>navigator.clipboard.writeText(e);return e.jsxs("div",{className:"flex flex-col h-full bg-[#030406] relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-96 h-96 bg-vital-cyan/[0.015] rounded-full blur-[120px] pointer-events-none"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-64 h-64 bg-neural-purple/[0.02] rounded-full blur-[100px] pointer-events-none"}),e.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[600px] h-[600px] bg-vital-cyan/[0.01] rounded-full blur-[200px] pointer-events-none"}),e.jsxs("div",{className:"h-14 border-b border-white/[0.04] flex items-center justify-between px-5 glass-slide z-10 shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-2.5 h-2.5 rounded-full bg-vital-cyan shadow-[0_0_15px_rgba(42,212,212,0.6)]"}),e.jsx("div",{className:"absolute inset-0 w-2.5 h-2.5 rounded-full bg-vital-cyan animate-ping opacity-20"})]}),e.jsx("div",{children:e.jsxs("span",{className:"text-xs font-serif font-medium tracking-wide text-serum-white",children:["Synapse ",e.jsx("span",{className:"text-vital-cyan",children:"AI"})]})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:async()=>{d([]);try{await xl.deleteForNote(c)}catch(e){}E("tutor"),F(null),y(!1),b(!0),w(null)},className:"p-2 hover:bg-white/[0.04] rounded-xl text-gray-500 hover:text-serum-white transition-all duration-300",title:"Reset",children:e.jsx(tt,{size:14})}),e.jsx("button",{onClick:s,className:"p-2 hover:bg-white/[0.04] rounded-xl text-gray-500 hover:text-serum-white transition-all duration-300",children:e.jsx(xt,{size:14})})]})]}),e.jsx("div",{className:"px-5 py-3 border-b border-white/[0.04] flex items-center gap-2 bg-bio-deep/30",children:e.jsx(Cl,{mode:N,onModeChange:Q})}),e.jsx("div",{ref:G,className:"flex-1 overflow-y-auto px-4 py-5 space-y-4 custom-scrollbar",children:"quiz"===N&&_&&S&&S.length>0?e.jsxs("div",{className:"flex flex-col h-full",children:[0===u.length?e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center text-center px-4 animate-fadeIn mb-4",children:[e.jsxs("div",{className:"relative mb-5",children:[e.jsx("div",{className:"w-16 h-16 rounded-2xl bg-gradient-to-br from-cyan-500/15 to-teal-500/10 border border-cyan-500/15 flex items-center justify-center shadow-xl shadow-cyan-500/5",children:e.jsx(pe,{size:28,className:"text-cyan-400"})}),e.jsx("div",{className:"absolute -bottom-1 -right-1 w-5 h-5 rounded-full bg-emerald-500 border-2 border-[#08090a] flex items-center justify-center",children:e.jsx(st,{size:10,className:"text-white"})})]}),e.jsx("h3",{className:"text-lg font-medium text-white mb-1",children:"Quiz Mode Active "}),e.jsx("p",{className:"text-sm text-zinc-400 max-w-[280px] leading-relaxed mb-2",children:"Select a topic below to start testing your knowledge"})]}):e.jsx("div",{className:"space-y-4 mb-4",children:H.map((t,r)=>e.jsx(Sl,{message:t,userName:n.name,userProfile:n,onCopy:ue,onSelectQuizAnswer:e=>ee(t.id,e),onSubmitQuiz:()=>te(t.id),onIDK:()=>ne(t.id),isSubmittingQuiz:A,onRetry:ae,onNextQuiz:ie,onChangeTopic:oe,onExitQuiz:se,showQuizActions:le(t,r),animatedMessageIds:L,markMessageAsAnimated:$},t.id))}),e.jsx(kl,{topics:S,selected:k,onSelect:e=>{T(e),O(!1),ce(e)}})]}):"quiz"!==N||!_||S&&0!==S.length?0===u.length?e.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-center px-4 animate-fadeIn",children:[e.jsxs("div",{className:"relative mb-5",children:[e.jsx("div",{className:"w-16 h-16 rounded-2xl bg-gradient-to-br from-cyan-500/15 to-teal-500/10 border border-cyan-500/15 flex items-center justify-center shadow-xl shadow-cyan-500/5",children:e.jsx(Z,{size:28,className:"text-cyan-400"})}),e.jsx("div",{className:"absolute -bottom-1 -right-1 w-5 h-5 rounded-full bg-emerald-500 border-2 border-[#08090a] flex items-center justify-center",children:e.jsx(st,{size:10,className:"text-white"})})]}),e.jsxs("h3",{className:"text-lg font-medium text-white mb-1",children:["Hey ",n.name," "]}),e.jsxs("p",{className:"text-sm text-zinc-400 max-w-[280px] leading-relaxed mb-2",children:["I've analyzed"," ",e.jsx("span",{className:"text-cyan-400 font-medium",children:a}),"."]}),n.examGoal&&"General Knowledge"!==n.examGoal&&e.jsxs("p",{className:"text-xs text-zinc-400 mb-5",children:["Tailored for"," ",e.jsx("span",{className:"text-amber-400/80 font-medium",children:n.examGoal})]}),e.jsx(Tl,{examGoal:n.examGoal||"",onSelect:e=>{h(e),q.current?.focus()}}),e.jsxs("div",{className:"mt-6 flex items-center gap-2 text-[11px] text-zinc-400",children:[e.jsx(Pe,{size:11,className:"text-zinc-400"}),e.jsx("span",{children:"Hover over modes above to learn what they do"})]})]}):e.jsx(e.Fragment,{children:H.map((t,r)=>e.jsx(Sl,{message:t,userName:n.name,userProfile:n,onCopy:ue,onSelectQuizAnswer:e=>ee(t.id,e),onSubmitQuiz:()=>te(t.id),onIDK:()=>ne(t.id),isSubmittingQuiz:A,onRetry:ae,onNextQuiz:ie,onChangeTopic:oe,onExitQuiz:se,showQuizActions:le(t,r),animatedMessageIds:L,markMessageAsAnimated:$},t.id))}):e.jsx("div",{className:"flex flex-col h-full",children:e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center text-center px-4 animate-fadeIn",children:[e.jsx("div",{className:"relative mb-5",children:e.jsx("div",{className:"w-16 h-16 rounded-2xl bg-gradient-to-br from-cyan-500/15 to-teal-500/10 border border-cyan-500/15 flex items-center justify-center shadow-xl shadow-cyan-500/5",children:e.jsx(pe,{size:28,className:"text-cyan-400"})})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ze,{size:14,className:"animate-spin text-cyan-400"}),e.jsx("span",{className:"text-sm text-zinc-300",children:"Extracting quiz topics..."})]})]})})}),(o||M)&&e.jsx("div",{className:"px-4 pb-2 transition-all duration-200 "+(M?"opacity-0 translate-y-2":"opacity-100 translate-y-0"),children:e.jsxs("div",{className:"bg-gradient-to-r from-cyan-950/40 to-teal-950/30 border border-cyan-500/20 rounded-xl overflow-hidden backdrop-blur-sm",children:[e.jsxs("div",{className:"flex items-center justify-between px-3 py-2 border-b border-cyan-500/10",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-5 h-5 rounded-md bg-cyan-500/10 border border-cyan-500/20 flex items-center justify-center",children:e.jsx(Ze,{size:9,className:"text-cyan-400"})}),e.jsx("span",{className:"text-[10px] uppercase tracking-wider text-cyan-500/70 font-semibold",children:"Selected Text"}),o&&e.jsxs("span",{className:"text-[11px] text-zinc-400",children:["(",o.length," chars)"]})]}),e.jsx("button",{onClick:()=>{D(!0),setTimeout(()=>{l?.(),D(!1)},220)},className:"text-zinc-300 hover:text-white p-1 hover:bg-white/5 rounded-lg transition-colors",children:e.jsx(xt,{size:12})})]}),e.jsx("div",{className:"px-3 py-2.5",children:e.jsx("p",{className:"text-[12px] text-cyan-100/90 leading-relaxed max-h-[140px] overflow-y-auto custom-scrollbar whitespace-pre-wrap",children:o})})]})},P),"clinical"===N&&!m&&u.length>2&&e.jsxs("div",{className:"px-4 pb-2 flex justify-center gap-3 animate-in fade-in slide-in-from-bottom-2 duration-300",children:[e.jsxs("button",{onClick:J,className:"group flex items-center gap-2.5 px-5 py-2.5 rounded-xl bg-gradient-to-r from-rose-500/10 via-orange-500/10 to-amber-500/10 border border-rose-500/30 hover:border-rose-400/50 text-rose-400 hover:text-rose-300 transition-all duration-300 text-xs font-bold uppercase tracking-wider shadow-lg shadow-rose-900/20 hover:shadow-rose-900/30 hover:scale-[1.02] active:scale-[0.98]",children:[e.jsx(pe,{size:14,className:"transition-transform group-hover:scale-110"}),e.jsx("span",{children:"Finish & Evaluate Case"}),e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-rose-400 animate-pulse"})]}),e.jsxs("button",{onClick:re,className:"flex items-center gap-2 px-4 py-2 rounded-xl bg-zinc-900/60 border border-zinc-800 text-zinc-200 hover:bg-zinc-900/80 hover:text-white transition-colors duration-200 text-xs font-medium",title:"Cancel simulation and return to Tutor",children:[e.jsx(xt,{size:14}),e.jsx("span",{children:"Cancel"})]})]}),"clinical"!==N&&u.length>0&&u.length<5&&!p&&e.jsx("div",{className:"px-4 pb-2",children:e.jsx(Tl,{examGoal:n.examGoal||"",onSelect:e=>{h(e),q.current?.focus()}})}),v&&e.jsx("div",{className:"px-4",children:e.jsx("div",{className:"mx-auto max-w-3xl w-full",children:e.jsxs("div",{className:"flex items-center justify-between gap-3 px-4 py-2 bg-amber-900/7 border border-amber-700/10 text-amber-200 text-sm rounded-2xl shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Pe,{size:16,className:"text-amber-300"}),e.jsx("div",{className:"text-[13px] leading-snug",children:v})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("button",{onClick:()=>w(null),className:"p-1 rounded hover:bg-white/5",title:"Dismiss",children:e.jsx(xt,{size:14})})})]})})}),e.jsxs("div",{className:"px-5 pb-5 pt-3 bg-gradient-to-t from-bio-void via-bio-void/95 to-transparent relative z-10",children:[e.jsxs("div",{className:"relative glass-slide border border-white/[0.06] rounded-2xl overflow-hidden focus-within:border-vital-cyan/30 focus-within:shadow-[0_0_30px_rgba(42,212,212,0.1)] transition-all duration-300",children:[e.jsx("textarea",{ref:q,value:p,onChange:e=>{const t=e.target.value;h(t);const n=e.target;t.trim()?(n.style.height="56px",n.style.height=`${Math.min(n.scrollHeight,160)}px`):n.style.height="56px"},onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),X())},placeholder:(()=>{if(o)return"Ask about the selected text...";const e=a?.slice(0,30)||"your notes";switch(N){case"quiz":return"Type 'quiz me' or ask for questions...";case"explain":return"Paste a concept to explain...";case"compare":return"Compare two concepts or conditions...";case"clinical":return u.length>1?"What's your next step? (e.g., 'Order CBC', 'Start IV fluids', 'Check for JVD')":"Click Clinical mode to start a simulation...";default:return`Ask anything about ${e}...`}})(),rows:1,className:"w-full bg-transparent px-5 py-4 pr-16 text-[15px] font-sans text-serum-white placeholder:text-zinc-400 focus:outline-none resize-none custom-scrollbar leading-relaxed",style:{minHeight:"56px",maxHeight:"160px"}}),e.jsx("button",{onClick:X,disabled:!p.trim()||m,"data-send-button":!0,className:"absolute right-3 bottom-3 p-3 bg-vital-cyan text-bio-void rounded-xl hover:bg-vital-cyan/90 disabled:opacity-20 disabled:cursor-not-allowed transition-all duration-300 shadow-[0_0_20px_rgba(42,212,212,0.3)] disabled:shadow-none",children:m?e.jsx(ze,{size:16,className:"animate-spin"}):e.jsx(at,{size:16})})]}),e.jsxs("p",{className:"text-[11px] text-zinc-400 text-center mt-3 tracking-wide font-sans",children:[e.jsx("span",{className:"text-zinc-400",children:"Enter"})," to send "," ",e.jsx("span",{className:"text-zinc-400",children:"Shift+Enter"})," for new line"]})]})]})},Al=I.memo(()=>{const t=I.useRef(null),[n,r]=I.useState(!0);return I.useEffect(()=>{const e=()=>r(!document.hidden);return document.addEventListener("visibilitychange",e),()=>document.removeEventListener("visibilitychange",e)},[]),I.useEffect(()=>{if(!t.current)return;const e=t.current,r=(()=>{const e=navigator.userAgent.toLowerCase();return/mobile|android|iphone|ipad|tablet/i.test(e)||window.innerWidth<1200})(),a=new b,i=new v(-1,1,1,-1,0,1),o=new w({alpha:!0,antialias:!1,powerPreference:r?"low-power":"high-performance",depth:!1,stencil:!1,precision:r?"mediump":"highp"}),s=r?1:1.5;o.setPixelRatio(Math.min(window.devicePixelRatio,s)),o.setSize(window.innerWidth,window.innerHeight),e.appendChild(o.domElement);const l={u_time:{value:0},u_resolution:{value:new S(window.innerWidth,window.innerHeight)},u_mouse:{value:new S(.5,.5)}},c=new N(2,2),u=new E({uniforms:l,vertexShader:"\n      varying vec2 vUv;\n      void main() {\n        vUv = uv;\n        gl_Position = vec4(position, 1.0);\n      }\n    ",fragmentShader:"\n      precision mediump float;\n      \n      uniform float u_time;\n      uniform vec2 u_resolution;\n      uniform vec2 u_mouse;\n\n      // ---------------------------------------------\n      // NOISE FUNCTIONS (Optimized Simplex)\n      // ---------------------------------------------\n      vec3 mod289(vec3 x) { return x - floor(x * (1.0 / 289.0)) * 289.0; }\n      vec2 mod289(vec2 x) { return x - floor(x * (1.0 / 289.0)) * 289.0; }\n      vec3 permute(vec3 x) { return mod289(((x*34.0)+1.0)*x); }\n\n      float snoise(vec2 v) {\n        const vec4 C = vec4(0.211324865405187, 0.366025403784439, -0.577350269189626, 0.024390243902439);\n        vec2 i  = floor(v + dot(v, C.yy) );\n        vec2 x0 = v - i + dot(i, C.xx);\n        vec2 i1;\n        i1 = (x0.x > x0.y) ? vec2(1.0, 0.0) : vec2(0.0, 1.0);\n        vec4 x12 = x0.xyxy + C.xxzz;\n        x12.xy -= i1;\n        i = mod289(i);\n        vec3 p = permute( permute( i.y + vec3(0.0, i1.y, 1.0 )) + i.x + vec3(0.0, i1.x, 1.0 ));\n        vec3 m = max(0.5 - vec3(dot(x0,x0), dot(x12.xy,x12.xy), dot(x12.zw,x12.zw)), 0.0);\n        m = m*m ;\n        m = m*m ;\n        vec3 x = 2.0 * fract(p * C.www) - 1.0;\n        vec3 h = abs(x) - 0.5;\n        vec3 ox = floor(x + 0.5);\n        vec3 a0 = x - ox;\n        m *= 1.79284291400159 - 0.85373472095314 * ( a0*a0 + h*h );\n        vec3 g;\n        g.x  = a0.x  * x0.x  + h.x  * x0.y;\n        g.yz = a0.yz * x12.xz + h.yz * x12.yw;\n        return 130.0 * dot(m, g);\n      }\n\n      // ---------------------------------------------\n      // CORE: DOMAIN WARPING (Fluid Simulation)\n      // ---------------------------------------------\n      float fbm(vec2 st) {\n        float value = 0.0;\n        float amplitude = 0.5;\n        for (int i = 0; i < 3; i++) {\n          value += amplitude * snoise(st);\n          st *= 2.0;\n          amplitude *= 0.5;\n        }\n        return value;\n      }\n\n      void main() {\n        // Normalize coordinates (Responsive aspect ratio)\n        vec2 st = gl_FragCoord.xy / u_resolution.xy;\n        st.x *= u_resolution.x / u_resolution.y;\n\n        // BIOLOGICAL TIME - Multi-scale rhythms for organic feel\n        float slow_t = u_time * 0.08;        // Slow drift (primary)\n        float pulse_t = u_time * 0.3;        // Quick pulse\n        float breath_t = u_time * 0.04;      // Deep breathing cycle\n        float micro_t = u_time * 0.15;       // Micro-oscillations\n        float edge_t = u_time * 0.05;        // Edge animation rhythm\n\n        // FULL-SCREEN INTERACTIVITY: Disabled - static background\n        vec2 mouse_norm = u_mouse * vec2(u_resolution.x/u_resolution.y, 1.0);\n        float mouse_dist = distance(st, mouse_norm);\n        \n        // Mouse interactivity disabled - no distort or ripples\n        // st stays unchanged\n        \n        // No ripple system when idle\n\n        // DOMAIN WARPING ALGORITHM - Multi-layer system for full-screen fluidity\n        // Layer 1: Slow base flow with edge contribution\n        vec2 q = vec2(0.);\n        q.x = fbm( st + 0.00 * slow_t ) + 0.02 * edge_t;\n        q.y = fbm( st + vec2(1.0) + breath_t * 0.3) + 0.02 * edge_t;\n\n        // Layer 2: Distorted swirl flow\n        vec2 r = vec2(0.);\n        r.x = fbm( st + 1.0 * q + vec2(1.7, 9.2) + 0.15 * slow_t + 0.08 * breath_t);\n        r.y = fbm( st + 1.0 * q + vec2(8.3, 2.8) + 0.126 * slow_t + 0.06 * breath_t);\n\n        // Layer 3: Micro-turbulence (adds dynamism in idle)\n        vec2 micro = vec2(0.);\n        micro.x = fbm( st * 2.0 + 0.3 * micro_t ) * 0.08;\n        micro.y = fbm( st * 2.5 - 0.25 * micro_t ) * 0.08;\n        \n        // Layer 4: Edge animation - keeps edges alive and flowing\n        vec2 edge = vec2(0.);\n        edge.x = fbm( st * 1.5 + 0.2 * edge_t ) * 0.06;\n        edge.y = fbm( st * 1.8 - 0.15 * edge_t ) * 0.06;\n        \n        // Final noise with all layers\n        float f = fbm(st + r + micro * 0.5 + edge * 0.3);\n\n        // COLOR PALETTE (Medical Editorial - Obsidian with Life)\n        vec3 colorBg = vec3(0.02, 0.04, 0.06); \n        vec3 colorFluid = vec3(0.0, 0.28, 0.38); \n        vec3 colorHighlight = vec3(0.10, 0.65, 0.70);\n\n        // ORGANIC MIXING with enhanced breathing and fluidity\n        // Base color transition\n        vec3 color = mix(colorBg, colorFluid, clamp((f*f)*3.5, 0.0, 1.0));\n\n        // Add veins with breathing intensity - extended range for full-screen life\n        float vein_breath = 0.6 + 0.4 * sin(breath_t + length(st)*0.5);\n        color = mix(color, colorHighlight, clamp(length(q), 0.0, 1.0) * 0.22 * vein_breath);\n\n        // Add dynamic pulse highlights (enhanced when idle)\n        float pulse = 0.5 + 0.5 * sin(pulse_t + length(st)*3.0) * cos(slow_t*0.5);\n        color = mix(color, colorHighlight, length(r.x) * 0.18 * pulse);\n        \n        // Micro-turbulence color contribution (enhanced for liveness)\n        color = mix(color, colorFluid, length(micro) * 0.16);\n        \n        // Edge animation color - more prominent now (no mouse distraction)\n        color = mix(color, colorFluid, length(edge) * 0.11);\n\n        // Slightly stronger vignette (subtle scrim increase for readability)\n        float vignette = 1.0 - smoothstep(0.15, 1.5, length(gl_FragCoord.xy / u_resolution.xy - 0.5)) * 0.40;\n        color *= vignette;\n\n        // GRAIN (Cinematic Texture - prevents banding)\n        float grain = snoise(gl_FragCoord.xy * 2.0 + u_time) * 0.025;\n        color += grain;\n\n        gl_FragColor = vec4(color, 1.0);\n      }\n    ",depthWrite:!1,depthTest:!1}),d=new C(c,u);a.add(d);const p=new S(.5,.5),h=new S(.5,.5),m=new S(0,0),f=new S(.5,.5);let g=null;const y=e=>{g||(g=requestAnimationFrame(()=>{p.x=e.clientX/window.innerWidth,p.y=1-e.clientY/window.innerHeight,g=null}))};window.addEventListener("mousemove",y,{passive:!0});const x=new k;let T,I=0;const A=1e3/(r?24:30),j=e=>{if(T=requestAnimationFrame(j),!n)return;const t=e-I;if(t<A)return;I=e-t%A;const r=x.getDelta();l.u_time.value+=r;const s=(new S).subVectors(p,f);f.copy(p);s.length()>.25&&s.setLength(.25),m.multiplyScalar(.9).add(s.multiplyScalar(.1));const c=(new S).subVectors(p,h);if(c.length()>.002){const e=.25;c.length()>e&&c.setLength(e),m.add(c.multiplyScalar(.06))}m.multiplyScalar(.93);m.length()>.06&&m.setLength(.06),h.add(m),h.x=Math.max(0,Math.min(1,h.x)),h.y=Math.max(0,Math.min(1,h.y)),l.u_mouse.value.copy(h),o.render(a,i)};let _;requestAnimationFrame(j);const O=()=>{clearTimeout(_),_=setTimeout(()=>{const e=window.innerWidth,t=window.innerHeight;o.setSize(e,t),l.u_resolution.value.set(e,t)},100)};return window.addEventListener("resize",O,{passive:!0}),()=>{cancelAnimationFrame(T),g&&cancelAnimationFrame(g),clearTimeout(_),window.removeEventListener("mousemove",y),window.removeEventListener("resize",O),c.dispose(),u.dispose(),o.dispose(),o.forceContextLoss(),e&&o.domElement&&e.removeChild(o.domElement)}},[n]),e.jsxs(e.Fragment,{children:[e.jsx("div",{ref:t,style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",zIndex:0,opacity:.9,pointerEvents:"none"}}),e.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",zIndex:1,background:"radial-gradient(ellipse at center, rgba(2,4,6,0.28) 0%, rgba(2,4,6,0.42) 60%, rgba(2,4,6,0.55) 100%)",pointerEvents:"none"}}),e.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",zIndex:2,opacity:.04,pointerEvents:"none",backgroundImage:"url(\"data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.75' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)'/%3E%3C/svg%3E\")"}})]})});function jl(e){const t=[];if(t.push("---"),t.push(`title: "${e.title}"`),t.push(`created: ${new Date(e.timestamp).toISOString()}`),t.push("source: Synapse Med"),t.push(`nodes: ${e.graphData.nodes.length}`),t.push(`connections: ${e.graphData.links.length}`),t.push("---"),t.push(""),t.push(`# ${e.title}`),t.push(""),e.summary&&(t.push("> **Summary:** "+e.summary),t.push("")),e.eli5Analogy&&(t.push("##  In Simple Terms"),t.push(""),t.push(`> "${e.eli5Analogy}"`),t.push("")),t.push("---"),t.push(""),t.push(e.markdownContent),t.push(""),e.pearls&&e.pearls.length>0){t.push("---"),t.push(""),t.push("##  Clinical Pearls"),t.push("");const n={"red-flag":"","exam-tip":"","gap-filler":"","fact-check":""};for(const r of e.pearls){const e=n[r.type]||"",a=r.type.split("-").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ");t.push(`### ${e} ${a}`),t.push(""),t.push(r.content),r.citation&&(t.push(""),t.push(`*Source: ${r.citation}*`)),t.push("")}}if(e.sources&&e.sources.length>0){t.push("---"),t.push(""),t.push("##  Verified Sources"),t.push("");for(const n of e.sources)t.push(`- [${n.title}](${n.uri})`);t.push("")}return t.push("---"),t.push(""),t.push(`*Generated by Synapse Med on ${(new Date).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}*`),t.join("\n")}function _l(e,t="obsidian"){const n="obsidian"===t?"\n  :root {\n    --bg-primary: #0a0c0e;\n    --bg-secondary: #0f1114;\n    --bg-tertiary: #161a1f;\n    --text-primary: #f0f2f5;\n    --text-secondary: #9ca3af;\n    --text-muted: #6b7280;\n    --accent-cyan: #2ad4d4;\n    --accent-rose: #f472b6;\n    --accent-amber: #f0b429;\n    --accent-purple: #a78bfa;\n    --accent-teal: #14b8a6;\n    --border-color: rgba(255,255,255,0.06);\n    --shadow-glow: 0 0 40px rgba(42, 212, 212, 0.1);\n  }\n  body {\n    background: var(--bg-primary);\n    color: var(--text-primary);\n  }\n":"clinical"===t?"\n  :root {\n    --bg-primary: #f8fafc;\n    --bg-secondary: #ffffff;\n    --bg-tertiary: #f1f5f9;\n    --text-primary: #1e293b;\n    --text-secondary: #475569;\n    --text-muted: #94a3b8;\n    --accent-cyan: #0891b2;\n    --accent-rose: #e11d48;\n    --accent-amber: #d97706;\n    --accent-purple: #7c3aed;\n    --accent-teal: #0d9488;\n    --border-color: rgba(0,0,0,0.08);\n    --shadow-glow: 0 4px 24px rgba(0,0,0,0.06);\n  }\n  body {\n    background: var(--bg-primary);\n    color: var(--text-primary);\n  }\n":"\n  :root {\n    --bg-primary: #ffffff;\n    --bg-secondary: #ffffff;\n    --bg-tertiary: #fafafa;\n    --text-primary: #000000;\n    --text-secondary: #333333;\n    --text-muted: #666666;\n    --accent-cyan: #0077b6;\n    --accent-rose: #c81d4e;\n    --accent-amber: #b45309;\n    --accent-purple: #6d28d9;\n    --accent-teal: #0f766e;\n    --border-color: #e5e5e5;\n    --shadow-glow: none;\n  }\n  body {\n    background: var(--bg-primary);\n    color: var(--text-primary);\n  }\n  @media print {\n    body { font-size: 11pt; }\n    .no-print { display: none !important; }\n    .page-break { page-break-before: always; }\n  }\n",r=function(e){let t=e;return t=t.replace(/^######\s(.+)$/gm,"<h6>$1</h6>"),t=t.replace(/^#####\s(.+)$/gm,"<h5>$1</h5>"),t=t.replace(/^####\s(.+)$/gm,"<h4>$1</h4>"),t=t.replace(/^###\s(.+)$/gm,"<h3>$1</h3>"),t=t.replace(/^##\s(.+)$/gm,"<h2>$1</h2>"),t=t.replace(/^#\s(.+)$/gm,"<h1>$1</h1>"),t=t.replace(/\*\*\*(.+?)\*\*\*/g,"<strong><em>$1</em></strong>"),t=t.replace(/\*\*(.+?)\*\*/g,"<strong>$1</strong>"),t=t.replace(/\*(.+?)\*/g,"<em>$1</em>"),t=t.replace(/_(.+?)_/g,"<em>$1</em>"),t=t.replace(/```(\w+)?\n([\s\S]*?)```/g,"<pre><code>$2</code></pre>"),t=t.replace(/`([^`]+)`/g,"<code>$1</code>"),t=t.replace(/^>\s(.+)$/gm,"<blockquote>$1</blockquote>"),t=t.replace(/\[([^\]]+)\]\(([^)]+)\)/g,'<a href="$2" target="_blank" rel="noopener noreferrer">$1</a>'),t=t.replace(/!\[([^\]]*)\]\(([^)]+)\)/g,'<img src="$2" alt="$1" style="max-width: 100%;">'),t=t.replace(/^---$/gm,"<hr>"),t=t.replace(/^\*\*\*$/gm,"<hr>"),t=t.replace(/^[-*]\s(.+)$/gm,"<li>$1</li>"),t=t.replace(/(<li>.*<\/li>\n?)+/g,"<ul>$&</ul>"),t=t.replace(/^\d+\.\s(.+)$/gm,"<li>$1</li>"),t=t.replace(/^(?!<[hupbol]|<li|<hr|<block|<pre)(.+)$/gm,"<p>$1</p>"),t=t.replace(/<p>\s*<\/p>/g,""),t=t.replace(/<\/blockquote>\n<blockquote>/g,"\n"),t}(e.markdownContent);let a="";if(e.pearls&&e.pearls.length>0){const t={"red-flag":" Red Flag","exam-tip":" Exam Tip","gap-filler":" Gap Filler","fact-check":" Fact Check"};a=`\n      <section class="pearls-section">\n        <div class="pearls-header">\n          <div class="pearls-icon"></div>\n          <div>\n            <div class="pearls-title">Clinical Pearls</div>\n            <div class="pearls-subtitle">${e.pearls.length} high-yield insights</div>\n          </div>\n        </div>\n        ${e.pearls.map(e=>`\n          <div class="pearl-card ${e.type}">\n            <div class="pearl-label">${t[e.type]||e.type}</div>\n            <div class="pearl-content">${Pl(e.content)}</div>\n          </div>\n        `).join("")}\n      </section>\n    `}let i="";e.sources&&e.sources.length>0&&(i=`\n      <section class="sources-section">\n        <div class="sources-header">\n          <div class="sources-icon"></div>\n          <div>\n            <div class="pearls-title">Verified Sources</div>\n            <div class="pearls-subtitle">${e.sources.length} references</div>\n          </div>\n        </div>\n        ${e.sources.map(e=>`\n          <a href="${Pl(e.uri)}" target="_blank" rel="noopener noreferrer" class="source-link">\n            <span class="source-title">${Pl(e.title)}</span>\n            <span class="source-url">${new URL(e.uri).hostname}</span>\n          </a>\n        `).join("")}\n      </section>\n    `);let o="";e.summary&&(o=`\n      <div class="summary-block">\n        <div class="summary-label">Executive Summary</div>\n        <div class="summary-text">${Pl(e.summary)}</div>\n      </div>\n    `);let s="";e.eli5Analogy&&(s=`\n      <div class="summary-block" style="border-left: 3px solid var(--accent-purple);">\n        <div class="summary-label" style="color: var(--accent-purple);"> In Simple Terms</div>\n        <div class="summary-text" style="font-style: italic;">"${Pl(e.eli5Analogy)}"</div>\n      </div>\n    `);const l=new Date(e.timestamp).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"});return`<!DOCTYPE html>\n<html lang="en">\n<head>\n  <meta charset="UTF-8">\n  <meta name="viewport" content="width=device-width, initial-scale=1.0">\n  <meta name="generator" content="Synapse Med">\n  <meta name="created" content="${new Date(e.timestamp).toISOString()}">\n  <title>${Pl(e.title)}  Synapse Med</title>\n  <style>\n    \n  * {\n    margin: 0;\n    padding: 0;\n    box-sizing: border-box;\n  }\n  \n  @font-face {\n    font-family: 'Inter';\n    src: url('https://fonts.gstatic.com/s/inter/v12/UcCO3FwrK3iLTeHuS_fvQtMwCp50KnMw2boKoduKmMEVuLyfAZ9hiJ-Ek-_EeA.woff2') format('woff2');\n    font-weight: 400;\n    font-style: normal;\n    font-display: swap;\n  }\n  \n  @font-face {\n    font-family: 'Inter';\n    src: url('https://fonts.gstatic.com/s/inter/v12/UcCO3FwrK3iLTeHuS_fvQtMwCp50KnMw2boKoduKmMEVuGKYAZ9hiJ-Ek-_EeA.woff2') format('woff2');\n    font-weight: 600;\n    font-style: normal;\n    font-display: swap;\n  }\n  \n  @font-face {\n    font-family: 'Playfair Display';\n    src: url('https://fonts.gstatic.com/s/playfairdisplay/v30/nuFvD-vYSZviVYUb_rj3ij__anPXJzDwcbmjWBN2PKdFvXDXbtXK-F2qC0s.woff2') format('woff2');\n    font-weight: 400;\n    font-style: italic;\n    font-display: swap;\n  }\n  \n  body {\n    font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;\n    line-height: 1.7;\n    font-size: 16px;\n    padding: 3rem;\n    max-width: 900px;\n    margin: 0 auto;\n    -webkit-font-smoothing: antialiased;\n    -moz-osx-font-smoothing: grayscale;\n  }\n  \n  /* Header */\n  .header {\n    margin-bottom: 4rem;\n    padding-bottom: 2rem;\n    border-bottom: 1px solid var(--border-color);\n  }\n  \n  .header-brand {\n    font-family: 'Inter', sans-serif;\n    font-size: 0.65rem;\n    font-weight: 600;\n    letter-spacing: 0.25em;\n    text-transform: uppercase;\n    color: var(--accent-cyan);\n    margin-bottom: 0.75rem;\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n  }\n  \n  .header-brand::before {\n    content: '';\n    width: 6px;\n    height: 6px;\n    background: var(--accent-cyan);\n    border-radius: 50%;\n    box-shadow: 0 0 10px var(--accent-cyan);\n  }\n  \n  .header h1 {\n    font-family: 'Playfair Display', Georgia, serif;\n    font-size: 3.5rem;\n    font-weight: 400;\n    font-style: italic;\n    line-height: 1.2;\n    margin-bottom: 1rem;\n    background: linear-gradient(135deg, var(--text-primary) 0%, var(--accent-cyan) 100%);\n    -webkit-background-clip: text;\n    -webkit-text-fill-color: transparent;\n    background-clip: text;\n  }\n  \n  .header-meta {\n    display: flex;\n    gap: 2rem;\n    font-size: 0.8rem;\n    color: var(--text-muted);\n    font-family: monospace;\n    letter-spacing: 0.05em;\n  }\n  \n  .header-meta span {\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n  }\n  \n  /* Summary Block */\n  .summary-block {\n    background: var(--bg-secondary);\n    border: 1px solid var(--border-color);\n    border-radius: 16px;\n    padding: 2rem;\n    margin-bottom: 3rem;\n    position: relative;\n    overflow: hidden;\n  }\n  \n  .summary-block::before {\n    content: '';\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    height: 3px;\n    background: linear-gradient(90deg, var(--accent-cyan), var(--accent-purple));\n  }\n  \n  .summary-label {\n    font-size: 0.65rem;\n    font-weight: 600;\n    letter-spacing: 0.2em;\n    text-transform: uppercase;\n    color: var(--accent-cyan);\n    margin-bottom: 0.75rem;\n  }\n  \n  .summary-text {\n    font-size: 1.1rem;\n    line-height: 1.8;\n    color: var(--text-secondary);\n  }\n  \n  /* Content Styling */\n  .content {\n    margin-bottom: 4rem;\n  }\n  \n  .content h1, .content h2, .content h3, .content h4, .content h5, .content h6 {\n    font-family: 'Inter', sans-serif;\n    font-weight: 600;\n    line-height: 1.4;\n    margin-top: 2.5rem;\n    margin-bottom: 1rem;\n    color: var(--text-primary);\n  }\n  \n  .content h1 { font-size: 2rem; }\n  .content h2 { \n    font-size: 1.5rem;\n    padding-bottom: 0.5rem;\n    border-bottom: 1px solid var(--border-color);\n  }\n  .content h3 { font-size: 1.25rem; color: var(--accent-cyan); }\n  .content h4 { font-size: 1.1rem; }\n  .content h5, .content h6 { font-size: 1rem; }\n  \n  .content p {\n    margin-bottom: 1.25rem;\n    color: var(--text-secondary);\n  }\n  \n  .content ul, .content ol {\n    margin-bottom: 1.25rem;\n    padding-left: 1.5rem;\n    color: var(--text-secondary);\n  }\n  \n  .content li {\n    margin-bottom: 0.5rem;\n    padding-left: 0.5rem;\n  }\n  \n  .content li::marker {\n    color: var(--accent-cyan);\n  }\n  \n  .content blockquote {\n    border-left: 3px solid var(--accent-purple);\n    padding-left: 1.5rem;\n    margin: 1.5rem 0;\n    font-style: italic;\n    color: var(--text-muted);\n    background: var(--bg-tertiary);\n    padding: 1rem 1.5rem;\n    border-radius: 0 8px 8px 0;\n  }\n  \n  .content code {\n    font-family: 'JetBrains Mono', 'Fira Code', monospace;\n    font-size: 0.875em;\n    background: var(--bg-tertiary);\n    padding: 0.2em 0.5em;\n    border-radius: 4px;\n    color: var(--accent-rose);\n  }\n  \n  .content pre {\n    background: var(--bg-tertiary);\n    border: 1px solid var(--border-color);\n    border-radius: 12px;\n    padding: 1.5rem;\n    overflow-x: auto;\n    margin: 1.5rem 0;\n  }\n  \n  .content pre code {\n    background: none;\n    padding: 0;\n    color: var(--text-primary);\n  }\n  \n  .content table {\n    width: 100%;\n    border-collapse: collapse;\n    margin: 1.5rem 0;\n    font-size: 0.9rem;\n  }\n  \n  .content th, .content td {\n    border: 1px solid var(--border-color);\n    padding: 0.75rem 1rem;\n    text-align: left;\n  }\n  \n  .content th {\n    background: var(--bg-tertiary);\n    font-weight: 600;\n    color: var(--text-primary);\n  }\n  \n  .content tr:nth-child(even) {\n    background: var(--bg-secondary);\n  }\n  \n  .content a {\n    color: var(--accent-cyan);\n    text-decoration: none;\n    border-bottom: 1px solid transparent;\n    transition: border-color 0.2s;\n  }\n  \n  .content a:hover {\n    border-bottom-color: var(--accent-cyan);\n  }\n  \n  .content strong {\n    font-weight: 600;\n    color: var(--text-primary);\n  }\n  \n  .content em {\n    font-style: italic;\n  }\n  \n  .content hr {\n    border: none;\n    height: 1px;\n    background: var(--border-color);\n    margin: 3rem 0;\n  }\n  \n  /* Clinical Pearls */\n  .pearls-section {\n    margin-top: 4rem;\n    padding-top: 3rem;\n    border-top: 1px solid var(--border-color);\n  }\n  \n  .pearls-header {\n    display: flex;\n    align-items: center;\n    gap: 1rem;\n    margin-bottom: 2rem;\n  }\n  \n  .pearls-icon {\n    width: 48px;\n    height: 48px;\n    background: linear-gradient(135deg, var(--accent-amber), #fcd34d);\n    border-radius: 12px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    font-size: 1.5rem;\n  }\n  \n  .pearls-title {\n    font-family: 'Inter', sans-serif;\n    font-size: 1.25rem;\n    font-weight: 600;\n    color: var(--text-primary);\n  }\n  \n  .pearls-subtitle {\n    font-size: 0.75rem;\n    color: var(--accent-amber);\n    font-family: monospace;\n    letter-spacing: 0.1em;\n  }\n  \n  .pearl-card {\n    position: relative;\n    border-radius: 16px;\n    padding: 1.5rem;\n    padding-left: 2rem;\n    margin-bottom: 1rem;\n    overflow: hidden;\n  }\n  \n  .pearl-card::before {\n    content: '';\n    position: absolute;\n    left: 0;\n    top: 0;\n    bottom: 0;\n    width: 4px;\n  }\n  \n  .pearl-card.red-flag {\n    background: linear-gradient(135deg, rgba(244, 114, 182, 0.1), transparent);\n    border: 1px solid rgba(244, 114, 182, 0.2);\n  }\n  .pearl-card.red-flag::before { background: var(--accent-rose); }\n  \n  .pearl-card.exam-tip {\n    background: linear-gradient(135deg, rgba(42, 212, 212, 0.1), transparent);\n    border: 1px solid rgba(42, 212, 212, 0.2);\n  }\n  .pearl-card.exam-tip::before { background: var(--accent-cyan); }\n  \n  .pearl-card.gap-filler {\n    background: linear-gradient(135deg, rgba(167, 139, 250, 0.1), transparent);\n    border: 1px solid rgba(167, 139, 250, 0.2);\n  }\n  .pearl-card.gap-filler::before { background: var(--accent-purple); }\n  \n  .pearl-card.fact-check {\n    background: linear-gradient(135deg, rgba(240, 180, 41, 0.1), transparent);\n    border: 1px solid rgba(240, 180, 41, 0.2);\n  }\n  .pearl-card.fact-check::before { background: var(--accent-amber); }\n  \n  .pearl-label {\n    font-size: 0.65rem;\n    font-weight: 600;\n    letter-spacing: 0.15em;\n    text-transform: uppercase;\n    margin-bottom: 0.5rem;\n  }\n  \n  .pearl-card.red-flag .pearl-label { color: var(--accent-rose); }\n  .pearl-card.exam-tip .pearl-label { color: var(--accent-cyan); }\n  .pearl-card.gap-filler .pearl-label { color: var(--accent-purple); }\n  .pearl-card.fact-check .pearl-label { color: var(--accent-amber); }\n  \n  .pearl-content {\n    color: var(--text-secondary);\n    line-height: 1.7;\n  }\n  \n  /* Sources Section */\n  .sources-section {\n    margin-top: 4rem;\n    padding-top: 3rem;\n    border-top: 1px solid var(--border-color);\n  }\n  \n  .sources-header {\n    display: flex;\n    align-items: center;\n    gap: 1rem;\n    margin-bottom: 2rem;\n  }\n  \n  .sources-icon {\n    width: 48px;\n    height: 48px;\n    background: linear-gradient(135deg, var(--accent-teal), #5eead4);\n    border-radius: 12px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    font-size: 1.5rem;\n  }\n  \n  .source-link {\n    display: flex;\n    flex-direction: column;\n    padding: 1rem 1.25rem;\n    background: var(--bg-secondary);\n    border: 1px solid var(--border-color);\n    border-radius: 12px;\n    margin-bottom: 0.75rem;\n    text-decoration: none;\n    transition: all 0.2s;\n  }\n  \n  .source-link:hover {\n    border-color: var(--accent-cyan);\n    transform: translateY(-1px);\n    box-shadow: var(--shadow-glow);\n  }\n  \n  .source-title {\n    font-size: 0.9rem;\n    font-weight: 500;\n    color: var(--text-primary);\n    margin-bottom: 0.25rem;\n  }\n  \n  .source-url {\n    font-size: 0.75rem;\n    color: var(--text-muted);\n    font-family: monospace;\n  }\n  \n  /* Footer */\n  .footer {\n    margin-top: 6rem;\n    padding-top: 2rem;\n    border-top: 1px solid var(--border-color);\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    font-size: 0.7rem;\n    color: var(--text-muted);\n    font-family: monospace;\n    letter-spacing: 0.1em;\n    text-transform: uppercase;\n  }\n  \n  .footer-brand {\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n  }\n  \n  .footer-brand::before {\n    content: '';\n    width: 8px;\n    height: 8px;\n    background: var(--accent-cyan);\n    border-radius: 50%;\n  }\n  \n  /* Graph Section */\n  .graph-section {\n    margin-top: 4rem;\n    padding-top: 3rem;\n    border-top: 1px solid var(--border-color);\n  }\n  \n  .graph-embed {\n    background: var(--bg-tertiary);\n    border: 1px solid var(--border-color);\n    border-radius: 16px;\n    padding: 2rem;\n    text-align: center;\n    min-height: 400px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n  }\n  \n  .graph-embed svg {\n    max-width: 100%;\n    height: auto;\n  }\n\n    ${n}\n  </style>\n</head>\n<body>\n  <header class="header">\n    <div class="header-brand">Synapse Med Study Guide</div>\n    <h1>${Pl(e.title)}</h1>\n    <div class="header-meta">\n      <span> ${l}</span>\n      <span> ${e.graphData.nodes.length} nodes</span>\n      <span> ${e.graphData.links.length} connections</span>\n    </div>\n  </header>\n  \n  ${o}\n  ${s}\n  \n  <main class="content">\n    ${r}\n  </main>\n  \n  ${a}\n  ${i}\n  \n  <footer class="footer">\n    <div class="footer-brand">Synapse Med</div>\n    <div>Exported ${(new Date).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}</div>\n  </footer>\n</body>\n</html>`}async function Ol(e,t,n){n?.({stage:"preparing",progress:0,message:"Initializing export..."});const r=new(0,(await T(async()=>{const{default:e}=await import("./jszip.min-DiWZ7tmh.js").then(e=>e.j);return{default:e}},__vite__mapDeps([0,1,2]))).default),a=Rl(e.title),i=r.folder(a);if(!i)throw new Error("Failed to create ZIP folder");n?.({stage:"preparing",progress:10,message:"Preparing files..."});const o=`# ${e.title}\n\nExported from Synapse Med on ${(new Date).toLocaleDateString()}\n\n## Contents\n\n${t.includeMarkdown?"- `study-guide.md`  Portable Markdown version\n":""}${t.includeHtml?"- `study-guide.html`  Styled HTML (open in browser)\n":""}${t.includePdf?"- `study-guide.pdf`  Print-ready PDF\n":""}${t.includeGraph?"- `knowledge-graph.svg`  Visual graph export\n":""}${t.includeGraphData?"- `graph-data.json`  Raw graph data for integration\n":""}\n\n## Statistics\n- Nodes: ${e.graphData.nodes.length}\n- Connections: ${e.graphData.links.length}\n- Clinical Pearls: ${e.pearls?.length||0}\n- Verified Sources: ${e.sources?.length||0}\n\n---\n*Synapse Med  Your Neural Learning Companion*\n`;if(i.file("README.md",o),t.includeMarkdown){n?.({stage:"markdown",progress:20,message:"Generating Markdown..."});const t=jl(e);i.file("study-guide.md",t)}if(t.includeHtml){n?.({stage:"html",progress:35,message:"Generating HTML..."});const r=_l(e,t.theme);i.file("study-guide.html",r)}if(t.includePdf){n?.({stage:"pdf",progress:50,message:"Generating PDF..."});const r=await async function(e,t="print",n="high",r){r?.({stage:"pdf",progress:10,message:"Loading PDF library..."});const{jsPDF:a}=await T(async()=>{const{jsPDF:e}=await import("./vendor-export-UWB0VjdR.js").then(e=>e.j);return{jsPDF:e}},__vite__mapDeps([2,1]));r?.({stage:"pdf",progress:20,message:"Preparing content..."});const i=new a({orientation:"portrait",unit:"mm",format:"a4",compress:!0}),o=i.internal.pageSize.getWidth(),s=i.internal.pageSize.getHeight(),l=20,c=o-40;let u=l;const d="maximum"===n?11:"high"===n?10:9,p="maximum"===n?6:"high"===n?5:4.5,h="print"===t?{primary:"#000000",secondary:"#333333",accent:"#0077b6",muted:"#666666"}:"clinical"===t?{primary:"#1e293b",secondary:"#475569",accent:"#0891b2",muted:"#94a3b8"}:{primary:"#f0f2f5",secondary:"#9ca3af",accent:"#2ad4d4",muted:"#6b7280"},m=e=>u+e>s-l&&(i.addPage(),u=l,!0),f=e=>{const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:{r:0,g:0,b:0}};r?.({stage:"pdf",progress:30,message:"Rendering header..."}),i.setFontSize(8);const g=f(h.accent);i.setTextColor(g.r,g.g,g.b),i.text("SYNAPSE MED STUDY GUIDE",l,u),u+=8,i.setFontSize(24);const y=f(h.primary);i.setTextColor(y.r,y.g,y.b);const x=i.splitTextToSize(e.title,c);i.text(x,l,u),u+=10*x.length+5,i.setFontSize(8);const b=f(h.muted);i.setTextColor(b.r,b.g,b.b);const v=new Date(e.timestamp).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"});if(i.text(`${v}    ${e.graphData.nodes.length} nodes    ${e.graphData.links.length} connections`,l,u),u+=12,i.setDrawColor(f(h.muted).r,f(h.muted).g,f(h.muted).b),i.setLineWidth(.2),i.line(l,u,o-l,u),u+=10,r?.({stage:"pdf",progress:40,message:"Rendering summary..."}),e.summary){i.setFontSize(8),i.setTextColor(g.r,g.g,g.b),i.text("EXECUTIVE SUMMARY",l,u),u+=5,i.setFontSize(d);const t=f(h.secondary);i.setTextColor(t.r,t.g,t.b);const n=i.splitTextToSize(e.summary,c);m(n.length*p+10),i.text(n,l,u),u+=n.length*p+10}r?.({stage:"pdf",progress:50,message:"Rendering content..."});const w=function(e){let t=e;return t=t.replace(/^#{1,6}\s/gm,""),t=t.replace(/\*\*\*(.+?)\*\*\*/g,"$1"),t=t.replace(/\*\*(.+?)\*\*/g,"$1"),t=t.replace(/\*(.+?)\*/g,"$1"),t=t.replace(/_(.+?)_/g,"$1"),t=t.replace(/```[\s\S]*?```/g,""),t=t.replace(/`([^`]+)`/g,"$1"),t=t.replace(/\[([^\]]+)\]\([^)]+\)/g,"$1"),t=t.replace(/!\[([^\]]*)\]\([^)]+\)/g,""),t=t.replace(/^---$/gm,""),t=t.replace(/^\*\*\*$/gm,""),t=t.replace(/^>\s/gm,"  "),t=t.replace(/\n{3,}/g,"\n\n"),t.trim()}(e.markdownContent),N=i.splitTextToSize(w,c);i.setFontSize(d),i.setTextColor(y.r,y.g,y.b);for(let E=0;E<N.length;E+=50){const e=N.slice(E,E+50);m(e.length*p),i.text(e,l,u),u+=e.length*p;const t=50+Math.floor(E/N.length*30);r?.({stage:"pdf",progress:t,message:`Rendering content... ${Math.floor(E/N.length*100)}%`})}if(r?.({stage:"pdf",progress:85,message:"Rendering clinical pearls..."}),e.pearls&&e.pearls.length>0){m(30),u+=10,i.setFontSize(14),i.setTextColor(y.r,y.g,y.b),i.text("Clinical Pearls",l,u),u+=10;for(const t of e.pearls){m(20);const e=f({"red-flag":"#f472b6","exam-tip":"#2ad4d4","gap-filler":"#a78bfa","fact-check":"#f0b429"}[t.type]||h.accent);i.setFontSize(8),i.setTextColor(e.r,e.g,e.b);const n=t.type.split("-").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ").toUpperCase();i.text(n,l,u),u+=5,i.setFontSize(d),i.setTextColor(y.r,y.g,y.b);const r=i.splitTextToSize(t.content,c-5);m(r.length*p+5),i.text(r,23,u),u+=r.length*p+8}}return r?.({stage:"pdf",progress:95,message:"Finalizing..."}),i.setFontSize(7),i.setTextColor(b.r,b.g,b.b),i.text(`Generated by Synapse Med  ${(new Date).toLocaleDateString()}`,l,s-10),r?.({stage:"pdf",progress:100,message:"PDF complete!"}),i.output("blob")}(e,"obsidian"===t.theme?"print":t.theme,t.quality,n);i.file("study-guide.pdf",r)}if(t.includeGraph){n?.({stage:"graph",progress:80,message:"Generating graph visualization..."});const t=function(e){const t={1:{fill:"#06b6d4",stroke:"#0891b2",name:"Core Concept"},2:{fill:"#f43f5e",stroke:"#e11d48",name:"Pathology"},3:{fill:"#8b5cf6",stroke:"#7c3aed",name:"Medication"},4:{fill:"#14b8a6",stroke:"#0d9488",name:"Anatomy"},5:{fill:"#f59e0b",stroke:"#d97706",name:"Physiology"},6:{fill:"#3b82f6",stroke:"#2563eb",name:"Diagnostic"},7:{fill:"#f97316",stroke:"#ea580c",name:"Clinical Sign"}},n=e.nodes.map((t,n)=>{const r=n/e.nodes.length*2*Math.PI,a=200+150*Math.random();return{...t,x:600+Math.cos(r)*a,y:400+Math.sin(r)*a,radius:20+1.5*(t.val||10)}}),r=new Map(n.map(e=>[e.id,e]));return`<?xml version="1.0" encoding="UTF-8"?>\n<svg \n  xmlns="http://www.w3.org/2000/svg" \n  viewBox="0 0 1200 800"\n  width="1200"\n  height="800"\n  style="background: #0a0c0e;"\n>\n  <defs>\n    <marker id="arrow" viewBox="0 -5 10 10" refX="25" refY="0" markerWidth="5" markerHeight="5" orient="auto">\n      <path fill="#6b7280" d="M0,-5L10,0L0,5"/>\n    </marker>\n    <pattern id="grid" width="40" height="40" patternUnits="userSpaceOnUse">\n      <circle cx="1" cy="1" r="0.5" fill="rgba(255,255,255,0.05)"/>\n    </pattern>\n  </defs>\n  \n  <rect width="100%" height="100%" fill="url(#grid)"/>\n  \n  <g class="links">\n    ${e.links.map(e=>{const t=r.get("string"==typeof e.source?e.source:e.source.id),n=r.get("string"==typeof e.target?e.target:e.target.id);if(!t||!n)return"";const a=(t.x+n.x)/2,i=(t.y+n.y)/2,o=n.x-t.x,s=n.y-t.y,l=Math.sqrt(o*o+s*s),c=.1*l,u=a+-s/l*c,d=i+o/l*c;return`\n      <path \n        d="M${t.x},${t.y} Q${u},${d} ${n.x},${n.y}"\n        fill="none"\n        stroke="#4b5563"\n        stroke-width="1.5"\n        stroke-opacity="0.4"\n        marker-end="url(#arrow)"\n      />\n      <text\n        x="${u}"\n        y="${d-5}"\n        font-size="8"\n        fill="#6b7280"\n        text-anchor="middle"\n        font-family="Inter, sans-serif"\n      >${e.relationship}</text>\n    `}).join("")}\n  </g>\n  \n  <g class="nodes">\n    ${n.map(e=>{const n=t[e.group]||{fill:"#64748b",stroke:"#475569"};return`\n      <g transform="translate(${e.x}, ${e.y})">\n        <circle \n          r="${e.radius+4}"\n          fill="none"\n          stroke="${n.stroke}"\n          stroke-width="1"\n          stroke-opacity="0.3"\n          stroke-dasharray="4,4"\n        />\n        <circle \n          r="${e.radius}"\n          fill="${n.fill}"\n          stroke="${n.stroke}"\n          stroke-width="2"\n        />\n        <text\n          y="${e.radius+18}"\n          font-size="11"\n          fill="#e5e7eb"\n          text-anchor="middle"\n          font-family="Inter, sans-serif"\n          font-weight="500"\n        >${Pl(e.label)}</text>\n      </g>\n    `}).join("")}\n  </g>\n  \n  <g class="legend">\n    ${Object.entries(t).map(([e,t],n)=>`\n    <g transform="translate(20, ${20+25*n})">\n      <circle r="6" cx="6" cy="6" fill="${t.fill}" />\n      <text x="18" y="10" font-size="10" fill="#9ca3af" font-family="Inter, sans-serif">${t.name}</text>\n    </g>\n  `).join("")}\n  </g>\n  \n  <text x="1180" y="785" font-size="10" fill="#4b5563" text-anchor="end" font-family="monospace">\n    Synapse Med  Knowledge Graph\n  </text>\n</svg>`}(e.graphData);i.file("knowledge-graph.svg",t)}if(t.includeGraphData){n?.({stage:"graph",progress:85,message:"Exporting graph data..."});const t=JSON.stringify({title:e.title,exportedAt:(new Date).toISOString(),nodes:e.graphData.nodes,links:e.graphData.links},null,2);i.file("graph-data.json",t)}n?.({stage:"bundling",progress:90,message:"Creating ZIP archive..."});const s=await r.generateAsync({type:"blob",compression:"DEFLATE",compressionOptions:{level:6}},e=>{const t=90+Math.floor(e.percent/10);n?.({stage:"bundling",progress:t,message:`Compressing... ${Math.floor(e.percent)}%`})});return n?.({stage:"complete",progress:100,message:"Export complete!"}),s}function Pl(e){const t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"};return e.replace(/[&<>"']/g,e=>t[e])}function Rl(e){return e.replace(/[<>:"/\\|?*]/g,"-").replace(/\s+/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"").substring(0,100)||"export"}function Ml(e,t){const n=URL.createObjectURL(e),r=document.createElement("a");r.href=n,r.download=t,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(n)}const Dl=[{id:"markdown",key:"includeMarkdown",label:"Markdown (.md)",description:"Plain text notes  works in Notion, Obsidian, or any text editor",hint:" Best for: Copying into your notes app or editing later",icon:Ce,color:"#14b8a6",recommended:!0},{id:"html",key:"includeHtml",label:"Web Page (.html)",description:"Beautiful formatted page  just double-click to open in browser",hint:" Best for: Reading, printing, or sharing with classmates",icon:Ie,color:"#f59e0b",recommended:!0},{id:"graphData",key:"includeGraphData",label:"Graph Data (.json)",description:"Knowledge map data for advanced use",hint:" For developers or data analysis tools",icon:we,color:"#06b6d4",recommended:!1}],Ll=[{id:"obsidian",label:"Obsidian",description:"Dark mode, atmospheric",preview:"bg-[#0a0c0e]",textPreview:"text-gray-100"},{id:"clinical",label:"Clinical",description:"Light mode, professional",preview:"bg-gray-50",textPreview:"text-gray-900"},{id:"print",label:"Print",description:"Optimized for printing",preview:"bg-white",textPreview:"text-black"}],Ul=({note:t,isOpen:n,onClose:r})=>{const[a,i]=I.useState({includeMarkdown:!0,includeHtml:!0,includePdf:!1,includeGraph:!1,includeGraphData:!1,theme:"obsidian",quality:"high"}),[o,s]=I.useState(null),[l,c]=I.useState(!1),[u,d]=I.useState(null),[p,h]=I.useState(null),m=I.useMemo(()=>[a.includeMarkdown,a.includeHtml,a.includePdf,a.includeGraph,a.includeGraphData].filter(Boolean).length,[a]),f=m>0&&!l,g=I.useCallback(e=>{i(t=>({...t,[e]:!t[e]}))},[]),y=I.useCallback(e=>{s(e)},[]),x=I.useCallback(async()=>{if(f){c(!0),d(null),s({stage:"preparing",progress:0,message:"Starting export..."});try{await async function(e,t,n){Ml(await Ol(e,t,n),`${Rl(e.title)}-export.zip`)}(t,a,y),s({stage:"complete",progress:100,message:"Export complete!"}),setTimeout(()=>{c(!1),s(null),r()},1500)}catch(e){d(e.message||"Export failed. Please try again."),c(!1),s(null)}}},[t,a,f,y,r]),b=I.useCallback(async e=>{h(e),d(null);try{"markdown"===e?await async function(e){const t=jl(e);Ml(new Blob([t],{type:"text/markdown"}),`${Rl(e.title)}.md`)}(t):"html"===e&&await async function(e,t="obsidian"){const n=_l(e,t);Ml(new Blob([n],{type:"text/html"}),`${Rl(e.title)}.html`)}(t,a.theme),h(null)}catch(n){d(n.message||"Export failed. Please try again."),h(null)}},[t,a.theme]);return n?e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center px-4 bg-black/80 backdrop-blur-xl animate-fadeIn",children:[e.jsxs("div",{className:"relative bg-gradient-to-b from-bio-deep to-bio-void border border-white/[0.06] rounded-3xl shadow-2xl w-full max-w-2xl transform animate-scaleIn overflow-hidden max-h-[90vh] flex flex-col",children:[e.jsx("div",{className:"absolute -top-40 -right-40 w-80 h-80 bg-vital-cyan/10 rounded-full blur-[120px] pointer-events-none"}),e.jsx("div",{className:"absolute -bottom-32 -left-32 w-64 h-64 bg-neural-purple/10 rounded-full blur-[100px] pointer-events-none"}),e.jsx("div",{className:"absolute top-0 left-1/2 -translate-x-1/2 w-48 h-px bg-gradient-to-r from-transparent via-vital-cyan/50 to-transparent"}),e.jsxs("div",{className:"relative px-8 pt-8 pb-6 border-b border-white/[0.04]",children:[e.jsx("button",{onClick:r,disabled:l,className:"absolute top-6 right-6 p-2 rounded-xl text-gray-500 hover:text-white hover:bg-white/5 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(xt,{size:20})}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-14 h-14 rounded-2xl bg-gradient-to-br from-vital-cyan/15 to-clinical-teal/10 border border-vital-cyan/20 flex items-center justify-center",children:e.jsx(Ve,{size:24,className:"text-vital-cyan"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-serif italic text-serum-white",children:"Export Study Guide"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1 font-sans",children:t.title})]})]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto px-8 py-6 custom-scrollbar",children:[u&&e.jsxs("div",{className:"mb-6 p-4 rounded-xl bg-tissue-rose/10 border border-tissue-rose/20 flex items-start gap-3 animate-fadeIn",children:[e.jsx(se,{size:18,className:"text-tissue-rose shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-tissue-rose font-medium",children:"Export Error"}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:u})]})]}),l&&o&&e.jsxs("div",{className:"mb-6 p-6 rounded-2xl glass-slide border border-white/[0.06] animate-fadeIn",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx(ze,{size:20,className:"text-vital-cyan animate-spin"}),e.jsx("div",{className:"absolute inset-0 w-5 h-5 rounded-full bg-vital-cyan/20 animate-ping"})]}),e.jsx("span",{className:"text-sm font-medium text-gray-200",children:o.message})]}),e.jsxs("span",{className:"text-xs font-mono text-vital-cyan",children:[o.progress,"%"]})]}),e.jsx("div",{className:"h-2 bg-white/[0.05] rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-vital-cyan to-clinical-teal rounded-full transition-all duration-300 ease-out relative",style:{width:`${o.progress}%`},children:e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/30 to-transparent animate-shimmer"})})}),e.jsx("div",{className:"flex justify-between mt-4 text-[10px] font-mono text-gray-500 uppercase tracking-wider",children:["preparing","markdown","html","pdf","graph","bundling","complete"].map(t=>e.jsx("span",{className:"transition-colors "+(o.stage===t?"text-vital-cyan":o.progress>0&&["preparing","markdown","html","pdf","graph","bundling","complete"].indexOf(t)<["preparing","markdown","html","pdf","graph","bundling","complete"].indexOf(o.stage)?"text-gray-400":""),children:"preparing"===t?"Prep":t},t))})]}),!l&&e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(vt,{size:14,className:"text-synapse-amber"}),e.jsx("span",{className:"text-xs font-sans font-semibold uppercase tracking-[0.15em] text-gray-400",children:"Quick Download"})]}),e.jsxs("p",{className:"text-[11px] text-gray-500 mb-4 leading-relaxed",children:["Not sure which to pick?"," ",e.jsx("span",{className:"text-vital-cyan",children:"HTML"})," is perfect for reading and printing.",e.jsx("span",{className:"text-teal-400",children:"Markdown"})," is great if you use Notion or Obsidian."]}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:[{id:"markdown",label:"Markdown",subtitle:"For notes apps",icon:Ce,color:"#14b8a6"},{id:"html",label:"Web Page",subtitle:"For reading",icon:Ie,color:"#f59e0b"}].map(t=>{const n=t.icon,r=p===t.id;return e.jsxs("button",{onClick:()=>b(t.id),disabled:!!p,className:`group relative p-5 rounded-xl border transition-all duration-300 ${r?"bg-white/[0.05] border-vital-cyan/30":"bg-white/[0.02] border-white/[0.06] hover:bg-white/[0.05] hover:border-white/[0.12]"} disabled:opacity-50`,children:[e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[r?e.jsx(ze,{size:22,className:"text-vital-cyan animate-spin"}):e.jsx(n,{size:22,style:{color:t.color}}),e.jsx("span",{className:"text-sm font-medium text-gray-200",children:t.label}),t.subtitle&&e.jsx("span",{className:"text-[10px] text-gray-500",children:t.subtitle})]}),e.jsx("div",{className:"absolute inset-0 rounded-xl opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none",style:{background:`radial-gradient(circle at center, ${t.color}08 0%, transparent 70%)`}})]},t.id)})})]}),!l&&e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ve,{size:14,className:"text-vital-cyan"}),e.jsx("span",{className:"text-xs font-sans font-semibold uppercase tracking-[0.15em] text-gray-400",children:"Bundle Contents"})]}),e.jsxs("span",{className:"text-xs font-mono text-gray-500",children:[m," selected"]})]}),e.jsx("div",{className:"space-y-2",children:Dl.map(t=>{const n=t.icon,r=a[t.key];return e.jsxs("button",{onClick:()=>g(t.key),className:"w-full flex items-center gap-4 p-4 rounded-xl border transition-all duration-300 "+(r?"bg-white/[0.04] border-white/[0.12]":"bg-white/[0.01] border-white/[0.04] hover:bg-white/[0.03] hover:border-white/[0.08]"),children:[e.jsx("div",{className:"w-5 h-5 rounded-md border-2 flex items-center justify-center transition-all duration-200 "+(r?"border-vital-cyan bg-vital-cyan":"border-gray-600"),children:r&&e.jsx(re,{size:12,className:"text-bio-void"})}),e.jsx("div",{className:"w-10 h-10 rounded-xl flex items-center justify-center transition-all "+(r?"bg-white/[0.08]":"bg-white/[0.03]"),children:e.jsx(n,{size:18,style:{color:r?t.color:"#6b7280"}})}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium transition-colors "+(r?"text-gray-100":"text-gray-400"),children:t.label}),t.recommended&&e.jsx("span",{className:"text-[9px] font-mono px-1.5 py-0.5 rounded bg-vital-cyan/10 text-vital-cyan uppercase tracking-wider",children:"Best"})]}),e.jsx("span",{className:"text-xs text-gray-500",children:t.description}),t.hint&&e.jsx("span",{className:"block text-[10px] text-gray-600 mt-1",children:t.hint})]}),e.jsx(ie,{size:16,className:"text-gray-600 transition-transform "+(r?"rotate-90":"")})]},t.id)})})]}),!l&&(a.includeHtml||a.includePdf)&&e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(Ye,{size:14,className:"text-neural-purple"}),e.jsx("span",{className:"text-xs font-sans font-semibold uppercase tracking-[0.15em] text-gray-400",children:"Appearance"})]}),e.jsx("div",{children:e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-mono text-gray-500 uppercase tracking-wider mb-2 block",children:"HTML Theme (for Web Page export)"}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:Ll.map(t=>e.jsxs("button",{onClick:()=>i(e=>({...e,theme:t.id})),className:"flex items-center gap-3 p-3 rounded-lg border transition-all "+(a.theme===t.id?"bg-white/[0.05] border-vital-cyan/30":"bg-white/[0.02] border-white/[0.04] hover:bg-white/[0.04]"),children:[e.jsx("div",{className:`w-6 h-6 rounded-md ${t.preview} border border-white/10`}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"text-xs font-medium text-gray-200",children:t.label}),e.jsx("div",{className:"text-[10px] text-gray-500",children:t.description})]})]},t.id))})]})})]}),!l&&e.jsxs("div",{className:"p-4 rounded-xl bg-white/[0.02] border border-white/[0.04]",children:[e.jsxs("div",{className:"flex items-center justify-between text-[10px] font-mono text-gray-500 uppercase tracking-wider",children:[e.jsx("span",{children:"Your Study Guide"}),e.jsxs("span",{children:[t.graphData.nodes.length," concepts mapped"]})]}),e.jsxs("div",{className:"mt-3 flex gap-4 text-xs text-gray-400",children:[e.jsxs("span",{children:[" ",t.pearls?.length||0," clinical pearls"]}),e.jsxs("span",{children:[" ",t.sources?.length||0," references"]}),e.jsxs("span",{children:[" ~",Math.ceil(t.markdownContent.length/3e3)," pages"]})]})]}),!l&&e.jsxs("div",{className:"mt-4 p-4 rounded-xl bg-vital-cyan/5 border border-vital-cyan/10 flex items-start gap-3",children:[e.jsx(Pe,{size:16,className:"text-vital-cyan shrink-0 mt-0.5"}),e.jsxs("div",{className:"text-[11px] text-gray-400 leading-relaxed",children:[e.jsx("span",{className:"text-vital-cyan font-medium",children:"Pro tip:"})," ","Export as Web Page (.html) and save it anywhere on your computer. Double-click to open it in your browser  works offline, no internet needed! Perfect for exam prep."]})]})]}),e.jsx("div",{className:"relative px-8 py-6 border-t border-white/[0.04] bg-black/20",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("button",{onClick:r,disabled:l,className:"px-5 py-3 rounded-xl text-sm font-medium text-gray-400 hover:text-white hover:bg-white/[0.05] transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),e.jsx("button",{onClick:x,disabled:!f,className:"flex items-center gap-3 px-6 py-3 rounded-xl font-semibold text-sm transition-all duration-300 "+(f?"bg-vital-cyan text-bio-void hover:shadow-[0_0_40px_rgba(42,212,212,0.3)] hover:scale-[1.02]":"bg-white/[0.03] text-gray-500 cursor-not-allowed"),children:l?e.jsxs(e.Fragment,{children:[e.jsx(ze,{size:16,className:"animate-spin"}),"Exporting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ge,{size:16}),"Export as ZIP"]})})]})})]}),e.jsx("style",{children:"\n        @keyframes fadeIn {\n          from { opacity: 0; }\n          to { opacity: 1; }\n        }\n        \n        @keyframes scaleIn {\n          from { \n            opacity: 0; \n            transform: scale(0.95) translateY(10px); \n          }\n          to { \n            opacity: 1; \n            transform: scale(1) translateY(0); \n          }\n        }\n        \n        @keyframes shimmer {\n          0% { transform: translateX(-100%); }\n          100% { transform: translateX(100%); }\n        }\n        \n        .animate-fadeIn {\n          animation: fadeIn 0.3s ease-out;\n        }\n        \n        .animate-scaleIn {\n          animation: scaleIn 0.4s cubic-bezier(0.16, 1, 0.3, 1);\n        }\n        \n        .animate-shimmer {\n          animation: shimmer 2s infinite;\n        }\n      "})]}):null},zl=e=>e.replace(/([A-Z])/g," $1").replace(/[_-]/g," ").replace(/^\w/,e=>e.toUpperCase()).trim();function Fl(e){if(!Array.isArray(e)||0===e.length)return"";const t=new Set;if(e.forEach(e=>{"object"==typeof e&&null!==e&&Object.keys(e).forEach(e=>t.add(e))}),0===t.size)return"";const n=Array.from(t),r=n.map(zl);return`\n${`| ${r.join(" | ")} |`}\n${`| ${r.map(()=>"---").join(" | ")} |`}\n${e.map(e=>`| ${n.map(t=>(e=>{if(null==e)return"-";let t="";return t=Array.isArray(e)?e.join(", "):"object"==typeof e?Object.values(e).join(" "):String(e),t.replace(/\|/g,"&#124;").replace(/\r?\n/g,"<br/>").trim()})(e[t])).join(" | ")} |`).join("\n")}\n`}class Gl extends Error{constructor(e,t){super(e),this.code=t,this.name="ApiKeyError"}}class ql{constructor(){}async getClient(){const e=await cl.getApiKey();if(!e)throw new Gl("No API Key found. Please add your Google Gemini API key in Settings.","MISSING");if(!e.startsWith("AIza"))throw new Gl("Invalid API Key format. Google Gemini API keys start with 'AIza'.","INVALID");if(e.length<35)throw new Gl("API Key appears to be incomplete. Please check and re-enter your key.","INVALID");return new Ds({apiKey:e})}async validateApiKey(e){try{const t=e||await cl.getApiKey();if(!t)return{valid:!1,error:"No API key provided"};if(!t.startsWith("AIza"))return{valid:!1,error:"Invalid key format. Keys start with 'AIza'"};const n=new Ds({apiKey:t});await n.models.generateContent({model:"gemini-2.0-flash",contents:"Say 'OK' if you can read this.",config:{maxOutputTokens:5}});return{valid:!0}}catch(t){return t.message?.includes("API_KEY_INVALID")||t.message?.includes("invalid")?{valid:!1,error:"Invalid API key. Please check and re-enter."}:t.message?.includes("quota")||t.message?.includes("RESOURCE_EXHAUSTED")?{valid:!1,error:"API quota exceeded. Wait or check your Google AI Studio limits."}:t.message?.includes("permission")||t.message?.includes("403")?{valid:!1,error:"API key doesn't have permission. Enable the Gemini API in Google AI Studio."}:{valid:!1,error:t.message||"Unknown error validating key"}}}handleApiError(e){const t=e.message||String(e);if(t.includes("RESOURCE_EXHAUSTED")||t.includes("quota"))throw new Gl("API quota exceeded. Google's free tier has limits. Wait a bit or upgrade your plan at aistudio.google.com.","QUOTA_EXCEEDED");if(t.includes("RATE_LIMIT")||t.includes("429"))throw new Gl("Rate limit hit. Please wait a moment and try again. Free tier: 15 requests/minute.","QUOTA_EXCEEDED");if(t.includes("API_KEY_INVALID")||t.includes("invalid")||t.includes("401"))throw new Gl("Your API key is invalid or expired. Please check and update it in Settings.","INVALID");if(t.includes("403")||t.includes("permission"))throw new Gl("Permission denied. Make sure Gemini API is enabled for your key at aistudio.google.com.","INVALID");throw e}extractJson(e){const t=e.indexOf("{");if(-1===t)return{};let n=!1,r=!1,a=0,i=-1,o=-1;for(let l=t;l<e.length;l++){const t=e[l];if(n)r?r=!1:"\\"===t?r=!0:'"'===t&&(n=!1);else if("{"===t)-1===i&&(i=l),a++;else if("}"===t){if(a--,0===a&&-1!==i){o=l;break}}else'"'===t&&(n=!0,r=!1)}if(-1===i)return{};if(-1===o){let t=e.substring(i);for(n&&(t+='"');a>0;)t+="}",a--;const r=this.tryParseWithSanitization(t);return r&&Object.keys(r).length>0?r:{}}let s=e.substring(i,o+1);return this.tryParseWithSanitization(s)}tryParseWithSanitization(e){const t=e=>{try{return JSON.parse(e)}catch(t){return null}};let n=t(e);if(n)return n;let r=e.replace(/\\(?!["\\/bfnrtu])/g,"\\\\");return n=t(r),n||(r=r.replace(/,\s*([}\]])/g,"$1"),n=t(r),n||(r=r.replace(/\r?\n/g,"\\n"),n=t(r),n||(r=r.replace(/\u0000/g,""),n=t(r),n||(r=r.replace(/"[^"]*$/g,'"'),n=t(r),n||{}))))}async retryWithBackoff(e,t=3,n=1e3){let r;for(let i=0;i<=t;i++)try{return await e()}catch(a){if(r=a,i===t)throw a;const e=n*Math.pow(2,i);await new Promise(t=>setTimeout(t,e))}throw r}detectTruncation(e){if(!e||e.length<100)return{isTruncated:!1};const t=e.trim();if(t.length>8e4){const e=(t.match(/```/g)||[]).length%2!=0,n=t.split("\n"),r=n[n.length-1].trim(),a=r.length>10&&!r.endsWith(".")&&!r.endsWith("!")&&!r.endsWith("?")&&!r.endsWith(":")&&!r.startsWith("#");return e?{isTruncated:!0,lastSection:this.findLastSection(t)}:!a||r.includes("[")||r.includes("|")?{isTruncated:!1}:{isTruncated:!0,lastSection:this.findLastSection(t)}}const n=t.split("\n"),r=n[n.length-1],a=/[.!?:]\s*$/.test(t),i=/\|[^\n]*$/.test(t)&&!t.endsWith("|"),o=(t.match(/```/g)||[]).length%2!=0,s=/^\s*[-*]\s+/.test(r);if(!(!a||i||o||s&&!a))return{isTruncated:!1};const l=this.findLastSection(t);return{isTruncated:!0,lastSection:l,lastCompleteHeading:l}}findLastSection(e){const t=e.match(/^#{1,6}\s+.+$/gm);if(!t)return;return t[t.length-1].replace(/^#{1,6}\s+/,"").trim()}linkifyClinicalTerms(e,t){if(!t||0===t.length)return e;if(!e)return"";const n=new Map,r=[],a=e=>e.toLowerCase().replace(/-/g," ").trim();if(t.forEach(e=>{if(e.label&&e.label.length>=3){const t=a(e.label);if(n.has(t)||(n.set(t,e),r.push(e.label.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"))),e.id&&e.id.length>=3){const t=a(e.id);if(!n.has(t)){n.set(t,e);const a=e.id.replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/-/g,"[-\\s]");r.includes(a)||r.push(a)}}}}),0===r.length)return e;const i=r.sort((e,t)=>t.length-e.length).join("|"),o=e.split("\n");return o.map(e=>{const t=e.trim().startsWith("#"),r=new RegExp(t?"(\\[.+?\\]\\(.+?\\))|(\\[([^\\]]+)\\])":`(\\[.+?\\]\\(.+?\\))|(\\[([^\\]]+)\\])|\\b(${i})\\b`,"gi");return e.replace(r,(e,t,r,a,i)=>{if(t)return t;const o=(a||i||"").toString();if(!o)return e;const s=o.toLowerCase().replace(/-/g," ").trim(),l=n.get(s);return l?`[${o}](node:${l.id})`:a?o:e})}).join("\n")}processTablesInMarkdown(e){return function(e){return e?e.replace(/```json\s*([\s\S]*?)\s*```/g,(e,t)=>{try{let r;try{r=JSON.parse(t)}catch(n){const e=t.indexOf("["),a=t.lastIndexOf("]");if(e>-1&&a>-1){const n=t.substring(e,a+1);r=JSON.parse(n)}else{const e=t.indexOf("{"),n=t.lastIndexOf("}");if(e>-1&&n>-1){const a=t.substring(e,n+1),i=JSON.parse(a),o=Object.keys(i).find(e=>Array.isArray(i[e]));o&&(r=i[o])}}}let a=[];if(Array.isArray(r))a=r;else if("object"==typeof r&&null!==r){const e=Object.keys(r).find(e=>Array.isArray(r[e]));e&&(a=r[e])}return a.length>0?Fl(a):e}catch(n){return e}}):""}(e)}formatGenericTable(e){if(!e||0===e.length)return"";const t=new Set;e.forEach(e=>{"object"==typeof e&&null!==e&&Object.keys(e).forEach(e=>t.add(e))});const n=Array.from(t).map(e=>e.replace(/([A-Z])/g," $1").replace(/^./,e=>e.toUpperCase()).trim()),r=e.map(e=>Array.from(t).map(t=>{const n=e[t];if(null==n)return"-";if(Array.isArray(n))return n.join(", ");if("object"==typeof n){if(n.name)return String(n.name);if(n.value)return String(n.value);return Object.entries(n).slice(0,2).map(([e,t])=>`${e}: ${t}`).join("; ")}return String(n)}));return this.createMarkdownTable(n,r)}formatMedicationTable(e){if(!e||0===e.length)return"";const t=new Set;e.forEach(e=>{"object"==typeof e&&null!==e&&Object.keys(e).forEach(e=>t.add(e))});const n=["name","class","dose","mechanism","administration","monitoring","indication","adverse_effects","sideEffects","contraindications","reversal"],r=[],a=[];n.forEach(e=>{t.has(e)&&(a.push(e),r.push(e.replace(/([A-Z])/g," $1").replace(/^./,e=>e.toUpperCase()).trim()))}),t.forEach(e=>{n.includes(e)||(a.push(e),r.push(e.replace(/([A-Z])/g," $1").replace(/^./,e=>e.toUpperCase()).trim()))});const i=e.map(e=>a.map(t=>{const n=e[t];return null==n?"-":Array.isArray(n)?n.join(", "):"object"==typeof n?JSON.stringify(n):String(n)}));return this.createMarkdownTable(r,i)}formatDifferentialTable(e){if(!e||0===e.length)return"";const t=e.map(e=>[e.condition||"",e.distinguishingFeatures||e.features||"",e.keyTests||e.tests||""]);return this.createMarkdownTable(["Condition","Distinguishing Features","Key Tests"],t)}formatLabValuesTable(e){if(!e||0===e.length)return"";const t=e.map(e=>[e.test||e.name||"",e.normalRange||e.range||"",e.abnormalIn||e.abnormal||""]);return this.createMarkdownTable(["Test","Normal Range","Abnormal In"],t)}formatStageTable(e){if(!e||0===e.length)return"";const t=e.map(e=>[e.stage||e.name||"",e.criteria||"",e.management||e.treatment||""]);return this.createMarkdownTable(["Stage","Criteria","Management"],t)}createMarkdownTable(e,t){if(0===e.length||0===t.length)return"";return`${`| ${e.join(" | ")} |`}\n${`| ${e.map(()=>"---").join(" | ")} |`}\n${t.map(e=>`| ${e.join(" | ")} |`).join("\n")}`}async cacheNoteContext(e){await cl.getApiKey()}async generateMetadataAndGraph(e,t,n,r,a){await this.getClient();const i=[];for(const d of e){const e=d.base64.split(",")[1];i.push({inlineData:{mimeType:d.file.type,data:e}})}const o=(()=>{switch(a?.teachingStyle){case"Socratic":return["TEACHING STYLE: SOCRATIC METHOD","- Ask guiding questions throughout the content","- Encourage critical thinking by posing 'What if...' scenarios","- Build concepts through discovery rather than direct statements","- Include 'Think about this...' prompts before revealing answers"].join("\n");case"Concise":return["TEACHING STYLE: CONCISE & DIRECT","- Keep explanations brief and to the point","- Use bullet points and numbered lists heavily","- Avoid lengthy prose; prioritize high-yield facts","- Include quick-reference tables and mnemonics"].join("\n");case"Clinical-Cases":return["TEACHING STYLE: CASE-BASED LEARNING","- Present concepts through clinical scenarios","- Include patient presentations and differential diagnoses","- Connect pathophysiology to clinical decision-making"].join("\n");default:return["TEACHING STYLE: DETAILED & COMPREHENSIVE","- Provide thorough explanations with clinical context","- Include background information and mechanisms","- Use examples and analogies to reinforce concepts","- Build knowledge systematically from fundamentals"].join("\n")}})(),s=a?.specialties?.length?`SPECIALTY FOCUS: ${a.specialties.join(", ")} - emphasize connections to these fields.`:"",l=a?.learningGoals?`LEARNING OBJECTIVES: ${a.learningGoals}`:"",c=a?[""," USER CONTEXT (PERSONALIZE OUTPUT FOR THIS LEARNER)","",`- Name: ${a.name||"Learner"}`,`- Role: ${a.discipline} (${a.level})`,"",o,"",s,l,"","INSTRUCTIONAL ADJUSTMENTS:",`1. TONE: Act as a senior mentor to a ${a.level} in ${a.discipline}.`,"2. DEPTH: "+(a.level&&a.level.includes("Pre-clinical")?"Focus on core mechanisms and pathophysiology.":"Focus on clinical management, guidelines, and algorithms."),"3. FOCUS: Emphasize clinically relevant, practice-oriented content for this user's discipline.","4. RELEVANCE: If the user is Nursing/Allied Health, emphasize patient care and monitoring. If Medical, emphasize diagnosis and treatment.","",""].filter(Boolean).join("\n"):"",u=["You are Synapse Med, a Principal Medical Educator serving ALL healthcare disciplines:","- MBBS/MD students preparing for board exams (USMLE, NEET-PG, PLAB)","- Nursing students (BSN, MSN, NCLEX prep)","- Physiotherapy/Physical Therapy students (DPT, MPT)","- Physician Assistant and Allied Health learners","- Specialty residents (Internal Medicine, Surgery, Pediatrics, etc.)","","YOUR TASK: Generate METADATA and KNOWLEDGE GRAPH as JSON ONLY."," DO NOT generate any markdown content - that comes in Phase 2 (separate API call).",""," UNIVERSAL MISSION: CLOSE THE KNOWLEDGE GAP","1. EXTRACT what the provided material DOES cover","2. IDENTIFY what's MISSING but essential for clinical practice/exams","3. FILL those gaps using Google Search (cite everything)","4. CREATE a complete, interconnected knowledge constellation","","","KNOWLEDGE GRAPH - CLINICAL CONSTELLATION (15-35 NODES)","",""," HIERARCHICAL ARCHITECTURE:","","HUB NODE (1 node, Group 1, val: 20):","  - The central topic/condition/system","  - Example: 'Congestive Heart Failure', 'Respiratory System', 'Diabetes Mellitus'","","INNER RING - CORE MECHANISMS (3-6 nodes, Groups 1 & 5):","  Group 1: Pathophysiological mechanisms (val: 16-18)","    - e.g., 'Virchow's Triad', 'Frank-Starling Mechanism'","  Group 5: Physiological processes (val: 14-17)","    - e.g., 'Cardiac Output Regulation', 'Gas Exchange'","","MIDDLE RING - CLINICAL MANIFESTATIONS (6-10 nodes, Groups 2, 4, 7):","  Group 2: Pathology/Diseases/Complications (val: 12-16)","    - e.g., 'Pulmonary Edema', 'Myocardial Infarction'","  Group 4: Anatomical structures (val: 10-14)","    - e.g., 'Left Ventricle', 'Alveolar Membrane'","  Group 7: Clinical Signs & Symptoms (val: 11-15)","    - e.g., 'Orthopnea', 'Jugular Venous Distension'","","OUTER RING - DIAGNOSTICS & MANAGEMENT (5-12 nodes, Groups 3 & 6):","  Group 3: Pharmacology/Treatments (val: 10-14)","    - e.g., 'Furosemide', 'ACE Inhibitors', 'Physical Therapy Protocol'","  Group 6: Diagnostic Tools (val: 9-13)","    - e.g., 'Echocardiography', 'BNP Levels', 'Chest X-Ray'","","GROUP DEFINITIONS (Choose appropriate groups for your domain):","  Group 1 ( Cyan): Core concepts, mechanisms, main topic","  Group 2 ( Rose): Pathology, diseases, complications, disorders","  Group 3 ( Purple): Pharmacology, treatments, interventions, therapies","  Group 4 ( Teal): Anatomy, structures, organs, systems","  Group 5 ( Amber): Physiology, normal processes, homeostasis","  Group 6 ( Blue): Diagnostics, tests, imaging, assessments","  Group 7 ( Orange): Clinical signs, symptoms, presentations","","NODE REQUIREMENTS (Generate 25-50 nodes for COMPREHENSIVE coverage):",""," CRITICAL: Generate nodes for ALL clinical terms you plan to use in brackets!","   - Include ALL related conditions, differentials, and complications","   - Include ALL diagnostic tests, imaging modalities, and clinical signs","   - Include ALL treatments, drugs, and interventions mentioned","   - Include ALL anatomical structures and pathophysiological mechanisms","   - If you will write [Cervical Myelopathy] in Phase 2, create a 'cervical-myelopathy' node HERE","","  - id: kebab-case, descriptive (e.g., 'left-ventricular-failure')","  - label: Title case, clinical term (e.g., 'Left Ventricular Failure')","  - group: 1-7 based on node type","  - val: 8-20 (20=hub, 16-18=inner, 12-16=middle, 8-14=outer)","  - description: ONE clinical sentence (max 15 words)","  - details: 3-6 RICH paragraphs in MARKDOWN:","    * Paragraph 1: Definition & Clinical Significance","    * Paragraph 2: Pathophysiology/Mechanism (if applicable)","    * Paragraph 3: Clinical Presentation & Exam Findings","    * Paragraph 4: Diagnostic Approach","    * Paragraph 5: Management & Prognosis","    * Paragraph 6: High-Yield Clinical Pearl","    Use **bold** for key terms, *italics* for clinical nuance","    Include specific values (e.g., 'EF <40%', 'HR >100 bpm')","  - synonyms: Array of alternative terms (e.g., ['MI', 'Heart Attack'])","  - clinicalPearl: One-sentence high-yield exam/clinical tip","  - differentials: Related conditions (for pathology nodes)","","LINK REQUIREMENTS (Create 30-70 connections):",""," WEB STRUCTURE (Not a tree!):","  1. Hub-to-Inner: Central topic  all mechanisms/physiology","  2. Inner-to-Middle: Mechanisms  pathology/anatomy/signs","  3. Middle-to-Outer: Conditions  diagnostics/treatments","  4. Cross-Ring: Related concepts across all levels","  5. Bidirectional: Drug  Mechanism, Sign  Pathology","","RELATIONSHIP VERBS (Precise clinical language):","  Causation: 'causes', 'leads to', 'results in', 'precipitates'","  Prevention: 'prevents', 'inhibits', 'blocks', 'reduces'","  Location: 'occurs in', 'affects', 'localizes to', 'involves'","  Mechanism: 'activates', 'suppresses', 'modulates', 'regulates'","  Clinical: 'manifests as', 'presents with', 'diagnosed by', 'treated with'","  Physiology: 'increases', 'decreases', 'maintains', 'impairs'","","","CLINICAL PEARLS - EXAM-FOCUSED INSIGHTS (6-10 pearls)","","","Generate pearls across these types:","  - 'gap-filler': Info NOT in source but essential for practice/exams","  - 'exam-tip': Board exam question patterns, buzzwords","  - 'red-flag': Critical don't-miss scenarios, emergencies","  - 'fact-check': Common misconceptions corrected with evidence","","","OUTPUT FORMAT: JSON ONLY (No markdown content)","","","{",'  "title": "Topic Title",','  "summary": "2-3 sentence clinical abstract",','  "eli5Analogy": "Simple analogy for complex concept",','  "pearls": [{ "type": "gap-filler|exam-tip|red-flag|fact-check", "content": "...", "citation": "..." }],','  "graphNodes": [',"    {",'      "id": "node-id",','      "label": "Node Label",','      "group": 1-7,','      "val": 8-20,','      "description": "One sentence",','      "details": "**Rich markdown** with *formatting*...",','      "synonyms": ["Alt1", "Alt2"],','      "clinicalPearl": "High-yield tip",','      "differentials": ["Condition A", "Condition B"]',"    }","  ],",'  "graphLinks": [','    { "source": "id1", "target": "id2", "relationship": "causes" }',"  ]","}",""," PHASE 1 OUTPUT: JSON ONLY - Markdown guide will be generated in Phase 2."].join("\n");return i.push({text:`Analyze "${t}" from the uploaded lecture material.\n\nYOUR MISSION:\n1. EXTRACT what the lecture covers\n2. IDENTIFY GAPS - what's missing that students need for exams?\n3. FILL GAPS using Google Search\n4. BUILD a comprehensive knowledge graph with 25-50 nodes\n\n CRITICAL FOR PHASE 2 SUCCESS:\nGenerate nodes for EVERY clinical term you might want to highlight, including:\n- All related conditions and differentials (e.g., Cervical Myelopathy, Cervical Radiculopathy)\n- All diagnostic tests and imaging modalities (e.g., MRI, CT, X-ray findings)\n- All clinical signs and symptoms (e.g., Neurological Symptoms, Muscle Weakness)\n- All anatomical structures mentioned (e.g., Intervertebral Discs, Spinal Cord)\n- All treatments and interventions (e.g., Physical Therapy, Cervical Traction)\n\n In Phase 2, only terms with nodes can become clickable smart links.\n   If you don't create a node for "Cervical Myelopathy" here, it can't be linked in Phase 2!\n\nOutput: JSON ONLY (metadata + graph structure)\n DO NOT generate markdown content - that will be done in a separate Phase 2 API call.`}),this.retryWithBackoff(async()=>{const e=await this.getClient();let a="",o=[],s="extracting",l=!1,d=!1;r&&r("extracting");const p=c?c+"\n\n"+u:u;try{const c=await e.models.generateContentStream({model:"gemini-2.5-flash",contents:{parts:i},config:{tools:[{googleSearch:{}}],systemInstruction:p,temperature:.3,thinkingConfig:{thinkingBudget:12288,includeThoughts:!0}}});for await(const e of c){if(e.candidates?.[0]?.content?.parts)for(const t of e.candidates[0].content.parts){const e=t;if(!0===e.thought){const t=e.text||"";if(t&&t.trim()){o.push(t),n&&n(t);const e=t.toLowerCase();!l&&(e.includes("search")||e.includes("google")||e.includes("verify")||e.includes("cross-reference")||e.includes("looking up"))&&(l=!0,"extracting"===s&&(s="verifying",r&&r("verifying"))),!d&&(e.includes("graph")||e.includes("node")||e.includes("link")||e.includes("constellation")||e.includes("json"))&&(d=!0,"graphing"!==s&&(s="graphing",r&&r("graphing")))}}else t.text&&!e.thought&&(a+=t.text,!d&&a.includes('"graphNodes"')&&(d=!0,s="graphing",r&&r("graphing")))}e.candidates?.[0]?.groundingMetadata&&!l&&(l=!0,"extracting"===s&&(s="verifying",r&&r("verifying")))}const u=this.extractJson(a||"{}");if(!u||"object"!=typeof u)throw new Error("Phase 1 failed: Invalid JSON response structure");if(u.title||(u.title=t),!u.graphNodes||!Array.isArray(u.graphNodes))throw new Error("Phase 1 failed: No knowledge graph nodes generated");const h=new Set(u.graphNodes.map(e=>e.id)),m=(u.graphLinks||[]).filter(e=>h.has(e.source)&&h.has(e.target)).map(e=>({source:e.source,target:e.target,relationship:e.relationship||e.label||"relates to"}));return{title:u.title||t,summary:u.summary||"",eli5Analogy:u.eli5Analogy,pearls:(u.pearls||[]).map(e=>({type:e.type,content:e.content,citation:e.citation})),graphNodes:u.graphNodes||[],graphLinks:m}}catch(h){this.handleApiError(h)}},3,1e3)}async generateMarkdownStreaming(e,t,n,r,a,i,o,s,l){const c=[];for(const f of e){const e=f.base64.split(",")[1];c.push({inlineData:{mimeType:f.file.type,data:e}})}const u=s?[""," PHASE 2: Master Guide Generation (MARKDOWN ONLY)","",""," SPEED OPTIMIZATION: Focus on comprehensive clinical content","   - You have FULL 64K output token budget for markdown","   - All uploaded files have been RE-SENT to you (full context)","   - Phase 1 metadata is provided below (don't regenerate it)","   -  Google Search is ENABLED - use it to fill gaps and CITE sources",""," YOUR EXCLUSIVE MISSION (Phase 2):","Generate a comprehensive, board-exam-ready MARKDOWN study guide that:","    Uses clinical terms from Phase 1 knowledge graph (auto-linked by client)","    **CITES authoritative sources inline throughout the text**","    Fills knowledge gaps not covered in uploaded materials using Google Search","    Follows the 9+ section structure (dynamic based on complexity)","    Uses JSON code blocks for tables (medications, differentials, etc.)",""," INLINE CITATION REQUIREMENTS (MANDATORY):","   When adding information from Google Search or external knowledge:","   ","    ALWAYS cite authoritative sources inline like this:","      - 'According to the American Heart Association, [information]...'","      - '...with an annual incidence of 1-2 per 1,000 people [CDC, 2023]'","      - 'The Mayo Clinic guidelines recommend [treatment]...'","      - 'Recent studies from Johns Hopkins indicate [finding]...'","      - '...as reported by the National Institutes of Health'","   ","    Mention source domains naturally:","      - American College of Cardiology (acc.org)","      - Centers for Disease Control (cdc.gov)","      - Mayo Clinic (mayoclinic.org)","      - National Institutes of Health (nih.gov)","      - UpToDate, Medscape, PubMed studies","   ","    For uploaded content, use: [Uploaded: Page X]","    For statistics/data, cite the source: '...affecting 1M people annually [WHO]'","   ","    DO NOT write generic statements without attribution","    DO NOT rely solely on uploaded material - actively search for gaps",""," CRITICAL: DO NOT REGENERATE Phase 1 Content ","    ABSOLUTELY NO 'Clinical Pearls' section in your markdown","    NO pearl boxes (exam-tip, gap-filler, red-flag, fact-check) ANYWHERE","    NO pearls at the END of your guide (extremely common mistake - FORBIDDEN)","    NO 'References' or 'Sources' section (auto-extracted from citations)","    NO title regeneration (use Phase 1 title provided below)","    NO ELI5 boxes (Phase 1 analogy shown separately)",""," TRIPLE WARNING: After your last section, STOP WRITING IMMEDIATELY ","   Common AI mistake: Adding exam-tip/gap-filler/red-flag/fact-check at the end","   If you add ANY pearls after your final section, the output will be REJECTED.",""," Your markdown will be COMBINED with Phase 1 metadata by the client:","   - Clinical pearls appear in dedicated UI section","   - Verified sources extracted from grounding metadata","   - Smart links auto-created from your clinical term usage","",` KNOWLEDGE GRAPH: ${n.length} nodes generated in Phase 1`,""," CRITICAL SMART LINKING RULES (READ CAREFULLY) ",""," FORBIDDEN: Using brackets for terms NOT in this list!","    If a term is NOT listed below, DO NOT put it in [brackets]","    Brackets are ONLY for terms that exist in the knowledge graph","    Writing [Random Term] when 'Random Term' is not a node = BROKEN LINK",""," CORRECT: Use brackets ONLY for these exact labels:",...n.slice(0,100).map((e,t)=>`  ${t+1}.  [${e.label}]`),n.length>100?`  ... and ${n.length-100} more nodes available`:"",""," SMART LINKING STRATEGY:","1. SCAN the list above before writing each section","2. ONLY use [brackets] for terms that EXACTLY match a label above","3. For terms NOT in the list, write them as plain text (no brackets)","4. Client auto-converts [Label]  clickable link ONLY if Label exists in graph","","Example:","    If 'Cervical Lordosis' is in list: Write [Cervical Lordosis]","    If 'Random Syndrome' is NOT in list: Write 'Random Syndrome' (no brackets)",""].filter(Boolean).join("\n"):"",[d,p]=(()=>{switch(l?.teachingStyle){case"Socratic":return[3e3,4500];case"Concise":return[2e3,3e3];case"Detailed":return[5e3,8e3];case"Clinical-Cases":return[4500,7e3];default:return[4e3,6e3]}})(),h=["You are Synapse Med, a Principal Medical Educator serving ALL healthcare disciplines:","- MBBS/MD students preparing for board exams (USMLE, NEET-PG, PLAB)","- Nursing students (BSN, MSN, NCLEX prep)","- Physiotherapy/Physical Therapy students (DPT, MPT)","- Physician Assistant and Allied Health learners","- Specialty residents (Internal Medicine, Surgery, Pediatrics, Pharmacy, etc.)","","YOUR TASK: Generate a COMPREHENSIVE, BOARD-EXAM FOCUSED MARKDOWN STUDY GUIDE.",""," CRITICAL ARCHITECTURE: Two-Phase System","   - PHASE 1 (completed): Metadata + Knowledge Graph (JSON, separate API call)","   - PHASE 2 (current): Master Guide Generation (Markdown, this API call)","   - Clinical Pearls were ALREADY generated in Phase 1","   - You have FULL ACCESS to original uploaded files (re-sent for this phase)","   - Use your FULL 64K output token budget for comprehensive markdown","   - Generate 5000-8000 words of detailed, clinically rich material","   - Maintain COHERENCE with Phase 1 metadata (title, summary, pearls)","",u,""," UNIVERSAL MISSION: CLOSE THE KNOWLEDGE GAP","Lectures and textbooks often leave critical gaps. Your mission:","1. EXTRACT what the uploaded lecture/material DOES cover","    Cite as [Uploaded: Page X] or [Lecture: Slide Y]","2. IDENTIFY what's MISSING but essential for exams/clinical practice","    Use diagnostic criteria, treatment values, clinical algorithms, etc.","3. FILL GAPS using Google Search (REQUIRED - not optional)","    Cite ALL external sources with proper URLs","4. CREATE board-exam focused, comprehensive content","    Include high-yield facts, clinical pearls embedded in text","5. NATURALLY INTEGRATE terms from Phase 1 knowledge graph","    Client will auto-link them to interactive graph nodes","","","GOOGLE SEARCH INTEGRATION - ACTIVE GAP FILLING (REQUIRED)","","","You have access to Google Search via the `googleSearch` tool.","USE IT ACTIVELY - this is NOT optional. Gap filling is MANDATORY.",""," WHEN TO SEARCH (Use for EVERY section):","   When uploaded material lacks specific numerical values (BP >140/90, EF <40%)","   When mechanism details are incomplete or superficial","   When treatment protocols need current evidence-based guidelines","   When epidemiological data is missing (prevalence, incidence, mortality)","   When differential diagnosis needs expansion beyond lecture notes","   When diagnostic criteria are incomplete (DSM-5, ICD-11, clinical scores)","   When prognostic data is absent (5-year survival, recurrence rates)",""," HOW TO SEARCH EFFECTIVELY:",`  1. Specific clinical queries: "${t} pathophysiology cellular mechanism"`,`  2. Current guidelines: "${t} ACC AHA ESC guidelines 2024"`,`  3. Diagnostic criteria: "${t} diagnostic criteria values DSM ICD"`,`  4. Evidence-based treatment: "${t} first-line treatment RCT meta-analysis"`,`  5. Epidemiology: "${t} prevalence incidence mortality demographics"`,`  6. Clinical scores: "${t} risk stratification calculator score"`,""," SEARCH RESULT VALIDATION (Filter rigorously):","   ACCEPT: PubMed, Cochrane, NEJM, JAMA, Lancet, BMJ","   ACCEPT: UpToDate, Mayo Clinic, Cleveland Clinic, Johns Hopkins","   ACCEPT: WHO, CDC, NIH, FDA, NHS, EMA official guidelines","   ACCEPT: ACC, AHA, ACP, AMA, ESC, ERS specialty society guidelines","   ACCEPT: NICE, SIGN, ATS, IDSA evidence-based recommendations","","   REJECT: Blog posts, health news sites, WebMD-style articles","   REJECT: Social media, forums, Reddit, Quora discussions","   REJECT: Commercial product pages, supplement sellers","   REJECT: Wikipedia, general encyclopedias (use as starting point only)","   REJECT: Sources older than 5 years (unless landmark studies)","   REJECT: Unrelated topics or vague search results","",""," PHASE 1: Metadata + Knowledge Graph Generation (JSON ONLY)","",""," SPEED OPTIMIZATION: This phase uses its OWN 64K token budget","   - Focus ONLY on structured metadata and graph","   - NO markdown content generation (that's Phase 2's job)","   - NO detailed explanations (save for Phase 2)","   - Output PURE JSON for fast parsing",""," YOUR EXCLUSIVE MISSION (Phase 1):","1. Extract/generate TITLE and concise SUMMARY (2-3 sentences)","2. Create ELI5 ANALOGY (one creative analogy for complex concept)","3. Generate 6-10 CLINICAL PEARLS (gap-fillers, exam-tips, red-flags, fact-checks)","4. Build KNOWLEDGE GRAPH with 25-50 nodes and their relationships",""," CRITICAL: DO NOT GENERATE:","    Markdown content or explanations (Phase 2 will do this)","    Detailed pathophysiology discussions (Phase 2 will do this)","    Treatment protocols or guidelines (Phase 2 will do this)","    Diagnostic algorithms (Phase 2 will do this)",""," Your output will be PASSED TO PHASE 2 which will:","   - Use your graph nodes for smart linking","   - Reference your pearls (so DON'T repeat them in markdown)","   - Use your title and summary as foundation","","","MARKDOWN STRUCTURE - COMPLETE CLINICAL GUIDE (DYNAMIC SECTIONS - 9+ AS NEEDED)","","","FOR DISEASE/CONDITION TOPICS (Adapt structure to domain):","","1. **Overview & Epidemiology**","   - Definition (1-2 sentences, board-exam level)","   - Prevalence, incidence (with numbers and demographics)","   - Mortality/morbidity statistics","   - Epidemiological trends (regional variations, age/sex predilection)","","2. **Pathophysiology**","   - Cellular and molecular mechanisms (detailed)","   - Affected organ systems and cascade of events","   - Biochemical pathways (with enzyme names, mediators)","   - Pathological changes (gross and microscopic if relevant)","","3. **Etiology & Risk Factors**","   - Genetic factors (specific genes, inheritance patterns)","   - Environmental exposures (chemicals, infections, lifestyle)","   - Modifiable vs. non-modifiable risk factors","   - Relative risk quantification when available","","4. **Clinical Presentation**","   - Cardinal signs and symptoms (with typical onset, duration)","   - Physical examination findings (inspection, palpation, auscultation)","   - Clinical variants (atypical presentations, special populations)","   - Natural history and disease progression","","5. **Diagnostic Workup**","   - Laboratory tests (specific values, sensitivity/specificity)","   - Imaging modalities (findings, when to order)","   - Diagnostic criteria (official guidelines - e.g., 'Revised Jones Criteria')","   - Diagnostic algorithms (step-by-step approach)","   - Differential diagnosis considerations","","6. **Differential Diagnosis**","   - Rule-out conditions (top 5-10 differentials)","   - Distinguishing clinical features (what sets them apart)","   - Key diagnostic tests to differentiate","   - Clinical decision rules when applicable","","7. **Management**","   - Initial stabilization (ABCs, emergency interventions)","   - Pharmacologic therapy:","     * First-line agents (drug names, doses, mechanisms)","     * Second-line options, combination therapy","     * Adverse effects, contraindications, monitoring","   - Non-pharmacologic interventions:","     * Lifestyle modifications, diet, exercise","     * Physical therapy, occupational therapy","     * Psychosocial support","   - Surgical/procedural options (indications, techniques)","   - Treatment algorithms (acute vs. chronic management)","","8. **Complications**","   - Short-term complications (hours to days)","   - Long-term complications (months to years)","   - Prevention strategies for common complications","   - Red flags indicating complications","","9. **Prognosis & Prevention**","   - Natural history without treatment","   - Outcomes with treatment (5-year survival, remission rates)","   - Prognostic factors (good vs. poor prognosis indicators)","   - Primary prevention (vaccines, lifestyle, screening)","   - Secondary prevention (preventing recurrence, complications)","   - Tertiary prevention (rehabilitation, quality of life)",""," DYNAMIC COMPREHENSIVE CONTENT - NO ARTIFICIAL SECTION LIMITS","   The sections above are the MINIMUM foundation.","   For complex clinical topics, ADD ADDITIONAL SECTIONS AS NEEDED:","","10. **Advanced Therapeutics** (if relevant)","    - Novel pharmacological agents, biologics, gene therapy","    - Emerging treatment modalities, clinical trials","    - Personalized medicine approaches","","11. **Special Populations** (if relevant)","    - Pediatric considerations (dosing, unique presentations)","    - Geriatric considerations (polypharmacy, altered pharmacokinetics)","    - Pregnancy and lactation (safety, teratogenicity)","    - Immunocompromised patients","","12. **Quality Metrics & Guidelines** (if relevant)","    - Current clinical practice guidelines (AHA, ACC, ESC, etc.)","    - Quality improvement measures","    - Screening recommendations (USPSTF ratings)","","13. **Case-Based Integration** (if helpful for learning)","    - Clinical vignettes demonstrating key concepts","    - Diagnostic reasoning workflows","    - Common exam question patterns",""," CRITICAL CONTENT RULES:","    Do NOT add 'Clinical Pearls' section (already in Phase 1 metadata)","    Do NOT add 'References' or 'Sources' section (extracted via grounding)","    DO generate as many sections as clinically necessary (10, 12, 15+ sections OK)","    DO end naturally when topic is comprehensively covered","    DO prioritize depth over breadth - better to cover fewer topics thoroughly","","","FORMATTING RULES - CLINICAL EXCELLENCE & BOARD EXAM FOCUS","","",""," UNIVERSAL TABLE RULE: JSON ARRAYS ONLY","",""," NEVER use Markdown tables (| col | col |). They break formatting."," ALWAYS use a JSON code block containing an ARRAY of objects.","","FORMAT:","```json","[",'  { "Column_Name_1": "Value", "Column_Name_2": "Value" },','  { "Column_Name_1": "Value", "Column_Name_2": "Value" }',"]","```","","RULES:","1. The JSON must be a **flat array** of objects.","2. Keys become column headers (e.g., 'Drug_Name', 'Dosage').","3. Values must be STRINGS (no nested objects/arrays).","4. If a value is a list, join it with commas (e.g., 'Nausea, Vomiting').","5. You can create a table for ANY data type (Meds, Labs, Differentials) using this format.","",""," CITATION & SOURCING REQUIREMENTS - ULTRA-RIGOROUS (MANDATORY)","",""," CITATION TARGETS:","   - Minimum 20-30 inline citations per guide","   - At least 1 citation per major section","   - 2-3 citations for key statistics/facts","   - Cite ALL quantitative claims (incidence, prevalence, mortality rates)",""," MANDATORY CITATION FORMAT:","   Organization/Journal Name, Year","   ","   Examples:","   - '...VTE affects 1-2 per 1,000 people annually CDC, 2023'","   - '...mortality rates of 2-10% European Society of Cardiology, 2019'","   - 'Factor V Leiden affects 3-8% of Caucasians Mayo Clinic, 2024'","   - 'According to American Heart Association, 2023, DAPT is recommended...'",""," AUTHORITATIVE SOURCES TO USE:","   Medical Organizations:","   - American Heart Association (AHA)","   - American College of Cardiology (ACC)","   - European Society of Cardiology (ESC)","   - American College of Chest Physicians (ACCP)","","   Government/Public Health:","   - Centers for Disease Control (CDC)","   - National Institutes of Health (NIH)","   - World Health Organization (WHO)","","   Clinical Resources:","   - Mayo Clinic","   - Cleveland Clinic","   - UpToDate","   - Medscape","","   Journals (when citing specific studies):","   - New England Journal of Medicine (NEJM)","   - The Lancet","   - JAMA","   - Circulation",""," CITATION QUALITY GUIDELINES:","   - Prefer organization guidelines over individual studies","   - Use 2023-2024 sources when possible (critical for board exams)","   - Diversify sources - AIM FOR 12+ UNIQUE SOURCES","   - For uploaded content: [Uploaded: Page X]",""," CRITICAL: CITATIONS MUST BE CLICKABLE MARKDOWN LINKS ","   Every citation MUST use this EXACT format:","    CORRECT: According to [Mayo Clinic, 2024](https://www.mayoclinic.org/...) the prevalence is...","    CORRECT: Studies show [Harrison et al., 2014](https://scholar.google.com/scholar?q=Harrison+cervical+lordosis+2014)...","    CORRECT: The mechanism involves [Cohen, 2015](https://pubmed.ncbi.nlm.nih.gov/...)...","   ","    WRONG: According to Mayo Clinic, 2024 the prevalence...","    WRONG: Studies show Harrison et al., 2014...","   ","   FORMAT REQUIRED: [Source Name, Year](full_url)","   - Source Name can be: 'Mayo Clinic', 'CDC', 'Harrison et al.', 'WHO', etc.","   - Year: 4-digit year","   - URL: Use actual URLs when possible (mayo clinic.org, cdc.gov, scholar.google.com, pubmed.gov)","   - If exact URL unknown, use: https://scholar.google.com/scholar?q=[search_terms]",""," DO NOT:","   - Use vague attributions ('studies show...' without citation)","   - Cite the same source repeatedly (spread citations across different sources)","   - Use plain text citations like 'Mayo Clinic, 2024' - MUST be clickable links","","","CONTENT LENGTH & TOKEN OPTIMIZATION:",`  - Target ${`${d}-${p}`} words for most medical topics (fits comfortably in 64K output tokens)`,`  - Complex topics (multi-system diseases, syndromes) may warrant up to ${`${Math.min(p+2e3,8e3)}`} words`,"  - Prioritize DEPTH over LENGTH - better to thoroughly cover essential content","  - Each section should be complete - do NOT truncate mid-section due to length","  - If approaching token limit, STOP at natural section break, do NOT cut off abruptly","   - NO artificial section limits - generate sections 10, 11, 12+ if clinically warranted","",""," FINAL CRITICAL REMINDER: END YOUR GUIDE CLEANLY ","","After completing your FINAL section, STOP IMMEDIATELY.","  - Generate sections 9, 10, 11, 12+ as needed for comprehensive coverage","  - When topic is fully covered, end after your last numbered section",""," DO NOT append any of the following after your last section:","   - Clinical Pearls section or boxes","   - exam-tip, gap-filler, red-flag, fact-check labels","   - References or Sources section","   - Summary or conclusion paragraphs","   - 'Verified Sources' listings",""," Your guide ends CLEANLY after the last section you write.","   Example: If you write sections 1-11, end immediately after section 11.","   Example: If you write sections 1-9, end immediately after section 9.","",""," SMART LINKING - Interactive Knowledge Graph (Phase 1 Integration)","","",` Phase 1 generated ${n.length} knowledge graph nodes.`,""," HOW SMART LINKS WORK FOR STUDENTS:","   When you mention these terms, they become CLICKABLE links.","   Students can click any term to:","    Jump directly to the Knowledge Graph visualization","    See that node highlighted and its connections","    Explore related concepts interactively","    Understand relationships between concepts visually",""," YOUR TASK - SMART LINKING (CRITICAL):","   - Use these terms NATURALLY throughout your guide","   - Surround them with [square brackets] in your markdown","   - The client auto-converts [term]  [term](node:id) for you",""," CRITICAL: USE EXACT LABELS, NOT HYPHENATED IDs ","    CORRECT: [Chronic Neck Pain] - uses the LABEL from Phase 1","    WRONG:  [chronic-neck-pain] - this is the ID, NOT the label!","","    CORRECT: [Loss of Cervical Lordosis]","    WRONG:  [loss-of-cervical-lordosis]","","    CORRECT: [Virchow's Triad]","    WRONG:  [virchows-triad]","","   The LABEL is human-readable (Title Case with spaces).","   The ID is kebab-case (for internal use only).","   YOU MUST USE THE LABEL, NEVER THE ID.","",` AVAILABLE GRAPH NODES (Top 50 of ${n.length}):`,"   FORMAT: [Label to use] (id: internal-id)",...n.slice(0,50).map((e,t)=>`  ${t+1}. [${e.label}] (id: ${e.id}) - Group ${e.group||"?"}`),""," When writing, use the LABEL in brackets: [${node.label}], NOT [${node.id}]",n.length>50?`  ... and ${n.length-50} more nodes available`:"",""," INTEGRATION STRATEGY:","  - Use EXACT labels from the list above (Title Case, spaces, proper punctuation)","  - Naturally mention these terms in context (e.g., 'The [Frank-Starling Mechanism]...')","  - Don't force terms if not clinically relevant","  - Client handles the linking syntax - focus on content quality","","","CITATION STRATEGY - ULTRA-LEGITIMATE SOURCES & PROPER GROUNDING","",""," GOOGLE SEARCH GROUNDING (Free Tier - 1M queries/day limit):",`Current topic: "${t}"`,"","SEARCH QUERY CONSTRUCTION:","   GOOD: 'congestive heart failure ACC AHA guidelines 2024'","   GOOD: 'diabetes mellitus type 2 pathophysiology mechanism insulin resistance'","   GOOD: 'myocardial infarction STEMI diagnostic criteria troponin threshold'","","   BAD: 'heart failure' (too vague)","   BAD: 'diabetes treatment' (not specific enough)","","SOURCE FILTERING (BEFORE citing):","   PubMed: pubmed.ncbi.nlm.nih.gov","   Mayo Clinic: mayoclinic.org","   Cleveland Clinic: my.clevelandclinic.org","   UpToDate: uptodate.com","   Specialty Societies: acc.org, heart.org, diabetes.org, etc.","   Government: cdc.gov, nih.gov, fda.gov, who.int","","   Wikipedia, WebMD, health blogs, forums","   Commercial sites, news articles","   Unverified medical sites","","","INLINE CITATION STANDARDS - SENTENCE-LEVEL CONTEXTUAL RELEVANCE","","","EVERY medical claim needs inline citation IMMEDIATELY after:",""," EXCELLENT CITATION EXAMPLES (Contextually relevant):",'  "Left ventricular ejection fraction (LVEF) <40% defines systolic heart failure [ACC/AHA HF Guidelines](https://www.ahajournals.org/...)"','  "ACE inhibitors reduce all-cause mortality by 23% in HFrEF [SOLVD Trial](https://pubmed.ncbi.nlm.nih.gov/1463530/)"','  "Hemoglobin A1c >6.5% on two separate occasions confirms diabetes diagnosis [ADA Standards](https://diabetesjournals.org/...)"',"","CITATION PLACEMENT RULES:","   Citation must DIRECTLY support the SPECIFIC claim in THAT sentence","   Cited source must discuss the EXACT mechanism/drug/value mentioned","   Aim for 1 citation per 30-50 words (3-4 per paragraph) - TARGET 25-35 CLICKABLE CITATIONS TOTAL","   EVERY citation MUST be a clickable markdown link: [Source, Year](url)","","   NOT: Generic citation at paragraph end","   NOT: Citation vaguely related to general topic","   NOT: Plain text citations (Mayo Clinic, 2024) - MUST be links!","   NOT: Same citation repeated for unrelated claims",""," SOURCE PRIORITY (Cite in this order):","  1. [Uploaded: Page X] - From user's uploaded lecture/material","  2. [Author Year](url) - Peer-reviewed journal from Google Search","  3. [Society Guidelines Year](url) - ACC, AHA, ESC, etc.","  4. [Institution](url) - Mayo, Cleveland, Johns Hopkins","","CITATION FORMAT EXAMPLES:","   Uploaded: [Uploaded: Page 15] or [Lecture: Slide 23]","   Journal: [Harrison et al. 2014](https://pubmed.ncbi.nlm.nih.gov/24847137/)","   Guideline: [ACC/AHA 2023](https://www.ahajournals.org/doi/10.1161/...)","   Institution: [Mayo Clinic 2024](https://www.mayoclinic.org/diseases-conditions/...)","","","QUALITY CONTROL CHECKLIST (Self-validate before completion)",""," 5000-8000 words of detailed content generated"," Sections flow naturally (extend beyond 9 if topic complexity demands it)"," Google Search used to fill knowledge gaps (not just uploaded material)"," Every major claim has CLICKABLE inline citation (TARGET 25-35 TOTAL, ALL AS MARKDOWN LINKS)"," Numerical values included with units (BP, labs, EF, etc.)"," Knowledge graph node terms mentioned naturally"," JSON code blocks used instead of markdown tables"," NO 'Clinical Pearls' section added (already in Phase 1)"," NO 'References' section added (handled by grounding)"," Guide ends cleanly after your final section (no matter which number it is)"," Coherent with Phase 1 summary and title","",i?"":"",i?" CONTINUATION MODE ACTIVATED":"",i?"":"",i?`You are generating a COMPREHENSIVE medical study guide.\n\n CONTEXT: This is a CONTINUATION from "${i}"\n\n  - Complete all remaining sections\n  - Maintain medical accuracy and board-exam focus\n  - Use inline citations throughout\n  - End cleanly after your final section`:""].filter(Boolean).join("\n"),m=i?`Continue the markdown study guide for "${t}" from section "${i}".\n\nCRITICAL REQUIREMENTS:\n- Complete remaining sections ONLY (pick up from "${i}")\n- Do NOT repeat any previous content\n- Do NOT add 'Clinical Pearls' section (already in Phase 1)\n- Do NOT add 'References' section (handled separately)\n- End cleanly after your final section (no matter which number it is)`:`Generate a comprehensive, board-exam focused markdown study guide for "${t}".\n\n TOPIC: ${t}\n${s?` PHASE 1 SUMMARY (for coherence): ${s.summary}`:""}\n${s&&s.pearls.length>0?` ${s.pearls.length} Clinical Pearls already in Phase 1 metadata`:""}\n\n UPLOADED MATERIAL ACCESS:\nYou have FULL ACCESS to the ${e.length} uploaded file(s) re-sent for this phase.\nUse them to extract core content and cite as [Uploaded: Page X].\n\n GOOGLE SEARCH REQUIREMENT:\nYou MUST use Google Search to FILL GAPS in the uploaded material.\nSearch for:\n  - Specific diagnostic criteria, lab values, treatment protocols\n  - Current evidence-based guidelines (ACC/AHA/ESC 2023-2024)\n  - Epidemiological data, prognosis, clinical scores\n  - Mechanism details not covered in the lecture\n\n KNOWLEDGE GRAPH INTEGRATION:\nNaturally mention ${n.length} clinical terms from Phase 1 graph.\nClient will auto-link them to interactive nodes.\n\n   OUTPUT REQUIREMENTS:\n- 4000-6000 words of detailed, clinically rich markdown\n- Generate ALL necessary sections (typically 9-12 sections, but can be more if needed)\n- Every claim cited inline with CLICKABLE MARKDOWN LINKS (TARGET 25-35 TOTAL)\n   REQUIRED FORMAT: [Mayo Clinic, 2024](https://www.mayoclinic.org/...) \n   REQUIRED FORMAT: [Harrison et al., 2014](https://scholar.google.com/scholar?q=...)\n   WRONG: Plain text like "Mayo Clinic, 2024" or "Harrison et al., 2014"\n- Use [Uploaded: Page X] for uploaded file content\n- JSON code blocks instead of markdown tables\n- End cleanly after your FINAL section (no matter which number it is)\n\n FORBIDDEN (will cause rejection):\n 'Clinical Pearls' section (already in Phase 1)\n 'References' or 'Sources' section (handled by grounding metadata)\n Subsections like 9.9 or extras after your final section\n Pearl boxes at the end (exam-tip, gap-filler, etc.)\n INTRODUCTORY PROSE addressing the user (e.g., "As a senior mentor, [Name]..." or "Welcome, [Name]...")\n Personal greetings or conversational opening paragraphs\n Using asterisks incorrectly (e.g., *phyio* instead of proper formatting)\n\n CRITICAL: START DIRECTLY WITH THE TITLE \nYour markdown MUST begin with:\n  # [Topic Title]: A Comprehensive Study Guide\n  \n  [First section starts immediately]\n\nDO NOT START WITH:\n   "As a senior mentor, [Name], it's crucial to understand..."\n   "Welcome to this comprehensive guide..."\n   "Dear [Name], let me walk you through..."\n   Any personalized greeting or introduction\n\n SUCCESS CRITERIA:\n- Comprehensive, board-exam quality content\n- Proper grounding with authoritative sources (AIM FOR 10+ UNIQUE SOURCES)\n- Contextually relevant inline citations\n- Coherent with Phase 1 metadata\n- Clean ending after your final section (whether it's 9, 11, or 13)`;return c.push({text:m}),this.retryWithBackoff(async()=>{const e=await this.getClient();let t=a||"",i=null,s=0,u=0;try{const a=(()=>{switch(l?.teachingStyle){case"Socratic":return["TEACHING STYLE: SOCRATIC METHOD","- Pose guiding questions throughout the content","- Encourage critical thinking with 'What if...' scenarios","- Include 'Think about this...' prompts before key concepts"].join("\n");case"Concise":return["TEACHING STYLE: CONCISE & DIRECT","- Keep explanations brief and focused","- Use bullet points and tables extensively","- Prioritize high-yield facts over lengthy explanations"].join("\n");case"Clinical-Cases":return["TEACHING STYLE: CASE-BASED LEARNING","- Present information through clinical scenarios","- Include patient presentations and management decisions","- Connect pathophysiology to real-world clinical practice"].join("\n");default:return["TEACHING STYLE: DETAILED & COMPREHENSIVE","- Provide thorough explanations with clinical context","- Include mechanisms, examples, and analogies"].join("\n")}})(),d=l?.specialties?.length?`SPECIALTY FOCUS: ${l.specialties.join(", ")} - emphasize connections to these fields.`:"",p=l?.learningGoals?`LEARNING OBJECTIVES: ${l.learningGoals}`:"",f=l?[""," USER CONTEXT (Phase 2)","",`- Name: ${l.name||"Learner"}`,`- Role: ${l.discipline} (${l.level})`,"",a,"",d,p,"","INSTRUCTIONAL ADJUSTMENTS:",`1. TONE: Act as a senior mentor to a ${l.level} in ${l.discipline}.`,"2. DEPTH: "+(l.level&&l.level.includes("Pre-clinical")?"Focus on core mechanisms and pathophysiology.":"Focus on clinical management, guidelines, and algorithms."),"3. FOCUS: Highlight clinically relevant facts tailored to this user's discipline.","",""].filter(Boolean).join("\n"):"",g=f?f+"\n\n"+h:h,y=await e.models.generateContentStream({model:"gemini-2.5-flash",contents:{parts:c},config:{tools:[{googleSearch:{}}],systemInstruction:g,temperature:.3,thinkingConfig:{thinkingBudget:20480,includeThoughts:!0}}});for await(const e of y){if(s++,1===s)try{e.candidates}catch(m){}if(e.candidates?.[0]?.content?.parts)for(const n of e.candidates[0].content.parts){if(!0===n.thought||!0===n.isThought){const e=n.text||"";e&&e.trim()&&o&&o(e)}else n.text&&(t+=n.text)}else e.candidates&&e.candidates.length;const a=e.text||"";if(a&&!e.candidates?.[0]?.content?.parts?.length&&(t+=a),s%20==0&&t.length>u){t.length;u=t.length}const l=this.processTablesInMarkdown(t),c=this.linkifyClinicalTerms(l,n);r(c),e.candidates?.[0]?.groundingMetadata&&(i=e.candidates[0].groundingMetadata)}if(0===s){const e=new Error("Empty stream: API returned no content. This may be a temporary API issue.");throw e.code="EMPTY_STREAM",e.retryable=!0,e}if(t.length<100){const e=new Error("Content generation incomplete. The AI produced empty or minimal output.");throw e.code="EMPTY_CONTENT",e.charCount=t.length,e}}catch(f){if("EMPTY_STREAM"!==f.code&&!f.message?.includes("500")&&500!==f.status){try{this.handleApiError(f)}catch(g){throw g}throw f}{"EMPTY_STREAM"===f.code&&await new Promise(e=>setTimeout(e,2e3)),t=a||"";const o=await e.models.generateContentStream({model:"gemini-2.5-flash",contents:{parts:c},config:{tools:[{googleSearch:{}}],systemInstruction:h,temperature:.3}});let s=0;for await(const e of o){s++;const a=e.text||"";t+=a;const o=this.processTablesInMarkdown(t),l=this.linkifyClinicalTerms(o,n);r(l),e.candidates?.[0]?.groundingMetadata&&(i=e.candidates[0].groundingMetadata)}if(0===s){const e=new Error("Empty stream persists after retry. Please try again.");throw e.code="EMPTY_STREAM",e}if(t.length<100){const e=new Error("Content generation incomplete after retry.");throw e.code="EMPTY_CONTENT",e}}}t=this.removeRedundantSections(t);const d=[];if(i&&(i.groundingChunks&&Array.isArray(i.groundingChunks)&&i.groundingChunks.forEach(e=>{if(e?.web?.uri&&e?.web?.title){if(e.web.uri.includes("vertexaisearch.cloud.google.com")||e.web.uri.includes("google.com/search")||e.web.uri.includes("/search?"))return;d.find(t=>t.uri===e.web.uri)||d.push({title:e.web.title,uri:e.web.uri})}}),i.groundingSupports&&Array.isArray(i.groundingSupports)&&i.groundingSupports.forEach(e=>{e.groundingChunkIndices&&Array.isArray(e.groundingChunkIndices)&&e.groundingChunkIndices.forEach(e=>{const t=i.groundingChunks?.[e];t?.web?.uri&&t?.web?.title&&(d.find(e=>e.uri===t.web.uri)||d.push({title:t.web.title,uri:t.web.uri}))})}),i.searchEntryPoint,i.webSearchQueries&&Array.isArray(i.webSearchQueries)),0===d.length){const e=[/\b([A-Z][a-z]+(?:\s+et\s+al\.?))\s*,\s*(\d{4})\b/g,/\b([A-Z][a-z]+\s*&\s*[A-Z][a-z]+)\s*,\s*(\d{4})\b/g,/\b([A-Z][A-Za-z\s&]+(?:Clinic|Institute|Association|Society|Organization|WHO|CDC|NIH|College|Academy))\s*,\s*(\d{4})\b/g,/\b(WHO|CDC|NIH|FDA|AHA|ACC|ESC)\s*,\s*(\d{4})\b/g],n=new Set;e.forEach(e=>{let r;for(;null!==(r=e.exec(t));){const e=`${r[1].trim()}, ${r[2]}`;n.add(e)}}),n.forEach(e=>{d.find(t=>t.title===e)||d.push({title:e,uri:`https://scholar.google.com/scholar?q=${encodeURIComponent(e)}`})});const r=/\[([^\]]+)\]\((https?:\/\/[^\)]+)\)/g;let a;for(;null!==(a=r.exec(t));){const[,e,t]=a;t.startsWith("node:")||d.find(e=>e.uri===t)||d.push({title:e,uri:t})}}d.length,t.length;const p=t.slice(-100).trim();return p.endsWith("...")||p.endsWith("and")||p.endsWith("or")||p.endsWith(","),{markdown:t,sources:d}},3,1e3)}removeRedundantSections(e){if(!e)return"";let t=e,n=t.split("\n");const r=n.findIndex(e=>e.match(/^#\s+[^#]/));if(-1!==r){const e=n[r],a=n.findIndex((t,n)=>n>r+10&&t===e);-1!==a&&(t=n.slice(0,a).join("\n"))}const a=t.split(/(?=^#{1,2}\s+\d+\.)/m),i=new Map;for(const o of a){const e=o.match(/^(#{1,2}\s+\d+\.\s*[^\n]+)/);if(e){const t=e[1].toLowerCase().replace(/\s+/g," ").trim();i.has(t)||i.set(t,o)}else o.trim()&&i.set(`_intro_${i.size}`,o)}return t=Array.from(i.values()).join(""),t=t.trim(),t}async augmentClinicalNoteStreaming(e,t="General Medical Topic",n,r,a){if(!(await cl.getApiKey()))throw new Gl("No API Key found. Please add your Google Gemini API key in Settings.","MISSING");try{let i,o;"function"==typeof n?o=n:(i=n,o=r),o=o||function(){};const s=await this.generateMetadataAndGraph(e,t,a,e=>{o({stage:"metadata",subStage:e})},i);o({stage:"metadata",subStage:"graphing",data:{title:s.title,summary:s.summary,eli5Analogy:s.eli5Analogy,pearls:s.pearls,graphData:{nodes:s.graphNodes,links:s.graphLinks}}}),await new Promise(e=>setTimeout(e,1500));let l="",c=[],u=0;const d=2;let p="structuring",h=null;const m=(e,t)=>{e!==h?(h=e,p=e,o({stage:"markdown",subStage:e,data:t?{markdownContent:t}:void 0})):t&&o({stage:"markdown",subStage:p,data:{markdownContent:t}})};m("structuring");const f={title:s.title,summary:s.summary,eli5Analogy:s.eli5Analogy,pearls:s.pearls};for(;u<=d;){const n=l.length,r=await this.generateMarkdownStreaming(e,t,s.graphNodes,e=>{const t=e.length;"structuring"===p&&t>500?m("writing",e):"writing"===p&&t>3e4?m("citing",e):o({stage:"markdown",subStage:p,data:{markdownContent:e}})},u>0?l:void 0,u>0?this.detectTruncation(l).lastSection:void 0,e=>{a&&a(e)},f,i);l=r.markdown,c=[...new Set([...c,...r.sources])];if(!this.detectTruncation(l).isTruncated||l.length===n||l.length>1e5)break;u++}const g=this.linkifyClinicalTerms(l,s.graphNodes),y=this.processTablesInMarkdown(g),x={id:crypto.randomUUID(),timestamp:Date.now(),title:s.title,sourceFileNames:e.map(e=>e.file.name),markdownContent:y||"Content generation incomplete.",summary:s.summary,eli5Analogy:s.eli5Analogy,pearls:s.pearls,graphData:{nodes:s.graphNodes,links:s.graphLinks},podcastScript:[],sources:c};return o({stage:"complete",data:x}),x}catch(i){throw i}}async augmentClinicalNote(e,t="General Medical Topic"){return new Promise((n,r)=>{this.augmentClinicalNoteStreaming(e,t,e=>{"complete"===e.stage&&e.data&&n(e.data)}).catch(r)})}async generatePodcastScript(e,t,n){return[]}async generateNativePodcastAudio(e){return null}}var Hl=(e=>(e.IDLE="IDLE",e.BUILDING_GRAPH="BUILDING_GRAPH",e.WRITING_GUIDE="WRITING_GUIDE",e.COMPLETE="COMPLETE",e.ERROR="ERROR",e))(Hl||{});const $l=e=>{if(!e)return!1;const t=e.toLowerCase().trim();return t.includes("akshaya")||t.includes("akshu")},Bl=[{label:"Medical (MD/DO)",icon:lt,color:"cyan"},{label:"Nursing",icon:_e,color:"rose"},{label:"Pharmacy",icon:Je,color:"purple"},{label:"Physiotherapy",icon:W,color:"teal"},{label:"Dentistry",icon:yt,color:"emerald"},{label:"Other",icon:yt,color:"amber"}],Vl=[{label:"Student (Pre-clinical)",description:"Focus on foundational sciences"},{label:"Student (Clinical)",description:"Rotations & clinical exposure"},{label:"Intern/Resident",description:"Postgraduate training"},{label:"Professional",description:"Practicing clinician"}],Yl=[{label:"Socratic",icon:Ge,description:"Questions that guide your discovery",color:"cyan"},{label:"Concise",icon:vt,description:"Rapid facts, bullet points, efficiency",color:"amber"},{label:"Detailed",icon:X,description:"Deep explanations, comprehensive coverage",color:"teal"},{label:"Clinical-Cases",icon:Le,description:"Learn through patient scenarios",color:"rose"},{label:"Custom",icon:ht,description:"Describe your preferred style",color:"purple"}],Wl=[{label:"USMLE Step 1",description:"Basic sciences",disciplines:["Medical (MD/DO)"]},{label:"USMLE Step 2 CK",description:"Clinical knowledge",disciplines:["Medical (MD/DO)"]},{label:"USMLE Step 3",description:"Clinical practice",disciplines:["Medical (MD/DO)"]},{label:"COMLEX",description:"Osteopathic boards",disciplines:["Medical (MD/DO)"]},{label:"NCLEX-RN",description:"Registered nurse",disciplines:["Nursing"]},{label:"NCLEX-PN",description:"Practical nurse",disciplines:["Nursing"]},{label:"NAPLEX",description:"Pharmacy licensure",disciplines:["Pharmacy"]},{label:"PANCE/PANRE",description:"PA certification",disciplines:["Medical (MD/DO)","Other"]},{label:"MCAT",description:"Medical school admission",disciplines:["Medical (MD/DO)","Other"]},{label:"University Semester Exam",description:"College/University exams",disciplines:["Medical (MD/DO)","Nursing","Pharmacy","Physiotherapy","Dentistry","Other"]},{label:"Board Certification",description:"Specialty boards",disciplines:["Medical (MD/DO)","Nursing","Pharmacy","Physiotherapy","Dentistry","Other"]},{label:"Clinical Competency",description:"Skills assessment",disciplines:["Medical (MD/DO)","Nursing","Pharmacy","Physiotherapy","Dentistry","Other"]},{label:"General Knowledge",description:"No specific exam",disciplines:["Medical (MD/DO)","Nursing","Pharmacy","Physiotherapy","Dentistry","Other"]},{label:"Custom",description:"Specify your own goal",disciplines:["Medical (MD/DO)","Nursing","Pharmacy","Physiotherapy","Dentistry","Other"]}],Kl=({name:t,className:n=""})=>{if($l(t)){const r=t.split(" ")[0];return e.jsxs("span",{className:`relative inline-block pr-3 ${n}`,children:[e.jsx("span",{className:"font-serif italic text-tissue-rose bg-gradient-to-r from-tissue-rose via-pink-400 to-tissue-rose bg-clip-text text-transparent animate-pulse drop-shadow-[0_0_8px_rgba(244,114,182,0.6)]",children:r}),e.jsx("span",{className:"absolute -top-1 right-0 text-tissue-rose/60 text-[10px]",children:""})]})}return e.jsx("span",{className:n,children:t.split(" ")[0]})},Jl=({onComplete:t,existingProfile:n,onCancel:r,mode:a="onboarding"})=>{const[i,o]=I.useState(1),s=I.useRef(null),[l,c]=I.useState(!1),[u,d]=I.useState(""),[p,h]=I.useState(!1),[m,f]=I.useState(null),[g,y]=I.useState({apiKey:n?.apiKey||"",discipline:n?.discipline||"Medical (MD/DO)",level:n?.level||"Student (Clinical)",teachingStyle:n?.teachingStyle||"Detailed",examGoal:n?.examGoal||void 0,customTeachingStyle:n?.customTeachingStyle||"",customExamGoal:n?.customExamGoal||"",theme:n?.theme||"obsidian",name:n?.name||"",birthday:n?.birthday||"",profilePicture:n?.profilePicture||"",specialties:n?.specialties||[],learningGoals:n?.learningGoals||""}),[x,b]=I.useState(""),v=()=>o(e=>Math.min(e+1,5)),w=()=>o(e=>Math.max(e-1,1)),N=()=>{if(g.name){const e=Date.now();t({...g,createdAt:n?.createdAt||e,updatedAt:e})}},E=()=>{x.trim()&&!g.specialties?.includes(x.trim())&&(y({...g,specialties:[...g.specialties||[],x.trim()]}),b(""))};I.useEffect(()=>{const e=g.name||"",t=$l(u),n=$l(e);t||!n||l?!n&&l&&c(!1):(c(!0),g.birthday||y(e=>({...e,birthday:"2003-08-04"}))),d(e)},[g.name,u,l,g.birthday]);const S="edit"===a;return e.jsxs(e.Fragment,{children:[G.createPortal(e.jsx(Al,{}),document.getElementById("bio-background-root")||document.body),l&&e.jsxs("div",{className:"fixed inset-0 z-40 pointer-events-none",children:[e.jsx("style",{children:"\n            @keyframes cinematicFadeIn {\n              0% {\n                opacity: 0;\n                background: rgba(0, 0, 0, 0);\n                backdrop-filter: blur(0px);\n              }\n              40% {\n                opacity: 0.6;\n                background: rgba(0, 0, 0, 0.3);\n                backdrop-filter: blur(10px);\n              }\n              100% {\n                opacity: 0;\n                background: rgba(0, 0, 0, 0);\n                backdrop-filter: blur(0px);\n              }\n            }\n            \n            @keyframes glowPulse {\n              0% {\n                box-shadow: 0 0 0 0 rgba(244, 114, 182, 0.4);\n                opacity: 0;\n              }\n              50% {\n                opacity: 1;\n              }\n              100% {\n                box-shadow: 0 0 60px 30px rgba(244, 114, 182, 0);\n                opacity: 0;\n              }\n            }\n            \n            .akshaya-fade {\n              animation: cinematicFadeIn 2.5s cubic-bezier(0.4, 0, 0.6, 1) forwards;\n            }\n            \n            .akshaya-glow {\n              animation: glowPulse 2.5s cubic-bezier(0.4, 0, 0.6, 1) forwards;\n            }\n          "}),e.jsx("div",{className:"akshaya-fade absolute inset-0"}),e.jsx("div",{className:"akshaya-glow absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-96 h-96 rounded-full pointer-events-none"})]}),e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-transparent text-serum-white overflow-hidden",children:e.jsxs("div",{className:"relative w-full max-w-xl mx-6 z-10",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsx("div",{children:e.jsx("h1",{className:"text-xs font-serif tracking-[0.3em] text-gray-200",children:S?"Edit Profile":"SYNAPSE MED"})}),S&&r&&e.jsx("button",{onClick:r,className:"p-2.5 rounded-xl glass-slide hover:bg-white/[0.04] transition-all duration-300",children:e.jsx(xt,{size:18,className:"text-gray-200"})})]}),e.jsx("div",{className:"flex gap-1.5 mb-10",children:Array.from({length:5}).map((t,n)=>e.jsx("div",{className:`h-0.5 rounded-full transition-all duration-700 ${0===n?"flex-[2]":4===n?"flex-[1.5]":"flex-1"} ${i>n?"bg-vital-cyan shadow-[0_0_10px_rgba(42,212,212,0.5)]":"bg-white/[0.06]"}`},n))}),e.jsxs("div",{className:"glass-slide border border-white/[0.06] p-8 rounded-2xl shadow-2xl max-h-[80vh] overflow-y-auto custom-scrollbar",children:[1===i&&e.jsx(e.Fragment,{}),2===i&&e.jsxs("div",{className:"space-y-6 animate-[fadeIn_0.4s_ease-out]",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-mono tracking-[0.2em] text-vital-cyan mb-2",children:"Step 02"}),e.jsx("h2",{className:"text-2xl font-serif font-light tracking-tight text-serum-white transition-all duration-700 ease-out",children:g.name?e.jsxs(e.Fragment,{children:["Let's make this yours,"," ",e.jsx(Kl,{name:g.name})]}):"Your Identity"}),e.jsx("p",{className:"text-gray-500 text-sm font-sans mt-2 transition-all duration-500 ease-out",children:g.name?"A face, a name, a birthdaythis is where it all comes together.":"Let's get to know you personally."})]}),e.jsx("div",{className:"flex justify-center",children:e.jsxs("div",{className:"relative group",children:[e.jsx("input",{type:"file",ref:s,onChange:e=>{const t=e.target.files?.[0];if(t){if(t.size>5242880)return void alert("Image too large. Please use an image under 5MB.");const e=new FileReader;e.onload=e=>{const t=e.target?.result;y({...g,profilePicture:t})},e.readAsDataURL(t)}},accept:"image/*",className:"hidden"}),e.jsx("div",{onClick:()=>s.current?.click(),className:"w-24 h-24 rounded-2xl border-2 border-dashed cursor-pointer transition-all duration-300 flex items-center justify-center overflow-hidden "+(g.profilePicture?"border-clinical-cyan/50":"border-white/10 hover:border-white/30 bg-white/3"),children:g.profilePicture?e.jsx("img",{src:g.profilePicture,alt:"Profile",className:"w-full h-full object-cover"}):e.jsx(ne,{size:28,className:"text-gray-500"})}),g.profilePicture&&e.jsx("button",{onClick:e=>{e.stopPropagation(),y({...g,profilePicture:""})},className:"absolute -top-2 -right-2 w-6 h-6 bg-rose-500/80 rounded-full flex items-center justify-center hover:bg-rose-500 transition-colors",children:e.jsx(xt,{size:12})})]})}),e.jsx("p",{className:"text-center text-[10px] text-gray-500",children:"Click to upload (max 5MB)"}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] uppercase text-gray-500 font-semibold tracking-wider mb-2 block",children:"What should we call you?"}),e.jsxs("div",{className:"relative",children:[e.jsx(yt,{className:"absolute top-3 left-3 text-gray-500",size:18}),e.jsx("input",{type:"text",placeholder:"Dr. Strange, Alex, Chief Resident...",value:g.name||"",onChange:e=>y({...g,name:e.target.value}),className:"w-full bg-white/5 border rounded-xl py-3 pl-10 pr-4 focus:outline-none transition-all duration-300 font-serif italic "+($l(g.name)?"border-tissue-rose/50 focus:border-tissue-rose/70 focus:shadow-[0_0_12px_rgba(244,114,182,0.25)] text-tissue-rose":"border-white/10 text-white focus:border-clinical-cyan/50 focus:shadow-vital-cyan/5")})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"text-[10px] uppercase font-semibold tracking-wider mb-2 block flex items-center gap-2 "+($l(g.name)?"text-tissue-rose/70":"text-gray-500"),children:["When's your birthday?"," ",$l(g.name)?e.jsx("span",{className:"text-tissue-rose/60 normal-case font-serif italic",children:"(I already know )"}):e.jsx("span",{className:"text-gray-500 normal-case",children:"(we'll remember)"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(te,{className:"absolute top-3 left-3 "+($l(g.name)?"text-tissue-rose/70":"text-gray-500"),size:18}),e.jsx("input",{type:"date",value:g.birthday||"",onChange:e=>y({...g,birthday:e.target.value}),className:"w-full bg-white/5 border rounded-xl py-3 pl-10 pr-4 focus:outline-none transition-all duration-300 font-serif italic [color-scheme:dark] "+($l(g.name)?"border-tissue-rose/30 text-tissue-rose focus:border-tissue-rose/70 focus:shadow-[0_0_12px_rgba(244,114,182,0.25)]":"border-white/10 text-white focus:border-clinical-cyan/50 focus:shadow-vital-cyan/5")})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:w,className:"flex-1 py-4 border border-white/[0.1] rounded-xl text-sm font-sans text-gray-200 hover:bg-white/[0.04] transition-all duration-300 flex items-center justify-center gap-2",children:[e.jsx(K,{size:14})," Back"]}),e.jsxs("button",{onClick:v,className:"flex-[2] py-4 bg-vital-cyan text-bio-void font-sans font-semibold rounded-xl flex items-center justify-center gap-2 hover:bg-vital-cyan/90 transition-all duration-300 shadow-[0_0_30px_rgba(42,212,212,0.2)]",children:["Continue ",e.jsx(J,{size:16})]})]})]}),3===i&&e.jsxs("div",{className:"space-y-8 animate-[fadeIn_0.4s_ease-out]",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-mono tracking-[0.2em] text-vital-cyan mb-2",children:"Step 03"}),e.jsx("h2",{className:"text-2xl font-serif font-light tracking-tight text-serum-white transition-all duration-700 ease-out",children:g.name?e.jsxs(e.Fragment,{children:["Alright ",e.jsx(Kl,{name:g.name}),", what's your clinical background?"]}):"Clinical Identity"}),e.jsx("p",{className:"text-gray-500 text-sm font-sans mt-2 transition-all duration-500 ease-out",children:g.name?"Your discipline and training level help us understand your world better.":"Define your professional context."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] uppercase text-gray-500 font-sans font-semibold tracking-wider mb-4 block",children:"What's your discipline?"}),e.jsx("div",{className:"grid grid-cols-3 gap-3",children:Bl.map(t=>e.jsxs("button",{onClick:()=>y({...g,discipline:t.label}),className:"p-4 rounded-xl border flex flex-col items-center gap-3 transition-all duration-300 "+(g.discipline===t.label?"bg-vital-cyan/10 border-vital-cyan/30 text-vital-cyan shadow-[0_0_20px_rgba(42,212,212,0.1)]":"bg-white/[0.02] border-white/[0.06] hover:bg-white/[0.04] hover:border-white/[0.1] text-gray-200"),children:[e.jsx(t.icon,{size:20}),e.jsx("span",{className:"text-[9px] font-sans font-medium text-center leading-tight",children:t.label})]},t.label))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] uppercase text-gray-500 font-sans font-semibold tracking-wider mb-4 block",children:"Where are you in your training?"}),e.jsx("div",{className:"space-y-2",children:Vl.map(t=>e.jsxs("button",{onClick:()=>y({...g,level:t.label}),className:"w-full p-4 rounded-xl border text-left transition-all duration-300 "+(g.level===t.label?"bg-vital-cyan/10 border-vital-cyan/30 shadow-[0_0_20px_rgba(42,212,212,0.1)]":"bg-white/[0.02] border-white/[0.06] hover:bg-white/[0.04] hover:border-white/[0.1]"),children:[e.jsx("div",{className:"text-sm font-sans font-medium "+(g.level===t.label?"text-vital-cyan":"text-gray-200"),children:t.label}),e.jsx("div",{className:"text-[10px] text-gray-200 font-sans mt-1",children:t.description})]},t.label))})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:w,className:"flex-1 py-4 border border-white/[0.1] rounded-xl text-sm font-sans text-gray-200 hover:bg-white/[0.04] transition-all duration-300 flex items-center justify-center gap-2",children:[e.jsx(K,{size:14})," Back"]}),e.jsxs("button",{onClick:v,className:"flex-[2] py-4 bg-vital-cyan text-bio-void font-sans font-semibold rounded-xl flex items-center justify-center gap-2 hover:bg-vital-cyan/90 transition-all duration-300 shadow-[0_0_30px_rgba(42,212,212,0.2)]",children:["Continue ",e.jsx(J,{size:16})]})]})]}),4===i&&e.jsxs("div",{className:"space-y-8 animate-[fadeIn_0.4s_ease-out]",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-mono tracking-[0.2em] text-vital-cyan mb-2",children:"Step 04"}),e.jsx("h2",{className:"text-2xl font-serif font-light tracking-tight text-serum-white transition-all duration-700 ease-out",children:g.name?e.jsxs(e.Fragment,{children:["How does ",e.jsx(Kl,{name:g.name})," learn best?"]}):"Learning Signature"}),e.jsx("p",{className:"text-gray-500 text-sm font-sans mt-2 transition-all duration-500 ease-out",children:g.name?"We get itsome people think through questions, others prefer deep reads, some need cases. What's your jam?":"How should we teach you?"})]}),e.jsx("div",{className:"grid gap-3",children:Yl.map(t=>e.jsxs("button",{onClick:()=>y({...g,teachingStyle:t.label}),className:"p-5 rounded-xl border text-left transition-all duration-300 flex items-start gap-4 "+(g.teachingStyle===t.label?"bg-vital-cyan/10 border-vital-cyan/30 shadow-[0_0_20px_rgba(42,212,212,0.1)]":"bg-white/[0.02] border-white/[0.06] hover:bg-white/[0.04] hover:border-white/[0.1]"),children:[e.jsx("div",{className:"w-11 h-11 rounded-xl flex items-center justify-center shrink-0 "+(g.teachingStyle===t.label?"bg-vital-cyan/20 text-vital-cyan":"bg-white/[0.04] text-gray-200"),children:e.jsx(t.icon,{size:20})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-sans font-medium "+(g.teachingStyle===t.label?"text-vital-cyan":"text-gray-200"),children:t.label}),e.jsx("div",{className:"text-[11px] text-gray-500 font-sans mt-1",children:t.description})]})]},t.label))}),"Custom"===g.teachingStyle&&e.jsxs("div",{className:"animate-[fadeIn_0.3s_ease-out]",children:[e.jsx("label",{className:"text-[10px] uppercase text-gray-500 font-sans font-semibold tracking-wider mb-3 block",children:"Describe Your Preferred Style"}),e.jsx("textarea",{placeholder:"e.g., Focus on visual diagrams, use mnemonics, explain like I'm teaching a friend...",value:g.customTeachingStyle||"",onChange:e=>y({...g,customTeachingStyle:e.target.value}),rows:2,className:"w-full glass-slide border border-vital-cyan/20 rounded-xl py-4 px-5 text-sm font-sans text-serum-white focus:border-vital-cyan/40 focus:outline-none transition-all duration-300 resize-none"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:w,className:"flex-1 py-4 border border-white/[0.1] rounded-xl text-sm font-sans text-gray-200 hover:bg-white/[0.04] transition-all duration-300 flex items-center justify-center gap-2",children:[e.jsx(K,{size:14})," Back"]}),e.jsxs("button",{onClick:v,className:"flex-[2] py-4 bg-vital-cyan text-bio-void font-sans font-semibold rounded-xl flex items-center justify-center gap-2 hover:bg-vital-cyan/90 transition-all duration-300 shadow-[0_0_30px_rgba(42,212,212,0.2)]",children:["Continue ",e.jsx(J,{size:16})]})]})]}),5===i&&e.jsxs("div",{className:"space-y-6 animate-[fadeIn_0.4s_ease-out]",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-mono tracking-[0.2em] text-vital-cyan mb-2",children:"Step 05"}),e.jsx("h2",{className:"text-2xl font-serif font-light tracking-tight text-serum-white transition-all duration-700 ease-out",children:g.name?e.jsxs(e.Fragment,{children:["Almost there, ",e.jsx(Kl,{name:g.name}),"what are you chasing?"]}):"Focus Areas"}),e.jsx("p",{className:"text-gray-500 text-sm font-sans mt-2 transition-all duration-500 ease-out",children:g.name?"Your target exams, favorite specialties, and what keeps you up at night studying.":"Personalize your learning experience."})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"text-[10px] uppercase text-gray-500 font-sans font-semibold tracking-wider mb-4 block flex items-center gap-2",children:[e.jsx(ht,{size:12,className:"text-synapse-amber"}),"Target Exam / Goal"]}),e.jsx("div",{className:"grid grid-cols-2 gap-2 max-h-[180px] overflow-y-auto pr-1 custom-scrollbar",children:Wl.filter(e=>e.disciplines.includes(g.discipline||"Medical (MD/DO)")||"General Knowledge"===e.label).map(t=>e.jsxs("button",{onClick:()=>y({...g,examGoal:t.label}),className:"p-3 rounded-xl border text-left transition-all duration-300 "+(g.examGoal===t.label?"bg-synapse-amber/10 border-synapse-amber/30 shadow-[0_0_15px_rgba(240,180,41,0.1)]":"bg-white/[0.02] border-white/[0.06] hover:bg-white/[0.04] hover:border-white/[0.1]"),children:[e.jsx("div",{className:"text-xs font-sans font-medium "+(g.examGoal===t.label?"text-synapse-amber":"text-gray-200"),children:t.label}),e.jsx("div",{className:"text-[9px] text-gray-500 font-sans mt-1",children:t.description})]},t.label))}),!g.examGoal&&e.jsx("p",{className:"text-[10px] text-gray-500 font-sans mt-3 italic",children:"Select an exam goal for personalized quiz questions"}),"Custom"===g.examGoal&&e.jsx("div",{className:"mt-3 animate-[fadeIn_0.3s_ease-out]",children:e.jsx("input",{type:"text",placeholder:"e.g., MBBS Finals, Nursing State Board, Pharmacy License Exam...",value:g.customExamGoal||"",onChange:e=>y({...g,customExamGoal:e.target.value}),className:"w-full glass-slide border border-synapse-amber/20 rounded-xl py-3 px-4 text-sm font-sans text-serum-white focus:border-synapse-amber/40 focus:outline-none transition-all duration-300"})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] uppercase text-gray-500 font-sans font-semibold tracking-wider mb-3 block",children:"What interests you clinically?"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",placeholder:"e.g., Cardiology, Oncology...",value:x,onChange:e=>b(e.target.value),onKeyDown:e=>"Enter"===e.key&&E(),className:"flex-1 glass-slide border border-white/[0.08] rounded-xl py-3 px-4 text-sm font-sans text-serum-white focus:border-vital-cyan/30 focus:outline-none transition-all duration-300"}),e.jsx("button",{onClick:E,className:"px-5 bg-vital-cyan/20 text-vital-cyan rounded-xl text-sm font-sans font-medium hover:bg-vital-cyan/30 transition-all duration-300",children:"Add"})]}),(g.specialties?.length||0)>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mt-3",children:g.specialties?.map(t=>e.jsxs("span",{className:"px-3 py-1 bg-clinical-teal/10 text-clinical-teal rounded-full text-xs flex items-center gap-2",children:[t,e.jsx("button",{onClick:()=>(e=>{y({...g,specialties:g.specialties?.filter(t=>t!==e)||[]})})(t),className:"hover:text-white",children:e.jsx(xt,{size:12})})]},t))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"text-[10px] uppercase text-gray-500 font-semibold tracking-wider mb-2 block",children:["What are you working toward?"," ",e.jsx("span",{className:"text-gray-500",children:"(Optional)"})]}),e.jsx("textarea",{placeholder:"What are you preparing for? Any specific areas you want to master?",value:g.learningGoals||"",onChange:e=>y({...g,learningGoals:e.target.value}),rows:3,className:"w-full bg-white/5 border border-white/10 rounded-xl py-3 px-4 text-sm text-white focus:border-clinical-cyan/50 focus:outline-none transition-colors resize-none"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:w,className:"flex-1 py-3 border border-white/10 rounded-xl text-sm text-gray-200 hover:bg-white/5 transition-colors flex items-center justify-center gap-2",children:[e.jsx(K,{size:14})," Back"]}),e.jsxs("button",{onClick:N,className:"flex-[2] py-3 bg-vital-cyan text-bio-void font-semibold rounded-xl flex items-center justify-center gap-2 hover:bg-vital-cyan/90 transition-all shadow-[0_0_30px_rgba(42,212,212,0.2)]",children:[S?"Save Changes":"Launch Synapse"," ",e.jsx(re,{size:16})]})]})]}),1===i&&e.jsxs("div",{className:"space-y-6 animate-[fadeIn_0.4s_ease-out]",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-mono tracking-[0.2em] text-vital-cyan mb-2",children:"Step 01"}),e.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[e.jsx("h2",{className:"text-2xl font-serif font-light tracking-tight text-serum-white",children:"Neural Connection"}),e.jsx("div",{className:"px-2 py-0.5 rounded bg-vital-cyan/10 border border-vital-cyan/20 text-[10px] text-vital-cyan font-mono tracking-wide",children:"REQUIRED"})]}),e.jsx("p",{className:"text-gray-500 text-sm font-sans mt-2",children:"Connect directly to Google's neural engineno backend middleman, no data collection."})]}),e.jsxs("div",{className:"relative p-6 rounded-3xl bg-gradient-to-br from-tissue-rose/[0.08] via-tissue-rose/[0.04] to-transparent border border-tissue-rose/20 overflow-hidden group shadow-[inset_0_0_40px_rgba(224,93,93,0.08)]",children:[e.jsx("div",{className:"absolute -top-20 -right-20 w-56 h-56 bg-tissue-rose/20 rounded-full blur-[80px]",style:{animation:"fluidGlow 5s ease-in-out infinite"}}),e.jsx("div",{className:"absolute -bottom-10 -left-10 w-40 h-40 bg-tissue-rose/15 rounded-full blur-[70px]",style:{animation:"fluidGlow 6s ease-in-out infinite",animationDelay:"1s"}}),e.jsxs("div",{className:"relative z-10 space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3 text-tissue-rose",children:[e.jsxs("div",{className:"relative w-6 h-6 flex items-center justify-center",children:[e.jsx(Oe,{size:18,fill:"currentColor",className:"opacity-95 heart-pulse relative z-10"}),e.jsx("span",{className:"heart-wave"}),e.jsx("span",{className:"heart-wave delay"}),e.jsx("span",{className:"heart-wave delay-2"})]}),e.jsx("span",{className:"text-[11px] uppercase tracking-[0.24em] font-bold opacity-95 text-tissue-rose/90",children:"Origin"})]}),e.jsxs("p",{className:"text-[18px] font-serif italic text-gray-100 leading-8 opacity-100 font-bold",children:['"',e.jsx("span",{className:"text-white",children:"I created"}),' Synapse as a heartfelt project to support a special physiotherapy student close to my heart through her challenging curriculum. Witnessing how it transformed her study experience inspired me to share it with the world."']}),e.jsx("div",{className:"h-px w-full bg-white/[0.06]"}),e.jsxs("p",{className:"text-[14px] text-gray-400 font-sans leading-relaxed font-medium",style:{letterSpacing:"0.04em"},children:["As a student developer building this without external funding, I cannot host expensive AI servers. Synapse uses a ",e.jsx("strong",{className:"text-gray-300",children:"BYOK"})," (Bring Your Own Key) model  you connect directly to Google's API. This keeps it"," ",e.jsx("strong",{className:"text-gray-300",children:"free, private, and unlimited"})," ","for you."]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"text-xs font-semibold text-gray-200 uppercase tracking-wider",children:"Get Your Free API Key (2 minutes)"}),e.jsxs("div",{className:"flex gap-3 p-3 rounded-xl bg-white/[0.02] border border-white/[0.06] hover:border-white/[0.1] transition-colors",children:[e.jsx("div",{className:"shrink-0 w-8 h-8 rounded-full bg-vital-cyan/10 border border-vital-cyan/20 flex items-center justify-center text-vital-cyan font-mono text-xs font-bold",children:"1"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"text-xs font-semibold text-gray-200",children:["Go to"," ",e.jsxs("a",{href:"https://aistudio.google.com/app/apikey",target:"_blank",rel:"noopener noreferrer",className:"text-vital-cyan hover:underline inline-flex items-center gap-1",children:["Google AI Studio",e.jsx(ye,{size:10})]})]}),e.jsx("div",{className:"text-[10px] text-gray-400 mt-1",children:"You'll need a free Google account (Gmail works)"})]})]}),e.jsxs("div",{className:"flex gap-3 p-3 rounded-xl bg-white/[0.02] border border-white/[0.06] hover:border-white/[0.1] transition-colors",children:[e.jsx("div",{className:"shrink-0 w-8 h-8 rounded-full bg-vital-cyan/10 border border-vital-cyan/20 flex items-center justify-center text-vital-cyan font-mono text-xs font-bold",children:"2"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-xs font-semibold text-gray-200",children:'Click "Create API Key"'}),e.jsx("div",{className:"text-[10px] text-gray-400 mt-1",children:'Select "Create new secret key in existing project" (or create a new project)'})]})]}),e.jsxs("div",{className:"flex gap-3 p-3 rounded-xl bg-white/[0.02] border border-white/[0.06] hover:border-white/[0.1] transition-colors",children:[e.jsx("div",{className:"shrink-0 w-8 h-8 rounded-full bg-vital-cyan/10 border border-vital-cyan/20 flex items-center justify-center text-vital-cyan font-mono text-xs font-bold",children:"3"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-xs font-semibold text-gray-200",children:"Copy the API key"}),e.jsxs("div",{className:"text-[10px] text-gray-400 mt-1",children:["It starts with"," ",e.jsx("code",{className:"bg-black/20 px-1.5 py-0.5 rounded text-[9px] font-mono",children:"AIza"})]})]})]}),e.jsxs("div",{className:"flex gap-3 p-3 rounded-xl bg-white/[0.02] border border-white/[0.06] hover:border-white/[0.1] transition-colors",children:[e.jsx("div",{className:"shrink-0 w-8 h-8 rounded-full bg-vital-cyan/10 border border-vital-cyan/20 flex items-center justify-center text-vital-cyan font-mono text-xs font-bold",children:"4"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-xs font-semibold text-gray-200",children:"Paste it below"}),e.jsx("div",{className:"text-[10px] text-gray-400 mt-1",children:"We'll verify it works, then you're ready to launch Synapse"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"relative group",children:[e.jsx("div",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-500",children:e.jsx(Re,{size:14})}),e.jsx("input",{type:"password",placeholder:"Paste key starting with AIza...",value:g.apiKey||"",onChange:e=>{y({...g,apiKey:e.target.value}),f(null)},className:"w-full bg-[#050607] border rounded-xl py-4 pl-11 pr-5 text-sm font-mono text-white placeholder:text-gray-600 focus:outline-none transition-all "+(!1===m?.valid?"border-red-500/50 focus:border-red-500 focus:shadow-[0_0_20px_rgba(239,68,68,0.1)]":!0===m?.valid?"border-green-500/50 focus:border-green-500 focus:shadow-[0_0_20px_rgba(34,197,94,0.1)]":"border-white/10 focus:border-vital-cyan/50 focus:shadow-[0_0_20px_rgba(42,212,212,0.1)]")}),!0===m?.valid&&e.jsx(ce,{size:16,className:"absolute right-4 top-1/2 -translate-y-1/2 text-green-500"}),!1===m?.valid&&e.jsx(se,{size:16,className:"absolute right-4 top-1/2 -translate-y-1/2 text-red-500"})]}),!1===m?.valid&&e.jsxs("p",{className:"text-[11px] text-red-400 flex items-start gap-1.5 p-2 rounded bg-red-500/5 border border-red-500/10",children:[e.jsx(se,{size:12,className:"shrink-0 mt-0.5"}),e.jsx("span",{children:m.error})]}),!0===m?.valid&&e.jsxs("p",{className:"text-[11px] text-green-400 flex items-start gap-1.5 p-2 rounded bg-green-500/5 border border-green-500/10",children:[e.jsx(ce,{size:12,className:"shrink-0 mt-0.5"}),"API key verified successfully!"]})]}),e.jsxs("div",{className:"flex items-center justify-between px-2 py-2 text-[10px] text-gray-500",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(ot,{size:11,className:"text-emerald-500"}),e.jsx("span",{children:"Stored locally on your device."})]}),e.jsxs("a",{href:"https://www.buymeacoffee.com/yourusername",target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1.5 text-gray-500 hover:text-synapse-amber transition-colors group",children:[e.jsx(me,{size:11,className:"group-hover:animate-bounce"}),e.jsx("span",{children:"Support future updates"})]})]}),e.jsx("button",{onClick:async()=>{if(g.apiKey&&g.apiKey.startsWith("AIza")){h(!0),f(null);try{const e=new ql,t=await e.validateApiKey(g.apiKey);f(t),t.valid&&setTimeout(()=>{v()},500)}catch(e){f({valid:!1,error:e.message||"Validation failed"})}finally{h(!1)}}else f({valid:!1,error:"Please enter a valid API key starting with 'AIza'"})},disabled:!g.apiKey||!g.apiKey.startsWith("AIza")||p,className:"w-full py-4 bg-gradient-to-r from-clinical-cyan to-clinical-teal text-white font-semibold rounded-xl flex items-center justify-center gap-2 shadow-lg shadow-clinical-cyan/20 hover:shadow-clinical-cyan/30 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:p?e.jsxs(e.Fragment,{children:[e.jsx(ze,{size:16,className:"animate-spin"}),"Validating..."]}):e.jsxs(e.Fragment,{children:[S?"Save & Proceed":"Proceed"," ",e.jsx(J,{size:16})]})}),S&&n?.apiKey&&e.jsx("button",{onClick:N,className:"w-full py-2 text-gray-500 text-sm hover:text-gray-300 transition-colors",children:"Skip (keep existing key)"})]})]}),e.jsx("div",{className:"mt-4 text-center",children:e.jsxs("span",{className:"text-[10px] text-gray-500 font-mono",children:[i," / ",5]})})]})})]})},Ql=[{label:"Medical (MD/DO)",icon:lt,color:"cyan"},{label:"Nursing",icon:_e,color:"rose"},{label:"Pharmacy",icon:Je,color:"purple"},{label:"Physiotherapy",icon:W,color:"teal"},{label:"Dentistry",icon:yt,color:"emerald"},{label:"Other",icon:yt,color:"amber"}],Xl=[{label:"Student (Pre-clinical)",description:"Foundational sciences"},{label:"Student (Clinical)",description:"Clinical rotations"},{label:"Intern/Resident",description:"Postgraduate training"},{label:"Professional",description:"Practicing clinician"}],Zl=[{label:"Socratic",icon:Ge,description:"Discovery-based questions",color:"cyan"},{label:"Concise",icon:vt,description:"Rapid, bullet-point facts",color:"amber"},{label:"Detailed",icon:X,description:"Comprehensive explanations",color:"teal"},{label:"Clinical-Cases",icon:Le,description:"Patient scenario learning",color:"rose"},{label:"Custom",icon:ht,description:"Describe your own style",color:"purple"}],ec=[{label:"USMLE Step 1",description:"Basic sciences",disciplines:["Medical (MD/DO)"]},{label:"USMLE Step 2 CK",description:"Clinical knowledge",disciplines:["Medical (MD/DO)"]},{label:"USMLE Step 3",description:"Clinical practice",disciplines:["Medical (MD/DO)"]},{label:"COMLEX",description:"Osteopathic boards",disciplines:["Medical (MD/DO)"]},{label:"NCLEX-RN",description:"Registered nurse",disciplines:["Nursing"]},{label:"NCLEX-PN",description:"Practical nurse",disciplines:["Nursing"]},{label:"NAPLEX",description:"Pharmacy licensure",disciplines:["Pharmacy"]},{label:"PANCE/PANRE",description:"PA certification",disciplines:["Medical (MD/DO)","Other"]},{label:"MCAT",description:"Med school admission",disciplines:["Medical (MD/DO)","Other"]},{label:"University Semester Exam",description:"College/University exams",disciplines:["Medical (MD/DO)","Nursing","Pharmacy","Physiotherapy","Dentistry","Other"]},{label:"Board Certification",description:"Specialty boards",disciplines:["Medical (MD/DO)","Nursing","Pharmacy","Physiotherapy","Dentistry","Other"]},{label:"Clinical Competency",description:"Skills assessment",disciplines:["Medical (MD/DO)","Nursing","Pharmacy","Physiotherapy","Dentistry","Other"]},{label:"General Knowledge",description:"No specific exam",disciplines:["Medical (MD/DO)","Nursing","Pharmacy","Physiotherapy","Dentistry","Other"]},{label:"Custom",description:"Specify your own goal",disciplines:["Medical (MD/DO)","Nursing","Pharmacy","Physiotherapy","Dentistry","Other"]}],tc=({profile:t,onSave:n,onClose:r})=>{const[a,i]=I.useState({...t}),[o,s]=I.useState("identity"),l=I.useRef(null),[c,u]=I.useState(null),[d,p]=I.useState(!1),[h,m]=I.useState(!1),[f,g]=I.useState(null),y=[{id:"identity",label:"Identity",icon:yt},{id:"preferences",label:"Preferences",icon:W},{id:"learning",label:"Learning Style",icon:X},{id:"settings",label:"API Key",icon:Re}];return e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70 backdrop-blur-xl overflow-y-auto overflow-x-hidden py-6",children:[e.jsxs("div",{className:"absolute inset-0 pointer-events-none",children:[e.jsx("div",{className:"absolute -top-40 -left-40 w-80 h-80 bg-vital-cyan/5 rounded-full blur-3xl"}),e.jsx("div",{className:"absolute -bottom-40 -right-40 w-80 h-80 bg-tissue-rose/5 rounded-full blur-3xl"})]}),e.jsxs("div",{className:"relative w-full max-w-3xl rounded-3xl glass-slide border border-white/[0.08] overflow-hidden",children:[e.jsx("div",{className:"sticky top-0 z-20 px-8 py-6 border-b border-white/[0.04] bg-gradient-to-b from-white/[0.02] to-transparent",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-br from-vital-cyan/20 to-vital-cyan/5 flex items-center justify-center border border-vital-cyan/20",children:e.jsx(yt,{className:"w-5 h-5 text-vital-cyan"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-semibold text-serum-white tracking-tight",children:"Profile Settings"}),e.jsx("p",{className:"text-xs text-clinical-text/50 mt-0.5",children:"Personalize your learning experience"})]})]}),e.jsx("button",{onClick:r,className:"p-2.5 rounded-xl hover:bg-white/[0.08] transition-all duration-300 group",children:e.jsx(xt,{className:"w-5 h-5 text-clinical-text/60 group-hover:text-clinical-text"})})]})}),e.jsx("div",{className:"px-8 pt-6 pb-4",children:e.jsx("div",{className:"flex gap-2 rounded-xl p-1.5 bg-white/[0.02] border border-white/[0.05]",children:y.map((t,n)=>{const r=t.icon,a=o===t.id;return e.jsxs("button",{onMouseEnter:()=>u(n),onMouseLeave:()=>u(null),onClick:()=>s(t.id),className:"flex-1 flex items-center justify-center gap-2 px-4 py-3 rounded-lg text-sm font-medium transition-all duration-500 ease-out relative group "+(a?"bg-gradient-to-r from-vital-cyan/30 to-vital-cyan/10 text-vital-cyan shadow-lg shadow-vital-cyan/10":"text-clinical-text/60 hover:text-clinical-text/80"),children:[e.jsx(r,{className:"w-4 h-4"}),e.jsx("span",{children:t.label}),a&&e.jsx("div",{className:"absolute bottom-0 left-1/2 -translate-x-1/2 h-0.5 w-8 bg-gradient-to-r from-transparent via-vital-cyan to-transparent"})]},t.id)})})}),e.jsxs("div",{className:"px-8 py-8 space-y-8 overflow-y-auto max-h-[calc(100vh-300px)]",children:["identity"===o&&e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"group",children:[e.jsxs("div",{className:"flex flex-col items-center gap-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-32 h-32 rounded-2xl overflow-hidden cursor-pointer relative transition-all duration-500 "+(a.profilePicture?"border-2 border-vital-cyan/30 shadow-lg shadow-vital-cyan/10":"border-2 border-dashed border-white/[0.1] hover:border-vital-cyan/50"),onClick:()=>l.current?.click(),children:a.profilePicture?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:a.profilePicture,alt:"Profile",className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/40 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-end justify-center pb-4",children:e.jsx("span",{className:"text-xs text-white font-medium",children:"Click to change"})})]}):e.jsxs("div",{className:"w-full h-full flex flex-col items-center justify-center bg-gradient-to-br from-white/[0.03] to-white/[0.01]",children:[e.jsx(ne,{className:"w-8 h-8 text-vital-cyan/60 mb-2"}),e.jsx("span",{className:"text-xs text-clinical-text/40 text-center px-2",children:"Add photo"})]})}),a.profilePicture&&e.jsx("button",{onClick:()=>{i({...a,profilePicture:void 0})},className:"absolute -top-2 -right-2 p-2 rounded-lg bg-tissue-rose/90 hover:bg-tissue-rose transition-all duration-300 shadow-lg",children:e.jsx(ft,{className:"w-4 h-4 text-white"})})]}),e.jsx("div",{children:e.jsx("p",{className:"text-xs text-clinical-text/50 text-center",children:"Max 2MB  JPG, PNG supported"})})]}),e.jsx("input",{ref:l,type:"file",accept:"image/*",onChange:e=>{const t=e.target.files?.[0];if(t){if(t.size>2097152)return void alert("Image too large. Max 2MB.");const e=new FileReader;e.onload=e=>{i({...a,profilePicture:e.target?.result})},e.readAsDataURL(t)}},className:"hidden"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"text-sm font-semibold text-serum-white flex items-center gap-2",children:[e.jsx("span",{className:"w-2 h-2 rounded-full "+($l(a.name)?"bg-tissue-rose animate-pulse":"bg-vital-cyan")}),"Display Name",$l(a.name)&&e.jsx("span",{className:"text-tissue-rose/60 text-xs ml-1",children:""})]}),e.jsx("input",{type:"text",value:a.name,onChange:e=>i({...a,name:e.target.value}),className:"w-full px-5 py-3.5 rounded-xl glass-panel placeholder:text-clinical-text/30 focus:outline-none transition-all duration-500 ease-out font-serif italic "+($l(a.name)?"text-tissue-rose border-tissue-rose/40 focus:border-tissue-rose/70 focus:shadow-[0_0_16px_rgba(244,114,182,0.25)]":"text-serum-white focus:border-vital-cyan focus:shadow-lg focus:shadow-vital-cyan/10"),placeholder:"Your name"}),$l(a.name)&&e.jsx("p",{className:"text-[10px] text-tissue-rose/60 italic font-serif",children:" Made with love for you"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"text-sm font-semibold text-serum-white flex items-center gap-2",children:[e.jsx(te,{className:"w-4 h-4 text-synapse-amber"}),"Birthday"]}),e.jsx("input",{type:"date",value:a.birthday||"",onChange:e=>i({...a,birthday:e.target.value}),className:"w-full px-5 py-3.5 rounded-xl glass-panel text-serum-white focus:border-vital-cyan focus:outline-none transition-all duration-300 focus:shadow-lg focus:shadow-vital-cyan/10"})]}),e.jsxs("div",{className:"relative p-6 rounded-2xl overflow-hidden border border-white/[0.08] bg-gradient-to-br from-tissue-rose/8 via-tissue-rose/3 to-transparent",children:[e.jsx("div",{className:"absolute -top-20 -right-20 w-40 h-40 bg-tissue-rose/5 rounded-full blur-3xl"}),e.jsxs("div",{className:"relative z-10 flex items-start gap-4",children:[e.jsx(Oe,{size:20,fill:"currentColor",className:"text-tissue-rose/90 mt-1 flex-shrink-0"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm italic text-tissue-rose/90 leading-relaxed font-medium",children:'"I created Synapse to empower medical students and healthcare professionals with AI-driven learning tools. It began as a heartfelt project to support a special physiotherapy student close to my heart through her rigorous curriculum. As a student developer without external funding, I open-sourced it so everyone can benefit from AI-powered clinical learning."'}),e.jsx("p",{className:"text-xs text-clinical-text/40",children:"Your API key connects you to Google's Gemini AI, enabling personalized study guides, knowledge graphs, and clinical insights. If you find value in Synapse, consider supporting future development through donations."})]})]})]})]}),"preferences"===o&&e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("label",{className:"text-sm font-semibold text-serum-white flex items-center gap-2",children:[e.jsx(lt,{className:"w-4 h-4 text-vital-cyan"}),"Clinical Discipline"]}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:Ql.map(t=>{const n=t.icon,r=a.discipline===t.label;return e.jsx("button",{onClick:()=>i({...a,discipline:t.label}),className:"p-4 rounded-xl border transition-all duration-300 group "+(r?"border-vital-cyan/50 bg-vital-cyan/15 shadow-lg shadow-vital-cyan/10":"border-white/[0.05] bg-white/[0.02] hover:border-white/[0.1] hover:bg-white/[0.04]"),children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg transition-all duration-300 "+(r?"bg-vital-cyan/20":"bg-white/[0.05] group-hover:bg-white/[0.08]"),children:e.jsx(n,{className:"w-5 h-5 "+(r?"text-vital-cyan":"text-clinical-text/50 group-hover:text-clinical-text/70")})}),e.jsx("span",{className:"text-sm font-medium text-left "+(r?"text-vital-cyan":"text-clinical-text/70"),children:t.label})]})},t.label)})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("label",{className:"text-sm font-semibold text-serum-white flex items-center gap-2",children:[e.jsx(X,{className:"w-4 h-4 text-synapse-amber"}),"Training Level"]}),e.jsx("div",{className:"space-y-2.5",children:Xl.map(t=>{const n=a.level===t.label;return e.jsxs("button",{onClick:()=>i({...a,level:t.label}),className:"w-full flex items-center justify-between p-4 rounded-xl border transition-all duration-300 group "+(n?"border-synapse-amber/50 bg-gradient-to-r from-synapse-amber/15 to-synapse-amber/5 shadow-lg shadow-synapse-amber/10":"border-white/[0.05] bg-white/[0.02] hover:border-white/[0.1] hover:bg-white/[0.04]"),children:[e.jsx("span",{className:"text-sm font-medium "+(n?"text-synapse-amber":"text-clinical-text/70"),children:t.label}),e.jsx("span",{className:"text-xs text-clinical-text/40",children:t.description})]},t.label)})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"text-sm font-semibold text-serum-white flex items-center gap-2",children:[e.jsx(Le,{className:"w-4 h-4 text-neural-purple"}),"Specialties"]}),e.jsx("input",{type:"text",value:a.specialties?.join(", ")||"",onChange:e=>i({...a,specialties:e.target.value.split(",").map(e=>e.trim()).filter(Boolean)}),className:"w-full px-5 py-3.5 rounded-xl glass-panel text-serum-white placeholder:text-clinical-text/30 focus:border-vital-cyan focus:outline-none transition-all duration-300 focus:shadow-lg focus:shadow-vital-cyan/10",placeholder:"e.g., Cardiology, Nephrology, Neurology"})]})]}),"learning"===o&&e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("label",{className:"text-sm font-semibold text-serum-white flex items-center gap-2",children:[e.jsx(ht,{className:"w-4 h-4 text-synapse-amber"}),"Target Exam / Goal"]}),e.jsx("div",{className:"grid grid-cols-2 gap-3 max-h-[280px] overflow-y-auto pr-2",children:ec.filter(e=>e.disciplines.includes(a.discipline||"Medical (MD/DO)")||"General Knowledge"===e.label||"Custom"===e.label).map(t=>{const n=a.examGoal===t.label;return e.jsxs("button",{onClick:()=>i({...a,examGoal:t.label}),className:"p-3.5 rounded-xl border transition-all duration-300 text-left group "+(n?"border-synapse-amber/50 bg-synapse-amber/15 shadow-lg shadow-synapse-amber/10":"border-white/[0.05] bg-white/[0.02] hover:border-white/[0.1] hover:bg-white/[0.04]"),children:[e.jsx("div",{className:"text-xs font-semibold "+(n?"text-synapse-amber":"text-clinical-text/70"),children:t.label}),e.jsx("div",{className:"text-[11px] text-clinical-text/40 mt-1",children:t.description})]},t.label)})}),"Custom"===a.examGoal&&e.jsx("input",{type:"text",value:a.customExamGoal||"",onChange:e=>i({...a,customExamGoal:e.target.value}),className:"w-full px-5 py-3.5 rounded-xl glass-panel text-serum-white placeholder:text-clinical-text/30 focus:border-synapse-amber focus:outline-none transition-all duration-300 focus:shadow-lg focus:shadow-synapse-amber/10",placeholder:"e.g., MBBS Finals, Nursing State Board..."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("label",{className:"text-sm font-semibold text-serum-white flex items-center gap-2",children:[e.jsx(Ge,{className:"w-4 h-4 text-neural-purple"}),"Preferred Teaching Style"]}),e.jsx("div",{className:"grid gap-3",children:Zl.map(t=>{const n=t.icon,r=a.teachingStyle===t.label;return e.jsxs("button",{onClick:()=>i({...a,teachingStyle:t.label}),className:"flex items-center gap-4 p-4 rounded-xl border transition-all duration-300 group "+(r?"border-neural-purple/50 bg-neural-purple/15 shadow-lg shadow-neural-purple/10":"border-white/[0.05] bg-white/[0.02] hover:border-white/[0.1] hover:bg-white/[0.04]"),children:[e.jsx("div",{className:"p-3 rounded-lg transition-all duration-300 "+(r?"bg-neural-purple/20":"bg-white/[0.05] group-hover:bg-white/[0.08]"),children:e.jsx(n,{className:"w-5 h-5 "+(r?"text-neural-purple":"text-clinical-text/50 group-hover:text-clinical-text/70")})}),e.jsxs("div",{className:"text-left flex-1",children:[e.jsx("div",{className:"text-sm font-semibold "+(r?"text-neural-purple":"text-clinical-text/80"),children:t.label}),e.jsx("div",{className:"text-xs text-clinical-text/50 mt-0.5",children:t.description})]})]},t.label)})}),"Custom"===a.teachingStyle&&e.jsx("textarea",{value:a.customTeachingStyle||"",onChange:e=>i({...a,customTeachingStyle:e.target.value}),className:"w-full px-5 py-3.5 rounded-xl glass-panel text-serum-white placeholder:text-clinical-text/30 focus:border-neural-purple focus:outline-none transition-all duration-300 focus:shadow-lg focus:shadow-neural-purple/10 resize-none",rows:3,placeholder:"Describe your ideal learning experience..."})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"text-sm font-semibold text-serum-white flex items-center gap-2",children:[e.jsx(vt,{className:"w-4 h-4 text-synapse-amber"}),"Learning Goals"]}),e.jsx("textarea",{value:a.learningGoals||"",onChange:e=>i({...a,learningGoals:e.target.value}),className:"w-full px-5 py-3.5 rounded-xl glass-panel text-serum-white placeholder:text-clinical-text/30 focus:border-synapse-amber focus:outline-none transition-all duration-300 focus:shadow-lg focus:shadow-synapse-amber/10 resize-none",rows:4,placeholder:"What are you hoping to achieve? (e.g., Pass USMLE Step 1, Master cardiology rotations)"})]})]}),"settings"===o&&e.jsxs("div",{className:"space-y-8",children:[e.jsx("div",{className:"space-y-2",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-br from-vital-cyan/20 to-vital-cyan/5 flex items-center justify-center border border-vital-cyan/20",children:e.jsx(ee,{className:"w-5 h-5 text-vital-cyan"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-serum-white",children:"Neural Link Setup"}),e.jsx("p",{className:"text-xs text-clinical-text/50 mt-0.5",children:"Connect to Google Gemini API for personalized tutoring"})]})]})}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h4",{className:"text-sm font-semibold text-serum-white flex items-center gap-2",children:[e.jsx(st,{className:"w-4 h-4 text-vital-cyan"}),"Getting Your API Key"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex gap-3 p-3 rounded-xl bg-white/[0.02] border border-white/[0.06] hover:border-white/[0.1] transition-colors",children:[e.jsx("div",{className:"shrink-0 w-8 h-8 rounded-full bg-vital-cyan/10 border border-vital-cyan/20 flex items-center justify-center text-vital-cyan font-mono text-xs font-bold",children:"1"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"text-xs font-semibold text-gray-200",children:["Go to"," ",e.jsxs("a",{href:"https://aistudio.google.com/app/apikey",target:"_blank",rel:"noopener noreferrer",className:"text-vital-cyan hover:underline inline-flex items-center gap-1",children:["Google AI Studio",e.jsx(ye,{size:10})]})]}),e.jsx("div",{className:"text-[10px] text-gray-400 mt-1",children:"You'll need a free Google account (Gmail works)"})]})]}),e.jsxs("div",{className:"flex gap-3 p-3 rounded-xl bg-white/[0.02] border border-white/[0.06] hover:border-white/[0.1] transition-colors",children:[e.jsx("div",{className:"shrink-0 w-8 h-8 rounded-full bg-vital-cyan/10 border border-vital-cyan/20 flex items-center justify-center text-vital-cyan font-mono text-xs font-bold",children:"2"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-xs font-semibold text-gray-200",children:'Click "Create API Key"'}),e.jsx("div",{className:"text-[10px] text-gray-400 mt-1",children:'Select "Create new secret key in existing project" (or create a new project)'})]})]}),e.jsxs("div",{className:"flex gap-3 p-3 rounded-xl bg-white/[0.02] border border-white/[0.06] hover:border-white/[0.1] transition-colors",children:[e.jsx("div",{className:"shrink-0 w-8 h-8 rounded-full bg-vital-cyan/10 border border-vital-cyan/20 flex items-center justify-center text-vital-cyan font-mono text-xs font-bold",children:"3"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-xs font-semibold text-gray-200",children:"Copy the API key"}),e.jsxs("div",{className:"text-[10px] text-gray-400 mt-1",children:["It starts with"," ",e.jsx("code",{className:"bg-black/20 px-1.5 py-0.5 rounded text-[9px] font-mono",children:"AIza"})]})]})]}),e.jsxs("div",{className:"flex gap-3 p-3 rounded-xl bg-white/[0.02] border border-white/[0.06] hover:border-white/[0.1] transition-colors",children:[e.jsx("div",{className:"shrink-0 w-8 h-8 rounded-full bg-vital-cyan/10 border border-vital-cyan/20 flex items-center justify-center text-vital-cyan font-mono text-xs font-bold",children:"4"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-xs font-semibold text-gray-200",children:"Paste it below"}),e.jsx("div",{className:"text-[10px] text-gray-400 mt-1",children:"We'll verify it works, then you're ready to launch Synapse"})]})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"text-sm font-semibold text-serum-white flex items-center gap-2",children:[e.jsx(Fe,{className:"w-4 h-4 text-neural-purple"}),"API Key"]}),e.jsxs("div",{className:"relative group",children:[e.jsx("input",{type:d?"text":"password",value:a.apiKey||"",onChange:e=>{i({...a,apiKey:e.target.value}),g(null)},className:"w-full px-5 py-3.5 pr-12 rounded-xl text-serum-white font-mono text-sm placeholder:text-clinical-text/30 focus:outline-none transition-all duration-500 ease-out "+(!1===f?.valid?"glass-panel border-tissue-rose/50 focus:border-tissue-rose shadow-lg shadow-tissue-rose/10":!0===f?.valid?"glass-panel border-green-500/50 focus:border-green-500 shadow-lg shadow-green-500/10":"glass-panel focus:border-vital-cyan focus:shadow-lg focus:shadow-vital-cyan/10"),placeholder:"AIza..."}),e.jsx("button",{type:"button",onClick:()=>p(!d),className:"absolute right-12 top-1/2 -translate-y-1/2 p-1.5 text-clinical-text/40 hover:text-clinical-text transition-colors",children:d?e.jsx(xe,{className:"w-4 h-4"}):e.jsx(be,{className:"w-4 h-4"})}),!0===f?.valid&&e.jsx("div",{className:"absolute right-4 top-1/2 -translate-y-1/2",children:e.jsx("div",{className:"p-1 rounded-lg bg-green-500/20",children:e.jsx(ce,{className:"w-5 h-5 text-green-400"})})}),!1===f?.valid&&e.jsx("div",{className:"absolute right-4 top-1/2 -translate-y-1/2",children:e.jsx("div",{className:"p-1 rounded-lg bg-tissue-rose/20",children:e.jsx(se,{className:"w-5 h-5 text-tissue-rose"})})})]})]}),!1===f?.valid&&e.jsxs("div",{className:"p-4 rounded-xl bg-tissue-rose/10 border border-tissue-rose/30 flex items-start gap-3",children:[e.jsx(se,{className:"w-5 h-5 text-tissue-rose flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-tissue-rose",children:"Verification failed"}),e.jsx("p",{className:"text-xs text-tissue-rose/70 mt-1",children:f.error})]})]}),!0===f?.valid&&e.jsxs("div",{className:"p-4 rounded-xl bg-green-500/10 border border-green-500/30 flex items-start gap-3",children:[e.jsx(ce,{className:"w-5 h-5 text-green-400 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-green-400",children:"API key verified"}),e.jsx("p",{className:"text-xs text-green-300/70 mt-1",children:"Your key is valid and connected to your Google account"})]})]}),e.jsx("button",{onClick:async()=>{if(a.apiKey&&a.apiKey.startsWith("AIza")){m(!0),g(null);try{const e=new ql,t=await e.validateApiKey(a.apiKey);g(t)}catch(e){g({valid:!1,error:e.message||"Validation failed"})}finally{m(!1)}}else g({valid:!1,error:"Please enter a valid API key starting with 'AIza'"})},disabled:!a.apiKey||h,className:"w-full py-3.5 bg-gradient-to-r from-vital-cyan/30 to-vital-cyan/10 hover:from-vital-cyan/40 hover:to-vital-cyan/20 text-vital-cyan rounded-xl text-sm font-semibold flex items-center justify-center gap-2 transition-all duration-300 disabled:opacity-40 disabled:cursor-not-allowed border border-vital-cyan/20 hover:border-vital-cyan/40",children:h?e.jsxs(e.Fragment,{children:[e.jsx(ze,{className:"w-4 h-4 animate-spin"}),"Verifying..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ce,{className:"w-4 h-4"}),"Verify API Key"]})}),e.jsxs("div",{className:"relative p-5 rounded-xl border border-green-500/20 bg-gradient-to-br from-green-500/8 to-green-500/2 overflow-hidden",children:[e.jsx("div",{className:"absolute -top-12 -right-12 w-32 h-32 bg-green-500/5 rounded-full blur-3xl"}),e.jsxs("div",{className:"relative z-10 flex items-start gap-3",children:[e.jsx(ot,{className:"w-5 h-5 text-green-400/80 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("p",{className:"text-sm font-semibold text-serum-white",children:"Your data is completely private"}),e.jsxs("p",{className:"text-xs text-clinical-text/60 leading-relaxed",children:["Your API key lives"," ",e.jsx("span",{className:"text-vital-cyan font-medium",children:"only on your device"}),", encrypted in your browser's IndexedDB. It's never sent to any server. You're in complete control."]})]})]})]}),e.jsxs("div",{className:"relative p-5 rounded-xl border border-synapse-amber/20 bg-gradient-to-br from-synapse-amber/8 to-synapse-amber/2 overflow-hidden",children:[e.jsx("div",{className:"absolute -top-12 -right-12 w-32 h-32 bg-synapse-amber/5 rounded-full blur-3xl"}),e.jsxs("div",{className:"relative z-10 flex items-start gap-3",children:[e.jsx(vt,{className:"w-5 h-5 text-synapse-amber/80 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("p",{className:"text-sm font-semibold text-serum-white",children:"Free Tier Limits"}),e.jsxs("p",{className:"text-xs text-clinical-text/60 leading-relaxed",children:["Google's free plan allows"," ",e.jsx("span",{className:"font-semibold text-synapse-amber",children:"15 requests/minute"})," ","and"," ",e.jsx("span",{className:"font-semibold text-synapse-amber",children:"1M tokens/day"}),". Perfect for personal study and practice."]})]})]})]})]})]}),e.jsx("div",{className:"sticky bottom-0 z-20 px-8 py-5 border-t border-white/[0.04] bg-gradient-to-t from-white/[0.02] to-transparent backdrop-blur-sm",children:e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs text-clinical-text/50",children:[e.jsx(Fe,{className:"w-3.5 h-3.5"}),"Saved locally on your device"]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:r,className:"px-6 py-2.5 rounded-xl border border-white/[0.1] text-clinical-text/70 hover:text-clinical-text hover:border-white/[0.2] transition-all duration-300 text-sm font-medium",children:"Cancel"}),e.jsxs("button",{onClick:()=>{a.name.trim()?n({...a,updatedAt:Date.now()}):alert("Name is required.")},className:"flex items-center gap-2 px-6 py-2.5 rounded-xl bg-gradient-to-r from-vital-cyan/90 to-vital-cyan/70 hover:from-vital-cyan hover:to-vital-cyan/80 text-bio-void font-semibold transition-all duration-300 shadow-lg shadow-vital-cyan/20 text-sm",children:[e.jsx(nt,{className:"w-4 h-4"}),"Save Changes"]})]})]})})]})]})},nc=Array.from({length:12},(e,t)=>{const n=t/12*Math.PI*2-Math.PI/2,r=160+t%2*50;return{x:Math.cos(n)*r,y:Math.sin(n)*r,delay:60*t,angle:n,radius:r}}),rc=[{from:0,to:6},{from:1,to:7},{from:2,to:8},{from:3,to:9},{from:4,to:10},{from:5,to:11},{from:0,to:4},{from:4,to:8},{from:8,to:0},{from:2,to:6},{from:6,to:10},{from:10,to:2}],ac="SYNAPSE".split("").map((e,t)=>({char:e,finalX:50*t-245,finalY:0,delay:50*t})),ic="Med".split("").map((e,t)=>({char:e,finalX:125+45*t,finalY:0,delay:350+70*t})),oc=[{size:380,thickness:1,speed:45,direction:1,delay:0,dash:"4 8"},{size:520,thickness:.5,speed:35,direction:-1,delay:150,dash:"2 12"},{size:680,thickness:.3,speed:60,direction:1,delay:300,dash:"1 30"}],sc=[{text:"INITIALIZING CORTICAL MATRIX...",delay:0},{text:"ESTABLISHING NEURAL PATHWAYS...",delay:600},{text:"CALIBRATING BIO-RHYTHMS...",delay:1200},{text:"SYNCHRONIZING HEMODYNAMICS...",delay:1800},{text:"VITAL SIGNS NOMINAL.",delay:2400},{text:"CONSCIOUSNESS ONLINE.",delay:3e3}],lc=({onComplete:t,minDuration:n=8e3})=>{const[r,a]=I.useState(1),[i,o]=I.useState(!1),[s,l]=I.useState(!1),[c,u]=I.useState(!1),[d,p]=I.useState(!1),[h,m]=I.useState(!1),[f,g]=I.useState(!1),[y,x]=I.useState(!1),[b,v]=I.useState(!1),[w,N]=I.useState(!1),[E,S]=I.useState(""),[C,k]=I.useState(-1),[T,A]=I.useState(0),[j,_]=I.useState(0),[O,P]=I.useState({sys:0,dia:0}),[R,M]=I.useState(0),D=I.useRef(null),L=I.useRef(0),U=I.useRef(0),z=I.useMemo(()=>{const e=[];for(let t=0;t<20;t++)e.push({id:t,x:100*Math.random(),y:100+20*Math.random(),size:2.5*Math.random()+.8,opacity:.4*Math.random()+.15,duration:12+12*Math.random(),delay:6*Math.random(),type:"plasma"});for(let t=0;t<10;t++){const n=t/10*Math.PI*2;e.push({id:100+t,x:50+Math.cos(n)*(22+12*Math.random()),y:50+Math.sin(n)*(22+12*Math.random()),size:1.5*Math.random()+.5,opacity:.3*Math.random()+.1,duration:18+8*Math.random(),delay:4*Math.random(),type:"neuron"})}for(let t=0;t<6;t++)e.push({id:200+t,x:35+30*Math.random(),y:35+30*Math.random(),size:1.2*Math.random()+.4,opacity:.5*Math.random()+.3,duration:2.5+3*Math.random(),delay:5*Math.random(),type:"synapse"});return e},[]);return I.useEffect(()=>{const e=[];return e.push(setTimeout(()=>{a(1),o(!0)},100)),e.push(setTimeout(()=>l(!0),400)),e.push(setTimeout(()=>{a(2),u(!0)},600)),e.push(setTimeout(()=>{a(3),p(!0),g(!0)},1600)),e.push(setTimeout(()=>m(!0),2e3)),e.push(setTimeout(()=>{a(4),v(!0),x(!0)},2800)),e.push(setTimeout(()=>{a(5),N(!0),k(0)},3600)),sc.forEach((t,n)=>{e.push(setTimeout(()=>{S(t.text),k(n)},3600+t.delay))}),e.push(setTimeout(()=>{a(6);const e=performance.now(),n=r=>{const a=r-e,i=Math.min(a/700,1),o=1===i?1:1-Math.pow(2,-10*i);M(o),i<1?L.current=requestAnimationFrame(n):t()};L.current=requestAnimationFrame(n)},n)),()=>{e.forEach(clearTimeout),L.current&&cancelAnimationFrame(L.current)}},[n,t]),I.useEffect(()=>{if(!y)return;let e=0,t=0,n=0,r=0;const a=setInterval(()=>{e=Math.min(e+3,64+Math.floor(6*Math.random())),t=Math.min(t+4,98+Math.floor(2*Math.random())),n=Math.min(n+6,118+Math.floor(6*Math.random())),r=Math.min(r+3,78+Math.floor(4*Math.random())),A(e),_(t),P({sys:n,dia:r}),e>=64&&t>=98&&clearInterval(a)},60),i=setInterval(()=>{A(e=>{const t=3*(Math.random()-.5);return Math.round(Math.max(60,Math.min(74,e+t)))}),_(e=>{const t=.8*(Math.random()-.5);return Math.round(Math.max(97,Math.min(100,e+t)))})},2e3);return()=>{clearInterval(a),clearInterval(i)}},[y]),I.useEffect(()=>{if(!y||!D.current)return;const e=D.current,t=e.getContext("2d");if(!t)return;const n=e.width,r=e.height;let a=0;const i=e=>{const t=e%110/110,n=r/2;return t<.1?n-3.5*Math.sin(10*t*Math.PI):t<.15?n:t<.18?n+90*(t-.15):t<.25?n-24*Math.sin((t-.18)/.07*Math.PI):t<.3?n+55*(.3-t):t<.35?n:t<.55?n-5.5*Math.sin(5*(t-.35)*Math.PI):n},o=()=>{t.clearRect(0,0,n,r),t.strokeStyle="rgba(42, 212, 212, 0.08)",t.lineWidth=.5,t.beginPath();for(let e=0;e<n;e+=10)t.moveTo(e,0),t.lineTo(e,r);for(let e=0;e<r;e+=10)t.moveTo(0,e),t.lineTo(n,e);t.stroke(),t.strokeStyle="#F43F5E",t.lineWidth=1.6,t.shadowColor="#F43F5E",t.shadowBlur=7,t.beginPath();for(let e=0;e<n;e++){const n=e<20?e/20:1;t.globalAlpha=n;const r=i(e+a);0===e?t.moveTo(e,r):t.lineTo(e,r)}t.stroke(),t.globalAlpha=1,t.shadowBlur=0,a+=1.8,U.current=requestAnimationFrame(o)};return o(),()=>cancelAnimationFrame(U.current)},[y]),e.jsxs("div",{className:"fixed inset-0 z-[9999] overflow-hidden flex items-center justify-center",style:{backgroundColor:"#030508",cursor:"none"},children:[e.jsxs("div",{className:"absolute inset-0 flex items-center justify-center",style:{transform:`scale(${1+1.6*R}) translateZ(0)`,filter:`blur(${7*R}px) brightness(${1+.7*R})`,opacity:1-R,willChange:R>0?"transform, filter, opacity":"auto"},children:[R>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute inset-0 mix-blend-screen pointer-events-none",style:{background:"radial-gradient(circle at 50% 50%, rgba(244,63,94,0.14) 0%, transparent 45%)",transform:`translate(${16*R}px, 0) translateZ(0)`,willChange:"transform"}}),e.jsx("div",{className:"absolute inset-0 mix-blend-screen pointer-events-none",style:{background:"radial-gradient(circle at 50% 50%, rgba(42,212,212,0.12) 0%, transparent 45%)",transform:`translate(${16*-R}px, 0) translateZ(0)`,willChange:"transform"}})]}),e.jsx("div",{className:"absolute inset-0 pointer-events-none",style:{background:"\n              radial-gradient(ellipse 75% 55% at 50% 48%, rgba(42, 212, 212, 0.07) 0%, transparent 58%),\n              radial-gradient(circle at 78% 22%, rgba(159, 122, 234, 0.04) 0%, transparent 38%),\n              radial-gradient(circle at 22% 78%, rgba(244, 63, 94, 0.04) 0%, transparent 38%),\n              radial-gradient(circle at 88% 68%, rgba(240, 180, 41, 0.025) 0%, transparent 28%)\n            ",animation:"atmosphere-breathe 9s ease-in-out infinite"}}),e.jsx("div",{className:"absolute inset-0 pointer-events-none z-50",style:{backgroundImage:"url(\"data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.85' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E\")",opacity:.035,mixBlendMode:"overlay"}}),e.jsx("div",{className:"absolute inset-0 overflow-hidden z-[5]",children:z.map(t=>e.jsx("div",{className:"absolute rounded-full",style:{left:`${t.x}%`,top:`${t.y}%`,width:`${t.size}px`,height:`${t.size}px`,opacity:c?t.opacity:0,backgroundColor:"synapse"===t.type?"rgba(42, 212, 212, 0.75)":"neuron"===t.type?"rgba(159, 122, 234, 0.55)":"rgba(255, 255, 255, 0.5)",boxShadow:"synapse"===t.type?"0 0 5px rgba(42, 212, 212, 0.7)":"none",filter:`blur(${t.size<1.5?.4:0}px)`,transition:"opacity 2s ease-in",animation:"plasma"===t.type?`particle-rise ${t.duration}s cubic-bezier(0.25, 0.46, 0.45, 0.94) ${t.delay}s infinite`:"neuron"===t.type?`particle-orbit ${t.duration}s linear ${t.delay}s infinite`:`particle-spark ${t.duration}s ease-in-out ${t.delay}s infinite`}},t.id))}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:e.jsx("div",{className:"relative",style:{width:"700px",height:"400px"},children:e.jsxs("svg",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2",style:{width:"900px",height:"900px"},viewBox:"-450 -450 900 900",children:[e.jsxs("defs",{children:[e.jsxs("filter",{id:"ring-glow",x:"-50%",y:"-50%",width:"200%",height:"200%",children:[e.jsx("feGaussianBlur",{stdDeviation:"1.8",result:"blur"}),e.jsxs("feMerge",{children:[e.jsx("feMergeNode",{in:"blur"}),e.jsx("feMergeNode",{in:"SourceGraphic"})]})]}),e.jsxs("linearGradient",{id:"ring-grad",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[e.jsx("stop",{offset:"0%",stopColor:"rgba(42, 212, 212, 0)"}),e.jsx("stop",{offset:"35%",stopColor:"rgba(42, 212, 212, 0.2)"}),e.jsx("stop",{offset:"65%",stopColor:"rgba(159, 122, 234, 0.15)"}),e.jsx("stop",{offset:"100%",stopColor:"rgba(42, 212, 212, 0)"})]})]}),oc.map((t,n)=>e.jsx("circle",{r:t.size/2,fill:"none",stroke:"url(#ring-grad)",strokeWidth:t.thickness,strokeDasharray:t.dash,filter:"url(#ring-glow)",style:{opacity:f?.75:0,transform:f?"scale(1)":"scale(0.75)",transition:"all 2.2s cubic-bezier(0.34, 1.56, 0.64, 1)",transitionDelay:`${t.delay}ms`,transformOrigin:"center",animation:f?`ring-spin-${t.direction>0?"cw":"ccw"} ${t.speed}s linear infinite`:"none"}},n))]})})}),e.jsxs("div",{className:"relative z-10",style:{width:"700px",height:"400px"},children:[ac.map(({char:t,finalX:n,finalY:r,delay:a},i)=>e.jsx("span",{className:"absolute left-1/2 top-1/2 font-light text-5xl md:text-7xl text-white",style:{fontFamily:'"Manrope", sans-serif',opacity:c?1:0,transform:c?`translate(calc(-50% + ${n}px), calc(-50% + ${r}px))`:"translate(-50%, -50%) scale(0)",transition:"all 0.9s cubic-bezier(0.34, 1.56, 0.64, 1)",transitionDelay:`${a}ms`,textShadow:c?"0 0 12px rgba(255,255,255,0.25)":"none"},children:t},`syn-${i}`)),ic.map(({char:t,finalX:n,finalY:r,delay:a},i)=>e.jsx("span",{className:"absolute left-1/2 top-1/2 italic font-normal text-5xl md:text-7xl text-[#2AD4D4]",style:{fontFamily:'"Cormorant Garamond", serif',opacity:c?1:0,transform:c?`translate(calc(-50% + ${n}px), calc(-50% + ${r}px))`:"translate(-50%, -50%) scale(0)",transition:"all 0.9s cubic-bezier(0.34, 1.56, 0.64, 1)",transitionDelay:`${a}ms`,textShadow:c?"0 0 18px rgba(42, 212, 212, 0.45), 0 0 36px rgba(42, 212, 212, 0.2)":"none"},children:t},`med-${i}`)),e.jsxs("svg",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 pointer-events-none",width:"500",height:"500",viewBox:"-250 -250 500 500",style:{overflow:"visible"},children:[e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:"helix-grad",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[e.jsx("stop",{offset:"0%",stopColor:"rgba(42, 212, 212, 0.65)"}),e.jsx("stop",{offset:"50%",stopColor:"rgba(159, 122, 234, 0.5)"}),e.jsx("stop",{offset:"100%",stopColor:"rgba(42, 212, 212, 0.4)"})]}),e.jsxs("filter",{id:"node-glow",children:[e.jsx("feGaussianBlur",{stdDeviation:"2",result:"coloredBlur"}),e.jsxs("feMerge",{children:[e.jsx("feMergeNode",{in:"coloredBlur"}),e.jsx("feMergeNode",{in:"SourceGraphic"})]})]})]}),rc.map(({from:t,to:n},r)=>{const a=nc[t],i=nc[n];return e.jsx("line",{x1:h?a.x:0,y1:h?a.y:0,x2:h?i.x:0,y2:h?i.y:0,stroke:"url(#helix-grad)",strokeWidth:"0.6",strokeOpacity:h?.35:0,style:{transition:"all 1.1s cubic-bezier(0.34, 1.56, 0.64, 1)",transitionDelay:35*r+"ms"}},`conn-${r}`)}),nc.map((t,n)=>e.jsx("circle",{cx:d?t.x:0,cy:d?t.y:0,r:d?n%2==0?3.5:2.5:0,fill:n%2==0?"#2AD4D4":"#9F7AEA",filter:"url(#node-glow)",style:{transition:"all 0.7s cubic-bezier(0.34, 1.56, 0.64, 1)",transitionDelay:`${t.delay}ms`}},`node-${n}`))]}),e.jsx("p",{className:"absolute left-1/2 -translate-x-1/2 text-center italic text-lg md:text-xl text-slate-300/85",style:{fontFamily:'"Cormorant Garamond", serif',top:"72%",opacity:b?1:0,transform:b?"translate(-50%, 0)":"translate(-50%, 18px)",transition:"all 0.9s ease-out",textShadow:"0 0 8px rgba(42, 212, 212, 0.15)"},children:"Your brain for medical learning."})]}),e.jsx("div",{className:"absolute top-7 right-7 md:top-9 md:right-9 z-40 transition-all duration-1200",style:{opacity:y?1:0,transform:y?"translateX(0) scale(1)":"translateX(16px) scale(0.92)"},children:e.jsxs("div",{className:"flex flex-col items-end gap-3",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx("span",{className:"text-[9px] font-mono text-gray-500 tracking-[0.3em] uppercase",children:"HR"}),e.jsx("span",{className:"text-2xl font-light text-[#F43F5E] tabular-nums leading-none",style:{fontFamily:'"Manrope", sans-serif',letterSpacing:"-0.02em"},children:T||"--"})]}),e.jsx("div",{className:"w-2.5 h-2.5 rounded-full bg-[#F43F5E]",style:{animation:T>0?"cardiac-pulse 1.3s ease-in-out infinite":"none",boxShadow:"0 0 10px rgba(244, 63, 94, 0.6)"}})]}),e.jsxs("div",{className:"relative w-32 h-10 border-b border-white/8 overflow-hidden rounded-sm bg-[#030508]/40",children:[e.jsx("canvas",{ref:D,width:128,height:40,className:"absolute inset-0"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-[#030508] via-transparent to-[#030508] pointer-events-none"})]}),e.jsxs("div",{className:"flex gap-5 mt-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-[#2AD4D4]/75"}),e.jsx("span",{className:"font-mono text-[8px] text-gray-600 uppercase tracking-[0.18em]",children:"SpO"}),e.jsxs("span",{className:"font-mono text-[10px] text-[#2AD4D4] tabular-nums",children:[j||"--","%"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-[#F0B429]/75"}),e.jsx("span",{className:"font-mono text-[8px] text-gray-600 uppercase tracking-[0.18em]",children:"BP"}),e.jsxs("span",{className:"font-mono text-[10px] text-[#F0B429] tabular-nums",children:[O.sys||"--","/",O.dia||"--"]})]})]})]})}),e.jsxs("div",{className:"absolute bottom-0 left-0 right-0 px-8 md:px-12 pb-7 md:pb-9 z-40 flex justify-between items-end transition-all duration-1200",style:{opacity:w?1:0,transform:w?"translateY(0) scale(1)":"translateY(12px) scale(0.95)"},children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex gap-2 items-center min-h-[20px]",children:[e.jsx("span",{className:"w-2 h-2 bg-[#2AD4D4] rounded-full",style:{animation:E?"pulse-indicator 1.5s ease-in-out infinite":"none",boxShadow:"0 0 8px rgba(42, 212, 212, 0.6)"}}),e.jsxs("span",{className:"font-mono text-[10px] md:text-[11px] text-[#2AD4D4]/75 tracking-[0.22em] uppercase transition-all duration-400",style:{fontFamily:'"JetBrains Mono", monospace'},children:[E,E&&e.jsx("span",{className:"animate-blink",children:"_"})]})]}),e.jsx("div",{className:"flex gap-1.5 ml-4",children:sc.map((t,n)=>e.jsx("div",{className:"h-0.5 rounded-full transition-all duration-400",style:{width:n<=C?"28px":"10px",backgroundColor:n<=C?"rgba(42, 212, 212, 0.65)":"rgba(255, 255, 255, 0.12)"}},n))}),e.jsxs("div",{className:"flex gap-6 mt-2 opacity-60",children:[e.jsxs("div",{className:"flex flex-col gap-0.5",children:[e.jsx("span",{className:"font-mono text-[7px] text-gray-600 uppercase tracking-[0.25em]",children:"System"}),e.jsx("span",{className:"text-[10px] text-gray-500 tracking-wide",children:"COGNITIVE_MATRIX"})]}),e.jsxs("div",{className:"flex flex-col gap-0.5",children:[e.jsx("span",{className:"font-mono text-[7px] text-gray-600 uppercase tracking-[0.25em]",children:"AI Core"}),e.jsx("span",{className:"text-[10px] text-[#2AD4D4]/60 tracking-wide",children:"GEMINI 2.5 FLASH"})]})]})]}),e.jsx("div",{className:"hidden md:flex gap-4 font-mono text-[9px] uppercase tracking-[0.2em] opacity-50",children:["PHYSIO","MD/DO","RN","PA","PHARM","PT"].map((t,n)=>e.jsx("span",{className:"transition-all duration-500",style:{color:0===n?"rgba(42, 212, 212, 0.55)":"rgba(255, 255, 255, 0.25)",transitionDelay:80*n+"ms"},children:t},t))})]})]}),e.jsx("style",{children:"\n        /* \n           ATMOSPHERIC ANIMATIONS\n            */\n        \n        @keyframes atmosphere-breathe {\n          0%, 100% { \n            transform: scale(1) rotate(0deg); \n            opacity: 0.65; \n          }\n          25% { \n            transform: scale(1.06) rotate(0.6deg); \n            opacity: 0.75;\n          }\n          50% { \n            transform: scale(1.12) rotate(0deg); \n            opacity: 0.95; \n          }\n          75% { \n            transform: scale(1.06) rotate(-0.6deg); \n            opacity: 0.75;\n          }\n        }\n\n        /* \n           GENESIS DOT ANIMATIONS\n            */\n        \n        @keyframes genesis-pulse {\n          0% { \n            transform: translate(-50%, -50%) scale(1); \n            opacity: 0.6; \n          }\n          100% { \n            transform: translate(-50%, -50%) scale(14); \n            opacity: 0; \n          }\n        }\n        \n        @keyframes genesis-pulse-outer {\n          0% { \n            transform: translate(-50%, -50%) scale(1); \n            opacity: 0.3; \n          }\n          100% { \n            transform: translate(-50%, -50%) scale(6); \n            opacity: 0; \n          }\n        }\n\n        /* \n           PARTICLE ANIMATIONS (Morphogenetic Flow)\n            */\n        \n        @keyframes particle-rise {\n          0% { \n            transform: translateY(0) scale(1); \n            opacity: 0; \n          }\n          12% { \n            opacity: 1; \n            transform: translateY(-8px) scale(1.15);\n          }\n          88% { \n            opacity: 1; \n            transform: translateY(-8px) scale(1.15);\n          }\n          100% { \n            transform: translateY(-105vh) scale(0.35); \n            opacity: 0; \n          }\n        }\n        \n        @keyframes particle-orbit {\n          from { \n            transform: rotate(0deg) translateX(25px) rotate(0deg); \n          }\n          to { \n            transform: rotate(360deg) translateX(25px) rotate(-360deg); \n          }\n        }\n        \n        @keyframes particle-spark {\n          0%, 100% { \n            opacity: 0; \n            transform: scale(0.6); \n          }\n          15% { \n            opacity: 1; \n            transform: scale(1.7) rotate(0deg);\n          }\n          50% { \n            opacity: 1; \n            transform: scale(2) rotate(180deg);\n          }\n          85% { \n            opacity: 1; \n            transform: scale(1.7) rotate(360deg);\n          }\n        }\n\n        /* \n           RING ANIMATIONS (Morphogenetic Scanner)\n            */\n        \n        @keyframes ring-spin-cw {\n          from { transform: rotate(0deg); }\n          to { transform: rotate(360deg); }\n        }\n        \n        @keyframes ring-spin-ccw {\n          from { transform: rotate(0deg); }\n          to { transform: rotate(-360deg); }\n        }\n\n        /* \n           CARDIAC & VITALS ANIMATIONS\n            */\n        \n        @keyframes cardiac-pulse {\n          0%, 100% { \n            transform: scale(1); \n            opacity: 0.75; \n          }\n          18% { \n            transform: scale(1.4); \n            opacity: 1; \n          }\n          36% { \n            transform: scale(1); \n          }\n          54% { \n            transform: scale(1.25); \n            opacity: 0.9; \n          }\n          72% { \n            transform: scale(1); \n          }\n        }\n        \n        @keyframes pulse-indicator {\n          0%, 100% { \n            opacity: 0.7; \n          }\n          50% { \n            opacity: 1; \n          }\n        }\n\n        /* \n           TERMINAL & UI ELEMENTS\n            */\n        \n        @keyframes blink {\n          0%, 100% { opacity: 1; }\n          50% { opacity: 0; }\n        }\n        .animate-blink {\n          animation: blink 1.1s step-end infinite;\n        }\n      "})]})},cc=[{start:5,end:11,period:"morning",prefix:"Good morning",icon:ut,accentColor:"text-vital-cyan",gradient:"from-serum-white via-vital-cyan to-emerald-300"},{start:11,end:17,period:"afternoon",prefix:"Good afternoon",icon:ct,accentColor:"text-synapse-amber",gradient:"from-synapse-amber via-amber-100 to-vital-cyan"},{start:17,end:22,period:"evening",prefix:"Good evening",icon:dt,accentColor:"text-neural-purple",gradient:"from-neural-purple via-violet-200 to-clinical-slate"},{start:22,end:1,period:"late_night",prefix:"Good night",icon:$e,accentColor:"text-vital-cyan",gradient:"from-indigo-300 via-vital-cyan to-slate-400"},{start:1,end:5,period:"early_morning",prefix:"Hello",icon:me,accentColor:"text-clinical-slate",gradient:"from-clinical-slate via-gray-200 to-serum-white"}],uc={morning:["You were made for this work.","Breathe. You are ready.","The world needs your hands today.","Step in. Be brave.","Your future patients are waiting."],afternoon:["Keep pushing. It matters.","Your fatigue proves your love.","Hard things build great hearts.","Don't give up. Not now.","You are stronger than you feel."],evening:["You gave enough today.","Be proud of your scars.","Let it go. You did good.","Healing starts with rest.","Peace. You earned it."],late_night:["The quiet hours build heroes.","You are not alone in this.","Your dedication is beautiful.","The world sleeps. You rise.","Rest. The work waits."],early_morning:["Grind now. Save lives later.","This is where you become great.","Eyes up. Keep moving.","Resilience is quiet work.","One foot in front of the other."]},dc={"Medical (MD/DO)":{morning:["Heavy coat, light heart.","Trust your gut. Train your mind.","Walk with purpose today.","Lead with kindness.","You carry a lot. Carry it well."],afternoon:["Sharpen your mind. Soften your heart.","Lives depend on your focus.","The burden is heavy. You are strong.","Think clearly. Care deeply.","Your decisions matter."],evening:["Leave the hospital in the hospital.","Forgive yourself for today.","You are more than a score.","Rest your diagnostic mind.","Silence the doubts."],late_night:["The sleepless watch over the weak.","You are the light in the dark.","Stand tall. You are needed.","Endure. It's worth it."],early_morning:["Excellence has no closing time.","Forging a doctor in the fire.","This is the price of mastery.","Keep the oath close."]},Nursing:{morning:["You are the heartbeat here.","Your presence is the medicine.","Be their calm in the storm.","Touch lives. Heal hearts."],afternoon:["Your patience is a superpower.","Don't pour from an empty cup.","You see what others miss.","Hold on. You're doing great.","Your voice saves lives."],evening:["Take off the scrubs. Exhale.","You carried them. Now rest.","Be gentle with yourself tonight.","Your compassion is enough.","Wash away the day."],late_night:["Guardian of the quiet hours.","You are their safe place.","The night trusts you.","Stand watch. Stand strong."],early_morning:["Unseen work. Infinite value.","Tired eyes, full heart.","Keep shining, healer.","Almost home. Stay strong."]},Pharmacy:{morning:["Precision is your love language.","Protect them. Guide them.","You are the silent guardian.","Accuracy saves lives.","Clear mind, steady hand."],afternoon:["Catch the error. Be the safety.","Your focus is their shield.","Knowledge is your weapon.","Stay sharp. Stay kind.","Every detail matters."],evening:["The safety net holds. Rest now.","Quiet your analytical mind.","You did your duty.","Balance is your prescription.","Disconnect to recharge."],late_night:["Vigilance never sleeps.","The unseen protector.","Your expertise is vital.","Stay awake. Stay true."],early_morning:["Compound wisdom. Distill hope.","Synthesis requires energy.","Focus through the fog.","Your rigor is beautiful."]},Physiotherapy:{morning:["Help them rise again.","Movement is freedom.","Be their strength today.","Empower every step.","Healing happens in motion."],afternoon:["Push them gently. Push yourself.","Celebrate the small wins.","Your energy moves them.","Pain changes. Hope remains.","Guide them through the struggle."],evening:["Rest your own body now.","You lifted others. Rest.","Reflect on the progress.","Recover to rebuild.","Stretch your spirit."],late_night:["Equilibrium takes time.","Stability comes from within.","Find your center.","Strength in the silence."],early_morning:["Build resilience. Start now.","Motion creates emotion.","Endurance starts here.","Step forward. Always."]},Dentistry:{morning:["Restore the smile. Restore the soul.","Precision with a gentle touch.","Create confidence today.","Be gentle. Be exact.","Healing is an art."],afternoon:["Steady hands, kind heart.","Focus on the person, not just the tooth.","Relieve their pain.","Craftsmanship takes patience.","Stay calm. They need it."],evening:["Rest your hands. Rest your eyes.","Let go of the perfectionism.","You brought relief today.","Unclench. Breathe.","Silence the drill."],late_night:["Anatomy requires respect.","Study the nerve. Know the pain.","Deep roots. Strong foundation.","Quiet focus."],early_morning:["Fine motor. Fine spirit.","Prepare for the delicate work.","Build something lasting.","Precision mindset."]},Other:{morning:["Your path is unique. Own it.","Bring your full self today.","Find your place. Fill it.","You belong here.","Start with purpose."],afternoon:["Carve your own way.","Your perspective is needed.","Keep building your legacy.","Stay curious. Stay open.","Work hard. Love harder."],evening:["Honor your journey.","Rest is part of the work.","Trust your timing.","Be proud of where you are.","Close the chapter."],late_night:["Deep work. Deep soul.","The outliers change the world.","Focus on your truth.","Find clarity in the dark."],early_morning:["Blaze a new trail.","Wake up. Show up.","Define your own success.","Begin again."]}};function pc(e,t=2e4){const{prefix:n,timePeriod:r,icon:a,accentColor:i,gradient:o}=function(){const e=(new Date).getHours();for(const t of cc)if(t.start>t.end){if(e>=t.start||e<t.end)return{prefix:t.prefix,timePeriod:t.period,icon:t.icon,accentColor:t.accentColor,gradient:t.gradient}}else if(e>=t.start&&e<t.end)return{prefix:t.prefix,timePeriod:t.period,icon:t.icon,accentColor:t.accentColor,gradient:t.gradient};return{prefix:"Welcome",timePeriod:"morning",icon:ut,accentColor:"text-vital-cyan",gradient:"from-serum-white via-vital-cyan to-emerald-300"}}(),s=function(e,t,n=2e4){let r;return r=t&&dc[t]?dc[t][e]:uc[e],r[Math.floor(Date.now()/n)%r.length]}(r,e,t);return{prefix:n,timePeriod:r,suffix:s,animation:"fadeInUp",icon:a,accentColor:i,gradient:o}}function hc(e){const t=pc(e);return{prefix:t.prefix,suffix:t.suffix||"",timePeriod:t.timePeriod,icon:t.icon,accentColor:t.accentColor,gradient:t.gradient}}function mc(e){return hc(e)}const fc=({fileId:t})=>{const[n,r]=I.useState(null),[a,i]=I.useState(!0);I.useEffect(()=>{let e=!0;return async function(){try{const n=await fl.download(t);if(!e||!n)return;const a=await fl.getMetadata(t);e&&a&&r({file_name:a.file_name,size:a.size,mime_type:a.mime_type})}catch(n){}finally{e&&i(!1)}}(),()=>{e=!1}},[t]);return a?e.jsx("div",{className:"flex items-center justify-between p-3 rounded-lg bg-white/[0.02] border border-white/[0.04]",children:e.jsx("div",{className:"text-gray-400 text-[13px]",children:"Loading..."})}):n?e.jsxs("div",{className:"flex items-center justify-between gap-3 p-4 rounded-lg bg-white/[0.02] border border-white/[0.04] hover:bg-white/[0.05] hover:border-white/[0.08] transition-all",children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-lg bg-tissue-rose/10 border border-tissue-rose/20 flex items-center justify-center",children:e.jsx(Ce,{size:16,className:"text-tissue-rose"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"text-[14px] text-gray-100 truncate font-medium",children:n.file_name}),e.jsxs("div",{className:"text-[12px] text-gray-500",children:[(n.size/1024).toFixed(1)," KB"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[e.jsx("button",{onClick:async()=>{try{const e=await fl.createObjectURL(t);e&&window.open(e,"_blank")}catch(e){}},className:"px-3 py-1.5 bg-white/5 hover:bg-white/10 rounded-md text-[12px] font-medium text-gray-300 hover:text-white transition-all",title:"Open in new tab",children:"Open"}),e.jsxs("button",{onClick:async()=>{try{const e=await fl.download(t);if(!e||!n)return;const r=URL.createObjectURL(e),a=document.createElement("a");a.href=r,a.download=n.file_name,document.body.appendChild(a),a.click(),a.remove(),URL.revokeObjectURL(r)}catch(e){}},className:"px-3 py-1.5 bg-white/5 hover:bg-white/10 rounded-md text-[12px] font-medium text-gray-300 hover:text-white transition-all flex items-center gap-1",title:"Download file",children:[e.jsx(ge,{size:12}),"Download"]})]})]}):null},gc=new ql,yc=()=>{const[r,a]=I.useState(Hl.IDLE),[i,o]=I.useState([]),[s,l]=I.useState(null),[c,u]=I.useState("dashboard"),[d,p]=I.useState([]),[h,m]=I.useState(""),[f,g]=I.useState("guide"),[y,x]=I.useState(!1),[b,v]=I.useState(null),[w,N]=I.useState(!1),[E,S]=I.useState(!1),[C,k]=I.useState(!1),[T,A]=I.useState(null),[j,_]=I.useState(!1),[O,P]=I.useState(!1),[R,M]=I.useState("extracting"),[D,L]=I.useState(""),[U,z]=I.useState(0),[F,q]=I.useState(!1),[H,$]=I.useState(""),[B,V]=I.useState(0),[Y,K]=I.useState(!1),[J,Q]=I.useState(null),[X,ne]=I.useState(!1),[re,ae]=I.useState(!1),[ie,oe]=I.useState(!0);I.useEffect(()=>{(async()=>{try{const e=await cl.get();if(e){let t;if(e.profile_picture_id){const n=await fl.download(e.profile_picture_id);n&&(t=await yl(n))}Q(function(e,t){return{name:e.name,discipline:e.discipline,level:e.level,teachingStyle:e.teaching_style,customTeachingStyle:e.custom_teaching_style,examGoal:e.exam_goal,customExamGoal:e.custom_exam_goal,profilePicture:t,birthday:e.birthday,theme:e.theme,specialties:e.specialties,learningGoals:e.learning_goals,apiKey:e.api_key,createdAt:new Date(e.created_at).getTime(),updatedAt:new Date(e.updated_at).getTime()}}(e,t))}}catch(e){}finally{ae(!0)}})()},[]),I.useEffect(()=>{if(!J||!re)return;(async()=>{try{let t;if(J.profilePicture){const e=await fetch(J.profilePicture).then(e=>e.blob());t=await fl.upload(e,{fileName:"profile-picture",relatedNoteId:"profile"})}await cl.save({...(e=J,{name:e.name,discipline:e.discipline,level:e.level,teaching_style:e.teachingStyle,custom_teaching_style:e.customTeachingStyle,exam_goal:e.examGoal,custom_exam_goal:e.customExamGoal,profile_picture_id:void 0,birthday:e.birthday,theme:e.theme,specialties:e.specialties,learning_goals:e.learningGoals,api_key:e.apiKey}),profile_picture_id:t})}catch(t){}var e})()},[J,re]),I.useEffect(()=>{const e=me.current;if(!e)return;const t=t=>{const n=e.getBoundingClientRect(),r=t.clientX-n.left,a=t.clientY-n.top,i=n.width/2,o=n.height/2,s=(a-o)/o*-8,l=(r-i)/i*8;e.style.transform=`perspective(1000px) rotateX(${s}deg) rotateY(${l}deg) scale3d(1.02, 1.02, 1.02)`},n=()=>{e.style.transform="perspective(1000px) rotateX(0deg) rotateY(0deg) scale3d(1, 1, 1)"};return e.addEventListener("mousemove",t),e.addEventListener("mouseleave",n),()=>{e.removeEventListener("mousemove",t),e.removeEventListener("mouseleave",n)}},[]);const se=I.useCallback(e=>{Q(e),ne(!1)},[]),le=I.useMemo(()=>{if(!J?.birthday)return!1;const e=new Date,t=new Date(J.birthday);return e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()},[J?.birthday]),[ue,de]=I.useState(()=>hc(J?.discipline));I.useEffect(()=>{de(mc(J?.discipline));const e=setInterval(()=>de(mc(J?.discipline)),2e4);return()=>clearInterval(e)},[J?.discipline]);const pe=I.useRef(null),me=I.useRef(null),fe=I.useMemo(()=>i.find(e=>e.id===s),[i,s]),[ge,xe]=I.useState(!1),be=I.useRef(!1);I.useEffect(()=>{(async()=>{try{const e=await ml.list(),t=await Promise.all(e.map(async e=>{let t;if(e.audio_file_id){const n=await fl.download(e.audio_file_id);n&&(t=await yl(n))}return function(e,t){return{id:e.id,title:e.title,markdownContent:e.markdown_content,summary:e.summary,eli5Analogy:e.eli5_analogy,pearls:e.pearls,graphData:e.graph_data,podcastScript:e.podcast_script,audioBase64:t,cacheName:e.cache_name,timestamp:new Date(e.created_at).getTime(),sourceFileNames:e.source_file_names,sourceFileIds:e.source_file_ids||[],sources:e.sources}}(e,t)}));o(t)}catch(e){}finally{xe(!0),be.current=!0}})()},[]),I.useEffect(()=>{if(!be.current)return;(async()=>{try{for(const e of i){let t;if(e.audioBase64){const n=gl(e.audioBase64,"audio/wav");t=await fl.upload(n,{fileName:"podcast-audio.wav",relatedNoteId:e.id})}await ml.save({...bl(e),audio_file_id:t})}}catch(e){}})()},[i]);const ve=I.useCallback(e=>{if(e.target.files){Array.from(e.target.files).forEach(e=>{const t=new FileReader;t.onload=t=>{const n=t.target?.result;p(t=>[...t,{file:e,base64:n,type:e.type}])},t.readAsDataURL(e)})}pe.current&&(pe.current.value="")},[]),we=I.useCallback(e=>{p(t=>t.filter((t,n)=>n!==e))},[]),Se=async()=>{if(0!==d.length)try{P(!0),M("extracting"),L(""),z(0),K(!1),a(Hl.BUILDING_GRAPH),await new Promise(e=>setTimeout(e,300));const n=crypto.randomUUID(),r={id:n,timestamp:Date.now(),title:"Generating...",sourceFileNames:d.map(e=>e.file.name),markdownContent:"_Connecting to Gemini 2.5 Flash (Thinking Mode)..._",summary:"",pearls:[],graphData:{nodes:[],links:[]},podcastScript:[],sources:[]};let i=null,s=null;const c=await gc.augmentClinicalNoteStreaming(d,h||"Untitled Session",J,e=>{if("metadata"===e.stage)e.subStage&&e.subStage!==i&&(i=e.subStage,M(e.subStage)),e.data?.graphData&&(M("structuring"),a(Hl.WRITING_GUIDE),o(t=>t.find(e=>e.id===n)?t.map(t=>t.id===n?{...t,title:e.data?.title||t.title,summary:e.data?.summary||t.summary,eli5Analogy:e.data?.eli5Analogy,pearls:e.data?.pearls||[],graphData:e.data?.graphData||t.graphData}:t):[{...r,title:e.data?.title||r.title,summary:e.data?.summary||r.summary,eli5Analogy:e.data?.eli5Analogy,pearls:e.data?.pearls||[],graphData:e.data?.graphData||r.graphData},...t]),l(n),u("dashboard"),g("guide"));else if("markdown"===e.stage){e.subStage&&e.subStage!==s&&(s=e.subStage,M(e.subStage));const t=e.data?.markdownContent||"";z(t.length),o(e=>e.map(e=>e.id===n?{...e,markdownContent:t}:e))}else"complete"===e.stage&&(e.data&&(o(t=>t.map(t=>t.id===n?{...t,markdownContent:e.data?.markdownContent||t.markdownContent,sources:e.data?.sources||[]}:t)),z(e.data.markdownContent?.length||0)),P(!1),K(!0),a(Hl.COMPLETE))},e=>{e&&e.trim()&&L(e)});c.id=n,o(e=>e.map(e=>e.id===n?{...e,...c,id:n}:e));try{if(d&&d.length>0){const t=[];for(const r of d)try{if(r.file){const e=await fl.upload(r.file,{fileName:r.file.name,relatedNoteId:n});t.push(e)}}catch(e){}t.length>0&&o(e=>e.map(e=>e.id===n?{...e,sourceFileIds:t}:e))}}catch(t){}p([]),m(""),a(Hl.COMPLETE),P(!1),K(!0)}catch(t){P(!1),"EMPTY_CONTENT"===t.code?($(t.message||"Content generation incomplete"),q(!0),a(Hl.ERROR)):(a(Hl.ERROR),alert("Analysis failed. Please try again."))}},ke=async()=>{if(fe&&s){N(!0);try{const e=await gc.generatePodcastScript(fe.title,fe.summary,fe.markdownContent),t=await gc.generateNativePodcastAudio(e);t||alert("Neural Audio generation unavailable (Capacity Limit). Showing script only."),o(n=>n.map(n=>n.id===s?{...n,podcastScript:e,audioBase64:t||void 0}:n))}catch(e){alert("Failed to generate audio. Try again.")}finally{N(!1)}}},Te=I.useCallback(()=>{const e=window.getSelection();if(e&&e.toString().trim().length>0){const t=e.toString().trim();t.length>=5&&t.length<=1500&&(A(t),k(!0))}},[]),Ie=I.useCallback(()=>{A(null)},[]),_e=I.useCallback(()=>{k(e=>!e),C&&A(null)},[C]);if(ie)return e.jsx(lc,{onComplete:()=>oe(!1),minDuration:5500});if(!re)return null;if(!J)return e.jsx(Jl,{onComplete:e=>{Q(e)}});const Oe="dashboard"===c&&s&&fe;return e.jsxs(e.Fragment,{children:[!Oe&&G.createPortal(e.jsx(Al,{}),document.getElementById("bio-background-root")||document.body),e.jsx("div",{className:"fixed inset-0 z-[100] bg-bio-void/95 backdrop-blur-xl hidden portrait:flex md:portrait:flex lg:portrait:hidden items-center justify-center p-8",children:e.jsxs("div",{className:"text-center max-w-sm",children:[e.jsx("div",{className:"w-20 h-20 mx-auto mb-6 rounded-2xl bg-vital-cyan/10 border border-vital-cyan/20 flex items-center justify-center",children:e.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",className:"text-vital-cyan animate-pulse",children:[e.jsx("rect",{x:"4",y:"2",width:"16",height:"20",rx:"2"}),e.jsx("path",{d:"M12 18h.01"}),e.jsx("path",{d:"M8 22h8",strokeDasharray:"2 2"})]})}),e.jsx("h2",{className:"text-2xl font-serif italic text-serum-white mb-3",children:"Rotate for Best Experience"}),e.jsxs("p",{className:"text-gray-400 text-sm leading-relaxed mb-6",children:["Synapse Med works beautifully in"," ",e.jsx("span",{className:"text-vital-cyan font-semibold",children:"landscape mode"})," ","on tablets. Please rotate your iPad or tablet horizontally."]}),e.jsxs("div",{className:"flex items-center justify-center gap-2 text-[11px] text-gray-500 font-mono",children:[e.jsx("span",{className:"w-8 h-5 border border-gray-500 rounded-sm flex items-center justify-center",children:e.jsx("span",{className:"w-1 h-1 bg-gray-500 rounded-full"})}),e.jsx("span",{children:""}),e.jsx("span",{className:"w-12 h-7 border border-vital-cyan rounded-sm flex items-center justify-center",children:e.jsx("span",{className:"w-1 h-1 bg-vital-cyan rounded-full"})})]})]})}),e.jsxs("div",{className:"min-h-screen bg-transparent text-serum-white font-sans flex overflow-hidden transition-colors duration-500 relative",children:[e.jsx(Ot,{isThinking:O,stage:R,currentThought:D,markdownProgress:U}),X&&J&&e.jsx(tc,{profile:J,onSave:se,onClose:()=>ne(!1)}),fe&&e.jsx(Ul,{note:fe,isOpen:j,onClose:()=>_(!1)}),F&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center px-4 bg-black/80 backdrop-blur-xl animate-fadeIn",children:e.jsxs("div",{className:"relative bg-gradient-to-b from-bio-deep to-bio-void border border-white/[0.06] rounded-3xl shadow-2xl p-10 max-w-lg w-full transform animate-scaleIn overflow-hidden",children:[e.jsx("div",{className:"absolute -top-32 -right-32 w-64 h-64 bg-vital-cyan/10 rounded-full blur-[100px] pointer-events-none"}),e.jsx("div",{className:"absolute -bottom-20 -left-20 w-40 h-40 bg-synapse-amber/10 rounded-full blur-[80px] pointer-events-none"}),e.jsx("div",{className:"absolute top-0 left-1/2 -translate-x-1/2 w-40 h-px bg-gradient-to-r from-transparent via-vital-cyan/50 to-transparent"}),e.jsxs("div",{className:"flex justify-center mb-8 relative",children:[e.jsx("div",{className:"absolute inset-0 w-24 h-24 mx-auto rounded-full bg-vital-cyan/10 animate-ping"}),e.jsx("div",{className:"relative w-24 h-24 rounded-2xl bg-gradient-to-br from-vital-cyan/15 to-clinical-teal/10 border border-vital-cyan/20 flex items-center justify-center backdrop-blur-sm",children:e.jsx(W,{className:"w-12 h-12 text-vital-cyan animate-pulse"})})]}),e.jsx("h3",{className:"text-3xl font-serif italic text-center text-serum-white mb-2 relative",children:"Taking a Moment"}),e.jsx("p",{className:"text-center text-vital-cyan/80 text-sm font-sans tracking-wide mb-6",children:"Our neural engine needs to recalibrate"}),e.jsxs("div",{className:"glass-slide rounded-2xl p-5 mb-8 relative",children:[e.jsx("p",{className:"text-center text-gray-200 text-sm leading-relaxed font-sans",children:H||"The content synthesis process requires additional time."}),e.jsx("p",{className:"text-center text-gray-500 text-xs mt-3 font-mono",children:"Your progress is safely preserved."})]}),B>0&&e.jsxs("div",{className:"flex flex-col items-center mb-8",children:[e.jsxs("div",{className:"relative w-28 h-28",children:[e.jsxs("svg",{className:"w-28 h-28 -rotate-90",children:[e.jsx("circle",{cx:"56",cy:"56",r:"50",stroke:"currentColor",strokeWidth:"3",fill:"transparent",className:"text-white/5"}),e.jsx("circle",{cx:"56",cy:"56",r:"50",stroke:"currentColor",strokeWidth:"3",fill:"transparent",strokeDasharray:314,strokeDashoffset:314-314*B/60,className:"text-vital-cyan transition-all duration-1000",strokeLinecap:"round"})]}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("span",{className:"text-3xl font-mono font-light text-serum-white",children:B})})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-3 tracking-widest uppercase font-sans",children:"Auto-retry in progress"})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("button",{onClick:()=>{q(!1),V(0),a(Hl.IDLE),o(e=>e.filter(e=>e.id!==s)),l(null),p([]),m(""),u("dashboard")},className:"flex-1 px-6 py-4 rounded-xl bg-white/[0.03] border border-white/[0.08] text-gray-200 font-medium hover:bg-white/[0.06] hover:border-white/[0.15] hover:text-serum-white transition-all duration-300 flex items-center justify-center gap-2 group",children:[e.jsx(xt,{size:18,className:"group-hover:rotate-90 transition-transform duration-300"}),e.jsx("span",{className:"tracking-wide",children:"Cancel"})]}),e.jsxs("button",{onClick:async()=>{if(B>0)return;V(60);const e=setInterval(()=>{V(t=>t<=1?(clearInterval(e),q(!1),a(Hl.BUILDING_GRAPH),P(!0),Se().catch(e=>{q(!0),$("Auto-retry failed. Please try again or start over.")}),0):t-1)},1e3)},disabled:B>0,className:"flex-1 px-6 py-4 rounded-xl font-semibold transition-all duration-300 flex items-center justify-center gap-2 "+(B>0?"bg-white/[0.03] text-gray-500 cursor-not-allowed":"bg-vital-cyan text-bio-void hover:shadow-[0_0_40px_rgba(42,212,212,0.3)] hover:scale-[1.02]"),children:[e.jsx(vt,{size:18}),e.jsx("span",{className:"tracking-wide",children:B>0?"Waiting...":"Retry Now"})]})]})]})}),e.jsxs("aside",{className:"w-20 border-r border-white/[0.04] flex flex-col items-center py-8 gap-10 z-30 transition-colors duration-500 "+(s?"bg-[#030406]":"bg-bio-deep/50 backdrop-blur-sm"),children:[e.jsxs("div",{className:"relative cursor-pointer group",onClick:()=>{l(null),u("dashboard")},title:"New Session",children:[e.jsx("div",{className:"absolute inset-0 w-4 h-4 m-auto rounded-full bg-vital-cyan/30 animate-ping"}),e.jsx("div",{className:"w-4 h-4 rounded-full bg-vital-cyan shadow-[0_0_20px_rgba(42,212,212,0.6)] group-hover:shadow-[0_0_30px_rgba(42,212,212,0.8)] transition-shadow duration-300"})]}),e.jsxs("nav",{className:"flex flex-col gap-2 w-full px-3",children:[e.jsxs("button",{onClick:()=>{l(null),u("dashboard")},className:"relative p-3.5 rounded-xl transition-all duration-300 flex justify-center group "+("dashboard"!==c||s?"text-gray-500 hover:text-serum-white hover:bg-white/[0.03]":"text-vital-cyan bg-vital-cyan/[0.08]"),title:"Upload",children:[e.jsx(he,{size:20,className:"relative z-10"}),"dashboard"===c&&!s&&e.jsx("div",{className:"absolute inset-0 rounded-xl border border-vital-cyan/20"}),e.jsx("span",{className:"absolute left-full ml-3 text-[10px] font-mono tracking-widest text-gray-300 opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap pointer-events-none",children:"UPLOAD"})]}),e.jsxs("button",{onClick:()=>{u("library"),l(null),k(!1),A(null)},className:"relative p-3.5 rounded-xl transition-all duration-300 flex justify-center group "+("library"===c?"text-vital-cyan bg-vital-cyan/[0.08]":"text-gray-500 hover:text-serum-white hover:bg-white/[0.03]"),title:"Library",children:[e.jsx(De,{size:20,className:"relative z-10"}),"library"===c&&e.jsx("div",{className:"absolute inset-0 rounded-xl border border-vital-cyan/20"}),e.jsx("span",{className:"absolute left-full ml-3 text-[10px] font-mono tracking-widest text-gray-300 opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap pointer-events-none",children:"LIBRARY"})]})]}),e.jsx("div",{className:"mt-auto",children:e.jsxs("button",{onClick:()=>ne(!0),className:"relative group",title:"Edit Profile",children:[J?.profilePicture?e.jsx("img",{src:J.profilePicture,alt:"Profile",className:"w-9 h-9 rounded-xl object-cover border border-white/10 opacity-70 hover:opacity-100 hover:border-vital-cyan/30 transition-all duration-300"}):e.jsx("div",{className:"w-9 h-9 rounded-xl bg-white/[0.03] border border-white/10 flex items-center justify-center opacity-70 hover:opacity-100 hover:border-vital-cyan/30 transition-all duration-300",children:e.jsx(yt,{size:16,className:"text-gray-200"})}),e.jsx("span",{className:"absolute left-full ml-3 text-[10px] font-mono tracking-widest text-gray-300 opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap pointer-events-none",children:"PROFILE"})]})})]}),e.jsxs("main",{className:"flex-1 flex flex-col h-screen overflow-hidden relative",children:[e.jsxs("header",{className:"h-16 border-b border-white/[0.04] flex items-center justify-between px-8 z-20 shrink-0 transition-colors duration-500 "+(s?"bg-[#030406]":"bg-bio-deep/30 backdrop-blur-md"),children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("h1",{className:"text-base font-sans tracking-[0.15em] text-serum-white/90 font-medium uppercase",children:["Synapse ",e.jsx("span",{className:"font-light text-gray-500",children:"Med"})]}),fe&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"h-4 w-px bg-white/10"}),e.jsx("span",{className:"text-sm font-serif italic text-vital-cyan/80 truncate max-w-[220px]",children:fe.title})]})]}),e.jsxs("div",{className:"flex items-center gap-5",children:[le&&e.jsx("div",{className:"absolute top-0 left-0 right-0 h-0.5 z-[60] bg-gradient-to-r from-pink-500 via-tissue-rose to-synapse-amber animate-pulse"}),e.jsxs("div",{className:"hidden md:flex items-center gap-3",children:[le&&e.jsx(te,{size:14,className:"text-pink-400 animate-bounce"}),e.jsx("span",{className:"text-xs font-sans text-gray-500",children:ue.prefix})]}),e.jsxs("button",{onClick:()=>ne(!0),className:"flex items-center gap-2 px-3 py-2 rounded-xl bg-white/[0.02] border border-white/[0.06] hover:border-vital-cyan/30 hover:bg-vital-cyan/[0.03] transition-all duration-300 group",title:"Edit Profile",children:[J?.profilePicture?e.jsx("img",{src:J.profilePicture,alt:"Profile",className:"w-5 h-5 rounded-lg object-cover"}):e.jsx(yt,{size:14,className:"text-gray-500 group-hover:text-vital-cyan transition-colors"}),e.jsx(it,{size:11,className:"text-gray-500 group-hover:text-vital-cyan transition-colors"})]}),e.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 rounded-xl bg-white/[0.02] border border-white/[0.04]",children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-synapse-amber shadow-[0_0_8px_rgba(240,180,41,0.6)] animate-pulse"}),e.jsx("span",{className:"text-[9px] font-mono text-gray-200 tracking-[0.2em] uppercase",children:"Flow State"})]})]})]}),"dashboard"===c&&!s&&e.jsx("div",{className:"flex-1 overflow-y-auto relative",children:e.jsxs("div",{className:"relative z-10 max-w-6xl mx-auto px-8 py-6 lg:px-16 lg:py-8",children:[e.jsxs("div",{className:"mb-6 lg:mb-4 animate-[fadeInUp_0.6s_ease-out]",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[ue.icon&&(()=>{const t=ue.icon;return e.jsx("div",{className:`p-1 rounded-md bg-white/5 ${ue.accentColor||"text-vital-cyan"} opacity-70`,children:e.jsx(t,{size:12})})})(),e.jsx("span",{className:"h-px w-8 bg-vital-cyan/60"}),e.jsx("span",{className:"font-sans text-[11px] uppercase tracking-[0.25em] text-vital-cyan/90 font-semibold",children:"Ready for Synthesis"})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("h2",{className:"font-serif text-5xl lg:text-6xl text-serum-white/95 italic tracking-tight leading-tight",children:"Welcome back,"}),e.jsxs("div",{className:"font-serif text-5xl lg:text-6xl not-italic font-semibold tracking-tight leading-tight py-2 "+(ue.gradient?`bg-gradient-to-r ${ue.gradient} bg-clip-text text-transparent`:"text-serum-white/95"),children:[J?.name,"."]}),ue.suffix&&e.jsxs("div",{className:`mt-4 text-sm lg:text-base ${ue.accentColor||"text-vital-cyan"}/80 font-sans not-italic animate-fadeInUp animate-subtlePulse`,children:[" ",ue.suffix]},ue.suffix)]})]}),e.jsxs("div",{className:"grid grid-cols-12 gap-8 lg:gap-12 items-start",children:[e.jsxs("div",{className:"col-span-12 lg:col-span-5 mt-8 space-y-10 animate-[fadeInUp_0.6s_ease-out_0.1s_both]",children:[e.jsxs("div",{className:"relative pl-6 border-l border-white/10",children:[e.jsx("span",{className:"absolute -left-[5px] top-0 w-2.5 h-2.5 rounded-full bg-vital-cyan shadow-[0_0_8px_rgba(42,212,212,0.4)]"}),e.jsx("h3",{className:"font-sans text-sm uppercase tracking-[0.2em] text-gray-200 mb-3",children:"Step 01. Context"}),e.jsx("input",{type:"text",placeholder:"Define your study topic...",value:h,onChange:e=>m(e.target.value),className:"w-full bg-transparent border-b border-white/10 py-2 font-serif text-2xl lg:text-3xl text-serum-white/95 placeholder-gray-400 focus:outline-none focus:border-vital-cyan transition-colors"})]}),e.jsxs("div",{className:"relative pl-6 border-l border-white/10",children:[e.jsx("span",{className:"absolute -left-[5px] top-0 w-2.5 h-2.5 rounded-full bg-gray-700"}),e.jsx("h3",{className:"font-sans text-sm uppercase tracking-[0.2em] text-gray-200 mb-3",children:"Step 02. Source"}),e.jsxs("p",{className:"font-sans text-sm text-gray-200 leading-relaxed max-w-sm",children:["Drop lecture slides, textbook PDFs, or handwritten notes.",e.jsx("br",{}),e.jsx("span",{className:"text-gray-200 text-xs mt-2 block",children:"Synapse will build an interactive knowledge graph, generate a comprehensive study guide with clinical pearls, and create an audio podcast for on-the-go revision."})]})]}),e.jsx("div",{className:"pt-6 border-t border-white/[0.06] mt-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-sans text-[10px] uppercase tracking-[0.2em] text-gray-200 mb-1",children:"Knowledge Base"}),e.jsxs("p",{className:"font-serif text-lg italic text-gray-200",children:[i.length," Nodes Active"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"font-sans text-[10px] uppercase tracking-[0.2em] text-gray-500 mb-1",children:"AI Model"}),e.jsx("p",{className:"font-mono text-xs text-vital-cyan/85",children:"Gemini 2.5 Flash"})]})]})})]}),e.jsxs("div",{className:"col-span-12 lg:col-span-7 animate-[fadeInUp_0.6s_ease-out_0.2s_both] lg:-mt-32",children:[e.jsxs("div",{ref:me,onClick:()=>pe.current?.click(),className:"glass-slide interactive-card relative w-full min-h-[420px] rounded-[2rem] p-8 lg:p-10 cursor-pointer overflow-hidden group "+(d.length>0?"border border-vital-cyan/20":"border border-white/[0.04]"),children:[e.jsx("input",{type:"file",multiple:!0,ref:pe,onChange:ve,className:"hidden",accept:".pdf,.txt,.png,.jpg,.jpeg,.heic,.heif,.webp,.aac,.flac,.mp3,.m4a,.mpeg,.mpga,.mp4,.ogg,.pcm,.wav,.webm,.flv,.mov,.mpg,.mp4,.webm,.wmv,.3gpp"}),e.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-80 h-80 bg-vital-cyan/5 rounded-full blur-[100px] pointer-events-none opacity-0 group-hover:opacity-60 transition-opacity duration-700"}),e.jsxs("div",{className:"h-full flex flex-col justify-between relative z-10",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-vital-cyan/60 animate-pulse shadow-[0_0_10px_rgba(42,212,212,0.5)]"}),e.jsx("span",{className:"font-mono text-[9px] text-vital-cyan/80 tracking-[0.2em] uppercase",children:"Ready"})]}),e.jsx("span",{className:"font-mono text-[8px] text-gray-500 border border-white/[0.06] px-2.5 py-1 rounded-lg tracking-widest uppercase",children:"Secure Upload"})]}),e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center py-8",children:[e.jsxs("div",{className:"relative w-44 h-44 flex items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 rounded-full border border-dashed transition-all duration-500 "+(d.length>0?"border-vital-cyan/40":"border-white/10 group-hover:border-vital-cyan/30")}),e.jsx("div",{className:"absolute inset-0 rounded-full border-2 border-t-transparent border-vital-cyan/40 opacity-0 group-hover:opacity-100 transition-opacity duration-500 animate-[spin_4s_linear_infinite]"}),e.jsx("div",{className:"absolute inset-[16px] rounded-full border border-b-transparent border-white/20 opacity-0 group-hover:opacity-100 transition-opacity duration-700 animate-[spin_6s_linear_infinite_reverse]"}),e.jsx("div",{className:"absolute inset-[24px] rounded-full transition-all duration-500 "+(d.length>0?"bg-vital-cyan/10 border border-vital-cyan/30":"bg-white/[0.02] border border-white/[0.06] group-hover:bg-vital-cyan/5 group-hover:border-vital-cyan/20")}),e.jsx("div",{className:"relative z-10 flex flex-col items-center transition-transform duration-500 group-hover:scale-110",children:d.length>0?e.jsx(st,{size:36,className:"text-vital-cyan animate-pulse"}):e.jsx(he,{size:36,className:"text-gray-400 group-hover:text-vital-cyan transition-colors duration-300"})})]}),e.jsxs("div",{className:"mt-8 text-center space-y-3",children:[e.jsx("h3",{className:"font-serif italic text-2xl text-serum-white",children:d.length>0?`${d.length} Sources Staged`:"Add Clinical Sources"}),e.jsxs("div",{className:"flex gap-3 justify-center text-[10px] font-mono tracking-wide text-gray-500 uppercase",children:[e.jsx("span",{children:"PDF"}),e.jsx("span",{className:"text-white/20",children:""}),e.jsx("span",{children:"TXT"}),e.jsx("span",{className:"text-white/20",children:""}),e.jsx("span",{children:"Images"}),e.jsx("span",{className:"text-white/20",children:""}),e.jsx("span",{children:"Audio"}),e.jsx("span",{className:"text-white/20",children:""}),e.jsx("span",{children:"Video"})]})]})]}),d.length>0&&e.jsx("div",{className:"mb-6 space-y-2 max-h-32 overflow-y-auto custom-scrollbar",onClick:e=>e.stopPropagation(),children:d.map((t,n)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-white/[0.02] rounded-xl border border-white/[0.04] group/file hover:border-vital-cyan/20 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[t.type.includes("pdf")?e.jsx(Ce,{size:16,className:"text-tissue-rose"}):t.type.includes("image")?e.jsx(Ee,{size:16,className:"text-vital-cyan"}):e.jsx(Ne,{size:16,className:"text-neural-purple"}),e.jsx("span",{className:"text-xs text-gray-200 truncate max-w-[200px] font-sans",children:t.file.name})]}),e.jsx("button",{onClick:e=>{e.stopPropagation(),we(n)},className:"text-gray-500 hover:text-tissue-rose transition-colors p-1",children:e.jsx(xt,{size:14})})]},n))}),e.jsxs("div",{className:"flex items-end justify-between font-mono text-[9px] text-gray-500 uppercase tracking-widest",children:[e.jsx("div",{className:d.length>0?"text-vital-cyan":"",children:d.length>0?`${d.length} sources detected`:"awaiting clinical sources..."}),e.jsx("div",{className:"text-gray-600",children:"synapse ready :: active"})]})]})]}),e.jsx("button",{onClick:Se,disabled:0===d.length,className:"w-full mt-6 py-5 rounded-2xl font-mono font-bold tracking-[0.15em] uppercase text-sm flex items-center justify-center gap-3 transition-all duration-500 "+(d.length>0?"bg-serum-white text-bio-void hover:shadow-[0_0_50px_rgba(255,255,255,0.25)] hover:scale-[1.01]":"bg-white/[0.02] text-gray-500 cursor-not-allowed border border-white/[0.04]"),children:d.length>0?e.jsxs(e.Fragment,{children:[e.jsx(vt,{size:18,className:"animate-pulse"}),e.jsx("span",{children:"Synthesize Graph"})]}):e.jsx("span",{children:"Add Files to Begin"})})]})]}),e.jsxs("footer",{className:"mt-12 lg:mt-10 pt-8 border-t border-white/[0.04] flex justify-between text-[9px] font-mono text-gray-500 tracking-[0.15em] uppercase",children:[e.jsx("div",{children:"AI Model: Gemini 2.5 Flash"}),e.jsxs("div",{children:["Status:"," ",d.length>0?"Ready for Synthesis":"Awaiting Input"]}),e.jsx("div",{children:"Synapse Med"})]})]})}),"library"===c&&e.jsxs("div",{className:"flex-1 overflow-y-auto relative",children:[e.jsx("div",{className:"absolute top-20 left-1/4 w-[500px] h-[500px] bg-neural-purple/[0.02] rounded-full blur-[150px] pointer-events-none"}),e.jsxs("div",{className:"relative z-10 p-10 lg:p-16",children:[e.jsxs("div",{className:"mb-12 animate-[fadeInUp_0.6s_ease-out]",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("span",{className:"h-px w-10 bg-neural-purple/50"}),e.jsx("span",{className:"font-sans text-[10px] uppercase tracking-[0.25em] text-neural-purple/90 font-semibold",children:"Knowledge Archive"})]}),e.jsx("h2",{className:"font-serif text-4xl lg:text-5xl text-serum-white italic",children:"Your Neural Library"}),e.jsxs("p",{className:"text-gray-500 mt-3 font-sans text-sm",children:[i.length," synthesized guides  Click to explore"]})]}),i.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6 animate-[fadeInUp_0.6s_ease-out_0.1s_both]",children:i.map((t,n)=>e.jsxs("div",{onClick:()=>{l(t.id),u("dashboard")},className:"interactive-card glass-slide relative p-7 rounded-2xl cursor-pointer border border-white/[0.04] group overflow-hidden",style:{animationDelay:.05*n+"s"},children:[e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-vital-cyan/[0.03] rounded-full blur-[60px] pointer-events-none opacity-0 group-hover:opacity-100 transition-opacity duration-500"}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex justify-between items-start mb-5",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-vital-cyan/10 to-clinical-teal/5 border border-vital-cyan/10 flex items-center justify-center",children:e.jsx(Ae,{size:22,className:"text-vital-cyan"})}),e.jsx("span",{className:"text-[10px] text-gray-500 font-mono tracking-wider",children:new Date(t.timestamp).toLocaleDateString("en-US",{month:"short",day:"numeric"})})]}),e.jsx("h3",{className:"text-xl font-serif text-serum-white group-hover:text-vital-cyan transition-colors duration-300 mb-3 line-clamp-2",children:t.title}),e.jsx("p",{className:"text-sm text-gray-500 line-clamp-2 font-sans leading-relaxed mb-5",children:t.summary}),e.jsxs("div",{className:"flex items-center gap-4 pt-4 border-t border-white/[0.04]",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(ee,{size:12,className:"text-gray-500"}),e.jsxs("span",{className:"text-[10px] text-gray-500 font-mono",children:[t.graphData.nodes.length," nodes"]})]}),t.podcastScript&&t.podcastScript.length>0&&e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(je,{size:12,className:"text-tissue-rose"}),e.jsx("span",{className:"text-[10px] text-gray-500 font-mono",children:"Audio"})]})]})]})]},t.id))}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 animate-[fadeInUp_0.6s_ease-out]",children:[e.jsx("div",{className:"w-24 h-24 rounded-2xl bg-white/[0.02] border border-white/[0.06] flex items-center justify-center mb-6",children:e.jsx(De,{size:40,className:"text-gray-500"})}),e.jsx("h3",{className:"font-serif text-2xl text-gray-200 italic mb-2",children:"No guides yet"}),e.jsx("p",{className:"text-gray-500 text-sm font-sans mb-6",children:"Upload your first clinical sources to begin"}),e.jsxs("button",{onClick:()=>u("dashboard"),className:"px-6 py-3 rounded-xl bg-vital-cyan/10 border border-vital-cyan/20 text-vital-cyan text-sm font-medium hover:bg-vital-cyan/20 transition-colors flex items-center gap-2",children:[e.jsx(Xe,{size:16}),"Create Your First Guide"]})]})]})]}),"dashboard"===c&&s&&fe&&e.jsx("div",{className:"flex-1 flex overflow-hidden",children:e.jsxs("div",{className:"flex-1 flex relative overflow-hidden",children:["guide"===f&&e.jsxs("div",{className:"flex-1 flex flex-col animate-[fadeIn_0.3s_ease-out]",children:[e.jsxs("div",{className:"h-14 border-b border-white/[0.04] flex items-center px-6 bg-[#030406] gap-6 justify-between",children:[e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>g("guide"),className:"px-5 py-2 rounded-xl text-xs font-sans font-medium tracking-wide bg-vital-cyan/10 text-vital-cyan border border-vital-cyan/20 transition-all shadow-[0_0_15px_rgba(42,212,212,0.15)]",children:"Master Guide"}),e.jsx("button",{onClick:()=>g("graph"),className:"px-5 py-2 rounded-xl text-xs font-sans font-medium tracking-wide text-gray-500 hover:text-serum-white transition-all hover:bg-white/[0.03] border border-transparent hover:border-white/[0.06]",children:"Neural Web"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("button",{onClick:_e,className:"flex items-center gap-2.5 px-4 py-2 rounded-xl border text-[10px] font-sans font-semibold uppercase tracking-[0.1em] transition-all duration-300 "+(C?"bg-vital-cyan/10 border-vital-cyan/30 text-vital-cyan shadow-[0_0_20px_rgba(42,212,212,0.15)]":"border-white/[0.06] text-gray-500 hover:text-serum-white hover:border-vital-cyan/30 hover:bg-vital-cyan/[0.03]"),children:[e.jsx(Z,{size:14}),e.jsx("span",{className:"hidden md:block",children:C?"Close AI":"Ask AI"}),!C&&e.jsx("span",{className:"hidden lg:flex items-center gap-1 text-[8px] text-gray-500 bg-white/[0.03] px-2 py-0.5 rounded-md font-mono",children:"or highlight"})]}),e.jsx("div",{className:"w-px h-6 bg-white/[0.06]"}),fe.podcastScript&&fe.podcastScript.length>0?e.jsx(jt,{script:fe.podcastScript,audioBase64:fe.audioBase64}):e.jsx("button",{onClick:ke,disabled:w,className:"px-4 py-2 bg-tissue-rose/10 hover:bg-tissue-rose/15 border border-tissue-rose/20 rounded-xl text-tissue-rose text-[10px] font-sans font-semibold uppercase tracking-[0.1em] transition-all flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:w?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-2 h-2 border-2 border-current border-t-transparent rounded-full animate-spin"})," ","Synthesizing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(je,{size:12})," Generate Podcast"]})}),e.jsxs("button",{onClick:()=>_(!0),className:"px-4 py-2 bg-neural-purple/10 hover:bg-neural-purple/15 border border-neural-purple/20 rounded-xl text-neural-purple text-[10px] font-sans font-semibold uppercase tracking-[0.1em] transition-all flex items-center gap-2 hover:shadow-[0_0_20px_rgba(167,139,250,0.15)]",title:"Export Study Guide",children:[e.jsx(Ve,{size:12}),e.jsx("span",{className:"hidden md:block",children:"Export"})]})]})]}),e.jsxs("div",{className:"flex-1 flex overflow-hidden relative bg-[#080a0d]",children:[e.jsx("div",{className:"overflow-y-auto scroll-smooth transition-all duration-500 ease-out custom-scrollbar "+(C?"pr-[600px]":"w-full"),style:{flex:1},onMouseUp:Te,children:e.jsxs("div",{className:"relative py-12 transition-all duration-500 "+(C?"pl-16 pr-12 max-w-5xl":"px-10 max-w-4xl mx-auto"),children:[e.jsx("div",{className:"absolute top-0 -right-1/4 w-[500px] h-[500px] bg-vital-cyan/[0.025] rounded-full blur-[120px] pointer-events-none z-0"}),e.jsx("div",{className:"absolute bottom-1/3 -left-1/4 w-[400px] h-[400px] bg-neural-purple/[0.015] rounded-full blur-[100px] pointer-events-none z-0"}),e.jsxs("div",{className:"relative z-10",children:[y&&fe.eli5Analogy&&e.jsxs("div",{className:"mb-10 p-7 bg-gradient-to-br from-neural-purple/10 to-transparent border border-neural-purple/20 rounded-2xl",children:[e.jsx("h3",{className:"text-neural-purple font-sans font-semibold mb-3 text-[10px] uppercase tracking-[0.15em]",children:"Analogy Mode"}),e.jsxs("p",{className:"text-gray-200 text-lg font-serif italic leading-relaxed",children:['"',fe.eli5Analogy,'"']})]}),e.jsx("div",{className:"markdown-content",children:e.jsx(t,{remarkPlugins:[n],urlTransform:e=>e,components:{h1:({node:t,children:n,...r})=>e.jsx("h1",{...r,children:n}),h2:({node:t,children:n,...r})=>e.jsx("h2",{...r,children:n}),h3:({node:t,children:n,...r})=>e.jsx("h3",{...r,children:n}),h4:({node:t,children:n,...r})=>e.jsx("h4",{...r,children:n}),h5:({node:t,children:n,...r})=>e.jsx("h5",{...r,children:n}),h6:({node:t,children:n,...r})=>e.jsx("h6",{...r,children:n}),a:({node:t,...n})=>{const r=n.href||"";if(r.startsWith("node:")){const t=r.split(":")[1];return e.jsx("span",{className:"smart-link",onClick:e=>{e.preventDefault(),e.stopPropagation();const n=fe.graphData.nodes.find(e=>e.id===t);n&&(v(n),g("graph"))},role:"button",tabIndex:0,onKeyDown:e=>{if("Enter"===e.key||" "===e.key){e.preventDefault();const n=fe.graphData.nodes.find(e=>e.id===t);n&&(v(n),g("graph"))}},children:n.children})}return r.startsWith("http")?e.jsxs("a",{...n,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-0.5 text-[0.8em] font-sans font-medium text-gray-500 bg-white/5 px-1.5 py-0.5 rounded border border-white/10 hover:border-clinical-cyan hover:text-clinical-cyan transition-all align-middle mx-1",children:[n.children," ",e.jsx(ye,{size:8})]}):e.jsx("span",{className:"text-clinical-cyan/80 border-b border-dotted border-clinical-cyan/50 cursor-help",title:"Reference",children:n.children})}},children:fe.markdownContent})})]}),fe.pearls&&fe.pearls.length>0&&fe.markdownContent&&fe.markdownContent.length>100&&e.jsxs("div",{className:"mb-10 mt-16 pt-10 border-t border-white/[0.04]",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-synapse-amber/10 border border-synapse-amber/20 flex items-center justify-center",children:e.jsx(st,{className:"w-5 h-5 text-synapse-amber"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-sans font-semibold text-serum-white",children:"Clinical Pearls"}),e.jsxs("span",{className:"text-[10px] font-mono text-synapse-amber/70 tracking-wide",children:[fe.pearls.length," high-yield insights"]})]})]}),e.jsx("div",{className:"grid gap-4",children:fe.pearls.map((t,n)=>{const r={"red-flag":{icon:gt,bg:"bg-gradient-to-r from-tissue-rose/10 to-tissue-rose/[0.02]",border:"border-tissue-rose/20",accent:"bg-tissue-rose",text:"text-red-200",label:" Red Flag",labelColor:"text-tissue-rose"},"exam-tip":{icon:Ae,bg:"bg-gradient-to-r from-vital-cyan/10 to-vital-cyan/[0.02]",border:"border-vital-cyan/20",accent:"bg-vital-cyan",text:"text-cyan-200",label:" Exam Tip",labelColor:"text-vital-cyan"},"gap-filler":{icon:Me,bg:"bg-gradient-to-r from-neural-purple/10 to-neural-purple/[0.02]",border:"border-neural-purple/20",accent:"bg-neural-purple",text:"text-purple-200",label:" Gap Filler",labelColor:"text-neural-purple"},"fact-check":{icon:ce,bg:"bg-gradient-to-r from-synapse-amber/10 to-synapse-amber/[0.02]",border:"border-synapse-amber/20",accent:"bg-synapse-amber",text:"text-amber-200",label:" Fact Check",labelColor:"text-synapse-amber"}},a=r[t.type]||r["fact-check"],i=a.icon;return e.jsxs("div",{className:`relative overflow-hidden rounded-2xl border ${a.border} ${a.bg} p-5 hover:scale-[1.01] transition-all duration-300`,children:[e.jsx("div",{className:`absolute left-0 top-0 bottom-0 w-1 ${a.accent}`}),e.jsxs("div",{className:"flex gap-4 pl-3",children:[e.jsx("div",{className:`shrink-0 w-9 h-9 rounded-xl ${a.bg} border ${a.border} flex items-center justify-center`,children:e.jsx(i,{className:`w-4 h-4 ${a.labelColor}`})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:`text-[9px] font-sans font-semibold tracking-[0.15em] uppercase mb-2 ${a.labelColor}`,children:a.label}),e.jsx("div",{className:`text-sm leading-relaxed font-sans ${a.text}`,children:t.content})]})]})]},n)})}),J&&e.jsx("div",{className:"mt-8 p-6 rounded-2xl glass-slide border border-white/[0.04]",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"shrink-0 w-12 h-12 rounded-xl bg-gradient-to-br from-neural-purple/20 to-vital-cyan/10 border border-neural-purple/20 flex items-center justify-center overflow-hidden",children:J.profilePicture?e.jsx("img",{src:J.profilePicture,alt:"",className:"w-12 h-12 object-cover"}):e.jsx(st,{className:"w-5 h-5 text-neural-purple"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm text-gray-200 leading-relaxed font-sans",children:le?` Happy Birthday, ${J.name}! What a gift to yourselfmastering ${fe?.title||"this topic"}. May this year bring clinical excellence and countless "aha!" moments. `:`Keep pushing, ${J.name}! Every pearl you absorb brings you closer to mastery. ${J.level?.includes("Student")?"Your dedication will pay offfuture patients are counting on clinicians like you.":"Your commitment to learning sets you apart as a true professional."} `}),e.jsx("p",{className:"text-[10px] text-vital-cyan/50 mt-2 font-mono tracking-wider",children:" Your Synapse Neural Mentor"})]})]})})]}),fe.sources&&fe.sources.length>0&&e.jsxs("div",{className:"mt-16 pt-10 border-t border-white/[0.04]",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-clinical-teal/10 border border-clinical-teal/20 flex items-center justify-center",children:e.jsx(ce,{size:18,className:"text-clinical-teal"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-base font-sans font-semibold text-serum-white",children:"Verified Sources"}),e.jsxs("span",{className:"text-[10px] font-mono text-clinical-teal/70 tracking-wide",children:[fe.sources.length," references"]})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:fe.sources.map((t,n)=>e.jsxs("a",{href:t.uri,target:"_blank",rel:"noopener noreferrer",className:"flex flex-col p-4 bg-white/[0.02] border border-white/[0.04] rounded-xl hover:bg-white/[0.04] hover:border-vital-cyan/20 transition-all group",children:[e.jsx("span",{className:"text-xs font-sans font-medium text-gray-200 truncate group-hover:text-vital-cyan transition-colors",children:t.title}),e.jsx("span",{className:"text-[10px] text-gray-500 truncate font-mono mt-1",children:new URL(t.uri).hostname})]},n))})]}),fe.sourceFileIds&&fe.sourceFileIds.length>0&&e.jsxs("div",{className:"mt-16 pt-10 border-t border-white/[0.04]",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-tissue-rose/10 border border-tissue-rose/20 flex items-center justify-center",children:e.jsx(Ce,{size:18,className:"text-tissue-rose"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-base font-sans font-semibold text-serum-white",children:"Attachments"}),e.jsxs("span",{className:"text-[10px] font-mono text-tissue-rose/70 tracking-wide",children:[fe.sourceFileIds.length," file",1!==fe.sourceFileIds.length?"s":""]})]})]}),e.jsx("div",{className:"space-y-3",children:fe.sourceFileIds.map((t,n)=>e.jsx(fc,{fileId:t},n))})]})]})}),e.jsx("div",{className:"fixed top-[112px] right-0 bottom-0 bg-[#050607] border-l border-white/[0.04] shadow-[-50px_0_120px_rgba(0,0,0,0.9)] transition-all duration-500 ease-out z-40 "+(C?"translate-x-0 opacity-100":"translate-x-full opacity-0 pointer-events-none"),style:{width:"580px"},children:C&&J&&fe&&e.jsx(Il,{contextMarkdown:fe.markdownContent,userProfile:J,graphNodes:fe.graphData.nodes,noteTitle:fe.title,noteId:fe.id,initialSelection:T,onClose:()=>{k(!1),A(null)},onClearSelection:Ie})})]})]}),"graph"===f&&e.jsxs("div",{className:"flex-1 flex flex-col relative animate-[fadeIn_0.3s_ease-out] bg-[#030406]",children:[e.jsxs("div",{className:"h-14 border-b border-white/[0.04] flex items-center px-6 bg-[#030406] gap-6 justify-between shrink-0 z-20",children:[e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>g("guide"),className:"px-5 py-2 rounded-xl text-xs font-sans font-medium tracking-wide text-gray-500 hover:text-serum-white transition-all hover:bg-white/[0.03] border border-transparent hover:border-white/[0.06]",children:"Master Guide"}),e.jsx("button",{onClick:()=>g("graph"),className:"px-5 py-2 rounded-xl text-xs font-sans font-medium tracking-wide bg-vital-cyan/10 text-vital-cyan border border-vital-cyan/20 transition-all shadow-[0_0_15px_rgba(42,212,212,0.15)]",children:"Neural Web"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[fe.podcastScript&&fe.podcastScript.length>0?e.jsx(jt,{script:fe.podcastScript,audioBase64:fe.audioBase64}):e.jsx("button",{onClick:ke,disabled:w,className:"px-4 py-2 bg-tissue-rose/10 hover:bg-tissue-rose/15 border border-tissue-rose/20 rounded-xl text-tissue-rose text-[10px] font-sans font-semibold uppercase tracking-[0.1em] transition-all flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:w?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-2 h-2 border-2 border-current border-t-transparent rounded-full animate-spin"})," ","Synthesizing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(je,{size:12})," Generate Podcast"]})}),e.jsxs("button",{onClick:()=>_(!0),className:"px-4 py-2 bg-neural-purple/10 hover:bg-neural-purple/15 border border-neural-purple/20 rounded-xl text-neural-purple text-[10px] font-sans font-semibold uppercase tracking-[0.1em] transition-all flex items-center gap-2 hover:shadow-[0_0_20px_rgba(167,139,250,0.15)]",title:"Export Study Guide",children:[e.jsx(Ve,{size:12}),e.jsx("span",{className:"hidden md:block",children:"Export"})]})]})]}),e.jsxs("div",{className:"flex-1 relative bg-transparent overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-vital-cyan/[0.02] via-transparent to-neural-purple/[0.02] pointer-events-none"}),!Y&&r===Hl.WRITING_GUIDE&&e.jsx("div",{className:"absolute top-6 left-1/2 -translate-x-1/2 z-30 animate-[fadeIn_0.3s_ease-out]",children:e.jsxs("div",{className:"flex items-center gap-3 px-6 py-3 glass-slide border border-synapse-amber/20 rounded-2xl shadow-2xl",children:[e.jsx("div",{className:"flex gap-1",children:[0,1,2].map(t=>e.jsx("div",{className:"w-1.5 h-1.5 bg-synapse-amber rounded-full animate-bounce",style:{animationDelay:.15*t+"s"}},t))}),e.jsx("span",{className:"text-sm text-synapse-amber font-sans font-medium",children:"Master Guide is being synthesized..."}),e.jsxs("span",{className:"text-[10px] text-gray-500 font-mono",children:["(",(U/1e3).toFixed(1),"K chars)"]})]})}),e.jsx(At,{data:fe.graphData,onNodeSelect:e=>v(e),selectedNodeId:b?.id,inspectorOpen:null!==b,className:"w-full h-full"}),!b&&e.jsxs("div",{className:"absolute bottom-10 left-1/2 -translate-x-1/2 glass-slide border border-white/[0.06] px-8 py-4 rounded-2xl shadow-2xl flex items-center gap-4 animate-[fadeInUp_0.5s_ease-out_1s_both] pointer-events-none",children:[e.jsx("div",{className:"w-2.5 h-2.5 rounded-full bg-vital-cyan animate-pulse shadow-[0_0_15px_rgba(42,212,212,0.5)]"}),e.jsx("span",{className:"text-xs font-sans font-medium text-gray-200 tracking-wide",children:Y||r!==Hl.WRITING_GUIDE?"Select a node to unlock deep clinical insights":"Graph ready  Guide still synthesizing in background"})]}),e.jsx(Ut,{node:b,graphData:fe.graphData,onClose:()=>v(null),onNodeClick:e=>{const t=fe.graphData.nodes.find(t=>t.id===e);t&&v(t)}})]})]})]})})]})]})]})},xc=document.getElementById("root");if(!xc)throw new Error("Could not find root element to mount to");F.createRoot(xc).render(e.jsx(A.StrictMode,{children:e.jsx(yc,{})}));
